
    <!DOCTYPE html>
    <html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Details Report for Atmaal</title>
        <style>
            body { font-family: Arial, sans-serif; margin: 20px; }
            h1, h2 { text-align: center; }
            .tabbed-section { margin-top: 20px; }
            .tabs { display: flex; flex-wrap: wrap; border-bottom: 2px solid #ccc; cursor: pointer; }
            .tab { padding: 10px 20px; border: 1px solid #ccc; border-bottom: none; background-color: #e0e0e0; }
            .tab.active { background-color: #f4f4f4; font-weight: bold; }
            .tab-content { display: none; padding: 20px; border: 1px solid #ccc; }
            .tab-content.active { display: block; }
            table { width: 100%; border-collapse: collapse; margin-top: 20px; }
            th, td { border: 1px solid #ccc; padding: 8px; text-align: left; vertical-align: top; }
            th { background-color: #f4f4f4; cursor: pointer; }
            .row-count { font-weight: bold; margin-bottom: 10px; }

            .code-btn {
              padding: 6px 10px;
              cursor: pointer;
              border: 1px solid #888;
              border-radius: 6px;
              background: #f4f4f4;
            }

            .code-modal-overlay {
              display: none;
              position: fixed;
              inset: 0;
              background: rgba(0,0,0,0.6);
              z-index: 9999;
              align-items: center;
              justify-content: center;
            }

            .code-modal-overlay.open {
              display: flex;
            }

            .code-modal {
              width: min(1200px, 92vw);
              height: min(800px, 86vh);
              background: #fff;
              border-radius: 10px;
              box-shadow: 0 10px 30px rgba(0,0,0,0.35);
              display: flex;
              flex-direction: column;
              overflow: hidden;
            }

            .code-modal-header {
              display: flex;
              align-items: center;
              justify-content: space-between;
              padding: 10px 12px;
              border-bottom: 1px solid #ddd;
              background: #f6f8fa;
            }

            .code-modal-title {
              font-weight: bold;
              font-family: Arial, sans-serif;
              font-size: 14px;
              overflow: hidden;
              text-overflow: ellipsis;
              white-space: nowrap;
              max-width: 70%;
            }

            .code-modal-actions button {
              margin-left: 8px;
            }

            .code-modal-action {
              padding: 6px 10px;
              cursor: pointer;
              border: 1px solid #888;
              border-radius: 6px;
              background: #fff;
            }

            /* Prevent word-wrap and keep code formatting */
            .code-modal-pre {
              margin: 0;
              padding: 12px;
              height: 100%;
              overflow: auto;
              background: #ffffff;
              border: none;
              font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
              font-size: 12px;
              line-height: 1.35;
              white-space: pre;      /* no wrap */
              word-break: normal;    /* no wrap */
              tab-size: 4;
            }
        </style>

        <script>
            function sortTable(header) {
                const table = header.closest('table');
                const index = Array.from(header.parentNode.children).indexOf(header);
                const rows = Array.from(table.querySelectorAll('tbody tr'));
                const isAscending = !header.classList.contains('ascending');

                rows.sort((a, b) => {
                    const aText = a.children[index].textContent.trim();
                    const bText = b.children[index].textContent.trim();

                    const aDate = new Date(aText.split('/').reverse().join('/'));
                    const bDate = new Date(bText.split('/').reverse().join('/'));
                    if (!isNaN(aDate) && !isNaN(bDate)) {
                        return isAscending ? aDate - bDate : bDate - aDate;
                    }

                    const aNum = parseFloat(aText.replace(/,/g,''));
                    const bNum = parseFloat(bText.replace(/,/g,''));
                    if (!isNaN(aNum) && !isNaN(bNum)) {
                        return isAscending ? aNum - bNum : bNum - aNum;
                    }

                    return isAscending ? aText.localeCompare(bText) : bText.localeCompare(aText);
                });

                rows.forEach(row => table.querySelector('tbody').appendChild(row));
                header.classList.toggle('ascending', isAscending);
            }

            document.addEventListener('DOMContentLoaded', function() {
                const tabs = document.querySelectorAll('.tab');
                const contents = document.querySelectorAll('.tab-content');
                tabs.forEach((tab, index) => {
                    tab.addEventListener('click', () => {
                        tabs.forEach(t => t.classList.remove('active'));
                        contents.forEach(c => c.classList.remove('active'));
                        tab.classList.add('active');
                        contents[index].classList.add('active');
                    });
                });
            });
        </script>

        <script>
          function openCodeModal(btn) {
            const overlay = document.getElementById("code-modal-overlay");
            const pre = document.getElementById("code-modal-pre");
            const title = document.getElementById("code-modal-title");

            const code = btn.getAttribute("data-code") || "";
            const t = btn.getAttribute("data-title") || "Code";

            // Put HTML-escaped code into <pre> safely
            pre.innerHTML = code;
            title.textContent = t;

            overlay.classList.add("open");
            document.body.style.overflow = "hidden"; // lock background scroll
          }

          function closeCodeModal(evt) {
            const overlay = document.getElementById("code-modal-overlay");
            overlay.classList.remove("open");
            document.body.style.overflow = "";
          }

          function copyCode() {
            const pre = document.getElementById("code-modal-pre");
            const text = pre.textContent || "";
            // NOTE: double braces because this HTML is built via a Python f-string
            navigator.clipboard.writeText(text).catch(() => {});
          }

          document.addEventListener("keydown", function(e) {
            if (e.key === "Escape") {
              const overlay = document.getElementById("code-modal-overlay");
              if (overlay.classList.contains("open")) closeCodeModal();
            }
          });
        </script>
    </head>
    <body>
        <h1>Details Report for Atmaal</h1>
        <div class="tabbed-section">
            <div class="tabs">
                <div class="tab active">Summary</div>
                <div class="tab">Stage Logging Summary</div>
                <div class="tab">Credential Usage</div>
                <div class="tab">Object Global Code</div>
                <div class="tab">Object Code Stages</div>
            </div>
            
        <div class="tab-content active">
            <h2>Summary</h2>
            <p>Customer: Atmaal</p>
            <p>Blue Prism Version: 7.3.0.15038</p>
            <p>JSONL export: <strong>code_stages.jsonl</strong></p>
        </div>
    
    <div class="tab-content">
        <h2>Stage Logging Summary (Counts &amp; %)</h2>
        <p class="row-count">Total Rows: 54</p>
        <table>
            <thead>
                <tr><th onclick="sortTable(this)">Process Name</th><th onclick="sortTable(this)">Total Stages</th><th onclick="sortTable(this)">No Logging (Count)</th><th onclick="sortTable(this)">No Logging (%)</th><th onclick="sortTable(this)">Errors Only (Exception Stages Count)</th><th onclick="sortTable(this)">Errors Only (%)</th><th onclick="sortTable(this)">Full Logging (Count)</th><th onclick="sortTable(this)">Full Logging (%)</th></tr>
            </thead>
            <tbody>
    <tr><td>ATMAAX API</td><td>149</td><td>64</td><td>42.95</td><td>7</td><td>4.7</td><td>85</td><td>57.05</td></tr><tr><td>CTF Utility - STC Letter Check</td><td>91</td><td>66</td><td>72.53</td><td>9</td><td>9.89</td><td>25</td><td>27.47</td></tr><tr><td>Change Password</td><td>26</td><td>0</td><td>0.0</td><td>2</td><td>7.69</td><td>26</td><td>100.0</td></tr><tr><td>Check Logged In</td><td>5</td><td>0</td><td>0.0</td><td>0</td><td>0.0</td><td>5</td><td>100.0</td></tr><tr><td>Cortex Application</td><td>166</td><td>139</td><td>83.73</td><td>14</td><td>8.43</td><td>27</td><td>16.27</td></tr><tr><td>Employer_List_Portal_V1.0</td><td>75</td><td>49</td><td>65.33</td><td>7</td><td>9.33</td><td>26</td><td>34.67</td></tr><tr><td>Employer_List_V1.0</td><td>62</td><td>43</td><td>69.35</td><td>6</td><td>9.68</td><td>19</td><td>30.65</td></tr><tr><td>Login</td><td>18</td><td>0</td><td>0.0</td><td>1</td><td>5.56</td><td>18</td><td>100.0</td></tr><tr><td>Login</td><td>18</td><td>0</td><td>0.0</td><td>1</td><td>5.56</td><td>18</td><td>100.0</td></tr><tr><td>Login Agent</td><td>118</td><td>78</td><td>66.1</td><td>2</td><td>1.69</td><td>40</td><td>33.9</td></tr><tr><td>Logout</td><td>6</td><td>0</td><td>0.0</td><td>0</td><td>0.0</td><td>6</td><td>100.0</td></tr><tr><td>MS Excel VBO</td><td>859</td><td>439</td><td>51.11</td><td>30</td><td>3.49</td><td>420</td><td>48.89</td></tr><tr><td>Mail-EWS</td><td>168</td><td>100</td><td>59.52</td><td>1</td><td>0.6</td><td>68</td><td>40.48</td></tr><tr><td>Millicom - Collection Utility</td><td>173</td><td>173</td><td>100.0</td><td>0</td><td>0.0</td><td>0</td><td>0.0</td></tr><tr><td>NewGen AutoLease Normal - Salary Transfer_V1.0</td><td>2376</td><td>0</td><td>0.0</td><td>77</td><td>3.24</td><td>2376</td><td>100.0</td></tr><tr><td>NewGen MRCC - Digital GOSI</td><td>3827</td><td>390</td><td>10.19</td><td>93</td><td>2.43</td><td>3437</td><td>89.81</td></tr><tr><td>NewGen_UW_CardsOperation_Object</td><td>138</td><td>100</td><td>72.46</td><td>15</td><td>10.87</td><td>38</td><td>27.54</td></tr><tr><td>New_SIMAH_Logic_V1.0</td><td>169</td><td>89</td><td>52.66</td><td>0</td><td>0.0</td><td>80</td><td>47.34</td></tr><tr><td>Newgen MRCC - IVR</td><td>1661</td><td>8</td><td>0.48</td><td>45</td><td>2.71</td><td>1653</td><td>99.52</td></tr><tr><td>Pending_Volume</td><td>26</td><td>14</td><td>53.85</td><td>0</td><td>0.0</td><td>12</td><td>46.15</td></tr><tr><td>RBS - CRS Unified Process_V1.0</td><td>65</td><td>38</td><td>58.46</td><td>3</td><td>4.62</td><td>27</td><td>41.54</td></tr><tr><td>RBS - CRS Unified_Obj_V1.0</td><td>115</td><td>84</td><td>73.04</td><td>17</td><td>14.78</td><td>31</td><td>26.96</td></tr><tr><td>Remote Desktop Connection For Local Configuration</td><td>61</td><td>1</td><td>1.64</td><td>0</td><td>0.0</td><td>60</td><td>98.36</td></tr><tr><td>Screenshot</td><td>22</td><td>12</td><td>54.55</td><td>0</td><td>0.0</td><td>10</td><td>45.45</td></tr><tr><td>UWCA_Balloon_Refinance_CTF_V1.0</td><td>2746</td><td>2710</td><td>98.69</td><td>293</td><td>10.67</td><td>36</td><td>1.31</td></tr><tr><td>UWCA_Balloon_Refinance_V1.0</td><td>2029</td><td>4</td><td>0.2</td><td>70</td><td>3.45</td><td>2025</td><td>99.8</td></tr><tr><td>UWCA_Common_Salary_and_Simah_logic_V1.0</td><td>241</td><td>240</td><td>99.59</td><td>1</td><td>0.41</td><td>1</td><td>0.41</td></tr><tr><td>UWCA_Common_Salary_and_Simah_logic_V2.0</td><td>260</td><td>250</td><td>96.15</td><td>1</td><td>0.38</td><td>10</td><td>3.85</td></tr><tr><td>UWCA_MRCC_CTF_V1.0</td><td>2775</td><td>2721</td><td>98.05</td><td>322</td><td>11.6</td><td>54</td><td>1.95</td></tr><tr><td>UWCA_MRCC_MSD_V1.0</td><td>180</td><td>178</td><td>98.89</td><td>17</td><td>9.44</td><td>2</td><td>1.11</td></tr><tr><td>UWCA_MRCC_V2.0</td><td>4952</td><td>181</td><td>3.66</td><td>248</td><td>5.01</td><td>4771</td><td>96.34</td></tr><tr><td>UWCA_MRCC_V3.0</td><td>6090</td><td>12</td><td>0.2</td><td>286</td><td>4.7</td><td>6078</td><td>99.8</td></tr><tr><td>Unlock</td><td>10</td><td>0</td><td>0.0</td><td>0</td><td>0.0</td><td>10</td><td>100.0</td></tr><tr><td>Utility - Central Logging</td><td>111</td><td>111</td><td>100.0</td><td>5</td><td>4.5</td><td>0</td><td>0.0</td></tr><tr><td>Utility - General</td><td>29</td><td>17</td><td>58.62</td><td>0</td><td>0.0</td><td>12</td><td>41.38</td></tr><tr><td>Utility - JSON</td><td>26</td><td>14</td><td>53.85</td><td>0</td><td>0.0</td><td>12</td><td>46.15</td></tr><tr><td>Utility - Maths</td><td>193</td><td>100</td><td>51.81</td><td>0</td><td>0.0</td><td>93</td><td>48.19</td></tr><tr><td>Utility - NewGen Launch and Log In</td><td>121</td><td>95</td><td>78.51</td><td>10</td><td>8.26</td><td>26</td><td>21.49</td></tr><tr><td>Utility - NewGen_Cards_Operation</td><td>85</td><td>43</td><td>50.59</td><td>4</td><td>4.71</td><td>42</td><td>49.41</td></tr><tr><td>Utility - Newgen Download Report</td><td>115</td><td>87</td><td>75.65</td><td>13</td><td>11.3</td><td>28</td><td>24.35</td></tr><tr><td>Utility - Strings (Extended)</td><td>64</td><td>37</td><td>57.81</td><td>3</td><td>4.69</td><td>27</td><td>42.19</td></tr><tr><td>Utility - Timestamp Conversion</td><td>24</td><td>16</td><td>66.67</td><td>0</td><td>0.0</td><td>8</td><td>33.33</td></tr><tr><td>Utility Object - CTF Launch_LogIn</td><td>104</td><td>76</td><td>73.08</td><td>10</td><td>9.62</td><td>28</td><td>26.92</td></tr><tr><td>Utility Object - CTF Launch_Login_Edge With IE compatibility</td><td>105</td><td>76</td><td>72.38</td><td>11</td><td>10.48</td><td>29</td><td>27.62</td></tr><tr><td>Utility Object - Inquiry Simah</td><td>106</td><td>76</td><td>71.7</td><td>12</td><td>11.32</td><td>30</td><td>28.3</td></tr><tr><td>Utility Process - CTF Launch_LogIn</td><td>32</td><td>22</td><td>68.75</td><td>0</td><td>0.0</td><td>10</td><td>31.25</td></tr><tr><td>Utility Process - CTF Launch_Login_Edge With IE compatibility</td><td>41</td><td>27</td><td>65.85</td><td>0</td><td>0.0</td><td>14</td><td>34.15</td></tr><tr><td>Utility Process - Employer Reject List</td><td>46</td><td>46</td><td>100.0</td><td>1</td><td>2.17</td><td>0</td><td>0.0</td></tr><tr><td>Utility Process - Inquiry Simah</td><td>10</td><td>6</td><td>60.0</td><td>0</td><td>0.0</td><td>4</td><td>40.0</td></tr><tr><td>Utility Process - LogFile &amp; ReportSharing</td><td>102</td><td>70</td><td>68.63</td><td>0</td><td>0.0</td><td>32</td><td>31.37</td></tr><tr><td>Utility Process - NewGen Download File</td><td>45</td><td>26</td><td>57.78</td><td>1</td><td>2.22</td><td>19</td><td>42.22</td></tr><tr><td>Utility Process - NewGen Launch and Log In</td><td>64</td><td>0</td><td>0.0</td><td>4</td><td>6.25</td><td>64</td><td>100.0</td></tr><tr><td>Utility _LOG Insertion Into DB_V1.0</td><td>29</td><td>3</td><td>10.34</td><td>0</td><td>0.0</td><td>26</td><td>89.66</td></tr><tr><td>Validating And Rejecting Deviation Application</td><td>778</td><td>26</td><td>3.34</td><td>23</td><td>2.96</td><td>752</td><td>96.66</td></tr>
            </tbody>
        </table>
    </div>
    
    <div class="tab-content">
        <h2>Processes and Stages Using Credentials Actions</h2>
        <p class="row-count">Total Rows: 56</p>
        <table>
            <thead>
                <tr><th onclick="sortTable(this)">Process Name</th><th onclick="sortTable(this)">Page Name</th><th onclick="sortTable(this)">Stage Name</th></tr>
            </thead>
            <tbody>
    <tr><td>ATMAAX API</td><td>Main Sheet</td><td>Atmax_API Credentials</td></tr><tr><td>Change Password</td><td>Main Sheet</td><td>Get Current Credentials</td></tr><tr><td>Change Password</td><td>Main Sheet</td><td>Change Password on Credential</td></tr><tr><td>Change Password</td><td>Main Sheet</td><td>Get New Credentials</td></tr><tr><td>Change Password</td><td>Main Sheet</td><td>Reset Password on Credential</td></tr><tr><td>Login</td><td>Main Sheet</td><td>Get Credentials</td></tr><tr><td>Login</td><td>Main Sheet</td><td>Get Credentials</td></tr><tr><td>NewGen AutoLease Normal - Salary Transfer_V1.0</td><td>Launch &amp; Log In NewGen</td><td>Get Credentials New Genn</td></tr><tr><td>NewGen AutoLease Normal - Salary Transfer_V1.0</td><td>Load Work Queue</td><td>Credentials::Get Property</td></tr><tr><td>NewGen AutoLease Normal - Salary Transfer_V1.0</td><td>Load Work Queue</td><td>Credentials::Get</td></tr><tr><td>NewGen AutoLease Normal - Salary Transfer_V1.0</td><td>Load Work Queue</td><td>Credentials::Set</td></tr><tr><td>NewGen AutoLease Normal - Salary Transfer_V1.0</td><td>Load Work Queue</td><td>Credentials::Set Property</td></tr><tr><td>NewGen MRCC - Digital GOSI</td><td>Launch &amp; Log In NewGen</td><td>Get Credentials New Genn</td></tr><tr><td>NewGen MRCC - Digital GOSI</td><td>Load Work Queue</td><td>Credentials::Set</td></tr><tr><td>NewGen MRCC - Digital GOSI</td><td>Load Work Queue</td><td>Credentials::Set Property</td></tr><tr><td>NewGen MRCC - Digital GOSI</td><td>Load Work Queue</td><td>Credentials::Get Property</td></tr><tr><td>NewGen MRCC - Digital GOSI</td><td>Load Work Queue</td><td>Credentials::Get</td></tr><tr><td>Newgen MRCC - IVR</td><td>Launch &amp; Log In NewGen</td><td>Get Credentials New Genn</td></tr><tr><td>Newgen MRCC - IVR</td><td>Load Work Queue</td><td>Credentials::Set</td></tr><tr><td>Newgen MRCC - IVR</td><td>Load Work Queue</td><td>Credentials::Set Property</td></tr><tr><td>Newgen MRCC - IVR</td><td>Load Work Queue</td><td>Credentials::Get Property</td></tr><tr><td>Newgen MRCC - IVR</td><td>Load Work Queue</td><td>Credentials::Get</td></tr><tr><td>Pending_Volume</td><td>Main Sheet</td><td>Get List of Valid Credentials</td></tr><tr><td>Pending_Volume</td><td>Main Sheet</td><td>Credentials::Get</td></tr><tr><td>RBS - CRS Unified Process_V1.0</td><td>Login</td><td>Get Credentials</td></tr><tr><td>Remote Desktop Connection For Local Configuration</td><td>Main Sheet</td><td>Get Password</td></tr><tr><td>UWCA_Balloon_Refinance_V1.0</td><td>Main Sheet</td><td>Get Stop Requested Status</td></tr><tr><td>UWCA_Balloon_Refinance_V1.0</td><td>Add to Queue (N)</td><td>Get Active Baskets</td></tr><tr><td>UWCA_Balloon_Refinance_V1.0</td><td>Add to Queue (D)</td><td>Get Active Baskets</td></tr><tr><td>UWCA_Balloon_Refinance_V1.0</td><td>Start CTF Application</td><td>Get Credentials</td></tr><tr><td>UWCA_MRCC_V2.0</td><td>Start CTF Application</td><td>Get Credentials</td></tr><tr><td>UWCA_MRCC_V2.0</td><td>Restart Activities</td><td>Get Stop Flag</td></tr><tr><td>UWCA_MRCC_V2.0</td><td>Add to Queue (N)</td><td>Get Active Baskets</td></tr><tr><td>UWCA_MRCC_V2.0</td><td>Add to Queue (D)</td><td>Get Active Baskets</td></tr><tr><td>UWCA_MRCC_V2.0</td><td>Add to Queue(Average Balance Segment)</td><td>Get Active Baskets</td></tr><tr><td>UWCA_MRCC_V2.0</td><td>Send Yesterdays Report</td><td>Get Credentials: Date</td></tr><tr><td>UWCA_MRCC_V2.0</td><td>Send Yesterdays Report</td><td>Set Credentials: Date</td></tr><tr><td>UWCA_MRCC_V2.0</td><td>BOT Account</td><td>Get Cortex Credentials</td></tr><tr><td>UWCA_MRCC_V3.0</td><td>Restart Activities</td><td>Get Stop Flag</td></tr><tr><td>UWCA_MRCC_V3.0</td><td>Add to Queue (N)</td><td>Get Active Baskets</td></tr><tr><td>UWCA_MRCC_V3.0</td><td>Add to Queue (D)</td><td>Get Active Baskets</td></tr><tr><td>UWCA_MRCC_V3.0</td><td>Add to Queue(Average Balance Segment)</td><td>Get Active Baskets</td></tr><tr><td>UWCA_MRCC_V3.0</td><td>Send Yesterdays Report</td><td>Get Credentials: Date</td></tr><tr><td>UWCA_MRCC_V3.0</td><td>Send Yesterdays Report</td><td>Set Credentials: Date</td></tr><tr><td>UWCA_MRCC_V3.0</td><td>BOT Account</td><td>Get Cortex Credentials</td></tr><tr><td>UWCA_MRCC_V3.0</td><td>Start CTF Application</td><td>Get Credentials</td></tr><tr><td>Utility - Central Logging</td><td>Insert Into DB</td><td>Get Credentials</td></tr><tr><td>Utility - NewGen_Cards_Operation</td><td>Launch - Login</td><td>Credentials::Get</td></tr><tr><td>Utility Process - LogFile &amp; ReportSharing</td><td>SendPreviousDayReport</td><td>Get Credentials</td></tr><tr><td>Utility Process - LogFile &amp; ReportSharing</td><td>SendPreviousDayReport</td><td>Set Credentials</td></tr><tr><td>Utility _LOG Insertion Into DB_V1.0</td><td>Main Sheet</td><td>Get Credentials</td></tr><tr><td>Validating And Rejecting Deviation Application</td><td>Launch &amp; Log In NewGen</td><td>Get Credentials New Genn</td></tr><tr><td>Validating And Rejecting Deviation Application</td><td>Load Work Queue</td><td>Credentials::Set</td></tr><tr><td>Validating And Rejecting Deviation Application</td><td>Load Work Queue</td><td>Credentials::Set Property</td></tr><tr><td>Validating And Rejecting Deviation Application</td><td>Load Work Queue</td><td>Credentials::Get Property</td></tr><tr><td>Validating And Rejecting Deviation Application</td><td>Load Work Queue</td><td>Credentials::Get</td></tr>
            </tbody>
        </table>
    </div>
    
    <div class="tab-content">
        <h2>Object Global Code (Detected)</h2>
        <p class="row-count">Total Rows: 0</p>
        <table>
            <thead>
                <tr><th onclick="sortTable(this)">Object Name</th><th onclick="sortTable(this)">Language</th><th onclick="sortTable(this)">Line Count</th><th onclick="sortTable(this)">SHA256</th></tr>
            </thead>
            <tbody>
    
            </tbody>
        </table>
    </div>
    
    <div class="tab-content">
        <h2>Object Code Stages (Drill-down)</h2>
        <p class="row-count">Total Rows: 237</p>
        <table>
            <thead>
                <tr>
                    <th onclick="sortTable(this)">Object</th>
                    <th onclick="sortTable(this)">Page</th>
                    <th onclick="sortTable(this)">Stage</th>
                    <th onclick="sortTable(this)">Language</th>
                    <th onclick="sortTable(this)">Lines</th>
                    <!--<th onclick="sortTable(this)">SHA256</th>-->
                    <th onclick="sortTable(this)">Findings</th>
                    <!--<th onclick="sortTable(this)">Preview</th>-->
                    <th>Code (Drill-down)</th>
                </tr>
            </thead>
            <tbody>
    
            <tr>
                <td>Login Agent</td>
                <td>Authenticate To Windows</td>
                <td>Authenticate</td>
                <td>visualbasic</td>
                <td>21</td>
                <!--<td style="font-family: monospace;">622359e1cf678e4b2413fec75bb29a4f5c9987abcd3be5001ac0c3ba53d38cca</td>-->
                <td>file_io</td>
                <!--<td>Try     &#x27;Create a new pipe client     Using pipeClient As New NamedPipeClientStream(         &quot;.&quot;,         &quot;BluePrismCredentialProviderPipe&quot;,         PipeDirection.InOut,         PipeOptions.None,         TokenImpersonationLevel.Impersonation)          &#x27;Attempt to connect to it         pipeClient.Con...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Try     &#x27;Create a new pipe client     Using pipeClient As New NamedPipeClientStream(         &quot;.&quot;,         &quot;BluePrismCredentialProviderPipe&quot;,         PipeDirection.InOut,         PipeOptions.None,         TokenImpersonationLevel.Impersonation)          &#x27;Attempt to connect to it         pipeClient.Connect(10000)          &#x27;Send credentials
    Dim dom As String
    If Local Then
        dom = Environment.MachineName
    End If
Else
    If Domain = &quot;&quot; Then
        dom = Environment.UserDomainName
    End If
Else             dom = Domain
    End
    If
    Dim ss As New StreamString(pipeClient)         ss.WriteString(String.Format(&quot;LOGON{0}{1}{0}{2}{0}{3}&quot;, vbLf, dom, Username, Password))          &#x27;Wait
    for reply         Using pr As New StreamReader(pipeClient, Encoding.Unicode)             Response = pr.ReadLine()
        If Response = &quot;OK&quot; Or
        Else Response = &quot;UNKNOWN&quot; Then
            Return              ErrorCode = pr.ReadLine()             ErrorMessage = pr.ReadLine()         End Using     End Using
        Catch ex As TimeoutException     Response = &quot;ERROR&quot;     ErrorCode = &quot;0x80131505&quot;     ErrorMessage = ex.Message
        Catch ex As Exception     Response = &quot;ERROR&quot;     ErrorCode = &quot;&quot;     ErrorMessage = ex.Message
            End
            Try"
                            data-title="Login Agent / Authenticate To Windows / Authenticate">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>Login Agent</td>
                <td>Change Password</td>
                <td>Change Password</td>
                <td>visualbasic</td>
                <td>5</td>
                <!--<td style="font-family: monospace;">4257535d5b0249ccac8b01f57924b4dfd5333a988cd67b4dd65208bcbd173287</td>-->
                <td>—</td>
                <!--<td>Dim res As NET_API_STATUS = NetUserChangePassword(Environment.UserDomainName, Environment.UserName, oldPass, newPass) If res &lt;&gt; NET_API_STATUS.NERR_Success Then     Throw New ApplicationException(&quot;Error setting password - Error code:&quot; &amp; res.ToString()) End If End If</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Dim res As NET_API_STATUS = NetUserChangePassword(Environment.UserDomainName, Environment.UserName, oldPass, newPass)
If res &lt;&gt; NET_API_STATUS.NERR_Success Then
    Throw New ApplicationException(&quot;Error setting password - Error code:&quot; &amp; res.ToString())
End If
End If"
                            data-title="Login Agent / Change Password / Change Password">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>Login Agent</td>
                <td>Get Credential Name</td>
                <td>Get Credential Name</td>
                <td>visualbasic</td>
                <td>1</td>
                <!--<td style="font-family: monospace;">b7a587eecda70e10a389ff449943faa92cafa5df47f46a0714f8a3f64b19166b</td>-->
                <td>—</td>
                <!--<td>Credential_Name = String.Format( _     FormatString, Environment.MachineName)</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Credential_Name = String.Format( _     FormatString, Environment.MachineName)"
                            data-title="Login Agent / Get Credential Name / Get Credential Name">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>Login Agent</td>
                <td>Is Locked</td>
                <td>Locked?</td>
                <td>visualbasic</td>
                <td>8</td>
                <!--<td style="font-family: monospace;">85d35e9c90c12aa01120cd24f1f4a730bebabd5b4aef8e78c023e137d41fa588</td>-->
                <td>—</td>
                <!--<td>If m_Locked Then     Locked = True End If Return  &#x27; If we&#x27;ve not got &#x27;locked&#x27; set, it may be that &#x27; we&#x27;re not locked, or it might mean that the &#x27; VBO wasn&#x27;t active when the screen was locked &#x27;     Try and get the desktop window to see         if we&#x27;re &#x27; currently locked or not             Dim hDesk ...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="If m_Locked Then
    Locked = True
End If
Return  &#x27;
If we&#x27;ve not got &#x27;locked&#x27; set, it may be that &#x27; we&#x27;re not locked, or it might mean that the &#x27; VBO wasn&#x27;t active when the screen was locked &#x27;
    Try and get the desktop window to see
        if we&#x27;re &#x27; currently locked or not
            Dim hDesk as IntPtr = OpenInputDesktop(0, False, 1) Locked = (hDesk = IntPtr.Zero) CloseDesktop(hDesk)"
                            data-title="Login Agent / Is Locked / Locked?">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>Login Agent</td>
                <td>Is Logged In</td>
                <td>Logged In</td>
                <td>visualbasic</td>
                <td>1</td>
                <!--<td style="font-family: monospace;">4386575e3dced153a92f4b4e96cd39fbc06ff8c5f2d914439d8756414c1c0670</td>-->
                <td>—</td>
                <!--<td>Logged_In = (GetLoggedInUsers().Count &gt; 0)</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Logged_In = (GetLoggedInUsers().Count &gt; 0)"
                            data-title="Login Agent / Is Logged In / Logged In">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>Login Agent</td>
                <td>IsInteractive</td>
                <td>Code1</td>
                <td>visualbasic</td>
                <td>1</td>
                <!--<td style="font-family: monospace;">68396174a19534f2c034226013962126dd56d1b4ff648ef1c3a8f45b16698740</td>-->
                <td>—</td>
                <!--<td>Is_Interactive = (IsInteractive())</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Is_Interactive = (IsInteractive())"
                            data-title="Login Agent / IsInteractive / Code1">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>Login Agent</td>
                <td>Lock Screen</td>
                <td>Lock Screen</td>
                <td>visualbasic</td>
                <td>1</td>
                <!--<td style="font-family: monospace;">0b78ab6c42009f67eb681d63b1cd7bd23d97a896e8e0a68337f217e476b3a691</td>-->
                <td>—</td>
                <!--<td>LockWorkStation()</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="LockWorkStation()"
                            data-title="Login Agent / Lock Screen / Lock Screen">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>Login Agent</td>
                <td>Log Out</td>
                <td>Log Out</td>
                <td>visualbasic</td>
                <td>12</td>
                <!--<td style="font-family: monospace;">8c015f683c8f01fd59bb9170164f05e2e41160874aedd45ab93b0ee87b5624f7</td>-->
                <td>file_io</td>
                <!--<td>Try     Dim match = Regex.Match(ResourceName, &quot;:([0-9]*)$&quot;)     Dim port = If(match.Success, Integer.Parse(match.Groups(1).Value), 8181)      Using tcp As New TcpClient()         tcp.Connect(IPAddress. Loopback, port)         Using sw As New StreamWriter(tcp.GetStream(), New UTF8Encoding(False))    ...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Try
    Dim match = Regex.Match(ResourceName, &quot;:([0-9]*)$&quot;)
    Dim port = If(match.Success, Integer.Parse(match.Groups(1).Value), 8181)      Using tcp As New TcpClient()         tcp.Connect(IPAddress.
Loopback, port)         Using sw As New StreamWriter(tcp.GetStream(), New UTF8Encoding(False))             sw.WriteLine(&quot;shutdown waitforsessions&quot;)             sw.Flush()         End Using     End Using
Catch
    End
    Try
        Dim flags as ExitWindowsFlags = ExitWindowsFlags.LogOff
        If Force Then
            flags = flags Or ExitWindowsFlags.Force
        End If
        Dim t As New Threading.Thread(Addressof ExitWindowsDelay) t.Start({flags, Delay})"
                            data-title="Login Agent / Log Out / Log Out">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>Login Agent</td>
                <td>Logged In Users</td>
                <td>Get Logged In Users</td>
                <td>visualbasic</td>
                <td>5</td>
                <!--<td style="font-family: monospace;">a8d7b4ab86a1a82deef4c49e8c2cc1c93b751466864e8038be34c67e38500466</td>-->
                <td>—</td>
                <!--<td>Users = New DataTable() Const userNameCol As String = &quot;Name&quot; Users.Columns.Add(userNameCol) For Each username As String In GetLoggedInUsers()     Dim row As DataRow = Users.NewRow()     row(userNameCol) = username     Users.Rows.Add(row) Next</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Users = New DataTable()
Const userNameCol As String = &quot;Name&quot; Users.Columns.Add(userNameCol)
For Each username As String In GetLoggedInUsers()
    Dim row As DataRow = Users.NewRow()     row(userNameCol) = username     Users.Rows.Add(row)
Next"
                            data-title="Login Agent / Logged In Users / Get Logged In Users">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>Login Agent</td>
                <td>Send Secure Attention Sequence</td>
                <td>SendSAS</td>
                <td>visualbasic</td>
                <td>11</td>
                <!--<td style="font-family: monospace;">625a0ff8d2bae68a0b3d5b08ecd5cbc5b3f5268e55142734410a17499ecc1ae1</td>-->
                <td>file_io</td>
                <!--<td>Try     &#x27;Create a new pipe client     Using pipeClient As New NamedPipeClientStream(         &quot;.&quot;,         &quot;BluePrismSASPipe&quot;,         PipeDirection.InOut,         PipeOptions.None,         TokenImpersonationLevel.Impersonation)          &#x27;Attempt to connect to it         pipeClient.Connect(10000)    ...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Try     &#x27;Create a new pipe client     Using pipeClient As New NamedPipeClientStream(         &quot;.&quot;,         &quot;BluePrismSASPipe&quot;,         PipeDirection.InOut,         PipeOptions.None,         TokenImpersonationLevel.Impersonation)          &#x27;Attempt to connect to it         pipeClient.Connect(10000)
    Dim sendBuffer As Byte() = Encoding.Unicode.GetBytes(&quot;SAS&quot;)         pipeClient.Write(sendBuffer, 0, sendBuffer.Length)          &#x27;Wait
    for reply         Using pr As New StreamReader(pipeClient, Encoding.Unicode)             Response = pr.ReadLine()
        If Response = &quot;OK&quot; Or
        Else Response = &quot;UNKNOWN&quot; Then                  System.Threading.Thread.Sleep(2000)
            return
            End
            if                          ErrorMessage = &quot;Received unexpected reply:&quot; + Response         End Using     End Using
            Catch ex As Exception     Response = &quot;ERROR&quot;     ErrorCode = &quot;&quot;     ErrorMessage = ex.Message
                End
                Try"
                            data-title="Login Agent / Send Secure Attention Sequence / SendSAS">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>Login Agent</td>
                <td>Unlock Screen</td>
                <td>Get Username &amp; Domain</td>
                <td>visualbasic</td>
                <td>1</td>
                <!--<td style="font-family: monospace;">1b10c1f75293da497426d22ac837f9b921f6b4e6c4b91ca680244cc660b48381</td>-->
                <td>—</td>
                <!--<td>Username = Environment.UserName Domain = Environment.UserDomainName</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Username = Environment.UserName Domain = Environment.UserDomainName"
                            data-title="Login Agent / Unlock Screen / Get Username &amp; Domain">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>MS Excel VBO</td>
                <td>AbhiProcess</td>
                <td>Delete blank rows1</td>
                <td>visualbasic</td>
                <td>1</td>
                <!--<td style="font-family: monospace;">08dd17300e7c22b64e4f04d3199857d6d3b12cd4ab42f08885ccd9bc01a83fd0</td>-->
                <td>—</td>
                <!--<td>Dim worksheet As Object worksheet = GetWorkbook(handle,Nothing).ActiveSheet         worksheet.Rows(i).Delete</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Dim worksheet As Object worksheet = GetWorkbook(handle,Nothing).ActiveSheet         worksheet.Rows(i).Delete"
                            data-title="MS Excel VBO / AbhiProcess / Delete blank rows1">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>MS Excel VBO</td>
                <td>Activate Workbook</td>
                <td>ActivateWorkbook</td>
                <td>visualbasic</td>
                <td>1</td>
                <!--<td style="font-family: monospace;">7b8e72ca8747708b4892926051fcc9c1a7637a9e8458ebb78546efc11fe0b08c</td>-->
                <td>crypto</td>
                <!--<td>GetWorkbook(handle,name).Activate() &#x27;GetWorkbook(handle,name).RefreshAll()</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="GetWorkbook(handle,name).Activate() &#x27;GetWorkbook(handle,name).RefreshAll()"
                            data-title="MS Excel VBO / Activate Workbook / ActivateWorkbook">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>MS Excel VBO</td>
                <td>Activate Workbook</td>
                <td>ActivateWorkbook1</td>
                <td>visualbasic</td>
                <td>1</td>
                <!--<td style="font-family: monospace;">333b59aebb0db87882bd07204e5aa63570ca21020f51ffc41f5105346562ce3a</td>-->
                <td>—</td>
                <!--<td>GetWorkbook(handle,name).Activate()</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="GetWorkbook(handle,name).Activate()"
                            data-title="MS Excel VBO / Activate Workbook / ActivateWorkbook1">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>MS Excel VBO</td>
                <td>Activate Worksheet</td>
                <td>OpenWorksheet</td>
                <td>visualbasic</td>
                <td>4</td>
                <!--<td style="font-family: monospace;">9e3e64377c2b21236ff58f1d54dd85776b283c7d02e79010b65165838509cb5e</td>-->
                <td>—</td>
                <!--<td>Dim ws as Object = GetWorksheet(handle,workbookname,worksheetname,createifmissing) sheetexists = ws IsNot Nothing If sheetexists Then     ws.Activate() End If</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Dim ws as Object = GetWorksheet(handle,workbookname,worksheetname,createifmissing) sheetexists = ws IsNot Nothing
If sheetexists Then
    ws.Activate()
End If"
                            data-title="MS Excel VBO / Activate Worksheet / OpenWorksheet">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>MS Excel VBO</td>
                <td>Auto Fill Range</td>
                <td>Auto Fill</td>
                <td>visualbasic</td>
                <td>7</td>
                <!--<td style="font-family: monospace;">05578d5cfa025e80f396ce7e9e6094d97b7fbc7a5aeba581f97609fd2556ab98</td>-->
                <td>—</td>
                <!--<td>Dim wb, ws As Object Dim excel, sheet, range As Object Try wb = GetWorkbook(Handle, Workbook) ws = GetWorksheet(Handle, Workbook, Worksheet) wb.Activate() ws.Activate() excel = ws.Application sheet = excel.ActiveSheet range = sheet.Range(Select_range) range.Select() &#x27;GetInstance(Handle).ActiveCell.V...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Dim wb, ws As Object
Dim excel, sheet, range As Object
Try wb = GetWorkbook(Handle, Workbook) ws = GetWorksheet(Handle, Workbook, Worksheet) wb.Activate() ws.Activate() excel = ws.Application sheet = excel.ActiveSheet range = sheet.Range(Select_range) range.Select() &#x27;GetInstance(Handle).ActiveCell.Value = &quot;=SUM(A1,B1)&quot; sheet.Range(Select_range).AutoFill (sheet.Range(Autofill_range)) Success = True
Catch e As Exception     Success = False     Message = e.Message
Finally     wb = Nothing     excel = Nothing     range = Nothing
    End
    Try"
                            data-title="MS Excel VBO / Auto Fill Range / Auto Fill">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>MS Excel VBO</td>
                <td>CheckFileExists</td>
                <td>File Exists?</td>
                <td>visualbasic</td>
                <td>1</td>
                <!--<td style="font-family: monospace;">820d5a988b623886b3e05c85913246ba549df48b6a1831dc1e5b392b3c8f3170</td>-->
                <td>file_io</td>
                <!--<td>fileexists = File.Exists(filename)</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="fileexists = File.Exists(filename)"
                            data-title="MS Excel VBO / CheckFileExists / File Exists?">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>MS Excel VBO</td>
                <td>CheckInstanceAndWorkbook</td>
                <td>CheckWorkbook</td>
                <td>visualbasic</td>
                <td>10</td>
                <!--<td style="font-family: monospace;">d2b60b6bb9fb95f7f652bfc1100804ce72ddcafc1b6a6e36ec66a528531fd965</td>-->
                <td>sql_keywords</td>
                <!--<td>Try     GetWorkbook(handle,workbookname)     workbookfound = True Catch ex as Exception     If ex.Message.IndexOf(&quot;DISP_E_BADINDEX&quot;)&lt;&gt;-1 Then         workbookfound = False     End If Else         Throw ex     End     If     End     Try</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Try     GetWorkbook(handle,workbookname)     workbookfound = True
Catch ex as Exception
    If ex.Message.IndexOf(&quot;DISP_E_BADINDEX&quot;)&lt;&gt;-1 Then
        workbookfound = False
    End If
Else         Throw ex
    End
    If
    End
    Try"
                            data-title="MS Excel VBO / CheckInstanceAndWorkbook / CheckWorkbook">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>MS Excel VBO</td>
                <td>CheckInstanceHandle</td>
                <td>Check Handle</td>
                <td>visualbasic</td>
                <td>1</td>
                <!--<td style="font-family: monospace;">53a703fbfb00e35ac207034fd0474a3807b1d16c439e3a3aa19ebeb9c48d78b8</td>-->
                <td>—</td>
                <!--<td>&#x27; Just ensure that the handle references a valid instance HandleMissing = (GetInstance(handle) is Nothing)</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="&#x27; Just ensure that the handle references a valid instance HandleMissing = (GetInstance(handle) is Nothing)"
                            data-title="MS Excel VBO / CheckInstanceHandle / Check Handle">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>MS Excel VBO</td>
                <td>Close All Instances</td>
                <td>CloseAllInstances</td>
                <td>visualbasic</td>
                <td>3</td>
                <!--<td style="font-family: monospace;">afdb54f7f22d36cd4c90b436accac6f1c7f6df58087e08d51df09ce6d6a83d7c</td>-->
                <td>—</td>
                <!--<td>Dim clone as Dictionary(Of Integer,Object) = _     new Dictionary(Of Integer,Object)(HandleMap) For Each Handle As Integer In clone.Keys     CloseInstance(Handle,False) Next</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Dim clone as Dictionary(Of Integer,Object) = _     new Dictionary(Of Integer,Object)(HandleMap)
For Each Handle As Integer In clone.Keys     CloseInstance(Handle,False)
Next"
                            data-title="MS Excel VBO / Close All Instances / CloseAllInstances">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>MS Excel VBO</td>
                <td>Close Instance</td>
                <td>Close Instance</td>
                <td>visualbasic</td>
                <td>4</td>
                <!--<td style="font-family: monospace;">0aa74be9becc506d23b18327e5077d7307f5c8bdbd2f345533d7385bae449b5c</td>-->
                <td>—</td>
                <!--<td>Try CloseInstance(handle, savechanges) Catch ex as Exception MessageBox.Show(ex.ToString())     End     Try</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Try CloseInstance(handle, savechanges)
Catch ex as Exception MessageBox.Show(ex.ToString())
    End
    Try"
                            data-title="MS Excel VBO / Close Instance / Close Instance">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>MS Excel VBO</td>
                <td>Close Workbook</td>
                <td>Close Workbook</td>
                <td>visualbasic</td>
                <td>2</td>
                <!--<td style="font-family: monospace;">8fd26dcabecee5d3d564b2ea1d36f701b161b8c97c20db51d397c43b11e96d62</td>-->
                <td>—</td>
                <!--<td>Dim wb as Object = GetWorkbook(handle,name) Dim app as Object = wb.Application  app.DisplayAlerts = False wb.Close(False) app.DisplayAlerts = True</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Dim wb as Object = GetWorkbook(handle,name)
Dim app as Object = wb.Application  app.DisplayAlerts = False wb.Close(False) app.DisplayAlerts = True"
                            data-title="MS Excel VBO / Close Workbook / Close Workbook">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>MS Excel VBO</td>
                <td>Copy</td>
                <td>Copy Selection</td>
                <td>visualbasic</td>
                <td>6</td>
                <!--<td style="font-family: monospace;">fc31cb1790dd1467c6893c4235ba2c45b1867268bb08dfa3b51f68b887d5f86a</td>-->
                <td>—</td>
                <!--<td>Dim wb, excel, range As Object Try  wb = GetWorkbook(Handle, Workbook) excel = wb.Application range = excel.Selection range.Copy  Success = True Catch e As Exception     Success = False     Message = e.Message Finally     wb = Nothing     excel = Nothing     range = Nothing     End     Try</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Dim wb, excel, range As Object
Try  wb = GetWorkbook(Handle, Workbook) excel = wb.Application range = excel.Selection range.Copy  Success = True
Catch e As Exception     Success = False     Message = e.Message
Finally     wb = Nothing     excel = Nothing     range = Nothing
    End
    Try"
                            data-title="MS Excel VBO / Copy / Copy Selection">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>MS Excel VBO</td>
                <td>Copy and Paste Worksheet Range</td>
                <td>Paste Worksheet</td>
                <td>visualbasic</td>
                <td>14</td>
                <!--<td style="font-family: monospace;">4658faded2f8c611fb806e8724b2a718567707456ce04653fbab8fe4e7d8c653</td>-->
                <td>—</td>
                <!--<td>Dim sw, dw As Object Dim ss, ds As Object Dim excel, sheet, source, destination, cells, cell As Object Try  sw = GetWorkbook(Handle, Source_Workbook) dw = GetWorkbook(Handle, Destination_Workbook)  ss = GetWorksheet(Handle, Source_Workbook, Source_Worksheet) ds = GetWorksheet(Handle, Destination_Wor...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Dim sw, dw As Object
Dim ss, ds As Object
Dim excel, sheet, source, destination, cells, cell As Object
Try  sw = GetWorkbook(Handle, Source_Workbook) dw = GetWorkbook(Handle, Destination_Workbook)  ss = GetWorksheet(Handle, Source_Workbook, Source_Worksheet) ds = GetWorksheet(Handle, Destination_Workbook, Destination_Worksheet)  sw.Activate() ss.Activate() excel = ss.Application sheet = excel.ActiveSheet cell = excel.ActiveCell
    If Source_Range=&quot;&quot; Then
        cells = sheet.Cells     Destination_Range = &quot;A1&quot;
    End If
Else     cells = sheet.Range(Source_Range)
    End
    If  cells.Select() source = excel.Selection source.Copy() cell.Select()  dw.Activate() ds.Activate() sheet = excel.ActiveSheet cell = excel.ActiveCell destination = sheet.Range(Destination_Range) destination.Select() sheet.Paste() cell.Select()  My.Computer.Clipboard.Clear()  Success = True
    Catch e As Exception     Success = False     Message = e.Message
    Finally     sw = Nothing     ss = Nothing     dw = Nothing     ds = Nothing     excel = Nothing     sheet = Nothing     source = Nothing     destination = Nothing     cells = Nothing     cell = Nothing
        End
        Try"
                            data-title="MS Excel VBO / Copy and Paste Worksheet Range / Paste Worksheet">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>MS Excel VBO</td>
                <td>Copy and Paste Worksheet Range</td>
                <td>Paste Worksheet1</td>
                <td>visualbasic</td>
                <td>14</td>
                <!--<td style="font-family: monospace;">e9745de52a6648c953edc8b650912db9db257effb87d8917118b06d16205c7f0</td>-->
                <td>—</td>
                <!--<td>Dim sw, dw As Object Dim ss, ds As Object Dim excel, sheet, source, destination, cells, cell As Object Try  sw = GetWorkbook(Handle, Source_Workbook) dw = GetWorkbook(Handle, Destination_Workbook)  ss = GetWorksheet(Handle, Source_Workbook, Source_Worksheet) ds = GetWorksheet(Handle, Destination_Wor...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Dim sw, dw As Object
Dim ss, ds As Object
Dim excel, sheet, source, destination, cells, cell As Object
Try  sw = GetWorkbook(Handle, Source_Workbook) dw = GetWorkbook(Handle, Destination_Workbook)  ss = GetWorksheet(Handle, Source_Workbook, Source_Worksheet) ds = GetWorksheet(Handle, Destination_Workbook, Destination_Worksheet)  sw.Activate() ss.Activate() excel = ss.Application sheet = excel.ActiveSheet cell = excel.ActiveCell
    If Source_Range=&quot;&quot; Then
        cells = sheet.Cells     Destination_Range = &quot;A1&quot;
    End If
Else     cells = sheet.Range(Source_Range)
    End
    If  cells.Select() source = excel.Selection source.Copy() &#x27;source.PasteSpecial(Excel.XlPasteType.xlPasteAll, Excel.XlPasteSpecialOperation.xlPasteSpecialOperationAdd, False, False) cell.Select()  dw.Activate() ds.Activate() sheet = excel.ActiveSheet cell = excel.ActiveCell destination = sheet.Range(Destination_Range) destination.Select() destination.PasteSpecial(Excel.XlPasteType.xlPasteAll, Excel.XlPasteSpecialOperation.xlPasteSpecialOperationAdd, False, False) &#x27;sheet.Paste() &#x27;cell.Select()  My.Computer.Clipboard.Clear()  Success = True
    Catch e As Exception     Success = False     Message = e.Message
    Finally     sw = Nothing     ss = Nothing     dw = Nothing     ds = Nothing     excel = Nothing     sheet = Nothing     source = Nothing     destination = Nothing     cells = Nothing     cell = Nothing
        End
        Try"
                            data-title="MS Excel VBO / Copy and Paste Worksheet Range / Paste Worksheet1">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>MS Excel VBO</td>
                <td>Create Instance</td>
                <td>Create Instance</td>
                <td>visualbasic</td>
                <td>2</td>
                <!--<td style="font-family: monospace;">3baf351353bdcf77d54f758d120300d0f27e7263191984eb630e9ea560411697</td>-->
                <td>—</td>
                <!--<td>Dim excel as Object = CreateObject(&quot;Excel.Application&quot;)  &#x27; Create a GUID with which we can kill the instance later &#x27; if we have to play hardball to get rid of it. excel.Caption = System.Guid.NewGuid().ToString().ToUpper()  handle = GetHandle(excel)</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Dim excel as Object = CreateObject(&quot;Excel.Application&quot;)  &#x27; Create a GUID with which we can kill the instance later &#x27;
if we have to play hardball to get rid of it. excel.Caption = System.Guid.NewGuid().ToString().ToUpper()  handle = GetHandle(excel)"
                            data-title="MS Excel VBO / Create Instance / Create Instance">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>MS Excel VBO</td>
                <td>Create Workbook</td>
                <td>CreateWorkbook</td>
                <td>visualbasic</td>
                <td>1</td>
                <!--<td style="font-family: monospace;">70b80d52a9ed672c00503a627bcec31f7f25d1d6e38bfdf91eabedc53c892301</td>-->
                <td>—</td>
                <!--<td>name = NewWorkbook(handle).Name</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="name = NewWorkbook(handle).Name"
                            data-title="MS Excel VBO / Create Workbook / CreateWorkbook">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>MS Excel VBO</td>
                <td>Cut</td>
                <td>Cut Selection</td>
                <td>visualbasic</td>
                <td>6</td>
                <!--<td style="font-family: monospace;">21bdd2d6be6afefbd8188d32e669bb4b4fb72c8cc94985b83b34e8fbd14108a8</td>-->
                <td>—</td>
                <!--<td>Dim wb, excel, range As Object Try  wb = GetWorkbook(Handle, Workbook) excel = wb.Application range = excel.Selection range.Cut  Success = True Catch e As Exception     Success = False     Message = e.Message Finally     wb = Nothing     excel = Nothing     range = Nothing     End     Try</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Dim wb, excel, range As Object
Try  wb = GetWorkbook(Handle, Workbook) excel = wb.Application range = excel.Selection range.Cut  Success = True
Catch e As Exception     Success = False     Message = e.Message
Finally     wb = Nothing     excel = Nothing     range = Nothing
    End
    Try"
                            data-title="MS Excel VBO / Cut / Cut Selection">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>MS Excel VBO</td>
                <td>Delete</td>
                <td>Delete Selection</td>
                <td>visualbasic</td>
                <td>7</td>
                <!--<td style="font-family: monospace;">713073c0015689f59ee1b38abd9c56df4d96206e331dc9a7c7be83c91301567e</td>-->
                <td>—</td>
                <!--<td>Dim wb, excel, range As Object Try  wb = GetWorkbook(Handle, Workbook) excel = wb.Application  range = excel.Selection range.Delete(Shift     =[Shift_Type])  Success = True Catch e As Exception     Success = False     Message = e.Message Finally     wb = Nothing     excel = Nothing     range = Nothi...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Dim wb, excel, range As Object
Try  wb = GetWorkbook(Handle, Workbook) excel = wb.Application  range = excel.Selection range.Delete(Shift
    =[Shift_Type])  Success = True
Catch e As Exception     Success = False     Message = e.Message
Finally     wb = Nothing     excel = Nothing     range = Nothing
    End
    Try"
                            data-title="MS Excel VBO / Delete / Delete Selection">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>MS Excel VBO</td>
                <td>Delete Filtered Values</td>
                <td>Delete Filtered Values</td>
                <td>visualbasic</td>
                <td>9</td>
                <!--<td style="font-family: monospace;">06bd12ea1927ecee54af01b9e770b7b55ee1f1b80ce6c2d80e4d9b80430f1854</td>-->
                <td>sql_keywords</td>
                <!--<td>Dim wb, ws As Object Dim excel, sheet, range As Object Try wb = GetWorkbook(Handle, Workbook) ws = GetWorksheet(Handle, Workbook, Worksheet) wb.Activate() ws.Activate() excel = ws.Application sheet = excel.ActiveSheet &#x27;sheet.Range(Select_Range).AutoFilter(Field     =Column_Number, Criteria1     =Fil...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Dim wb, ws As Object
Dim excel, sheet, range As Object
Try wb = GetWorkbook(Handle, Workbook) ws = GetWorksheet(Handle, Workbook, Worksheet) wb.Activate() ws.Activate() excel = ws.Application sheet = excel.ActiveSheet &#x27;sheet.Range(Select_Range).AutoFilter(Field
    =Column_Number, Criteria1
    =Filter_Criteria) sheet.UsedRange.Offset(1, 0).SpecialCells(12).EntireRow.Delete  Success = True
Catch e As Exception     Success = False     Message = e.Message
Finally     wb = Nothing     excel = Nothing     range = Nothing
    End
    Try"
                            data-title="MS Excel VBO / Delete Filtered Values / Delete Filtered Values">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>MS Excel VBO</td>
                <td>Delete Worksheet</td>
                <td>Delete Worksheet</td>
                <td>visualbasic</td>
                <td>5</td>
                <!--<td style="font-family: monospace;">3368ce2bde5837c45d5d9cc86a6ada755bf699e60f815180fad8483a857318eb</td>-->
                <td>—</td>
                <!--<td>Dim Inst As Object = GetInstance(handle) Inst.DisplayAlerts = False Dim ws as Object = GetWorksheet(handle,workbookname,worksheetname,False) sheetexisted = ws IsNot Nothing If sheetexisted Then     ws.Delete()  Inst.DisplayAlerts = True End If</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Dim Inst As Object = GetInstance(handle) Inst.DisplayAlerts = False
Dim ws as Object = GetWorksheet(handle,workbookname,worksheetname,False) sheetexisted = ws IsNot Nothing
If sheetexisted Then
    ws.Delete()  Inst.DisplayAlerts = True
End If"
                            data-title="MS Excel VBO / Delete Worksheet / Delete Worksheet">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>MS Excel VBO</td>
                <td>Delete row</td>
                <td>Code1</td>
                <td>visualbasic</td>
                <td>1</td>
                <!--<td style="font-family: monospace;">e9858cf798e4706ad03326f1a1ef5f63b6464d348e90fdfaf0d76eaaadfd22f0</td>-->
                <td>—</td>
                <!--<td>Dim worksheet As Object worksheet = GetWorkbook(Handle,Nothing).ActiveSheet worksheet.Rows(1).Delete</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Dim worksheet As Object worksheet = GetWorkbook(Handle,Nothing).ActiveSheet worksheet.Rows(1).Delete"
                            data-title="MS Excel VBO / Delete row / Code1">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>MS Excel VBO</td>
                <td>Filter Excel</td>
                <td>Filter Excel</td>
                <td>visualbasic</td>
                <td>11</td>
                <!--<td style="font-family: monospace;">ea0447136df2959d33ffdcdd2063aa959fc767da0017c4c95fb2cf2eb780dd5f</td>-->
                <td>—</td>
                <!--<td>Dim wb, ws As Object Dim excel, sheet, range As Object Try wb = GetWorkbook(Handle, Workbook) ws = GetWorksheet(Handle, Workbook, Worksheet) wb.Activate() ws.Activate() excel = ws.Application sheet = excel.ActiveSheet &#x27;sheet.Range(Select_Range).AutoFilter(Field     =Column_Number, Criteria1     =Fil...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Dim wb, ws As Object
Dim excel, sheet, range As Object
Try wb = GetWorkbook(Handle, Workbook) ws = GetWorksheet(Handle, Workbook, Worksheet) wb.Activate() ws.Activate() excel = ws.Application sheet = excel.ActiveSheet &#x27;sheet.Range(Select_Range).AutoFilter(Field
    =Column_Number, Criteria1
    =Filter_Criteria) sheet.UsedRange.AutoFilter(Field
    =Column_Number, Criteria1
    =Filter_Criteria) Success = True
Catch e As Exception     Success = False     Message = e.Message
Finally     wb = Nothing     excel = Nothing     range = Nothing
    End
    Try"
                            data-title="MS Excel VBO / Filter Excel / Filter Excel">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>MS Excel VBO</td>
                <td>Filter Excel Other than Equal</td>
                <td>Filter Excel1</td>
                <td>visualbasic</td>
                <td>13</td>
                <!--<td style="font-family: monospace;">58283b6362c0e5736421182d026713da6347e6ea51a9ecec4b94953712a57b22</td>-->
                <td>—</td>
                <!--<td>Dim wb, ws As Object Dim excel, sheet, range As Object Try wb = GetWorkbook(Handle, Workbook) ws = GetWorksheet(Handle, Workbook, Worksheet) wb.Activate() ws.Activate() excel = ws.Application sheet = excel.ActiveSheet &#x27;sheet.Range(Select_Range).AutoFilter(Field     =Column_Number, Criteria1     =Fil...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Dim wb, ws As Object
Dim excel, sheet, range As Object
Try wb = GetWorkbook(Handle, Workbook) ws = GetWorksheet(Handle, Workbook, Worksheet) wb.Activate() ws.Activate() excel = ws.Application sheet = excel.ActiveSheet &#x27;sheet.Range(Select_Range).AutoFilter(Field
    =Column_Number, Criteria1
    =Filter_Criteria) &#x27;sheet.UsedRange.AutoFilter(Field
    =Column_Number, Criteria1
    =Filter_Criteria) sheet.UsedRange.AutoFilter(Field
    =Column_Number, Criteria1
    =Filter_Criteria) Success = True
Catch e As Exception     Success = False     Message = e.Message
Finally     wb = Nothing     excel = Nothing     range = Nothing
    End
    Try"
                            data-title="MS Excel VBO / Filter Excel Other than Equal / Filter Excel1">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>MS Excel VBO</td>
                <td>Find Next Empty Cell</td>
                <td>FindEmptyCell</td>
                <td>visualbasic</td>
                <td>42</td>
                <!--<td style="font-family: monospace;">90ae305657daad959ca099b372cdc8deadf7fe9a111ee0375975e4d2971c1dec</td>-->
                <td>sql_keywords, http, urls(1)</td>
                <!--<td>&#x27; The initial char of the direction (capitalised) Dim strDir as String = direction.Trim().Substring(0,1).ToUpper()  &#x27; The excel instance Dim excel as Object = GetInstance(handle)  &#x27; The excel enum representing the direction &#x27; Note setting to zero is just to nix a duff compiler warning Dim dirn as In...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="&#x27; The initial char of the direction (capitalised)
Dim strDir as String = direction.Trim().Substring(0,1).ToUpper()  &#x27; The excel instance
Dim excel as Object = GetInstance(handle)  &#x27; The excel enum representing the direction &#x27; Note
setting to zero is just to nix a duff compiler warning
Dim dirn as Integer = 0  &#x27; xlDirection enum values from
&#x27; http
//msdn.microsoft.com/en-us/library/bb241212.aspx  &#x27; Get the direction we need to go
Select
Case strDir
Case &quot;U&quot;         dirn = -4162 &#x27; Excel.XlDirection.xlToUp
Case &quot;D&quot;         dirn = -4121 &#x27; Excel.XlDirection.xlToDown
Case &quot;L&quot;         dirn = -4159 &#x27; Excel.XlDirection.xlToLeft
Case &quot;R&quot;         dirn = -4161 &#x27; Excel.XlDirection.xlToRight
    Case
Else         Throw New ArgumentException(&quot;Invalid Direction: &quot; &amp; strDir)
End Select
Dim cell as Object = excel.ActiveCell
While True      &#x27; First check the
next one along -
If that&#x27;s blank Then
    we&#x27;re away..
End If
Dim
nextCell as Object = Get
NextCell(cell, strDir)      &#x27;
If the cell address is the same on moving - that indicates we&#x27;re     &#x27; at a limit (eg. 1st column going left, last row going down etc.)     &#x27; Just
    return empty to indicate that there are no blank cells in     &#x27; that direction.
    If cell.Address =
    nextCell.Address Then         cellref = &quot;&quot;
    Return
Else
    If
nextCell.Value = Nothing Then &#x27; We&#x27;ve found our blank         cellref =
nextCell.Address(False,False)
Return
End
If          cell =
nextCell          &#x27; Quick way (rather than plodding from one cell to the
next)     &#x27; is to effectively press the &#x27;End&#x27; key - but this is highly     &#x27; inconsistent in what it
returns.     &#x27; Go to the &#x27;end&#x27; of the range - ie. the last filled cell     &#x27; cell = cell.End(dirn)     &#x27; Now we need to go one beyond, ie. to the
next cell     &#x27; cell = Get
NextCell(cell, strDir)  End While"
                            data-title="MS Excel VBO / Find Next Empty Cell / FindEmptyCell">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>MS Excel VBO</td>
                <td>Format Cell</td>
                <td>FormatCell</td>
                <td>visualbasic</td>
                <td>1</td>
                <!--<td style="font-family: monospace;">e59b181ac84db41d968e7aefe95dbedd1b8ab1456c69716347a9288bd6153246</td>-->
                <td>—</td>
                <!--<td>GetWorkbook(handle,Nothing).ActiveSheet.Range(cellref,cellref).NumberFormat = format</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="GetWorkbook(handle,Nothing).ActiveSheet.Range(cellref,cellref).NumberFormat = format"
                            data-title="MS Excel VBO / Format Cell / FormatCell">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>MS Excel VBO</td>
                <td>Format Cell - Bai Ajel</td>
                <td>1</td>
                <td>visualbasic</td>
                <td>7</td>
                <!--<td style="font-family: monospace;">bda4fff1646a8eebae6da7ce6d719c1babea14eae178a82f751bf81e9f2912cb</td>-->
                <td>sql_keywords</td>
                <!--<td>Dim wb, ws As Object Dim excel, sheet, range As Object Try wb = GetWorkbook(Handle, Workbook) ws = GetWorksheet(Handle, Workbook, Worksheet) wb.Activate() ws.Activate() excel = ws.Application sheet = excel.ActiveSheet excel.Range(Select_Range).Select excel.Selection.Style = &quot;comma&quot;  Success = True C...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Dim wb, ws As Object
Dim excel, sheet, range As Object
Try wb = GetWorkbook(Handle, Workbook) ws = GetWorksheet(Handle, Workbook, Worksheet) wb.Activate() ws.Activate() excel = ws.Application sheet = excel.ActiveSheet excel.Range(Select_Range).Select excel.Selection.Style = &quot;comma&quot;  Success = True
Catch e As Exception     Success = False     Message = e.Message
Finally     wb = Nothing     excel = Nothing     range = Nothing
    End
    Try"
                            data-title="MS Excel VBO / Format Cell - Bai Ajel / 1">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>MS Excel VBO</td>
                <td>Format Columns</td>
                <td>1000 Seperator without decimal</td>
                <td>visualbasic</td>
                <td>7</td>
                <!--<td style="font-family: monospace;">fc690c5bc9ad8a8fc41126739f4a7884478aa6a0f28779587a00715ca08d6283</td>-->
                <td>sql_keywords</td>
                <!--<td>Dim wb, ws As Object Dim excel, sheet, range As Object Try wb = GetWorkbook(Handle, Workbook) ws = GetWorksheet(Handle, Workbook, Worksheet) wb.Activate() ws.Activate() excel = ws.Application sheet = excel.ActiveSheet excel.Range(Select_Range).Select excel.Selection.NumberFormat = &quot;0,000&quot;  Success =...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Dim wb, ws As Object
Dim excel, sheet, range As Object
Try wb = GetWorkbook(Handle, Workbook) ws = GetWorksheet(Handle, Workbook, Worksheet) wb.Activate() ws.Activate() excel = ws.Application sheet = excel.ActiveSheet excel.Range(Select_Range).Select excel.Selection.NumberFormat = &quot;0,000&quot;  Success = True
Catch e As Exception     Success = False     Message = e.Message
Finally     wb = Nothing     excel = Nothing     range = Nothing
    End
    Try"
                            data-title="MS Excel VBO / Format Columns / 1000 Seperator without decimal">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>MS Excel VBO</td>
                <td>Format Columns</td>
                <td>Date Format</td>
                <td>visualbasic</td>
                <td>7</td>
                <!--<td style="font-family: monospace;">7d2999f773ac0e96c11072312d75af69ab792e37e12bbc2c3b3ea74a139ce367</td>-->
                <td>sql_keywords</td>
                <!--<td>Dim wb, ws As Object Dim excel, sheet, range As Object Try wb = GetWorkbook(Handle, Workbook) ws = GetWorksheet(Handle, Workbook, Worksheet) wb.Activate() ws.Activate() excel = ws.Application sheet = excel.ActiveSheet excel.Range(Select_Range).Select excel.Selection.NumberFormat = &quot;m/d/yyyy&quot;  Succes...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Dim wb, ws As Object
Dim excel, sheet, range As Object
Try wb = GetWorkbook(Handle, Workbook) ws = GetWorksheet(Handle, Workbook, Worksheet) wb.Activate() ws.Activate() excel = ws.Application sheet = excel.ActiveSheet excel.Range(Select_Range).Select excel.Selection.NumberFormat = &quot;m/d/yyyy&quot;  Success = True
Catch e As Exception     Success = False     Message = e.Message
Finally     wb = Nothing     excel = Nothing     range = Nothing
    End
    Try"
                            data-title="MS Excel VBO / Format Columns / Date Format">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>MS Excel VBO</td>
                <td>Format Columns</td>
                <td>Date Format YYYY</td>
                <td>visualbasic</td>
                <td>7</td>
                <!--<td style="font-family: monospace;">1013ffc12540d7a6da72a98ef474616e0e7844ea0f0397b3c935f6980fe41dac</td>-->
                <td>sql_keywords</td>
                <!--<td>Dim wb, ws As Object Dim excel, sheet, range As Object Try wb = GetWorkbook(Handle, Workbook) ws = GetWorksheet(Handle, Workbook, Worksheet) wb.Activate() ws.Activate() excel = ws.Application sheet = excel.ActiveSheet excel.Range(Select_Range).Select excel.Selection.NumberFormat = &quot;YYYYMMDD&quot;  Succes...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Dim wb, ws As Object
Dim excel, sheet, range As Object
Try wb = GetWorkbook(Handle, Workbook) ws = GetWorksheet(Handle, Workbook, Worksheet) wb.Activate() ws.Activate() excel = ws.Application sheet = excel.ActiveSheet excel.Range(Select_Range).Select excel.Selection.NumberFormat = &quot;YYYYMMDD&quot;  Success = True
Catch e As Exception     Success = False     Message = e.Message
Finally     wb = Nothing     excel = Nothing     range = Nothing
    End
    Try"
                            data-title="MS Excel VBO / Format Columns / Date Format YYYY">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>MS Excel VBO</td>
                <td>Format Columns</td>
                <td>Fraction Format</td>
                <td>visualbasic</td>
                <td>7</td>
                <!--<td style="font-family: monospace;">5b22d159027fe78bba4984c443fe8af4c3f582934ddc0482f312dfded363fcfd</td>-->
                <td>sql_keywords</td>
                <!--<td>Dim wb, ws As Object Dim excel, sheet, range As Object Try wb = GetWorkbook(Handle, Workbook) ws = GetWorksheet(Handle, Workbook, Worksheet) wb.Activate() ws.Activate() excel = ws.Application sheet = excel.ActiveSheet excel.Range(Select_Range).Select excel.Selection.NumberFormat = &quot;# ?/?&quot;  Success =...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Dim wb, ws As Object
Dim excel, sheet, range As Object
Try wb = GetWorkbook(Handle, Workbook) ws = GetWorksheet(Handle, Workbook, Worksheet) wb.Activate() ws.Activate() excel = ws.Application sheet = excel.ActiveSheet excel.Range(Select_Range).Select excel.Selection.NumberFormat = &quot;# ?/?&quot;  Success = True
Catch e As Exception     Success = False     Message = e.Message
Finally     wb = Nothing     excel = Nothing     range = Nothing
    End
    Try"
                            data-title="MS Excel VBO / Format Columns / Fraction Format">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>MS Excel VBO</td>
                <td>Format Columns</td>
                <td>General Format</td>
                <td>visualbasic</td>
                <td>7</td>
                <!--<td style="font-family: monospace;">8c369574f9a3f9c2f8a2ebf0c25469ebd3e48fc4b45fe6894f806404f79fc044</td>-->
                <td>sql_keywords</td>
                <!--<td>Dim wb, ws As Object Dim excel, sheet, range As Object Try wb = GetWorkbook(Handle, Workbook) ws = GetWorksheet(Handle, Workbook, Worksheet) wb.Activate() ws.Activate() excel = ws.Application sheet = excel.ActiveSheet excel.Range(Select_Range).Select excel.Selection.NumberFormat = &quot;General&quot;  Success...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Dim wb, ws As Object
Dim excel, sheet, range As Object
Try wb = GetWorkbook(Handle, Workbook) ws = GetWorksheet(Handle, Workbook, Worksheet) wb.Activate() ws.Activate() excel = ws.Application sheet = excel.ActiveSheet excel.Range(Select_Range).Select excel.Selection.NumberFormat = &quot;General&quot;  Success = True
Catch e As Exception     Success = False     Message = e.Message
Finally     wb = Nothing     excel = Nothing     range = Nothing
    End
    Try"
                            data-title="MS Excel VBO / Format Columns / General Format">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>MS Excel VBO</td>
                <td>Format Columns</td>
                <td>Number Format</td>
                <td>visualbasic</td>
                <td>7</td>
                <!--<td style="font-family: monospace;">9c53ef59e57753c8b3b24c4fe989957b1832a179031f4a4bdbf7925da8b82bc4</td>-->
                <td>sql_keywords</td>
                <!--<td>Dim wb, ws As Object Dim excel, sheet, range As Object Try wb = GetWorkbook(Handle, Workbook) ws = GetWorksheet(Handle, Workbook, Worksheet) wb.Activate() ws.Activate() excel = ws.Application sheet = excel.ActiveSheet excel.Range(Select_Range).Select excel.Selection.NumberFormat = &quot;0.00&quot;  Success = ...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Dim wb, ws As Object
Dim excel, sheet, range As Object
Try wb = GetWorkbook(Handle, Workbook) ws = GetWorksheet(Handle, Workbook, Worksheet) wb.Activate() ws.Activate() excel = ws.Application sheet = excel.ActiveSheet excel.Range(Select_Range).Select excel.Selection.NumberFormat = &quot;0.00&quot;  Success = True
Catch e As Exception     Success = False     Message = e.Message
Finally     wb = Nothing     excel = Nothing     range = Nothing
    End
    Try"
                            data-title="MS Excel VBO / Format Columns / Number Format">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>MS Excel VBO</td>
                <td>Format Columns</td>
                <td>Number Format1</td>
                <td>visualbasic</td>
                <td>7</td>
                <!--<td style="font-family: monospace;">346c671c2438c1db9436a10d579f4936a5b866b0590ea8301284afd80b470258</td>-->
                <td>sql_keywords</td>
                <!--<td>Dim wb, ws As Object Dim excel, sheet, range As Object Try wb = GetWorkbook(Handle, Workbook) ws = GetWorksheet(Handle, Workbook, Worksheet) wb.Activate() ws.Activate() excel = ws.Application sheet = excel.ActiveSheet excel.Range(Select_Range).Select excel.Selection.NumberFormat = &quot;0,000.00&quot;  Succes...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Dim wb, ws As Object
Dim excel, sheet, range As Object
Try wb = GetWorkbook(Handle, Workbook) ws = GetWorksheet(Handle, Workbook, Worksheet) wb.Activate() ws.Activate() excel = ws.Application sheet = excel.ActiveSheet excel.Range(Select_Range).Select excel.Selection.NumberFormat = &quot;0,000.00&quot;  Success = True
Catch e As Exception     Success = False     Message = e.Message
Finally     wb = Nothing     excel = Nothing     range = Nothing
    End
    Try"
                            data-title="MS Excel VBO / Format Columns / Number Format1">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>MS Excel VBO</td>
                <td>Format Columns</td>
                <td>Number Format2</td>
                <td>visualbasic</td>
                <td>7</td>
                <!--<td style="font-family: monospace;">2ca196ee8a87b24f3e7314c5d5dd8dcf441db8d071c3f0f1b85800def864ef32</td>-->
                <td>sql_keywords</td>
                <!--<td>Dim wb, ws As Object Dim excel, sheet, range As Object Try wb = GetWorkbook(Handle, Workbook) ws = GetWorksheet(Handle, Workbook, Worksheet) wb.Activate() ws.Activate() excel = ws.Application sheet = excel.ActiveSheet excel.Range(Select_Range).Select With excel.Selection     .NumberFomat = &quot;0&quot;     ....</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Dim wb, ws As Object
Dim excel, sheet, range As Object
Try wb = GetWorkbook(Handle, Workbook) ws = GetWorksheet(Handle, Workbook, Worksheet) wb.Activate() ws.Activate() excel = ws.Application sheet = excel.ActiveSheet excel.Range(Select_Range).Select With excel.Selection     .NumberFomat = &quot;0&quot;     .Value = .Value End With  &#x27;excel.Selection.NumberFormat = &quot;0&quot;  Success = True
Catch e As Exception     Success = False     Message = e.Message
Finally     wb = Nothing     excel = Nothing     range = Nothing
    End
    Try"
                            data-title="MS Excel VBO / Format Columns / Number Format2">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>MS Excel VBO</td>
                <td>Format Columns</td>
                <td>Number Format3</td>
                <td>visualbasic</td>
                <td>7</td>
                <!--<td style="font-family: monospace;">70063ccec9d4d99bd1ccd9d7a46b7a0a8675f7e6267d01f0b32f9e6d861785a7</td>-->
                <td>sql_keywords</td>
                <!--<td>Dim wb, ws As Object Dim excel, sheet, range As Object Try wb = GetWorkbook(Handle, Workbook) ws = GetWorksheet(Handle, Workbook, Worksheet) wb.Activate() ws.Activate() excel = ws.Application sheet = excel.ActiveSheet excel.Range(Select_Range).Select With excel.Selection     .NumberFomat = &quot;0.0&quot;    ...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Dim wb, ws As Object
Dim excel, sheet, range As Object
Try wb = GetWorkbook(Handle, Workbook) ws = GetWorksheet(Handle, Workbook, Worksheet) wb.Activate() ws.Activate() excel = ws.Application sheet = excel.ActiveSheet excel.Range(Select_Range).Select With excel.Selection     .NumberFomat = &quot;0.0&quot;     .Value = .Value End With  excel.Selection.NumberFormat = &quot;0&quot;  Success = True
Catch e As Exception     Success = False     Message = e.Message
Finally     wb = Nothing     excel = Nothing     range = Nothing
    End
    Try"
                            data-title="MS Excel VBO / Format Columns / Number Format3">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>MS Excel VBO</td>
                <td>Format Columns</td>
                <td>Number Format4</td>
                <td>visualbasic</td>
                <td>7</td>
                <!--<td style="font-family: monospace;">fc690c5bc9ad8a8fc41126739f4a7884478aa6a0f28779587a00715ca08d6283</td>-->
                <td>sql_keywords</td>
                <!--<td>Dim wb, ws As Object Dim excel, sheet, range As Object Try wb = GetWorkbook(Handle, Workbook) ws = GetWorksheet(Handle, Workbook, Worksheet) wb.Activate() ws.Activate() excel = ws.Application sheet = excel.ActiveSheet excel.Range(Select_Range).Select excel.Selection.NumberFormat = &quot;0,000&quot;  Success =...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Dim wb, ws As Object
Dim excel, sheet, range As Object
Try wb = GetWorkbook(Handle, Workbook) ws = GetWorksheet(Handle, Workbook, Worksheet) wb.Activate() ws.Activate() excel = ws.Application sheet = excel.ActiveSheet excel.Range(Select_Range).Select excel.Selection.NumberFormat = &quot;0,000&quot;  Success = True
Catch e As Exception     Success = False     Message = e.Message
Finally     wb = Nothing     excel = Nothing     range = Nothing
    End
    Try"
                            data-title="MS Excel VBO / Format Columns / Number Format4">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>MS Excel VBO</td>
                <td>Format Columns</td>
                <td>Number Format5</td>
                <td>visualbasic</td>
                <td>7</td>
                <!--<td style="font-family: monospace;">01117d88f22f026ed24a60b1ca6b29336ad8c8b5abe51c6f68d7f64f93d037b6</td>-->
                <td>sql_keywords</td>
                <!--<td>Dim wb, ws As Object Dim excel, sheet, range As Object Try wb = GetWorkbook(Handle, Workbook) ws = GetWorksheet(Handle, Workbook, Worksheet) wb.Activate() ws.Activate() excel = ws.Application sheet = excel.ActiveSheet excel.Range(Select_Range).Select excel.Selection.NumberFormat = &quot;0&quot;  Success = Tru...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Dim wb, ws As Object
Dim excel, sheet, range As Object
Try wb = GetWorkbook(Handle, Workbook) ws = GetWorksheet(Handle, Workbook, Worksheet) wb.Activate() ws.Activate() excel = ws.Application sheet = excel.ActiveSheet excel.Range(Select_Range).Select excel.Selection.NumberFormat = &quot;0&quot;  Success = True
Catch e As Exception     Success = False     Message = e.Message
Finally     wb = Nothing     excel = Nothing     range = Nothing
    End
    Try"
                            data-title="MS Excel VBO / Format Columns / Number Format5">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>MS Excel VBO</td>
                <td>Format Columns</td>
                <td>Percentage Format</td>
                <td>visualbasic</td>
                <td>7</td>
                <!--<td style="font-family: monospace;">eda306779c0b468a70855dcb90d05591949dcf453e2d6dfd314a2388a3028e1e</td>-->
                <td>sql_keywords</td>
                <!--<td>Dim wb, ws As Object Dim excel, sheet, range As Object Try wb = GetWorkbook(Handle, Workbook) ws = GetWorksheet(Handle, Workbook, Worksheet) wb.Activate() ws.Activate() excel = ws.Application sheet = excel.ActiveSheet excel.Range(Select_Range).Select excel.Selection.NumberFormat = &quot;0.00%&quot;  Success =...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Dim wb, ws As Object
Dim excel, sheet, range As Object
Try wb = GetWorkbook(Handle, Workbook) ws = GetWorksheet(Handle, Workbook, Worksheet) wb.Activate() ws.Activate() excel = ws.Application sheet = excel.ActiveSheet excel.Range(Select_Range).Select excel.Selection.NumberFormat = &quot;0.00%&quot;  Success = True
Catch e As Exception     Success = False     Message = e.Message
Finally     wb = Nothing     excel = Nothing     range = Nothing
    End
    Try"
                            data-title="MS Excel VBO / Format Columns / Percentage Format">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>MS Excel VBO</td>
                <td>Format Columns</td>
                <td>Text Format</td>
                <td>visualbasic</td>
                <td>7</td>
                <!--<td style="font-family: monospace;">aad18ff1c300b45625073f0ea388b9272a36c0517bf0c7f59943eb2cfb483a84</td>-->
                <td>sql_keywords</td>
                <!--<td>Dim wb, ws As Object Dim excel, sheet, range As Object Try wb = GetWorkbook(Handle, Workbook) ws = GetWorksheet(Handle, Workbook, Worksheet) wb.Activate() ws.Activate() excel = ws.Application sheet = excel.ActiveSheet excel.Range(Select_Range).Select excel.Selection.NumberFormat = &quot;@&quot;  Success = Tru...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Dim wb, ws As Object
Dim excel, sheet, range As Object
Try wb = GetWorkbook(Handle, Workbook) ws = GetWorksheet(Handle, Workbook, Worksheet) wb.Activate() ws.Activate() excel = ws.Application sheet = excel.ActiveSheet excel.Range(Select_Range).Select excel.Selection.NumberFormat = &quot;@&quot;  Success = True
Catch e As Exception     Success = False     Message = e.Message
Finally     wb = Nothing     excel = Nothing     range = Nothing
    End
    Try"
                            data-title="MS Excel VBO / Format Columns / Text Format">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>MS Excel VBO</td>
                <td>Format Columns</td>
                <td>Text Format1</td>
                <td>visualbasic</td>
                <td>7</td>
                <!--<td style="font-family: monospace;">aad18ff1c300b45625073f0ea388b9272a36c0517bf0c7f59943eb2cfb483a84</td>-->
                <td>sql_keywords</td>
                <!--<td>Dim wb, ws As Object Dim excel, sheet, range As Object Try wb = GetWorkbook(Handle, Workbook) ws = GetWorksheet(Handle, Workbook, Worksheet) wb.Activate() ws.Activate() excel = ws.Application sheet = excel.ActiveSheet excel.Range(Select_Range).Select excel.Selection.NumberFormat = &quot;@&quot;  Success = Tru...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Dim wb, ws As Object
Dim excel, sheet, range As Object
Try wb = GetWorkbook(Handle, Workbook) ws = GetWorksheet(Handle, Workbook, Worksheet) wb.Activate() ws.Activate() excel = ws.Application sheet = excel.ActiveSheet excel.Range(Select_Range).Select excel.Selection.NumberFormat = &quot;@&quot;  Success = True
Catch e As Exception     Success = False     Message = e.Message
Finally     wb = Nothing     excel = Nothing     range = Nothing
    End
    Try"
                            data-title="MS Excel VBO / Format Columns / Text Format1">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>MS Excel VBO</td>
                <td>Format Columns</td>
                <td>Time Format</td>
                <td>visualbasic</td>
                <td>7</td>
                <!--<td style="font-family: monospace;">e76074ae99ee06a55a7ade20622354a61b8390884951dc848ef5ab8d2071c93e</td>-->
                <td>sql_keywords</td>
                <!--<td>Dim wb, ws As Object Dim excel, sheet, range As Object Try wb = GetWorkbook(Handle, Workbook) ws = GetWorksheet(Handle, Workbook, Worksheet) wb.Activate() ws.Activate() excel = ws.Application sheet = excel.ActiveSheet excel.Range(Select_Range).Select excel.Selection.NumberFormat = &quot;hh:mm:ss&quot;  Succes...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Dim wb, ws As Object
Dim excel, sheet, range As Object
Try wb = GetWorkbook(Handle, Workbook) ws = GetWorksheet(Handle, Workbook, Worksheet) wb.Activate() ws.Activate() excel = ws.Application sheet = excel.ActiveSheet excel.Range(Select_Range).Select excel.Selection.NumberFormat = &quot;hh:mm:ss&quot;  Success = True
Catch e As Exception     Success = False     Message = e.Message
Finally     wb = Nothing     excel = Nothing     range = Nothing
    End
    Try"
                            data-title="MS Excel VBO / Format Columns / Time Format">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>MS Excel VBO</td>
                <td>Get Active Cell</td>
                <td>GetActiveCell</td>
                <td>visualbasic</td>
                <td>1</td>
                <!--<td style="font-family: monospace;">29565734b5b24bd9af2cdab6f0542393ce0066978d626fd39de1a47b5dc0c035</td>-->
                <td>—</td>
                <!--<td>cellref = GetInstance(handle).ActiveCell.Address(False,False)</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="cellref = GetInstance(handle).ActiveCell.Address(False,False)"
                            data-title="MS Excel VBO / Get Active Cell / GetActiveCell">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>MS Excel VBO</td>
                <td>Get Cell Value</td>
                <td>Get Cell Value</td>
                <td>visualbasic</td>
                <td>1</td>
                <!--<td style="font-family: monospace;">42d6b2a19a1adfc32e5f512e9af6dc2bacb542ea60621c61788fdce9a6e6b2b3</td>-->
                <td>—</td>
                <!--<td>Dim cellVal as String = GetInstance(handle).ActiveCell.Value     value = IIf(cellVal Is Nothing, &quot;&quot;, cellVal)</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Dim cellVal as String = GetInstance(handle).ActiveCell.Value     value = IIf(cellVal Is Nothing, &quot;&quot;, cellVal)"
                            data-title="MS Excel VBO / Get Cell Value / Get Cell Value">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>MS Excel VBO</td>
                <td>Get Formatted Cell Value</td>
                <td>Get Cell Text</td>
                <td>visualbasic</td>
                <td>1</td>
                <!--<td style="font-family: monospace;">64b1f6621366b5d38a58feb166dc8a2fc9607781141e7210deba679e4576de45</td>-->
                <td>—</td>
                <!--<td>value = GetInstance(handle).ActiveCell.Text</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="value = GetInstance(handle).ActiveCell.Text"
                            data-title="MS Excel VBO / Get Formatted Cell Value / Get Cell Text">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>MS Excel VBO</td>
                <td>Get Number Of Rows</td>
                <td>Count Rows</td>
                <td>visualbasic</td>
                <td>1</td>
                <!--<td style="font-family: monospace;">611586734d5b8e30834efd4e370b70bebbf4417d84db8d6dcc16b86460345bb9</td>-->
                <td>—</td>
                <!--<td>&#x27; enum - Excel.XlSearchDirection.xlPrevious=2 rowcount = GetWorksheet(handle,workbookname,worksheetname).Cells.Find(&quot;*&quot;, , , , , 2).Row</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="&#x27; enum - Excel.XlSearchDirection.xlPrevious=2 rowcount = GetWorksheet(handle,workbookname,worksheetname).Cells.Find(&quot;*&quot;, , , , , 2).Row"
                            data-title="MS Excel VBO / Get Number Of Rows / Count Rows">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>MS Excel VBO</td>
                <td>Get Worksheet As Collection</td>
                <td>GetWorksheetAsCollection</td>
                <td>visualbasic</td>
                <td>33</td>
                <!--<td style="font-family: monospace;">cfc01b8284cf70272d9662eb32080cb8aa2d9675693912ba3fc27a8d7f057fbe</td>-->
                <td>—</td>
                <!--<td>Dim ws as Object = GetWorksheet(handle, workbookname, worksheetname, False)      &#x27; Do we have a sheet?     sheetexists = ws IsNot Nothing     &#x27; No sheet? No en     try.         If Not sheetexists Then             Return      ws.Activate()     ws.UsedRange.Select()     ws.UsedRange.Copy()            ...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Dim ws as Object = GetWorksheet(handle, workbookname, worksheetname, False)      &#x27;
Do we have a sheet?     sheetexists = ws IsNot Nothing     &#x27; No sheet? No en
    try.
        If Not sheetexists Then
            Return      ws.Activate()     ws.UsedRange.Select()     ws.UsedRange.Copy()
            Dim data As String = Clipboard.GetDataObject().GetData(DataFormats.UnicodeText, True)          &#x27; The data split into rows
            Dim asRows() As String = Split(data, vbCrLf)
            Dim table As New DataTable()     &#x27;
            Set a flag indicating the header row
            Dim isHeaderRow As Boolean = True
            For Each strRow As String In asRows
                If Not String.IsNullOrEmpty(strRow) Then
                    Dim fields() As String = Split(strRow, vbTab)
                    If isHeaderRow Then
                        isHeaderRow = False
                    End If
                    For Each field As String in fields                     table.Columns.Add(field)
                    Next
                Else
                    Dim row as DataRow = table.NewRow()
                    For i As Integer = 0 To fields.Length - 1
                        If i &lt; fields.Length Then
                            row(i) = fields(i)
                        End If
                    Else                         row(i) = &quot;&quot;
                        End
                        If
                    Next I                 table.Rows.Add(row)
                    End
                    If
                    End
                    If
                Next     worksheetcollection = table"
                            data-title="MS Excel VBO / Get Worksheet As Collection / GetWorksheetAsCollection">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>MS Excel VBO</td>
                <td>Get Worksheet Name</td>
                <td>Get Worksheet</td>
                <td>visualbasic</td>
                <td>6</td>
                <!--<td style="font-family: monospace;">90fc124690f851479075e2671897d0041493aff6b5bbba927ffcf25bc5917281</td>-->
                <td>—</td>
                <!--<td>Dim wb, ws As Object Try  wb = GetWorkbook(Handle, Workbook) ws = wb.Worksheets(Position) Worksheet = ws.Name  Success = True Catch e As Exception    position = -1     Success = False     Message = e.Message Finally     wb = Nothing     ws = Nothing     End     Try</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Dim wb, ws As Object
Try  wb = GetWorkbook(Handle, Workbook) ws = wb.Worksheets(Position) Worksheet = ws.Name  Success = True
Catch e As Exception    position = -1     Success = False     Message = e.Message
Finally     wb = Nothing     ws = Nothing
    End
    Try"
                            data-title="MS Excel VBO / Get Worksheet Name / Get Worksheet">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>MS Excel VBO</td>
                <td>Get Worksheet Names</td>
                <td>Get Worksheets</td>
                <td>visualbasic</td>
                <td>6</td>
                <!--<td style="font-family: monospace;">c150d214b07af824f56f62d8ebe86786b7608506b1fb87b99d26980bdd1c5be9</td>-->
                <td>reflection</td>
                <!--<td>Dim wb As Object = GetWorkbook(Handle, WorkbookName) Dim sheets as Object = wb.Sheets  Worksheet_Names = New DataTable() Worksheet_Names.Columns.Add(&quot;Name&quot;, GetType(String)) If sheets IsNot Nothing Then     For Each sheet as Object in sheets         Worksheet_Names.Rows.Add(New Object() {sheet.Name}...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Dim wb As Object = GetWorkbook(Handle, WorkbookName)
Dim sheets as Object = wb.Sheets  Worksheet_Names = New DataTable() Worksheet_Names.Columns.Add(&quot;Name&quot;, GetType(String))
If sheets IsNot Nothing Then
    For Each sheet as Object in sheets         Worksheet_Names.Rows.Add(New Object() {sheet.Name})
    Next
End If"
                            data-title="MS Excel VBO / Get Worksheet Names / Get Worksheets">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>MS Excel VBO</td>
                <td>Get Worksheet Position</td>
                <td>Get Worksheet Position</td>
                <td>visualbasic</td>
                <td>6</td>
                <!--<td style="font-family: monospace;">475da8913545206e06b971f1037ad90849dcbc578b0c6ca9ecd6453de1a38ce3</td>-->
                <td>—</td>
                <!--<td>Dim wb, ws As Object Try  wb = GetWorkbook(Handle, Workbook) ws = wb.Worksheets Position = ws(Worksheet).Index  Success = True Catch e As Exception    position = -1     Success = False     Message = e.Message Finally     wb = Nothing     ws = Nothing     End     Try</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Dim wb, ws As Object
Try  wb = GetWorkbook(Handle, Workbook) ws = wb.Worksheets Position = ws(Worksheet).Index  Success = True
Catch e As Exception    position = -1     Success = False     Message = e.Message
Finally     wb = Nothing     ws = Nothing
    End
    Try"
                            data-title="MS Excel VBO / Get Worksheet Position / Get Worksheet Position">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>MS Excel VBO</td>
                <td>Get Worksheet Range As Collection</td>
                <td>GetWorksheetRangeAsCollection</td>
                <td>visualbasic</td>
                <td>30</td>
                <!--<td style="font-family: monospace;">cad0f6d468bb870297661b7abaa113792b06cef46c146271687e643c78c8c773</td>-->
                <td>—</td>
                <!--<td>Dim ws as Object = GetWorksheet(handle, workbookname, worksheetname) Dim r as Object     r = ws.Range(Start_Cell &amp; &quot;:&quot; &amp; End_Cell)     r.Select()     r.Copy() Dim data As String = Clipboard.GetDataObject().GetData(DataFormats.UnicodeText, True)          &#x27; The data split into rows Dim asRows() As Str...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Dim ws as Object = GetWorksheet(handle, workbookname, worksheetname)
Dim r as Object     r = ws.Range(Start_Cell &amp; &quot;:&quot; &amp; End_Cell)     r.Select()     r.Copy()
Dim data As String = Clipboard.GetDataObject().GetData(DataFormats.UnicodeText, True)          &#x27; The data split into rows
Dim asRows() As String = Split(data, vbCrLf)
Dim table As New DataTable()     &#x27;
Set a flag indicating the header row
Dim isHeaderRow As Boolean = True
For Each strRow As String In asRows
    If Not String.IsNullOrEmpty(strRow) Then
        Dim fields() As String = Split(strRow, vbTab)
        If isHeaderRow Then
            isHeaderRow = False
        End If
        For Each field As String in fields                     table.Columns.Add(field)
        Next
    Else
        Dim row as DataRow = table.NewRow()
        For i As Integer = 0 To fields.Length - 1
            If i &lt; fields.Length Then
                row(i) = fields(i)
            End If
        Else                         row(i) = &quot;&quot;
            End
            If
        Next I                 table.Rows.Add(row)
        End
        If
        End
        If
    Next     worksheetcollection = table"
                            data-title="MS Excel VBO / Get Worksheet Range As Collection / GetWorksheetRangeAsCollection">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>MS Excel VBO</td>
                <td>Get Worksheet as Collection Offset</td>
                <td>GetWorksheetAsCollectionOffset</td>
                <td>visualbasic</td>
                <td>37</td>
                <!--<td style="font-family: monospace;">7d3d8584e5ace55cf98ff99f1d2d43ca176ce49f2d02c97f296dde59f3669c4f</td>-->
                <td>—</td>
                <!--<td>Dim ws as Object = GetWorksheet(handle, workbookname, worksheetname)     ws.Activate() Dim cell as Object = ws.Range(Start_Cell) Dim r as Object = ws.UsedRange.Offset(cell.row-1,cell.column-1)     r.Select()     r.Copy() Dim data As String = Clipboard.GetDataObject().GetData(DataFormats.UnicodeText,...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Dim ws as Object = GetWorksheet(handle, workbookname, worksheetname)     ws.Activate()
Dim cell as Object = ws.Range(Start_Cell)
Dim r as Object = ws.UsedRange.Offset(cell.row-1,cell.column-1)     r.Select()     r.Copy()
Dim data As String = Clipboard.GetDataObject().GetData(DataFormats.UnicodeText, True)          &#x27; The data split into rows
Dim asRows() As String = Split(data, vbCrLf)
Dim table As New DataTable()     &#x27;
Set a flag indicating the header row
Dim isHeaderRow As Boolean = Use_Header
For Each strRow As String In asRows
    If Not String.IsNullOrEmpty(strRow) Then
        Dim fields() As String = Split(strRow, vbTab)
        If Not Use_Header Then
            Dim i As Integer
            For Each field As String in fields                     i += 1                     table.Columns.Add(&quot;Field&quot; &amp; i)
            Next
            End
            If
            If isHeaderRow Then
                isHeaderRow = False
            End If
            For Each field As String in fields                     table.Columns.Add(field)
            Next
        Else
            Dim row as DataRow = table.NewRow()
            For i As Integer = 0 To fields.Length - 1
                If i &lt; fields.Length Then
                    row(i) = fields(i)
                End If
            Else                         row(i) = &quot;&quot;
                End
                If
            Next I                 table.Rows.Add(row)
            End
            If
            End
            If
        Next     worksheetcollection = table"
                            data-title="MS Excel VBO / Get Worksheet as Collection Offset / GetWorksheetAsCollectionOffset">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>MS Excel VBO</td>
                <td>Go To Cell</td>
                <td>Select Cell</td>
                <td>visualbasic</td>
                <td>1</td>
                <!--<td style="font-family: monospace;">3fab15ab1f9820ca0e9164d693344f655dcd95be71fa5c104980f9c9d5a0509e</td>-->
                <td>—</td>
                <!--<td>GetWorkbook(handle, &quot;&quot;).ActiveSheet.Range(cellref,cellref).Activate()</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="GetWorkbook(handle, &quot;&quot;).ActiveSheet.Range(cellref,cellref).Activate()"
                            data-title="MS Excel VBO / Go To Cell / Select Cell">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>MS Excel VBO</td>
                <td>Go To Next Cell</td>
                <td>GoToNextCell</td>
                <td>visualbasic</td>
                <td>21</td>
                <!--<td style="font-family: monospace;">e313a7946129f51ec857556e5b98381e1ab23acfc3351b8150ee783d08ea828b</td>-->
                <td>—</td>
                <!--<td>Dim Instance As Object = GetInstance(handle) If Instance.ActiveCell Is Nothing Then     Dim wb As Object = Instance.ActiveWorkBook     If wb IsNot Nothing Then         Dim ws As Object = wb.ActiveSheet         If ws IsNot Nothing Then             ws.Range(1,1).Activate()         End If     Else     ...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Dim Instance As Object = GetInstance(handle)
If Instance.ActiveCell Is Nothing Then
    Dim wb As Object = Instance.ActiveWorkBook
    If wb IsNot Nothing Then
        Dim ws As Object = wb.ActiveSheet
        If ws IsNot Nothing Then
            ws.Range(1,1).Activate()
        End If
    Else             Throw New Exception(&quot;There is no active worksheet&quot;)
        End
        If
    Else         Throw New Exception(&quot;There is no active workbook&quot;)
        End
        If
    Else
        Try         Instance.ActiveCell.Offset(rows,cols).Activate()
        Catch ex As Exception
            End
            Try
                End
                If cellref = Instance.ActiveCell.Address(False,False)"
                            data-title="MS Excel VBO / Go To Next Cell / GoToNextCell">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>MS Excel VBO</td>
                <td>Hide</td>
                <td>HideInstance</td>
                <td>visualbasic</td>
                <td>1</td>
                <!--<td style="font-family: monospace;">ce168462910e03439b02f240db28d78b867c22ddfb302c09e0346ac413ab9bf1</td>-->
                <td>—</td>
                <!--<td>GetInstance(handle).Visible = False</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="GetInstance(handle).Visible = False"
                            data-title="MS Excel VBO / Hide / HideInstance">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>MS Excel VBO</td>
                <td>Hide Other Worksheets</td>
                <td>Hide Other Worksheets</td>
                <td>visualbasic</td>
                <td>8</td>
                <!--<td style="font-family: monospace;">9faf43af4283378908b8696efcad6afcd5525dd1a212c78afddf756ace6d022f</td>-->
                <td>—</td>
                <!--<td>Dim wb As Object Try  wb = GetWorkbook(Handle, Workbook)     For Each ws As Object In wb.Worksheets     ws.Visible = (ws.Name = Worksheet)     Next  Success = True Catch e As Exception     Success = False     Message = e.Message Finally     wb = Nothing     End     Try</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Dim wb As Object
Try  wb = GetWorkbook(Handle, Workbook)
    For Each ws As Object In wb.Worksheets     ws.Visible = (ws.Name = Worksheet)
    Next  Success = True
Catch e As Exception     Success = False     Message = e.Message
Finally     wb = Nothing
    End
    Try"
                            data-title="MS Excel VBO / Hide Other Worksheets / Hide Other Worksheets">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>MS Excel VBO</td>
                <td>Hide Worksheet</td>
                <td>Hide Worksheet</td>
                <td>visualbasic</td>
                <td>6</td>
                <!--<td style="font-family: monospace;">eb846680b87d6b2407c97ac8eb2b91ae4a64d064446cf8b2a5d293abca6ab15f</td>-->
                <td>—</td>
                <!--<td>Dim ws As Object Try  ws = GetWorkSheet(Handle, Workbook, Worksheet) ws.Visible = False  Success = True Catch e As Exception     Success = False     Message = e.Message Finally     ws = Nothing     End     Try</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Dim ws As Object
Try  ws = GetWorkSheet(Handle, Workbook, Worksheet) ws.Visible = False  Success = True
Catch e As Exception     Success = False     Message = e.Message
Finally     ws = Nothing
    End
    Try"
                            data-title="MS Excel VBO / Hide Worksheet / Hide Worksheet">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>MS Excel VBO</td>
                <td>Highlight Active Cell</td>
                <td>Check Handle1</td>
                <td>visualbasic</td>
                <td>1</td>
                <!--<td style="font-family: monospace;">53a703fbfb00e35ac207034fd0474a3807b1d16c439e3a3aa19ebeb9c48d78b8</td>-->
                <td>—</td>
                <!--<td>&#x27; Just ensure that the handle references a valid instance HandleMissing = (GetInstance(handle) is Nothing)</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="&#x27; Just ensure that the handle references a valid instance HandleMissing = (GetInstance(handle) is Nothing)"
                            data-title="MS Excel VBO / Highlight Active Cell / Check Handle1">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>MS Excel VBO</td>
                <td>Highlight Active Cell</td>
                <td>Highlight Cell</td>
                <td>visualbasic</td>
                <td>2</td>
                <!--<td style="font-family: monospace;">0600ed564d40a377841419ffe00693c24bd5e57f64bc5bbaed9b8aebfe04754c</td>-->
                <td>—</td>
                <!--<td>Dim IngColor As Long IngColor = RGB(R,G,B) GetInstance(handle).ActiveCell.Interior.Color = IngColor Dim activeCell = GetInstance(handle).ActiveCell</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Dim IngColor As Long IngColor = RGB(R,G,B) GetInstance(handle).ActiveCell.Interior.Color = IngColor
Dim activeCell = GetInstance(handle).ActiveCell"
                            data-title="MS Excel VBO / Highlight Active Cell / Highlight Cell">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>MS Excel VBO</td>
                <td>Import CSV</td>
                <td>Import CSV</td>
                <td>visualbasic</td>
                <td>8</td>
                <!--<td style="font-family: monospace;">0f06b93942338bc088df6a197ef2579a1ae650c2a9582e0130e705487363f584</td>-->
                <td>hardcoded_credential_like</td>
                <!--<td>Dim dw, ds, dr, qt As Object Try  dw = GetWorkbook(Handle, Workbook) ds = GetWorksheet(Handle, Workbook, Worksheet) dr = ds.Range(Range) qt = ds.QueryTables.Add(Connection     =&quot;TEXT;&quot; &amp; Path, Destination     =dr)  With qt     .FieldNames = True     .RowNumbers = False     .FillAdjacentFormulas = Fa...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Dim dw, ds, dr, qt As Object
Try  dw = GetWorkbook(Handle, Workbook) ds = GetWorksheet(Handle, Workbook, Worksheet) dr = ds.Range(Range) qt = ds.QueryTables.Add(Connection
    =&quot;TEXT;&quot; &amp; Path, Destination
    =dr)  With qt     .FieldNames = True     .RowNumbers = False     .FillAdjacentFormulas = False     .PreserveFormatting = True     .RefreshOnFileOpen = False     .RefreshStyle = 1 &#x27;xlInsertDeleteCells     .SavePassword = False     .SaveData = True     .AdjustColumnWidth = True     .RefreshPeriod = 0     .TextFilePromptOnRefresh = False     .TextFilePlatform = 437     .TextFileStartRow = 1     .TextFileParseType = 1 &#x27;xlDelimited     .TextFileTextQualifier = Qualifier     .TextFileConsecutiveDelimiter = False     .TextFileTabDelimiter = False     .TextFileSemicolonDelimiter = False     .TextFileCommaDelimiter = True     .TextFileSpaceDelimiter = False     .TextFileTrailingMinusNumbers = True End With qt.Refresh(False)  Success = True
Catch e As Exception     Success = False     Message = e.Message
Finally     dw = Nothing     ds = Nothing     dr = Nothing     qt = Nothing
    End
    Try"
                            data-title="MS Excel VBO / Import CSV / Import CSV">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>MS Excel VBO</td>
                <td>Insert</td>
                <td>Insert</td>
                <td>visualbasic</td>
                <td>7</td>
                <!--<td style="font-family: monospace;">bc45c9baae5cb997dabc54ed2ff1ac787590545e10a0941663379daed9c9c9d3</td>-->
                <td>—</td>
                <!--<td>Dim wb, excel, range As Object Try  wb = GetWorkbook(Handle, Workbook) excel = wb.Application  range = excel.Selection range.Insert(Shift     =[Shift_Type])  Success = True Catch e As Exception     Success = False     Message = e.Message Finally     wb = Nothing     excel = Nothing     range = Nothi...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Dim wb, excel, range As Object
Try  wb = GetWorkbook(Handle, Workbook) excel = wb.Application  range = excel.Selection range.Insert(Shift
    =[Shift_Type])  Success = True
Catch e As Exception     Success = False     Message = e.Message
Finally     wb = Nothing     excel = Nothing     range = Nothing
    End
    Try"
                            data-title="MS Excel VBO / Insert / Insert">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>MS Excel VBO</td>
                <td>Is Read Only</td>
                <td>Check Read Only</td>
                <td>visualbasic</td>
                <td>1</td>
                <!--<td style="font-family: monospace;">f635a694342cff12939ee987f21d23fedfc4abead4d14eab10b9ff75a57a0ca2</td>-->
                <td>—</td>
                <!--<td>isreadonly = GetWorkbook(handle,workbookname).ReadOnly</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="isreadonly = GetWorkbook(handle,workbookname).ReadOnly"
                            data-title="MS Excel VBO / Is Read Only / Check Read Only">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>MS Excel VBO</td>
                <td>Move Worksheet</td>
                <td>Move Named Worksheet</td>
                <td>visualbasic</td>
                <td>27</td>
                <!--<td style="font-family: monospace;">9b8e98276c9251895d674c33a54cad730f646d90cb975937b880c4ebe6d3032e</td>-->
                <td>—</td>
                <!--<td>Dim dBook, sSheet As Object Dim p As Integer Try  dBook = GetWorkbook(Handle, DestinationWorkbook) sSheet = GetWorksheet(Handle, SourceWorkbook, SourceWorksheet)  p = Math.Max(1, DestinationPosition) p = Math.Min(dBook.Worksheets.Count, p)     If DestinationPosition &gt; p Then         If Copy Then    ...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Dim dBook, sSheet As Object
Dim p As Integer
Try  dBook = GetWorkbook(Handle, DestinationWorkbook) sSheet = GetWorksheet(Handle, SourceWorkbook, SourceWorksheet)  p = Math.Max(1, DestinationPosition) p = Math.Min(dBook.Worksheets.Count, p)
    If DestinationPosition &gt; p Then
        If Copy Then
            sSheet.Copy(After
        End If
        =dBook.Worksheets(p))
    Else         sSheet.Move(After
        =dBook.Worksheets(p))
        End
        If
    Else
        If Copy Then
            sSheet.Copy(Before
        End If
        =dBook.Worksheets(p))
    Else         sSheet.Move(Before
        =dBook.Worksheets(p))
        End
        If
        End
        If  Success = True
        Catch e As Exception     Success = False     Message = e.Message
        Finally     dBook = Nothing     sSheet = Nothing
            End
            Try"
                            data-title="MS Excel VBO / Move Worksheet / Move Named Worksheet">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>MS Excel VBO</td>
                <td>Move Worksheet</td>
                <td>Move Numbered Worksheet</td>
                <td>visualbasic</td>
                <td>28</td>
                <!--<td style="font-family: monospace;">0c69bfa4b3adcaaabad0f320157cc8661021b43837dac53a904b0bcc8b8a2976</td>-->
                <td>—</td>
                <!--<td>Dim sBook, dBook As Object Dim sSheet As Object Dim p As Integer Try  sBook = GetWorkbook(Handle, SourceWorkbook) dBook = GetWorkbook(Handle, DestinationWorkbook)  sSheet = sBook.Worksheets(SourceWorksheet)  p = Math.Max(1, DestinationPosition) p = Math.Min(sBook.Worksheets.Count, p)     If Destinat...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Dim sBook, dBook As Object
Dim sSheet As Object
Dim p As Integer
Try  sBook = GetWorkbook(Handle, SourceWorkbook) dBook = GetWorkbook(Handle, DestinationWorkbook)  sSheet = sBook.Worksheets(SourceWorksheet)  p = Math.Max(1, DestinationPosition) p = Math.Min(sBook.Worksheets.Count, p)
    If DestinationPosition &gt; p Then
        If Copy Then
            sSheet.Copy(After
        End If
        =dBook.Worksheets(p))
    Else         sSheet.Move(After
        =dBook.Worksheets(p))
        End
        If
    Else
        If Copy Then
            sSheet.Copy(Before
        End If
        =dBook.Worksheets(p))
    Else         sSheet.Move(Before
        =dBook.Worksheets(p))
        End
        If
        End
        If  Success = True
        Catch e As Exception     Success = False     Message = e.Message
        Finally     sBook = Nothing     dBook = Nothing     sSheet = Nothing
            End
            Try"
                            data-title="MS Excel VBO / Move Worksheet / Move Numbered Worksheet">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>MS Excel VBO</td>
                <td>Open Instance</td>
                <td>Open Arbitrary Instance</td>
                <td>visualbasic</td>
                <td>1</td>
                <!--<td style="font-family: monospace;">0c6285b3b23f867a2e274fcb7ef15af00c30bca017b9c46ad0bfc1a6ec43c152</td>-->
                <td>—</td>
                <!--<td>handle = GetHandle(GetObject(,&quot;Excel.Application&quot;))</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="handle = GetHandle(GetObject(,&quot;Excel.Application&quot;))"
                            data-title="MS Excel VBO / Open Instance / Open Arbitrary Instance">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>MS Excel VBO</td>
                <td>Open Instance</td>
                <td>Open Named Instance</td>
                <td>visualbasic</td>
                <td>1</td>
                <!--<td style="font-family: monospace;">7ab645c9ee38d46eb5d144d852a9895c2c76da51637063cb3bc3fa07a66e6b5b</td>-->
                <td>—</td>
                <!--<td>handle = GetHandle(GetObject(WorkbookName,&quot;Excel.Application&quot;))</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="handle = GetHandle(GetObject(WorkbookName,&quot;Excel.Application&quot;))"
                            data-title="MS Excel VBO / Open Instance / Open Named Instance">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>MS Excel VBO</td>
                <td>Open Workbook</td>
                <td>Open Workbook</td>
                <td>visualbasic</td>
                <td>1</td>
                <!--<td style="font-family: monospace;">9857ec99099315553e83e3a671315b32e3dbf6e94b27bf88df1533ddc97638d3</td>-->
                <td>—</td>
                <!--<td>Dim wb as Object = GetInstance(handle).Workbooks.Open(filename) name = wb.Name wb.Activate()</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Dim wb as Object = GetInstance(handle).Workbooks.Open(filename) name = wb.Name wb.Activate()"
                            data-title="MS Excel VBO / Open Workbook / Open Workbook">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>MS Excel VBO</td>
                <td>Paste</td>
                <td>Paste Values1</td>
                <td>visualbasic</td>
                <td>10</td>
                <!--<td style="font-family: monospace;">fe84446a6356bc39a316db67da3adf9e840eac9459d1dd1ebe88383aa23c3055</td>-->
                <td>—</td>
                <!--<td>Dim wb, excel, range As Object Try  wb = GetWorkbook(Handle, Workbook) excel = wb.Application  range = excel.Selection range.PasteSpecial(Paste     =Paste_Option, Operation     =-4142, SkipBlanks     =False, Transpose     =False)  Success = True Catch e As Exception     Success = False     Message =...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Dim wb, excel, range As Object
Try  wb = GetWorkbook(Handle, Workbook) excel = wb.Application  range = excel.Selection range.PasteSpecial(Paste
    =Paste_Option, Operation
    =-4142, SkipBlanks
    =False, Transpose
    =False)  Success = True
Catch e As Exception     Success = False     Message = e.Message
Finally     wb = Nothing    range = Nothing
    End
    Try"
                            data-title="MS Excel VBO / Paste / Paste Values1">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>MS Excel VBO</td>
                <td>Protect Workbook</td>
                <td>Protect Workbook</td>
                <td>visualbasic</td>
                <td>6</td>
                <!--<td style="font-family: monospace;">abe4a7827768b41110ed8ee70dd8e329edec696fdbd5dbcbb6c0233e6d7faf96</td>-->
                <td>—</td>
                <!--<td>Dim wb As Object Try  wb = GetWorkbook(Handle, Workbook) wb.Protect(Password, True, True)  Success = True Catch e As Exception     Success = False     Message = e.Message Finally     wb = Nothing     End     Try</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Dim wb As Object
Try  wb = GetWorkbook(Handle, Workbook) wb.Protect(Password, True, True)  Success = True
Catch e As Exception     Success = False     Message = e.Message
Finally     wb = Nothing
    End
    Try"
                            data-title="MS Excel VBO / Protect Workbook / Protect Workbook">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>MS Excel VBO</td>
                <td>Refresh All PivotTable</td>
                <td>RefreshWorksheet</td>
                <td>visualbasic</td>
                <td>8</td>
                <!--<td style="font-family: monospace;">95bd00f2e50ae1ffdfefacdf3a97c07c7bc048a85021c19692c9971371b50c32</td>-->
                <td>—</td>
                <!--<td>Dim ws as Object = GetWorksheet(handle,workbookname,worksheetname,createifmissing) &#x27;sheetexists = ws IsNot Nothing  &#x27; If sheetexists Then     ws.Activate() &#x27;ws.Refresh &#x27; End If Dim ws as Worksheet Dim pt &#x27;as PivotTable For Each pt in ws.PivotTables     pt.RefreshTable Next pt</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Dim ws as Object = GetWorksheet(handle,workbookname,worksheetname,createifmissing) &#x27;sheetexists = ws IsNot Nothing  &#x27;
If sheetexists Then
    ws.Activate() &#x27;ws.Refresh &#x27;
End If
Dim ws as Worksheet
Dim pt &#x27;as PivotTable
For Each pt in ws.PivotTables     pt.RefreshTable
Next pt"
                            data-title="MS Excel VBO / Refresh All PivotTable / RefreshWorksheet">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>MS Excel VBO</td>
                <td>Release Instance</td>
                <td>Release Instance</td>
                <td>visualbasic</td>
                <td>7</td>
                <!--<td style="font-family: monospace;">f80253ae998ee19ad8fa62ea63bb40a04046ec18fb327a54411e0883d88b2676</td>-->
                <td>—</td>
                <!--<td>Dim current as Object = CurrentInstance Dim inst as Object = GetInstance(handle) &#x27; Careful - sets the &#x27;current instance&#x27; to inst      HandleMap.Remove(handle)     InstanceMap.Remove(inst) If Object.ReferenceEquals(inst, current) Then     CurrentInstance = Nothing End If Else         CurrentInstance ...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Dim current as Object = CurrentInstance
Dim inst as Object = GetInstance(handle) &#x27; Careful - sets the &#x27;current instance&#x27; to inst      HandleMap.Remove(handle)     InstanceMap.Remove(inst)
If Object.ReferenceEquals(inst, current) Then
    CurrentInstance = Nothing
End If
Else         CurrentInstance = current
End If"
                            data-title="MS Excel VBO / Release Instance / Release Instance">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>MS Excel VBO</td>
                <td>Remove Blank Rows</td>
                <td>Delete blank rows</td>
                <td>visualbasic</td>
                <td>11</td>
                <!--<td style="font-family: monospace;">828f6ffc5485f96f99e47c3142b3be76fa6d0f86cfcaf89b7dda5db460e52976</td>-->
                <td>sql_keywords</td>
                <!--<td>Dim worksheet As Object worksheet = GetWorkbook(handle,Nothing).ActiveSheet Const xlCellTypeLastCell As Integer = 11 Dim FirstRow As Integer = 1 Dim LastRow As Integer = worksheet.Cells.SpecialCells(xlCellTypeLastCell).Row For i As Integer = LastRow To FirstRow Step -1     If worksheet.Application.C...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Dim worksheet As Object worksheet = GetWorkbook(handle,Nothing).ActiveSheet
Const xlCellTypeLastCell As Integer = 11
Dim FirstRow As Integer = 1
Dim LastRow As Integer = worksheet.Cells.SpecialCells(xlCellTypeLastCell).Row
For i As Integer = LastRow To FirstRow Step -1
    If worksheet.Application.CountA(worksheet.Rows(i)) = 0 Then
        worksheet.Rows(i).Delete
    End If
    End
    If
Next"
                            data-title="MS Excel VBO / Remove Blank Rows / Delete blank rows">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>MS Excel VBO</td>
                <td>Remove Duplicates</td>
                <td>Remove Duplicates1</td>
                <td>visualbasic</td>
                <td>7</td>
                <!--<td style="font-family: monospace;">cb55781ab04ba7b0fcbc257bc11c53cd5f337299284448e18dbb3afa080c2154</td>-->
                <td>—</td>
                <!--<td>Dim wb, ws, dup As object Try  wb = GetWorkbook(Handle, Workbook) ws = GetWorksheet(Handle, Workbook, Worksheet)  dup = ws.Application.range(Input_Range).RemoveDuplicates(Columns     =1)  Success = True Catch e As Exception     Success = False     Message = e.Message Finally     wb = Nothing     ws ...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Dim wb, ws, dup As object
Try  wb = GetWorkbook(Handle, Workbook) ws = GetWorksheet(Handle, Workbook, Worksheet)  dup = ws.Application.range(Input_Range).RemoveDuplicates(Columns
    =1)  Success = True
Catch e As Exception     Success = False     Message = e.Message
Finally     wb = Nothing     ws = Nothing     dup = Nothing
    End
    Try"
                            data-title="MS Excel VBO / Remove Duplicates / Remove Duplicates1">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>MS Excel VBO</td>
                <td>Remove Excel Filter</td>
                <td>Remove Excel Filter</td>
                <td>visualbasic</td>
                <td>7</td>
                <!--<td style="font-family: monospace;">66b846d5ecf30d3870f65e0604edbba0f41d962673091ce5595972ef5eb43b26</td>-->
                <td>—</td>
                <!--<td>Dim wb, ws As Object Dim excel, sheet, range As Object Try wb = GetWorkbook(Handle, Workbook) ws = GetWorksheet(Handle, Workbook, Worksheet) wb.Activate() ws.Activate() excel = ws.Application sheet = excel.ActiveSheet sheet.UsedRange.AutoFilter  Success = True Catch e As Exception     Success = Fals...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Dim wb, ws As Object
Dim excel, sheet, range As Object
Try wb = GetWorkbook(Handle, Workbook) ws = GetWorksheet(Handle, Workbook, Worksheet) wb.Activate() ws.Activate() excel = ws.Application sheet = excel.ActiveSheet sheet.UsedRange.AutoFilter  Success = True
Catch e As Exception     Success = False     Message = e.Message
Finally     wb = Nothing     excel = Nothing     range = Nothing
    End
    Try"
                            data-title="MS Excel VBO / Remove Excel Filter / Remove Excel Filter">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>MS Excel VBO</td>
                <td>Run Macro</td>
                <td>Run Macro</td>
                <td>visualbasic</td>
                <td>1</td>
                <!--<td style="font-family: monospace;">fd15144606fcf8c0874f7059248e5a3c84e47564992dafa37c27b9c4185f1e65</td>-->
                <td>—</td>
                <!--<td>GetInstance(Handle).Run(Macro_Name)</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="GetInstance(Handle).Run(Macro_Name)"
                            data-title="MS Excel VBO / Run Macro / Run Macro">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>MS Excel VBO</td>
                <td>Run Macro - Perm</td>
                <td>Run Macro-Perm</td>
                <td>visualbasic</td>
                <td>1</td>
                <!--<td style="font-family: monospace;">ce857d43ef8fd5e6a9fd1903b0fd0312ecfbf4a5a083ebf394b9aa84671b7e20</td>-->
                <td>—</td>
                <!--<td>GetInstance(Handle).Run(Macro_Name,Perm1)</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="GetInstance(Handle).Run(Macro_Name,Perm1)"
                            data-title="MS Excel VBO / Run Macro - Perm / Run Macro-Perm">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>MS Excel VBO</td>
                <td>Save Workbook</td>
                <td>SaveWorkbook</td>
                <td>visualbasic</td>
                <td>2</td>
                <!--<td style="font-family: monospace;">fe8a3dd9afb26f15a21a5428c05f7919379d4e6dad5a45048852a1192f9a2853</td>-->
                <td>—</td>
                <!--<td>Dim wb as Object = GetWorkbook(handle,workbookname) Dim excel as Object = wb.Application excel.DisplayAlerts = False wb.Save() excel.DisplayAlerts = True</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Dim wb as Object = GetWorkbook(handle,workbookname)
Dim excel as Object = wb.Application excel.DisplayAlerts = False wb.Save() excel.DisplayAlerts = True"
                            data-title="MS Excel VBO / Save Workbook / SaveWorkbook">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>MS Excel VBO</td>
                <td>Save Workbook As</td>
                <td>SaveWorkbookAs</td>
                <td>visualbasic</td>
                <td>2</td>
                <!--<td style="font-family: monospace;">fe904e5fa1816936c03c22445c07bc93fb97ca6c17d1f50d2393293967a92fa4</td>-->
                <td>—</td>
                <!--<td>Dim wb as Object = GetWorkbook(handle,workbookname) Dim excel as Object = wb.Application  excel.DisplayAlerts = False wb.SaveAs(filename) excel.DisplayAlerts = True  newworkbookname = wb.Name</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Dim wb as Object = GetWorkbook(handle,workbookname)
Dim excel as Object = wb.Application  excel.DisplayAlerts = False wb.SaveAs(filename) excel.DisplayAlerts = True  newworkbookname = wb.Name"
                            data-title="MS Excel VBO / Save Workbook As / SaveWorkbookAs">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>MS Excel VBO</td>
                <td>Select</td>
                <td>Select Cells</td>
                <td>visualbasic</td>
                <td>7</td>
                <!--<td style="font-family: monospace;">a5c56ef719fde78abd8885241b2461e5c6ac4301ed9bd2e47a8acf143e83b708</td>-->
                <td>—</td>
                <!--<td>Dim wb, ws As Object Dim excel, sheet, range As Object Try  wb = GetWorkbook(Handle, Workbook) ws = GetWorksheet(Handle, Workbook, Worksheet)  wb.Activate() ws.Activate() excel = ws.Application sheet = excel.ActiveSheet range = sheet.Range(Reference) range.Select()  Success = True Catch e As Excepti...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Dim wb, ws As Object
Dim excel, sheet, range As Object
Try  wb = GetWorkbook(Handle, Workbook) ws = GetWorksheet(Handle, Workbook, Worksheet)  wb.Activate() ws.Activate() excel = ws.Application sheet = excel.ActiveSheet range = sheet.Range(Reference) range.Select()  Success = True
Catch e As Exception     Success = False     Message = e.Message
Finally     wb = Nothing     ws = Nothing     excel = Nothing     sheet = Nothing     range = Nothing
    End
    Try"
                            data-title="MS Excel VBO / Select / Select Cells">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>MS Excel VBO</td>
                <td>Set Cell Value</td>
                <td>Set Cell Value</td>
                <td>visualbasic</td>
                <td>1</td>
                <!--<td style="font-family: monospace;">2ceb423173bb184e054bc4c8751b8d83fe0188a686973b792f1563c975982d20</td>-->
                <td>—</td>
                <!--<td>GetInstance(handle).ActiveCell.Value = value</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="GetInstance(handle).ActiveCell.Value = value"
                            data-title="MS Excel VBO / Set Cell Value / Set Cell Value">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>MS Excel VBO</td>
                <td>Set Events Enabled</td>
                <td>Enable Events</td>
                <td>visualbasic</td>
                <td>1</td>
                <!--<td style="font-family: monospace;">09e942e12e26b9dcfa0bad9d98b760813dd8969cf09b371f13e3d7aedb82bbcf</td>-->
                <td>—</td>
                <!--<td>GetInstance(handle).EnableEvents = enable</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="GetInstance(handle).EnableEvents = enable"
                            data-title="MS Excel VBO / Set Events Enabled / Enable Events">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>MS Excel VBO</td>
                <td>Set Window Location</td>
                <td>SetWindowLocation</td>
                <td>visualbasic</td>
                <td>1</td>
                <!--<td style="font-family: monospace;">232dac9fbbc94470989cddbf96a6cdf5c7cb4c16991c224467e7f0f4893e3d72</td>-->
                <td>—</td>
                <!--<td>Dim excel as Object = GetInstance(handle)  excel.WindowState = -4143 &#x27;Excel.XlWindowState.xlNormal excel.Left = x excel.Top = y</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Dim excel as Object = GetInstance(handle)  excel.WindowState = -4143 &#x27;Excel.XlWindowState.xlNormal excel.Left = x excel.Top = y"
                            data-title="MS Excel VBO / Set Window Location / SetWindowLocation">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>MS Excel VBO</td>
                <td>Set Window Size</td>
                <td>SetWindowSize</td>
                <td>visualbasic</td>
                <td>1</td>
                <!--<td style="font-family: monospace;">0fb23c7db166d32304b4f342782d9a9c88edb4319578e6a412c1ade264b8f1f9</td>-->
                <td>—</td>
                <!--<td>Dim excel as Object = GetInstance(handle)  excel.WindowState = -4143 &#x27;Excel.XlWindowState.xlNormal excel.Width = width excel.Height = height</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Dim excel as Object = GetInstance(handle)  excel.WindowState = -4143 &#x27;Excel.XlWindowState.xlNormal excel.Width = width excel.Height = height"
                            data-title="MS Excel VBO / Set Window Size / SetWindowSize">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>MS Excel VBO</td>
                <td>Set Window State</td>
                <td>SetWindowState</td>
                <td>visualbasic</td>
                <td>13</td>
                <!--<td style="font-family: monospace;">13d79de57a41d548798e5e5bdf2a00ada450d73b5496dece811474e2f5a6cf99</td>-->
                <td>—</td>
                <!--<td>Dim excel as Object = GetInstance(handle) If state.ToLower().StartsWith(&quot;min&quot;) Then     excel.WindowState = -4140 End If Else     If state.ToLower().StartsWith(&quot;max&quot;) Then         excel.WindowState = -4137     End If Else     If state.ToLower() = &quot;normal&quot; Then         excel.WindowState = -4143     E...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Dim excel as Object = GetInstance(handle)
If state.ToLower().StartsWith(&quot;min&quot;) Then
    excel.WindowState = -4140
End If
Else
    If state.ToLower().StartsWith(&quot;max&quot;) Then
        excel.WindowState = -4137
    End If
Else
    If state.ToLower() = &quot;normal&quot; Then
        excel.WindowState = -4143
    End If
End If"
                            data-title="MS Excel VBO / Set Window State / SetWindowState">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>MS Excel VBO</td>
                <td>Show</td>
                <td>ShowInstance</td>
                <td>visualbasic</td>
                <td>1</td>
                <!--<td style="font-family: monospace;">f2b49f98924991307eb456b2128793b905ab53058288d98fa582e3609dbabf8f</td>-->
                <td>—</td>
                <!--<td>GetInstance(handle).Visible = True</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="GetInstance(handle).Visible = True"
                            data-title="MS Excel VBO / Show / ShowInstance">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>MS Excel VBO</td>
                <td>Sort</td>
                <td>Auto Fill1</td>
                <td>visualbasic</td>
                <td>7</td>
                <!--<td style="font-family: monospace;">d1293c8f679dedbbc27f96e3ae45636809e6c363b3ba2b72f0d21c8d74c06d20</td>-->
                <td>—</td>
                <!--<td>Dim wb, ws As Object Dim excel, sheet, range As Object Try wb = GetWorkbook(Handle, Workbook) ws = GetWorksheet(Handle, Workbook, Worksheet) wb.Activate() ws.Activate() excel = ws.Application sheet = excel.ActiveSheet &#x27;range = sheet.Range(Select_Range) &#x27;range.Select() sheet.Sort.SortFields.Clear &#x27;Ge...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Dim wb, ws As Object
Dim excel, sheet, range As Object
Try wb = GetWorkbook(Handle, Workbook) ws = GetWorksheet(Handle, Workbook, Worksheet) wb.Activate() ws.Activate() excel = ws.Application sheet = excel.ActiveSheet &#x27;range = sheet.Range(Select_Range) &#x27;range.Select() sheet.Sort.SortFields.Clear &#x27;GetInstance(Handle).ActiveCell.Value = &quot;=SUM(A1,B1)&quot; &#x27;call sheet.Sort.SortFields.Add(sheet.Columns(1),,Microsoft.Office.Interop.Excel.XlSortOrder.xlAscending) call sheet.Sort.SetRange(sheet.Range(&quot;A2:A7&quot;)) sheet.Sort.Apply  Success = True
Catch e As Exception     Success = False     Message = e.Message
Finally     wb = Nothing     excel = Nothing     range = Nothing
    End
    Try"
                            data-title="MS Excel VBO / Sort / Auto Fill1">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>MS Excel VBO</td>
                <td>Split Worksheet</td>
                <td>Split Worksheet</td>
                <td>visualbasic</td>
                <td>49</td>
                <!--<td style="font-family: monospace;">424f9c125ce6626dd9be8d58fd7bb81f87847f46ef0c9b3331216eb7f4aaae28</td>-->
                <td>file_io</td>
                <!--<td>Dim sheet as Object = GetWorksheet(handle,workbookname,worksheetname,False)  sheetexists = sheet IsNot Nothing If Not sheetexists Then     Return     Dim book as Object = sheet.Parent     Dim excel as Object = sheet.Application     Dim prefix as String = book.Name     If prefix.ToLower().EndsWith(&quot;....</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Dim sheet as Object = GetWorksheet(handle,workbookname,worksheetname,False)  sheetexists = sheet IsNot Nothing
If Not sheetexists Then
    Return
    Dim book as Object = sheet.Parent
    Dim excel as Object = sheet.Application
    Dim prefix as String = book.Name
    If prefix.ToLower().EndsWith(&quot;.xls&quot;) Then
        prefix = prefix.Substring(0,prefix.Length - 4)
    End If
    End
    If
    If Not path.EndsWith(&quot;\&quot;) Then
        path += &quot;\&quot;
    End If
    End
    If  filefound = Directory.Exists(path)
        If Not filefound Then
            &#x27; Might as well quit now
        End If
        Return
        End
        If
        Dim lastCell as Object = sheet.Cells.Find(&quot;*&quot;, , , , , 2)             &#x27;Excel.XlSearchDirection.xlPrevious=2 &#x27;
    loop through the worksheet in blocks of Numblines lines  &#x27; Force overwrites
    if the excel book already exists. excel.DisplayAlerts = False &#x27; Hide alerts
        Dim
    loopCount as Integer = 0
    For row as Integer = 1 To lastCell.Row-1 Step rowspersheet &#x27; -1 to cope with total-rows = rowspersheet
    loopCount =
loopCount + 1
Dim newbook as Object = excel.Workbooks.Add
If notitle Then
    &#x27;copy each block into the new worksheet         sheet.Range(sheet.Cells(row, 1), sheet.Cells(
End If
loopCount * rowspersheet, sheet.Columns.Count)).EntireRow.Copy(newbook.Sheets(1).Range(&quot;A1&quot;))
Else         &#x27;in here - so there must be a title row that needs copying to all the new worksheets
    If row = 1 Then
        &#x27;copy row 1-201 into new worksheet (including title row at #1)             sheet.Range(sheet.Cells(row, 1),sheet.Cells(row + rowspersheet,sheet.Columns.Count)).EntireRow.Copy(newbook.Sheets(1).Range(&quot;A1&quot;))
    End If
Else             &#x27;copy title row into new worksheet             sheet.Range(sheet.Cells(1, 1),sheet.Cells(1,sheet.Columns.Count)).EntireRow.Copy(newbook.Sheets(1).Range(&quot;A1&quot;))             &#x27;
next copy row i
loop+1 to i
loop+NumbLines into new worksheet (i.e. 202-401)             sheet.Range(sheet.Cells(row + 1, 1),sheet.Cells(row + rowspersheet,sheet.Columns.Count)).EntireRow.Copy(newbook.Sheets(1).Range(&quot;A2&quot;))
End
If
End
If     &#x27;close and save the new workbook     newbook.Close(True, path &amp; prefix &amp; &quot;_SECTION_&quot; &amp; (
loopCount+1000).ToString().Substring(1) &amp; &quot;.xls&quot;)
Next"
                            data-title="MS Excel VBO / Split Worksheet / Split Worksheet">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>MS Excel VBO</td>
                <td>Write Collection</td>
                <td>WriteColl</td>
                <td>visualbasic</td>
                <td>27</td>
                <!--<td style="font-family: monospace;">80fd7941a98b55bb41a482e932f4a8a875debdaa85e0eb0f3efdcccd756c051d</td>-->
                <td>—</td>
                <!--<td>&#x27; Get to the cell Dim ws as Object = GetWorksheet(handle,workbookname,worksheetname) Dim origin as Object = ws.Range(cellref,cellref) Dim cell as Object = origin Dim colInd as Integer = 0, rowInd as Integer = 0 &#x27; Offsets from the origin cell          &#x27; Deal with the column names first If includecoln...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="&#x27; Get to the cell
Dim ws as Object = GetWorksheet(handle,workbookname,worksheetname)
Dim origin as Object = ws.Range(cellref,cellref)
Dim cell as Object = origin
Dim colInd as Integer = 0, rowInd as Integer = 0 &#x27; Offsets from the origin cell          &#x27; Deal with the column names first
If includecolnames Then
    For Each col as DataColumn in collection.Columns
        Try                 cell = origin.Offset(rowInd, colInd)
        Catch ex as Exception &#x27; Hit the edge.
            Exit
            For
            End
            Try             cell.Value = col.ColumnName             colInd += 1
            Next         rowInd += 1
            End
            If          &#x27; Now
                for the data itself
                    For Each row as DataRow in collection.Rows         colInd = 0
                        For Each col as DataColumn in collection.Columns
                            Try                 cell = origin.Offset(rowInd, colInd)
                            Catch ex as Exception &#x27; Hit the edge.
                                Exit
                                For
                                End
                                Try             &#x27;MessageBox.Show(&quot;RowOffset:&quot; &amp; rowInd &amp; &quot;; ColOffset:&quot; &amp; colInd &amp; &quot;; cell: &quot; &amp; cell.Address(False,False))             cell.Value = row(col)             colInd += 1
                                Next         rowInd+=1
                            Next"
                            data-title="MS Excel VBO / Write Collection / WriteColl">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>MS Excel VBO</td>
                <td>Write To Clipboard</td>
                <td>Write To Clipboard</td>
                <td>visualbasic</td>
                <td>1</td>
                <!--<td style="font-family: monospace;">993fdab0f1b0701259ccddbecef2059dc5f6486a006275aca84d1ca46c64580c</td>-->
                <td>—</td>
                <!--<td>My.Computer.Clipboard.Clear() My.Computer.Clipboard.SetText(Value)</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="My.Computer.Clipboard.Clear() My.Computer.Clipboard.SetText(Value)"
                            data-title="MS Excel VBO / Write To Clipboard / Write To Clipboard">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>Mail-EWS</td>
                <td>Check</td>
                <td>Code2</td>
                <td>csharp</td>
                <td>32</td>
                <!--<td style="font-family: monospace;">47414d592a3b30a77f889ebbc2c928428ff5d05a21a7e56542ef0290c8d052b6</td>-->
                <td>—</td>
                <!--<td>string fid; ToFolderFlag=Convert.ToBoolean(0); fid=&quot;NA&quot;; ExchangeService service = new ExchangeService(ExchangeVersion.Exchange2010_SP1); try {     if(UserName==&quot;&quot;) service.AutodiscoverUrl( MailID );     else {         service.Credentials = new WebCredentials(UserName, Password );         service.Au...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="string fid;
ToFolderFlag=Convert.ToBoolean(0);
fid=&quot;NA&quot;;
ExchangeService service = new ExchangeService(ExchangeVersion.Exchange2010_SP1);
try {
    if(UserName==&quot;&quot;) service.AutodiscoverUrl( MailID );
    else {
        service.Credentials = new WebCredentials(UserName, Password );
        service.AutodiscoverUrl( MailID,RedirectionUrlValidationCallback );
    }

}
catch {
    service.Url = new Uri(SUrl);
}
PropertySet itempropertyset = new PropertySet(BasePropertySet.FirstClassProperties);
itempropertyset.RequestedBodyType = BodyType.Text;
ItemView itemview = new ItemView(1000);
itemview.PropertySet = itempropertyset;
SearchFilter sf = new SearchFilter.SearchFilterCollection(LogicalOperator.And, new SearchFilter.IsEqualTo(EmailMessageSchema.IsRead, false));
FindItemsResults&lt;Item&gt; findResults = service.FindItems(WellKnownFolderName.Inbox, sf, new ItemView(1000));
Folder rootfolder = Folder.Bind(service, WellKnownFolderName.MsgFolderRoot);
rootfolder.Load();
foreach (Folder folder in rootfolder.FindFolders(new FolderView(100))) {
    if(folder.DisplayName==MoveToFolder) {
        fid=folder.Id.ToString();
    }

}
if(fid!=&quot;NA&quot;) {
    ToFolderFlag=Convert.ToBoolean(1);
}"
                            data-title="Mail-EWS / Check / Code2">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>Mail-EWS</td>
                <td>Connect Default User</td>
                <td>Code11</td>
                <td>csharp</td>
                <td>23</td>
                <!--<td style="font-family: monospace;">3f7c5b2614bfd910a52a2a923d31b4b9883561197271ba13b857ec1f7875e9d8</td>-->
                <td>http, urls(1)</td>
                <!--<td>ExchangeService service = new ExchangeService(ExchangeVersion.Exchange2010_SP1); //service.AutodiscoverUrl( MailID ); //service.Url = new Uri(&quot;https://mail-xi.ey.net/ews/exchange.asmx&quot;); try {     service.AutodiscoverUrl( MailID ); } catch {     service.Url = new Uri(ServerUrl); } try {     Property...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="ExchangeService service = new ExchangeService(ExchangeVersion.Exchange2010_SP1);
//service.AutodiscoverUrl( MailID );
//service.Url = new Uri(&quot;https://mail-xi.ey.net/ews/exchange.asmx&quot;);
try {
    service.AutodiscoverUrl( MailID );
}
catch {
    service.Url = new Uri(ServerUrl);
}
try {
    PropertySet itempropertyset = new PropertySet(BasePropertySet.FirstClassProperties);
    itempropertyset.RequestedBodyType = BodyType.Text;
    ItemView itemview = new ItemView(1000);
    itemview.PropertySet = itempropertyset;
    /*SearchFilter sf = new SearchFilter.SearchFilterCollection(LogicalOperator.And, new SearchFilter.IsEqualTo(EmailMessageSchema.IsRead, false));
    FindItemsResults&lt;Item&gt; findResults = service.FindItems(WellKnownFolderName.Inbox, sf, new ItemView(1000));
    */ Success= true;
    Message = &quot;Success&quot;;
}
catch(Exception e) {
    Message = e.ToString();
    Success= false;
}"
                            data-title="Mail-EWS / Connect Default User / Code11">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>Mail-EWS</td>
                <td>Connect Different User</td>
                <td>Code6</td>
                <td>csharp</td>
                <td>16</td>
                <!--<td style="font-family: monospace;">017e659a5d4a70421f965303ef5d8acff49d30403ae0fada6c286ae765896c48</td>-->
                <td>http, urls(1)</td>
                <!--<td>ExchangeService service = new ExchangeService(ExchangeVersion.Exchange2010_SP1); try {     service.Credentials = new WebCredentials(UserName, Password );     service.AutodiscoverUrl( MailID,RedirectionUrlValidationCallback ); } catch {     service.Url = new Uri(SUrl); } //service.Url = new Uri(&quot;http...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="ExchangeService service = new ExchangeService(ExchangeVersion.Exchange2010_SP1);
try {
    service.Credentials = new WebCredentials(UserName, Password );
    service.AutodiscoverUrl( MailID,RedirectionUrlValidationCallback );
}
catch {
    service.Url = new Uri(SUrl);
}
//service.Url = new Uri(&quot;https://mail-xi.ey.net/ews/exchange.asmx&quot;);
PropertySet itempropertyset = new PropertySet(BasePropertySet.FirstClassProperties);
itempropertyset.RequestedBodyType = BodyType.Text;
ItemView itemview = new ItemView(1000);
itemview.PropertySet = itempropertyset;
/* SearchFilter sf = new SearchFilter.SearchFilterCollection(LogicalOperator.And, new SearchFilter.IsEqualTo(EmailMessageSchema.IsRead, false));
FindItemsResults&lt;Item&gt; findResults = service.FindItems(WellKnownFolderName.Inbox,sf, new ItemView(1000));
*/"
                            data-title="Mail-EWS / Connect Different User / Code6">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>Mail-EWS</td>
                <td>Create Folder</td>
                <td>Code16</td>
                <td>csharp</td>
                <td>26</td>
                <!--<td style="font-family: monospace;">254451b3d53b804b2611beb26e68c2bd6d22f707a8c180d3cc5d22940a55758c</td>-->
                <td>—</td>
                <!--<td>string fid; fid=&quot;NA&quot;; ExchangeService service = new ExchangeService(ExchangeVersion.Exchange2010_SP1); try {     if(UserName==&quot;&quot;) service.AutodiscoverUrl( MailID );     else {         service.Credentials = new WebCredentials(UserName, Password );         service.AutodiscoverUrl( MailID,RedirectionUr...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="string fid;
fid=&quot;NA&quot;;
ExchangeService service = new ExchangeService(ExchangeVersion.Exchange2010_SP1);
try {
    if(UserName==&quot;&quot;) service.AutodiscoverUrl( MailID );
    else {
        service.Credentials = new WebCredentials(UserName, Password );
        service.AutodiscoverUrl( MailID,RedirectionUrlValidationCallback );
    }

}
catch {
    service.Url = new Uri(SUrl);
}
PropertySet itempropertyset = new PropertySet(BasePropertySet.FirstClassProperties);
itempropertyset.RequestedBodyType = BodyType.Text;
ItemView itemview = new ItemView(1000);
itemview.PropertySet = itempropertyset;
//SearchFilter sf = new SearchFilter.SearchFilterCollection(LogicalOperator.And, new SearchFilter.IsEqualTo(EmailMessageSchema.IsRead, false));
//FindItemsResults&lt;Item&gt; findResults = service.FindItems(WellKnownFolderName.Inbox, sf, new ItemView(1000));
Folder rootfolder = Folder.Bind(service, WellKnownFolderName.MsgFolderRoot);
rootfolder.Load();
Folder folder = new Folder(service);
folder.DisplayName = FolderName;
//folder.FolderClass = &quot;IPF.MyCustomFolderClass&quot;;
folder.Save(WellKnownFolderName.Inbox);"
                            data-title="Mail-EWS / Create Folder / Code16">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>Mail-EWS</td>
                <td>Get Folder Names</td>
                <td>Code13</td>
                <td>csharp</td>
                <td>39</td>
                <!--<td style="font-family: monospace;">e5f5e64e79a87a279ad12c485c2b430e7e88498cb4ba568ebefcc9b7fcca1f0d</td>-->
                <td>reflection</td>
                <!--<td>DataTable table = new DataTable(); DataColumn column; DataRow row; DataView view; column = new DataColumn(); column.DataType = Type.GetType(&quot;System.String&quot;); column.ColumnName = &quot;Folder&quot;; table.Columns.Add(column); column = new DataColumn(); column.DataType = Type.GetType(&quot;System.String&quot;); column.Co...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="DataTable table = new DataTable();
DataColumn column;
DataRow row;
DataView view;
column = new DataColumn();
column.DataType = Type.GetType(&quot;System.String&quot;);
column.ColumnName = &quot;Folder&quot;;
table.Columns.Add(column);
column = new DataColumn();
column.DataType = Type.GetType(&quot;System.String&quot;);
column.ColumnName = &quot;ID&quot;;
table.Columns.Add(column);
Call3=table;
ExchangeService service = new ExchangeService(ExchangeVersion.Exchange2010_SP1);
try {
    if(UserName==&quot;&quot;) service.AutodiscoverUrl( MailID );
    else {
        service.Credentials = new WebCredentials(UserName, Password );
        service.AutodiscoverUrl( MailID,RedirectionUrlValidationCallback );
    }

}
catch {
    service.Url = new Uri(SUrl);
}
PropertySet itempropertyset = new PropertySet(BasePropertySet.FirstClassProperties);
itempropertyset.RequestedBodyType = BodyType.Text;
ItemView itemview = new ItemView(1000);
itemview.PropertySet = itempropertyset;
// Get all the folders in the message&#x27;s root folder. Folder rootfolder = Folder.Bind(service, WellKnownFolderName.MsgFolderRoot);
Console.WriteLine(&quot;The &quot; + rootfolder.DisplayName + &quot; has &quot; + rootfolder.ChildFolderCount + &quot; child folders.&quot;);
// A GetFolder operation has been performed. // Now do something with the folder, such as display each child folder&#x27;s name and ID. rootfolder.Load();
foreach (Folder folder in rootfolder.FindFolders(new FolderView(100))) {
    row = table.NewRow();
    row[&quot;Folder&quot;] =folder.DisplayName;
    row[&quot;ID&quot;] =folder.Id;
    table.Rows.Add(row);
}
Call3=table;"
                            data-title="Mail-EWS / Get Folder Names / Code13">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>Mail-EWS</td>
                <td>Read and mark read</td>
                <td>Code5</td>
                <td>csharp</td>
                <td>60</td>
                <!--<td style="font-family: monospace;">381ca9e6531eb9db084297623eddcfb0016b39a18a1e03c8a19f976cc79755df</td>-->
                <td>http, reflection, urls(1)</td>
                <!--<td>// http://stackoverflow.com/questions/36069801/ews-read-mail-plain-text-body-getting-serviceobjectpropertyexception string sub; string body_h; string from_m; asub=&quot;&quot;; aTo=&quot;&quot;; DataTable table = new DataTable(); DataColumn column; DataRow row; DataView view; column = new DataColumn(); column.DataType ...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="// http://stackoverflow.com/questions/36069801/ews-read-mail-plain-text-body-getting-serviceobjectpropertyexception string sub;
string body_h;
string from_m;
asub=&quot;&quot;;
aTo=&quot;&quot;;
DataTable table = new DataTable();
DataColumn column;
DataRow row;
DataView view;
column = new DataColumn();
column.DataType = Type.GetType(&quot;System.String&quot;);
column.ColumnName = &quot;Subject&quot;;
table.Columns.Add(column);
column = new DataColumn();
column.DataType = Type.GetType(&quot;System.String&quot;);
column.ColumnName = &quot;Sender&quot;;
table.Columns.Add(column);
column = new DataColumn();
column.DataType = Type.GetType(&quot;System.String&quot;);
column.ColumnName = &quot;Body&quot;;
table.Columns.Add(column);
Call3=table;
ExchangeService service = new ExchangeService(ExchangeVersion.Exchange2010_SP1);
try {
    if(UserName==&quot;&quot;) service.AutodiscoverUrl( MailID );
    else {
        service.Credentials = new WebCredentials(UserName, Password );
        service.AutodiscoverUrl( MailID,RedirectionUrlValidationCallback );
    }

}
catch {
    service.Url = new Uri(SUrl);
}
PropertySet itempropertyset = new PropertySet(BasePropertySet.FirstClassProperties);
itempropertyset.RequestedBodyType = BodyType.Text;
ItemView itemview = new ItemView(1000);
itemview.PropertySet = itempropertyset;
SearchFilter sf = new SearchFilter.SearchFilterCollection(LogicalOperator.And, new SearchFilter.IsEqualTo(EmailMessageSchema.IsRead, false));
FindItemsResults&lt;Item&gt; findResults = service.FindItems(WellKnownFolderName.Inbox, sf, new ItemView(1000));
foreach ( Item item in findResults.Items ) {
    EmailMessage mes = (EmailMessage)item;
    from_m=mes.Sender.Name;
    item.Load(itempropertyset);
    body_h=item.Body;
    sub=item.Subject;
    asub=sub;
    mes.IsRead = true;
    mes.Update(ConflictResolutionMode.AlwaysOverwrite);
    {
        body_h=item.Body;
        row = table.NewRow();
        row[&quot;Subject&quot;] =sub;
        row[&quot;Sender&quot;] =from_m;
        row[&quot;Body&quot;] =body_h;
        table.Rows.Add(row);
    }

}
Call3=table;"
                            data-title="Mail-EWS / Read and mark read / Code5">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>Mail-EWS</td>
                <td>Read message from specific mail ID</td>
                <td>Code9</td>
                <td>csharp</td>
                <td>57</td>
                <!--<td style="font-family: monospace;">e63cfa9b2d5946525ce3a79bec32d92d12a080407e95d1145284b5d6fa88969e</td>-->
                <td>http, reflection, urls(1)</td>
                <!--<td>// http://stackoverflow.com/questions/36069801/ews-read-mail-plain-text-body-getting-serviceobjectpropertyexception string sub; string body_h; string from_m; // asub=&quot;&quot;; // aTo=&quot;&quot;; from_m=&quot;&quot;; DataTable table = new DataTable(); DataColumn column; DataRow row; DataView view; column = new DataColumn();...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="// http://stackoverflow.com/questions/36069801/ews-read-mail-plain-text-body-getting-serviceobjectpropertyexception string sub;
string body_h;
string from_m;
// asub=&quot;&quot;;
// aTo=&quot;&quot;;
from_m=&quot;&quot;;
DataTable table = new DataTable();
DataColumn column;
DataRow row;
DataView view;
column = new DataColumn();
column.DataType = Type.GetType(&quot;System.String&quot;);
column.ColumnName = &quot;Subject&quot;;
table.Columns.Add(column);
column = new DataColumn();
column.DataType = Type.GetType(&quot;System.String&quot;);
column.ColumnName = &quot;Sender&quot;;
table.Columns.Add(column);
column = new DataColumn();
column.DataType = Type.GetType(&quot;System.String&quot;);
column.ColumnName = &quot;Body&quot;;
table.Columns.Add(column);
Call3=table;
ExchangeService service = new ExchangeService(ExchangeVersion.Exchange2010_SP1);
try {
    if(UserName==&quot;&quot;) service.AutodiscoverUrl( MailID );
    else {
        service.Credentials = new WebCredentials(UserName, Password );
        service.AutodiscoverUrl( MailID,RedirectionUrlValidationCallback );
    }

}
catch {
    service.Url = new Uri(SUrl);
}
PropertySet itempropertyset = new PropertySet(BasePropertySet.FirstClassProperties);
itempropertyset.RequestedBodyType = BodyType.Text;
ItemView itemview = new ItemView(1000);
itemview.PropertySet = itempropertyset;
SearchFilter sf = new SearchFilter.SearchFilterCollection(LogicalOperator.And, new SearchFilter.IsEqualTo(EmailMessageSchema.IsRead, false));
FindItemsResults&lt;Item&gt; findResults = service.FindItems(WellKnownFolderName.Inbox, sf, new ItemView(1000));
foreach ( Item item in findResults.Items ) {
    item.Load(itempropertyset);
    from_m = ((Microsoft.Exchange.WebServices.Data.EmailAddress)item[EmailMessageSchema.From]).Address;
    body_h=item.Body;
    sub=item.Subject;
    if(from_m.ToLower()==From.ToLower()) {
        body_h=item.Body;
        row = table.NewRow();
        row[&quot;Subject&quot;] =sub;
        row[&quot;Sender&quot;] =from_m;
        row[&quot;Body&quot;] =body_h;
        table.Rows.Add(row);
    }

}
Call3=table;"
                            data-title="Mail-EWS / Read message from specific mail ID / Code9">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>Mail-EWS</td>
                <td>Read msg using domain</td>
                <td>Code10</td>
                <td>csharp</td>
                <td>58</td>
                <!--<td style="font-family: monospace;">f6e5f17f96a27debb0dbd11836bd9eff4ac6baf305a7e50d8763e4f0fa150b0a</td>-->
                <td>http, reflection, urls(1)</td>
                <!--<td>// http://stackoverflow.com/questions/36069801/ews-read-mail-plain-text-body-getting-serviceobjectpropertyexception string sub; string body_h; string from_m; // asub=&quot;&quot;; // aTo=&quot;&quot;; from_m=&quot;&quot;; DataTable table = new DataTable(); DataColumn column; DataRow row; DataView view; column = new DataColumn();...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="// http://stackoverflow.com/questions/36069801/ews-read-mail-plain-text-body-getting-serviceobjectpropertyexception string sub;
string body_h;
string from_m;
// asub=&quot;&quot;;
// aTo=&quot;&quot;;
from_m=&quot;&quot;;
DataTable table = new DataTable();
DataColumn column;
DataRow row;
DataView view;
column = new DataColumn();
column.DataType = Type.GetType(&quot;System.String&quot;);
column.ColumnName = &quot;Subject&quot;;
table.Columns.Add(column);
column = new DataColumn();
column.DataType = Type.GetType(&quot;System.String&quot;);
column.ColumnName = &quot;Sender&quot;;
table.Columns.Add(column);
column = new DataColumn();
column.DataType = Type.GetType(&quot;System.String&quot;);
column.ColumnName = &quot;Body&quot;;
table.Columns.Add(column);
Call3=table;
ExchangeService service = new ExchangeService(ExchangeVersion.Exchange2010_SP1);
try {
    if(UserName==&quot;&quot;) service.AutodiscoverUrl( MailID );
    else {
        service.Credentials = new WebCredentials(UserName, Password );
        service.AutodiscoverUrl( MailID,RedirectionUrlValidationCallback );
    }

}
catch {
    service.Url = new Uri(SUrl);
}
PropertySet itempropertyset = new PropertySet(BasePropertySet.FirstClassProperties);
itempropertyset.RequestedBodyType = BodyType.Text;
ItemView itemview = new ItemView(1000);
itemview.PropertySet = itempropertyset;
SearchFilter sf = new SearchFilter.SearchFilterCollection(LogicalOperator.And, new SearchFilter.IsEqualTo(EmailMessageSchema.IsRead, false));
FindItemsResults&lt;Item&gt; findResults = service.FindItems(WellKnownFolderName.Inbox, sf, new ItemView(1000));
foreach ( Item item in findResults.Items ) {
    item.Load(itempropertyset);
    from_m = ((Microsoft.Exchange.WebServices.Data.EmailAddress)item[EmailMessageSchema.From]).Address;
    body_h=item.Body;
    sub=item.Subject;
    var m=Regex.Match(from_m, &quot;.*@&quot;+Domain+&quot;$&quot;);
    if (m.Success) {
        body_h=item.Body;
        row = table.NewRow();
        row[&quot;Subject&quot;] =sub;
        row[&quot;Sender&quot;] =from_m;
        row[&quot;Body&quot;] =body_h;
        table.Rows.Add(row);
    }

}
Call3=table;"
                            data-title="Mail-EWS / Read msg using domain / Code10">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>Mail-EWS</td>
                <td>Send mail</td>
                <td>Code12</td>
                <td>csharp</td>
                <td>20</td>
                <!--<td style="font-family: monospace;">494a7d172ada842d5a15a4256e5dc90d7be6beb401f9796e3c5b4a47f81f4342</td>-->
                <td>—</td>
                <!--<td>ExchangeService service = new ExchangeService(ExchangeVersion.Exchange2010_SP1); try {     if(UserName==&quot;&quot;) service.AutodiscoverUrl( MailID );     else {         service.Credentials = new WebCredentials(UserName, Password );         service.AutodiscoverUrl( MailID,RedirectionUrlValidationCallback );...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="ExchangeService service = new ExchangeService(ExchangeVersion.Exchange2010_SP1);
try {
    if(UserName==&quot;&quot;) service.AutodiscoverUrl( MailID );
    else {
        service.Credentials = new WebCredentials(UserName, Password );
        service.AutodiscoverUrl( MailID,RedirectionUrlValidationCallback );
    }

}
catch {
    service.Url = new Uri(SUrl);
}
EmailMessage message = new EmailMessage(service);
message.Subject = Subject;
message.Body = Body;
message.ToRecipients.Add(SendTo);
if(Cc!=&quot;&quot;) message.CcRecipients.Add(Cc);
if(Bcc!=&quot;&quot;) message.BccRecipients.Add(Bcc);
if(Attachment!=&quot;&quot;) message.Attachments.AddFileAttachment(Attachment);
message.SendAndSaveCopy();"
                            data-title="Mail-EWS / Send mail / Code12">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>Mail-EWS</td>
                <td>Send to Many</td>
                <td>Send Mail with Multiple </td>
                <td>csharp</td>
                <td>53</td>
                <!--<td style="font-family: monospace;">5bd1194deef82bff1dd2de7870d50084ddc2bed1c76373e1399e1bc1d3404e3b</td>-->
                <td>—</td>
                <!--<td>ExchangeService service = new ExchangeService(ExchangeVersion.Exchange2010_SP1); try {     if(UserName==&quot;&quot;) service.AutodiscoverUrl( MailID );     else {         service.Credentials = new WebCredentials(UserName, Password );         service.AutodiscoverUrl( MailID,RedirectionUrlValidationCallback );...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="ExchangeService service = new ExchangeService(ExchangeVersion.Exchange2010_SP1);
try {
    if(UserName==&quot;&quot;) service.AutodiscoverUrl( MailID );
    else {
        service.Credentials = new WebCredentials(UserName, Password );
        service.AutodiscoverUrl( MailID,RedirectionUrlValidationCallback );
    }

}
catch {
    service.Url = new Uri(SUrl);
}
try {
    EmailMessage message = new EmailMessage(service);
    message.Subject = Subject;
    message.Body = Body;
    if ( SendTo!= &quot;&quot;) {
        foreach (var address1 in SendTo.Split(new [] {
            &quot;;
            &quot;
        }
    , StringSplitOptions.RemoveEmptyEntries)) {
        message.ToRecipients.Add(address1);
    }

}
if ( cc!= &quot;&quot;) {
    foreach (var address2 in cc.Split(new [] {
        &quot;;
        &quot;
    }
, StringSplitOptions.RemoveEmptyEntries)) {
    message.CcRecipients.Add(address2);
}

}
if(Bcc!=&quot;&quot;) message.BccRecipients.Add(Bcc);
if ( Attachments != null ) {
    message.Body = Body;
    foreach (DataRow row in Attachments.Rows) {
        message.Attachments.AddFileAttachment(row[&quot;Path&quot;].ToString());
    }

}
//message.Attachments.AddFileAttachment(Attachment);
message.SendAndSaveCopy();
Success= true;
Message = &quot;Success&quot;;
}
catch(Exception e) {
    Message = e.ToString();
    Success= false;
}"
                            data-title="Mail-EWS / Send to Many / Send Mail with Multiple ">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>Mail-EWS</td>
                <td>date and time of mail</td>
                <td>Code14</td>
                <td>csharp</td>
                <td>62</td>
                <!--<td style="font-family: monospace;">0a8c721083f22fac6cae3fbab6207881d333df854cdcf5bd4d10a9e6b2852991</td>-->
                <td>http, reflection, urls(1)</td>
                <!--<td>// http://stackoverflow.com/questions/36069801/ews-read-mail-plain-text-body-getting-serviceobjectpropertyexception string sub; string body_h; string from_m; // asub=&quot;&quot;; // aTo=&quot;&quot;; from_m=&quot;&quot;; DataTable table = new DataTable(); DataColumn column; DataRow row; DataView view; column = new DataColumn();...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="// http://stackoverflow.com/questions/36069801/ews-read-mail-plain-text-body-getting-serviceobjectpropertyexception string sub;
string body_h;
string from_m;
// asub=&quot;&quot;;
// aTo=&quot;&quot;;
from_m=&quot;&quot;;
DataTable table = new DataTable();
DataColumn column;
DataRow row;
DataView view;
column = new DataColumn();
column.DataType = Type.GetType(&quot;System.String&quot;);
column.ColumnName = &quot;Subject&quot;;
table.Columns.Add(column);
column = new DataColumn();
column.DataType = Type.GetType(&quot;System.String&quot;);
column.ColumnName = &quot;Sender&quot;;
table.Columns.Add(column);
column = new DataColumn();
column.DataType = Type.GetType(&quot;System.String&quot;);
column.ColumnName = &quot;Body&quot;;
table.Columns.Add(column);
column = new DataColumn();
column.DataType = Type.GetType(&quot;System.String&quot;);
column.ColumnName = &quot;Date&amp;Time&quot;;
table.Columns.Add(column);
Call3=table;
ExchangeService service = new ExchangeService(ExchangeVersion.Exchange2010_SP1);
try {
    if(UserName==&quot;&quot;) service.AutodiscoverUrl( MailID );
    else {
        service.Credentials = new WebCredentials(UserName, Password );
        service.AutodiscoverUrl( MailID,RedirectionUrlValidationCallback );
    }

}
catch {
    service.Url = new Uri(SUrl);
}
PropertySet itempropertyset = new PropertySet(BasePropertySet.FirstClassProperties);
itempropertyset.RequestedBodyType = BodyType.Text;
ItemView itemview = new ItemView(1000);
itemview.PropertySet = itempropertyset;
SearchFilter sf = new SearchFilter.SearchFilterCollection(LogicalOperator.And, new SearchFilter.IsEqualTo(EmailMessageSchema.IsRead, false));
FindItemsResults&lt;Item&gt; findResults = service.FindItems(WellKnownFolderName.Inbox, sf, new ItemView(1000));
foreach ( Item item in findResults.Items ) {
    item.Load(itempropertyset);
    from_m = ((Microsoft.Exchange.WebServices.Data.EmailAddress)item[EmailMessageSchema.From]).Address;
    body_h=item.Body;
    sub=item.Subject;
    if(DateTime&lt;item.DateTimeCreated) {
        body_h=item.Body;
        row = table.NewRow();
        row[&quot;Subject&quot;] =sub;
        row[&quot;Sender&quot;] =from_m;
        row[&quot;Body&quot;] =body_h;
        row[&quot;Date&amp;Time&quot;]=item.DateTimeCreated.ToString();
        table.Rows.Add(row);
    }

}
Call3=table;"
                            data-title="Mail-EWS / date and time of mail / Code14">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>Mail-EWS</td>
                <td>download Attachment</td>
                <td>Code8</td>
                <td>csharp</td>
                <td>77</td>
                <!--<td style="font-family: monospace;">f9065ba54cdc86e44509f332a602fc5f89ddd12e385305d0224b85d321c15fdf</td>-->
                <td>http, reflection, urls(1)</td>
                <!--<td>// http://stackoverflow.com/questions/36069801/ews-read-mail-plain-text-body-getting-serviceobjectpropertyexception int count=0; string sub; string body_h; string from_m; //asub=&quot;&quot;; DataTable table = new DataTable(); DataColumn column; DataRow row; DataView view; column = new DataColumn(); column.Da...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="// http://stackoverflow.com/questions/36069801/ews-read-mail-plain-text-body-getting-serviceobjectpropertyexception int count=0;
string sub;
string body_h;
string from_m;
//asub=&quot;&quot;;
DataTable table = new DataTable();
DataColumn column;
DataRow row;
DataView view;
column = new DataColumn();
column.DataType = Type.GetType(&quot;System.String&quot;);
column.ColumnName = &quot;Subject&quot;;
table.Columns.Add(column);
column = new DataColumn();
column.DataType = Type.GetType(&quot;System.String&quot;);
column.ColumnName = &quot;Sender&quot;;
table.Columns.Add(column);
column = new DataColumn();
column.DataType = Type.GetType(&quot;System.String&quot;);
column.ColumnName = &quot;Body&quot;;
table.Columns.Add(column);
Call3=table;
ExchangeService service = new ExchangeService(ExchangeVersion.Exchange2010_SP1);
try {
    if(UserName==&quot;&quot;) service.AutodiscoverUrl( MailID );
    else {
        service.Credentials = new WebCredentials(UserName, Password );
        service.AutodiscoverUrl( MailID,RedirectionUrlValidationCallback );
    }

}
catch {
    service.Url = new Uri(SUrl);
}
PropertySet itempropertyset = new PropertySet(BasePropertySet.FirstClassProperties);
itempropertyset.RequestedBodyType = BodyType.Text;
ItemView itemview = new ItemView(1000);
itemview.PropertySet = itempropertyset;
SearchFilter sf = new SearchFilter.SearchFilterCollection(LogicalOperator.And, new SearchFilter.IsEqualTo(EmailMessageSchema.IsRead, false));
FindItemsResults&lt;Item&gt; findResults = service.FindItems(WellKnownFolderName.Inbox, sf, new ItemView(1000));
foreach ( Item item in findResults.Items ) {
    EmailMessage mes = (EmailMessage)item;
    from_m=mes.Sender.Name;
    item.Load(itempropertyset);
    //Console.WriteLine(item.Body);
    body_h=item.Body;
    sub=item.Subject;
    //asub=sub;
    var m=Regex.Match(sub.ToUpper(), &quot;.*(CBTS[0-9]{
        7
    }
).*&quot;);
if (m.Success) {
    body_h=item.Body;
    row = table.NewRow();
    row[&quot;Subject&quot;] =sub;
    row[&quot;Sender&quot;] =from_m;
    row[&quot;Body&quot;] =body_h;
    EmailMessage message = EmailMessage.Bind(service, item.Id, new PropertySet(BasePropertySet.IdOnly, ItemSchema.Attachments, ItemSchema.HasAttachments));
    foreach (Attachment attachment in message.Attachments) {
        int b=attachment.Name.IndexOf(&quot;.&quot;);
        if (attachment is FileAttachment) if (attachment.Name.Contains(&quot;.xlsx&quot;)) {
            count=count+1;
            FileAttachment fileAttachment = attachment as FileAttachment;
            //fileAttachment.Load(&quot;c:\\folder\\&quot; + fileAttachment.Name);
            fileAttachment.Load(&quot;c:\\folder\\&quot; + m.Groups[1].Value+&quot;_&quot;+count+&quot;.xlsx&quot;);
            Console.WriteLine(&quot;Attachment name: &quot; + fileAttachment.Name);
        }

}
mes.IsRead = true;
mes.Update(ConflictResolutionMode.AlwaysOverwrite);
table.Rows.Add(row);
}

}
Call3=table;"
                            data-title="Mail-EWS / download Attachment / Code8">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>Mail-EWS</td>
                <td>forward mail</td>
                <td>Code1</td>
                <td>csharp</td>
                <td>70</td>
                <!--<td style="font-family: monospace;">b2f80f58261a7361cbbe9bbc84e0e03bb69d807fb9069e78b0a6e9700046b61a</td>-->
                <td>reflection</td>
                <!--<td>string sub; string body_h; string from_m; //string messageBodyPrefix = &quot;This is a message that was forwarded by using the EWS Managed API&quot;; string messageBodyPrefix = &quot;&quot;; // asub=&quot;&quot;; // aTo=&quot;&quot;; from_m=&quot;&quot;; DataTable table = new DataTable(); DataColumn column; DataRow row; DataView view; column = new ...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="string sub;
string body_h;
string from_m;
//string messageBodyPrefix = &quot;This is a message that was forwarded by using the EWS Managed API&quot;;
string messageBodyPrefix = &quot;&quot;;
// asub=&quot;&quot;;
// aTo=&quot;&quot;;
from_m=&quot;&quot;;
DataTable table = new DataTable();
DataColumn column;
DataRow row;
DataView view;
column = new DataColumn();
column.DataType = Type.GetType(&quot;System.String&quot;);
column.ColumnName = &quot;Subject&quot;;
table.Columns.Add(column);
column = new DataColumn();
column.DataType = Type.GetType(&quot;System.String&quot;);
column.ColumnName = &quot;Sender&quot;;
table.Columns.Add(column);
column = new DataColumn();
column.DataType = Type.GetType(&quot;System.String&quot;);
column.ColumnName = &quot;Body&quot;;
table.Columns.Add(column);
Call3=table;
ExchangeService service = new ExchangeService(ExchangeVersion.Exchange2010_SP1);
try {
    if(UserName==&quot;&quot;) service.AutodiscoverUrl( MailID );
    else {
        service.Credentials = new WebCredentials(UserName, Password );
        service.AutodiscoverUrl( MailID,RedirectionUrlValidationCallback );
    }

}
catch {
    service.Url = new Uri(SUrl);
}
PropertySet itempropertyset = new PropertySet(BasePropertySet.FirstClassProperties);
itempropertyset.RequestedBodyType = BodyType.Text;
ItemView itemview = new ItemView(1000);
itemview.PropertySet = itempropertyset;
SearchFilter sf = new SearchFilter.SearchFilterCollection(LogicalOperator.And, new SearchFilter.IsEqualTo(EmailMessageSchema.IsRead, false));
FindItemsResults&lt;Item&gt; findResults = service.FindItems(WellKnownFolderName.Inbox, sf, new ItemView(1000));
EmailMessage message = new EmailMessage(service);
foreach ( Item item in findResults.Items ) {
    item.Load(itempropertyset);
    from_m = ((Microsoft.Exchange.WebServices.Data.EmailAddress)item[EmailMessageSchema.From]).Address;
    body_h=item.Body;
    sub=item.Subject;
    if(from_m.ToLower()==From.ToLower()) {
        if(sub.ToUpper().Contains(Sub.ToUpper())) {
            message = item as EmailMessage;
            ResponseMessage responseMessage = message.CreateForward();
            body_h=item.Body;
            row = table.NewRow();
            row[&quot;Subject&quot;] =sub;
            row[&quot;Sender&quot;] =from_m;
            row[&quot;Body&quot;] =body_h;
            responseMessage.BodyPrefix = messageBodyPrefix;
            // Add the recipients who are to receive the forwarded email message. responseMessage.ToRecipients.Add(SendTo);
            if(Cc!=&quot;&quot;) responseMessage.CcRecipients.Add(Cc);
            if(Bcc!=&quot;&quot;) responseMessage.BccRecipients.Add(Bcc);
            // Send the forwarded email message and save a copy of the message in the default Sent Items folder. responseMessage.SendAndSaveCopy();
            table.Rows.Add(row);
        }

}

}
Call3=table;"
                            data-title="Mail-EWS / forward mail / Code1">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>Mail-EWS</td>
                <td>master</td>
                <td>domain and mail</td>
                <td>csharp</td>
                <td>116</td>
                <!--<td style="font-family: monospace;">c5654ced34150a798a728d2102c9e8b8956049d6a8271ac13ff17ad80451ffed</td>-->
                <td>http, reflection, urls(1)</td>
                <!--<td>// http://stackoverflow.com/questions/36069801/ews-read-mail-plain-text-body-getting-serviceobjectpropertyexception int count=0; string sub; string body_h; string from_m; string fid=&quot;NA&quot;; string messageBodyPrefix=&quot;&quot;; messageBodyPrefix=ForwardNote; from_m=&quot;&quot;; DataTable table = new DataTable(); DataCo...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="// http://stackoverflow.com/questions/36069801/ews-read-mail-plain-text-body-getting-serviceobjectpropertyexception int count=0;
string sub;
string body_h;
string from_m;
string fid=&quot;NA&quot;;
string messageBodyPrefix=&quot;&quot;;
messageBodyPrefix=ForwardNote;
from_m=&quot;&quot;;
DataTable table = new DataTable();
DataColumn column;
DataRow row;
DataView view;
column = new DataColumn();
column.DataType = Type.GetType(&quot;System.String&quot;);
column.ColumnName = &quot;Subject&quot;;
table.Columns.Add(column);
column = new DataColumn();
column.DataType = Type.GetType(&quot;System.String&quot;);
column.ColumnName = &quot;Sender&quot;;
table.Columns.Add(column);
column = new DataColumn();
column.DataType = Type.GetType(&quot;System.String&quot;);
column.ColumnName = &quot;Body&quot;;
table.Columns.Add(column);
Call3=table;
ExchangeService service = new ExchangeService(ExchangeVersion.Exchange2010_SP1);
try {
    if(UserName==&quot;&quot;) service.AutodiscoverUrl( MailID );
    else {
        service.Credentials = new WebCredentials(UserName, Password );
        service.AutodiscoverUrl( MailID,RedirectionUrlValidationCallback );
    }

}
catch {
    service.Url = new Uri(SUrl);
}
PropertySet itempropertyset = new PropertySet(BasePropertySet.FirstClassProperties);
itempropertyset.RequestedBodyType = BodyType.Text;
ItemView itemview = new ItemView(1000);
itemview.PropertySet = itempropertyset;
Folder rootfolder = Folder.Bind(service, WellKnownFolderName.MsgFolderRoot);
rootfolder.Load();
foreach (Folder folder in rootfolder.FindFolders(new FolderView(100))) {
    if(folder.DisplayName==MoveToFolder) {
        fid=folder.Id.ToString();
    }

}
SearchFilter sf = new SearchFilter.SearchFilterCollection(LogicalOperator.And, new SearchFilter.IsEqualTo(EmailMessageSchema.IsRead, false));
FindItemsResults&lt;Item&gt; findResults = service.FindItems(WellKnownFolderName.Inbox, sf, new ItemView(1000));
foreach ( Item item in findResults.Items ) {
    EmailMessage mes = (EmailMessage)item;
    //from_m=mes.Sender.Name;
    item.Load(itempropertyset);
    //Console.WriteLine(item.Body);
    from_m = ((Microsoft.Exchange.WebServices.Data.EmailAddress)item[EmailMessageSchema.From]).Address;
    body_h=item.Body;
    sub=item.Subject;
    if(DateTime&lt;item.DateTimeCreated) {
        if(from_m.ToLower()==from.ToLower()) {
            var x=Regex.Match(from_m, &quot;.*@&quot;+domain+&quot;$&quot;);
            if (x.Success &amp; from_m==from) {
                // var m=Regex.Match(sub.ToUpper(), &quot;.*(&quot;+Sub.ToUpper()+&quot;).*&quot;);
                // if (m.Success) if(sub.ToUpper().Contains(Sub.ToUpper())) {
                    body_h=item.Body;
                    row = table.NewRow();
                    row[&quot;Subject&quot;] =sub;
                    row[&quot;Sender&quot;] =from_m;
                    row[&quot;Body&quot;] =body_h;
                    EmailMessage message = EmailMessage.Bind(service, item.Id, new PropertySet(BasePropertySet.IdOnly, ItemSchema.Attachments, ItemSchema.HasAttachments));
                    foreach (Attachment attachment in message.Attachments) {
                        if (attachment is FileAttachment) if(AttachmentType==&quot;&quot;) {
                            FileAttachment fileAttachment = attachment as FileAttachment;
                            fileAttachment.Load(SaveAttachmentPath + fileAttachment.Name);
                        }
                    else
                    {
                        if (attachment.Name.Contains(AttachmentType)) {
                            count=count+1;
                            FileAttachment fileAttachment = attachment as FileAttachment;
                            if(Sub==&quot;&quot;) fileAttachment.Load(SaveAttachmentPath + fileAttachment.Name);
                            else fileAttachment.Load(SaveAttachmentPath+Sub+&quot;_&quot;+count+AttachmentType);
                        }

                }

        }
    if(MarkAsRead) {
        mes.IsRead = true;
        mes.Update(ConflictResolutionMode.AlwaysOverwrite);
    }
if(fid!=&quot;NA&quot;) {
    item.Load(itempropertyset);
    item.Move(fid);
}
if(Forward) {
    message = item as EmailMessage;
    ResponseMessage responseMessage = message.CreateForward();
    responseMessage.BodyPrefix = messageBodyPrefix;
    // Add the recipients who are to receive the forwarded email message. responseMessage.ToRecipients.Add(SendTo);
    if(Cc!=&quot;&quot;) responseMessage.CcRecipients.Add(Cc);
    if(Bcc!=&quot;&quot;) responseMessage.BccRecipients.Add(Bcc);
    // Send the forwarded email message and save a copy of the message in the default Sent Items folder. responseMessage.SendAndSaveCopy();
}
table.Rows.Add(row);
}

}

}

}

}
Call3=table;"
                            data-title="Mail-EWS / master / domain and mail">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>Mail-EWS</td>
                <td>master</td>
                <td>domain filtering</td>
                <td>csharp</td>
                <td>113</td>
                <!--<td style="font-family: monospace;">8866de77219a8f6215cfe6c4aee34b9ff35e85691679b522043605e9a7e572ea</td>-->
                <td>http, reflection, urls(1)</td>
                <!--<td>// http://stackoverflow.com/questions/36069801/ews-read-mail-plain-text-body-getting-serviceobjectpropertyexception int count=0; string sub; string body_h; string from_m; from_m=&quot;&quot;; string fid=&quot;NA&quot;; string messageBodyPrefix=&quot;&quot;; messageBodyPrefix=ForwardNote; DataTable table = new DataTable(); DataCo...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="// http://stackoverflow.com/questions/36069801/ews-read-mail-plain-text-body-getting-serviceobjectpropertyexception int count=0;
string sub;
string body_h;
string from_m;
from_m=&quot;&quot;;
string fid=&quot;NA&quot;;
string messageBodyPrefix=&quot;&quot;;
messageBodyPrefix=ForwardNote;
DataTable table = new DataTable();
DataColumn column;
DataRow row;
DataView view;
column = new DataColumn();
column.DataType = Type.GetType(&quot;System.String&quot;);
column.ColumnName = &quot;Subject&quot;;
table.Columns.Add(column);
column = new DataColumn();
column.DataType = Type.GetType(&quot;System.String&quot;);
column.ColumnName = &quot;Sender&quot;;
table.Columns.Add(column);
column = new DataColumn();
column.DataType = Type.GetType(&quot;System.String&quot;);
column.ColumnName = &quot;Body&quot;;
table.Columns.Add(column);
Call3=table;
ExchangeService service = new ExchangeService(ExchangeVersion.Exchange2010_SP1);
try {
    if(UserName==&quot;&quot;) service.AutodiscoverUrl( MailID );
    else {
        service.Credentials = new WebCredentials(UserName, Password );
        service.AutodiscoverUrl( MailID,RedirectionUrlValidationCallback );
    }

}
catch {
    service.Url = new Uri(SUrl);
}
PropertySet itempropertyset = new PropertySet(BasePropertySet.FirstClassProperties);
itempropertyset.RequestedBodyType = BodyType.Text;
ItemView itemview = new ItemView(1000);
itemview.PropertySet = itempropertyset;
SearchFilter sf = new SearchFilter.SearchFilterCollection(LogicalOperator.And, new SearchFilter.IsEqualTo(EmailMessageSchema.IsRead, false));
FindItemsResults&lt;Item&gt; findResults = service.FindItems(WellKnownFolderName.Inbox, sf, new ItemView(1000));
Folder rootfolder = Folder.Bind(service, WellKnownFolderName.MsgFolderRoot);
rootfolder.Load();
foreach (Folder folder in rootfolder.FindFolders(new FolderView(100))) {
    if(folder.DisplayName==MoveToFolder) {
        fid=folder.Id.ToString();
    }

}
foreach ( Item item in findResults.Items ) {
    EmailMessage mes = (EmailMessage)item;
    //from_m=mes.Sender.Name;
    item.Load(itempropertyset);
    //Console.WriteLine(item.Body);
    from_m = ((Microsoft.Exchange.WebServices.Data.EmailAddress)item[EmailMessageSchema.From]).Address;
    body_h=item.Body;
    sub=item.Subject;
    if(DateTime&lt;item.DateTimeCreated) {
        var x=Regex.Match(from_m, &quot;.*@&quot;+domain+&quot;$&quot;);
        if (x.Success) {
            //var m=Regex.Match(sub.ToUpper(), &quot;.*(&quot;+Sub.ToUpper()+&quot;).*&quot;);
            //if (m.Success) if(sub.ToUpper().Contains(Sub.ToUpper())) {
                body_h=item.Body;
                row = table.NewRow();
                row[&quot;Subject&quot;] =sub;
                row[&quot;Sender&quot;] =from_m;
                row[&quot;Body&quot;] =body_h;
                EmailMessage message = EmailMessage.Bind(service, item.Id, new PropertySet(BasePropertySet.IdOnly, ItemSchema.Attachments, ItemSchema.HasAttachments));
                foreach (Attachment attachment in message.Attachments) {
                    if (attachment is FileAttachment) if(AttachmentType==&quot;&quot;) {
                        FileAttachment fileAttachment = attachment as FileAttachment;
                        fileAttachment.Load(SaveAttachmentPath + fileAttachment.Name);
                    }
                else
                {
                    if (attachment.Name.Contains(AttachmentType)) {
                        count=count+1;
                        FileAttachment fileAttachment = attachment as FileAttachment;
                        //if(m.Groups[1].Value==&quot;&quot;) if(Sub==&quot;&quot;) fileAttachment.Load(SaveAttachmentPath + fileAttachment.Name);
                        else fileAttachment.Load(SaveAttachmentPath+Sub+&quot;_&quot;+count+AttachmentType);
                    }

            }

    }
if(MarkAsRead) {
    mes.IsRead = true;
    mes.Update(ConflictResolutionMode.AlwaysOverwrite);
}
if(fid!=&quot;NA&quot;) {
    item.Load(itempropertyset);
    item.Move(fid);
}
if(Forward) {
    message = item as EmailMessage;
    ResponseMessage responseMessage = message.CreateForward();
    responseMessage.BodyPrefix = messageBodyPrefix;
    // Add the recipients who are to receive the forwarded email message. responseMessage.ToRecipients.Add(SendTo);
    if(Cc!=&quot;&quot;) responseMessage.CcRecipients.Add(Cc);
    if(Bcc!=&quot;&quot;) responseMessage.BccRecipients.Add(Bcc);
    // Send the forwarded email message and save a copy of the message in the default Sent Items folder. responseMessage.SendAndSaveCopy();
}
table.Rows.Add(row);
}

}

}

}
Call3=table;"
                            data-title="Mail-EWS / master / domain filtering">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>Mail-EWS</td>
                <td>master</td>
                <td>mail filtering</td>
                <td>csharp</td>
                <td>112</td>
                <!--<td style="font-family: monospace;">342fd53eefcb7c2f1f9c552a4586ab4ca984c95ffbc24730d6f789a34ae2c33c</td>-->
                <td>http, reflection, urls(1)</td>
                <!--<td>// http://stackoverflow.com/questions/36069801/ews-read-mail-plain-text-body-getting-serviceobjectpropertyexception int count=0; string sub; string body_h; string from_m; from_m=&quot;&quot;; string fid=&quot;NA&quot;; string messageBodyPrefix=&quot;&quot;; messageBodyPrefix=ForwardNote; DataTable table = new DataTable(); DataCo...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="// http://stackoverflow.com/questions/36069801/ews-read-mail-plain-text-body-getting-serviceobjectpropertyexception int count=0;
string sub;
string body_h;
string from_m;
from_m=&quot;&quot;;
string fid=&quot;NA&quot;;
string messageBodyPrefix=&quot;&quot;;
messageBodyPrefix=ForwardNote;
DataTable table = new DataTable();
DataColumn column;
DataRow row;
DataView view;
column = new DataColumn();
column.DataType = Type.GetType(&quot;System.String&quot;);
column.ColumnName = &quot;Subject&quot;;
table.Columns.Add(column);
column = new DataColumn();
column.DataType = Type.GetType(&quot;System.String&quot;);
column.ColumnName = &quot;Sender&quot;;
table.Columns.Add(column);
column = new DataColumn();
column.DataType = Type.GetType(&quot;System.String&quot;);
column.ColumnName = &quot;Body&quot;;
table.Columns.Add(column);
Call3=table;
ExchangeService service = new ExchangeService(ExchangeVersion.Exchange2010_SP1);
try {
    if(UserName==&quot;&quot;) service.AutodiscoverUrl( MailID );
    else {
        service.Credentials = new WebCredentials(UserName, Password );
        service.AutodiscoverUrl( MailID,RedirectionUrlValidationCallback );
    }

}
catch {
    service.Url = new Uri(SUrl);
}
PropertySet itempropertyset = new PropertySet(BasePropertySet.FirstClassProperties);
itempropertyset.RequestedBodyType = BodyType.Text;
ItemView itemview = new ItemView(1000);
itemview.PropertySet = itempropertyset;
SearchFilter sf = new SearchFilter.SearchFilterCollection(LogicalOperator.And, new SearchFilter.IsEqualTo(EmailMessageSchema.IsRead, false));
FindItemsResults&lt;Item&gt; findResults = service.FindItems(WellKnownFolderName.Inbox, sf, new ItemView(1000));
Folder rootfolder = Folder.Bind(service, WellKnownFolderName.MsgFolderRoot);
rootfolder.Load();
foreach (Folder folder in rootfolder.FindFolders(new FolderView(100))) {
    if(folder.DisplayName==MoveToFolder) {
        fid=folder.Id.ToString();
    }

}
foreach ( Item item in findResults.Items ) {
    EmailMessage mes = (EmailMessage)item;
    //from_m=mes.Sender.Name;
    item.Load(itempropertyset);
    //Console.WriteLine(item.Body);
    from_m = ((Microsoft.Exchange.WebServices.Data.EmailAddress)item[EmailMessageSchema.From]).Address;
    body_h=item.Body;
    sub=item.Subject;
    if(DateTime&lt;item.DateTimeCreated) {
        if(from_m.ToLower()==from.ToLower()) {
            //var m=Regex.Match(sub.ToUpper(), &quot;.*(&quot;+Sub.ToUpper()+&quot;).*&quot;);
            //if (m.Success) if(sub.ToUpper().Contains(Sub.ToUpper())) {
                body_h=item.Body;
                row = table.NewRow();
                row[&quot;Subject&quot;] =sub;
                row[&quot;Sender&quot;] =from_m;
                row[&quot;Body&quot;] =body_h;
                EmailMessage message = EmailMessage.Bind(service, item.Id, new PropertySet(BasePropertySet.IdOnly, ItemSchema.Attachments, ItemSchema.HasAttachments));
                foreach (Attachment attachment in message.Attachments) {
                    if (attachment is FileAttachment) if(AttachmentType==&quot;&quot;) {
                        FileAttachment fileAttachment = attachment as FileAttachment;
                        fileAttachment.Load(SaveAttachmentPath + fileAttachment.Name);
                    }
                else
                {
                    if (attachment.Name.Contains(AttachmentType)) {
                        count=count+1;
                        FileAttachment fileAttachment = attachment as FileAttachment;
                        if(Sub==&quot;&quot;) fileAttachment.Load(SaveAttachmentPath + fileAttachment.Name);
                        else fileAttachment.Load(SaveAttachmentPath+Sub+&quot;_&quot;+count+AttachmentType);
                    }

            }

    }
if(MarkAsRead) {
    mes.IsRead = true;
    mes.Update(ConflictResolutionMode.AlwaysOverwrite);
}
if(fid!=&quot;NA&quot;) {
    item.Load(itempropertyset);
    item.Move(fid);
}
if(Forward) {
    message = item as EmailMessage;
    ResponseMessage responseMessage = message.CreateForward();
    responseMessage.BodyPrefix = messageBodyPrefix;
    // Add the recipients who are to receive the forwarded email message. responseMessage.ToRecipients.Add(SendTo);
    if(Cc!=&quot;&quot;) responseMessage.CcRecipients.Add(Cc);
    if(Bcc!=&quot;&quot;) responseMessage.BccRecipients.Add(Bcc);
    // Send the forwarded email message and save a copy of the message in the default Sent Items folder. responseMessage.SendAndSaveCopy();
}
table.Rows.Add(row);
}

}

}

}
Call3=table;"
                            data-title="Mail-EWS / master / mail filtering">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>Mail-EWS</td>
                <td>master</td>
                <td>no filter</td>
                <td>csharp</td>
                <td>109</td>
                <!--<td style="font-family: monospace;">8288d6e322219f180b84c5192464103ff70aad1946c0e6133846e4881484db97</td>-->
                <td>http, reflection, urls(1)</td>
                <!--<td>// http://stackoverflow.com/questions/36069801/ews-read-mail-plain-text-body-getting-serviceobjectpropertyexception int count=0; string sub; string body_h; string from_m; from_m=&quot;&quot;; string fid=&quot;NA&quot;; string messageBodyPrefix=&quot;&quot;; messageBodyPrefix=ForwardNote; DataTable table = new DataTable(); DataCo...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="// http://stackoverflow.com/questions/36069801/ews-read-mail-plain-text-body-getting-serviceobjectpropertyexception int count=0;
string sub;
string body_h;
string from_m;
from_m=&quot;&quot;;
string fid=&quot;NA&quot;;
string messageBodyPrefix=&quot;&quot;;
messageBodyPrefix=ForwardNote;
DataTable table = new DataTable();
DataColumn column;
DataRow row;
DataView view;
column = new DataColumn();
column.DataType = Type.GetType(&quot;System.String&quot;);
column.ColumnName = &quot;Subject&quot;;
table.Columns.Add(column);
column = new DataColumn();
column.DataType = Type.GetType(&quot;System.String&quot;);
column.ColumnName = &quot;Sender&quot;;
table.Columns.Add(column);
column = new DataColumn();
column.DataType = Type.GetType(&quot;System.String&quot;);
column.ColumnName = &quot;Body&quot;;
table.Columns.Add(column);
Call3=table;
ExchangeService service = new ExchangeService(ExchangeVersion.Exchange2010_SP1);
try {
    if(UserName==&quot;&quot;) service.AutodiscoverUrl( MailID );
    else {
        service.Credentials = new WebCredentials(UserName, Password );
        service.AutodiscoverUrl( MailID,RedirectionUrlValidationCallback );
    }

}
catch {
    service.Url = new Uri(SUrl);
}
PropertySet itempropertyset = new PropertySet(BasePropertySet.FirstClassProperties);
itempropertyset.RequestedBodyType = BodyType.Text;
ItemView itemview = new ItemView(1000);
itemview.PropertySet = itempropertyset;
SearchFilter sf = new SearchFilter.SearchFilterCollection(LogicalOperator.And, new SearchFilter.IsEqualTo(EmailMessageSchema.IsRead, false));
FindItemsResults&lt;Item&gt; findResults = service.FindItems(WellKnownFolderName.Inbox, sf, new ItemView(1000));
Folder rootfolder = Folder.Bind(service, WellKnownFolderName.MsgFolderRoot);
rootfolder.Load();
foreach (Folder folder in rootfolder.FindFolders(new FolderView(100))) {
    if(folder.DisplayName==MoveToFolder) {
        fid=folder.Id.ToString();
    }

}
foreach ( Item item in findResults.Items ) {
    EmailMessage mes = (EmailMessage)item;
    //from_m=mes.Sender.Name;
    item.Load(itempropertyset);
    //Console.WriteLine(item.Body);
    from_m = ((Microsoft.Exchange.WebServices.Data.EmailAddress)item[EmailMessageSchema.From]).Address;
    body_h=item.Body;
    sub=item.Subject;
    if(DateTime&lt;item.DateTimeCreated) {
        //var m=Regex.Match(sub.ToUpper(), &quot;.*(&quot;+Sub.ToUpper()+&quot;).*&quot;);
        //if (m.Success) if(sub.ToUpper().Contains(Sub.ToUpper())) {
            body_h=item.Body;
            row = table.NewRow();
            row[&quot;Subject&quot;] =sub;
            row[&quot;Sender&quot;] =from_m;
            row[&quot;Body&quot;] =body_h;
            EmailMessage message = EmailMessage.Bind(service, item.Id, new PropertySet(BasePropertySet.IdOnly, ItemSchema.Attachments, ItemSchema.HasAttachments));
            foreach (Attachment attachment in message.Attachments) {
                if (attachment is FileAttachment) if(AttachmentType==&quot;&quot;) {
                    FileAttachment fileAttachment = attachment as FileAttachment;
                    fileAttachment.Load(SaveAttachmentPath + fileAttachment.Name);
                }
            else
            {
                if (attachment.Name.Contains(AttachmentType)) {
                    count=count+1;
                    FileAttachment fileAttachment = attachment as FileAttachment;
                    if(Sub==&quot;&quot;) fileAttachment.Load(SaveAttachmentPath + fileAttachment.Name);
                    else fileAttachment.Load(SaveAttachmentPath+Sub+&quot;_&quot;+count+AttachmentType);
                }

        }

}
if(MarkAsRead) {
    mes.IsRead = true;
    mes.Update(ConflictResolutionMode.AlwaysOverwrite);
}
if(fid!=&quot;NA&quot;) {
    item.Load(itempropertyset);
    item.Move(fid);
}
if(Forward) {
    message = item as EmailMessage;
    ResponseMessage responseMessage = message.CreateForward();
    responseMessage.BodyPrefix = messageBodyPrefix;
    // Add the recipients who are to receive the forwarded email message. responseMessage.ToRecipients.Add(SendTo);
    if(Cc!=&quot;&quot;) responseMessage.CcRecipients.Add(Cc);
    if(Bcc!=&quot;&quot;) responseMessage.BccRecipients.Add(Bcc);
    // Send the forwarded email message and save a copy of the message in the default Sent Items folder. responseMessage.SendAndSaveCopy();
}
table.Rows.Add(row);
}

}

}
Call3=table;"
                            data-title="Mail-EWS / master / no filter">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>Mail-EWS</td>
                <td>move mail</td>
                <td>Code7</td>
                <td>csharp</td>
                <td>36</td>
                <!--<td style="font-family: monospace;">2413e6924993f3e486c45686be98eaec3b850af79744a4521cd60b4fd2b73c21</td>-->
                <td>—</td>
                <!--<td>string fid; fid=&quot;NA&quot;; ExchangeService service = new ExchangeService(ExchangeVersion.Exchange2010_SP1); try {     if(UserName==&quot;&quot;) service.AutodiscoverUrl( MailID );     else {         service.Credentials = new WebCredentials(UserName, Password );         service.AutodiscoverUrl( MailID,RedirectionUr...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="string fid;
fid=&quot;NA&quot;;
ExchangeService service = new ExchangeService(ExchangeVersion.Exchange2010_SP1);
try {
    if(UserName==&quot;&quot;) service.AutodiscoverUrl( MailID );
    else {
        service.Credentials = new WebCredentials(UserName, Password );
        service.AutodiscoverUrl( MailID,RedirectionUrlValidationCallback );
    }

}
catch {
    service.Url = new Uri(SUrl);
}
PropertySet itempropertyset = new PropertySet(BasePropertySet.FirstClassProperties);
itempropertyset.RequestedBodyType = BodyType.Text;
ItemView itemview = new ItemView(1000);
itemview.PropertySet = itempropertyset;
SearchFilter sf = new SearchFilter.SearchFilterCollection(LogicalOperator.And, new SearchFilter.IsEqualTo(EmailMessageSchema.IsRead, false));
FindItemsResults&lt;Item&gt; findResults = service.FindItems(WellKnownFolderName.Inbox, sf, new ItemView(1000));
Folder rootfolder = Folder.Bind(service, WellKnownFolderName.MsgFolderRoot);
rootfolder.Load();
foreach (Folder folder in rootfolder.FindFolders(new FolderView(100))) {
    if(folder.DisplayName==MoveToFolder) {
        fid=folder.Id.ToString();
    }

}
if(fid!=&quot;NA&quot;) {
    foreach ( Item item in findResults.Items ) {
        EmailMessage mes = (EmailMessage)item;
        item.Load(itempropertyset);
        item.Move(fid);
    }

}"
                            data-title="Mail-EWS / move mail / Code7">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>Mail-EWS</td>
                <td>reply</td>
                <td>Code30</td>
                <td>csharp</td>
                <td>68</td>
                <!--<td style="font-family: monospace;">fee39656ff63483a377206c4cb567822829987aa2b873f108ea783e8e61edc22</td>-->
                <td>reflection</td>
                <!--<td>bool replyToAll = true; string sub; string body_h; string from_m; //string messageBodyPrefix = &quot;This is a message that was forwarded by using the EWS Managed API&quot;; string messageBodyPrefix = &quot;&quot;; // asub=&quot;&quot;; // aTo=&quot;&quot;; from_m=&quot;&quot;; DataTable table = new DataTable(); DataColumn column; DataRow row; Data...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="bool replyToAll = true;
string sub;
string body_h;
string from_m;
//string messageBodyPrefix = &quot;This is a message that was forwarded by using the EWS Managed API&quot;;
string messageBodyPrefix = &quot;&quot;;
// asub=&quot;&quot;;
// aTo=&quot;&quot;;
from_m=&quot;&quot;;
DataTable table = new DataTable();
DataColumn column;
DataRow row;
DataView view;
column = new DataColumn();
column.DataType = Type.GetType(&quot;System.String&quot;);
column.ColumnName = &quot;Subject&quot;;
table.Columns.Add(column);
column = new DataColumn();
column.DataType = Type.GetType(&quot;System.String&quot;);
column.ColumnName = &quot;Sender&quot;;
table.Columns.Add(column);
column = new DataColumn();
column.DataType = Type.GetType(&quot;System.String&quot;);
column.ColumnName = &quot;Body&quot;;
table.Columns.Add(column);
Call3=table;
ExchangeService service = new ExchangeService(ExchangeVersion.Exchange2010_SP1);
try {
    if(UserName==&quot;&quot;) service.AutodiscoverUrl( MailID );
    else {
        service.Credentials = new WebCredentials(UserName, Password );
        service.AutodiscoverUrl( MailID,RedirectionUrlValidationCallback );
    }

}
catch {
    service.Url = new Uri(SUrl);
}
PropertySet itempropertyset = new PropertySet(BasePropertySet.FirstClassProperties);
itempropertyset.RequestedBodyType = BodyType.Text;
ItemView itemview = new ItemView(1000);
itemview.PropertySet = itempropertyset;
SearchFilter sf = new SearchFilter.SearchFilterCollection(LogicalOperator.And, new SearchFilter.IsEqualTo(EmailMessageSchema.IsRead, false));
FindItemsResults&lt;Item&gt; findResults = service.FindItems(WellKnownFolderName.Inbox, sf, new ItemView(1000));
EmailMessage message = new EmailMessage(service);
foreach ( Item item in findResults.Items ) {
    item.Load(itempropertyset);
    from_m = ((Microsoft.Exchange.WebServices.Data.EmailAddress)item[EmailMessageSchema.From]).Address;
    body_h=item.Body;
    sub=item.Subject;
    if(from_m.ToLower()==From.ToLower()) {
        if(sub.ToUpper().Contains(Sub.ToUpper())) {
            message = item as EmailMessage;
            ResponseMessage responseMessage = message.CreateReply(replyToAll);
            body_h=item.Body;
            row = table.NewRow();
            row[&quot;Subject&quot;] =sub;
            row[&quot;Sender&quot;] =from_m;
            row[&quot;Body&quot;] =body_h;
            responseMessage.BodyPrefix=Body;
            responseMessage.SendAndSaveCopy();
            table.Rows.Add(row);
        }

}

}
Call3=table;"
                            data-title="Mail-EWS / reply / Code30">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>Mail-EWS</td>
                <td>unread mails</td>
                <td>Code4</td>
                <td>csharp</td>
                <td>115</td>
                <!--<td style="font-family: monospace;">dbe25eb920d14a456880fe00dc9cd4545cb6a0e257656986fe111746e1f3499a</td>-->
                <td>http, reflection, urls(4)</td>
                <!--<td>// http://stackoverflow.com/questions/36069801/ews-read-mail-plain-text-body-getting-serviceobjectpropertyexception string sub; string body_h; string from_m; asub=&quot;&quot;; aTo=&quot;&quot;; DataTable table = new DataTable(); DataColumn column; DataRow row; DataView view; column = new DataColumn(); column.DataType ...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="// http://stackoverflow.com/questions/36069801/ews-read-mail-plain-text-body-getting-serviceobjectpropertyexception string sub;
string body_h;
string from_m;
asub=&quot;&quot;;
aTo=&quot;&quot;;
DataTable table = new DataTable();
DataColumn column;
DataRow row;
DataView view;
column = new DataColumn();
column.DataType = Type.GetType(&quot;System.String&quot;);
column.ColumnName = &quot;Subject&quot;;
table.Columns.Add(column);
column = new DataColumn();
column.DataType = Type.GetType(&quot;System.String&quot;);
column.ColumnName = &quot;Sender&quot;;
table.Columns.Add(column);
column = new DataColumn();
column.DataType = Type.GetType(&quot;System.String&quot;);
column.ColumnName = &quot;Body&quot;;
table.Columns.Add(column);
//row[&quot;item&quot;] = &quot;item &quot;;
/* row = table.NewRow();
row[&quot;item&quot;] = &quot;item &quot;;
table.Rows.Add(row);
*/ Call3=table;
//ExchangeService service = new ExchangeService(ExchangeVersion.Exchange2007_SP1);
ExchangeService service = new ExchangeService(ExchangeVersion.Exchange2010_SP1);
//service.Credentials = new WebCredentials(&quot;tp.devtest14@xe04.ey.com&quot;, &quot;&quot;, &quot;xdtd01.ey.net&quot;);
//service.Credentials = new WebCredentials(&quot;&quot;, &quot;&quot;, &quot;xdtd01.ey.net&quot;);
//service.Credentials = new NetworkCredential(userEmailAddress, userPassword);
////////////service.Credentials = new WebCredentials(&quot;arjun.lal@xe04.ey.com&quot;, &quot;*********&quot;, &quot;outlook-xi.ey.net&quot;);
//service.Credentials = new WebCredentials(&quot;arjun.lal@xe04.ey.com&quot;, &quot;*********&quot;, &quot;outlook-xi.ey.net&quot;);
//service.AutodiscoverUrl( &quot;tp.devtest14@xe04.ey.com&quot; );
// service.Credentials = new NetworkCredential(&quot;Arjun.Lal@xe04.ey.com&quot;, &quot;&quot;);
//service.Credentials = new NetworkCredential(&quot;Arjun.Lal@xe04.ey.com&quot;, &quot;History_05&quot;);
//service.Credentials = new NetworkCredential(&quot;tp.devtest14@xe04.ey.com&quot;, &quot;&quot;);
//************************************ try {
    if(UserName==&quot;&quot;) service.AutodiscoverUrl( MailID );
    else {
        service.Credentials = new WebCredentials(UserName, Password );
        service.AutodiscoverUrl( MailID,RedirectionUrlValidationCallback );
    }

}
catch {
    service.Url = new Uri(SUrl);
}
//service.AutodiscoverUrl(&quot;tp.devtest14@xe04.ey.com&quot; );
//service.AutodiscoverUrl(&quot;https://xdtd01.ey.net/EWS/Exchange.asmx&quot;);
//service.AutodiscoverUrl(&quot;Balasubramanian.C@xe04.ey.com&quot; );
//service.Url = new Uri(&quot;https://xdtd01.ey.net/EWS/Exchange.asmx&quot;);
// service.Url = new Uri(&quot;https://outlook-xi.ey.net/EWS/Exchange.asmx&quot;);
//service.AutodiscoverUrl(userEmailAddress, RedirectionCallback);
//service.AutodiscoverUrl(&quot;Arjun.Lal@xe04.ey.com&quot;, RedirectionCallback);
// Console.WriteLine(&quot;EWS Endpoint: {
    0
}
&quot;, service.Url);
//service.Url = new Uri(&quot;https://outlook-xi.ey.net/ews/Services.wsdl&quot;);
//************************************ /* PropertySet itemProperty = new PropertySet();
itemProperty.RequestedBodyType = BodyType.Text;
itemProperty.Add(ItemSchema.Body);
SearchFilter searchFilter = new SearchFilter.SearchFilterCollection(LogicalOperator.And, new SearchFilter.IsEqualTo(EmailMessageSchema.IsRead, false));
PropertySet FindItemPropertySet = new PropertySet(BasePropertySet.IdOnly);
ItemView view = new ItemView(999);
// view.PropertySet = FindItemPropertySet;
PropertySet GetItemsPropertySet = new PropertySet(BasePropertySet.FirstClassProperties);
GetItemsPropertySet.RequestedBodyType = BodyType.Text;
FindItemsResults&lt;Item&gt; emailMessages = null;
do {
    emailMessages = service.FindItems(WellKnownFolderName.Inbox, searchFilter, view);
    if (emailMessages.Items.Count &gt; 0) {
        service.LoadPropertiesForItems(emailMessages.Items, GetItemsPropertySet);
        foreach (Item Item in emailMessages.Items) {
            Console.WriteLine(Item.Body.Text);
        }

}

}
while (emailMessages.MoreAvailable);
*/ /* IsEqualTo restriction = new IsEqualTo(MessagePropertyPath.IsRead, false);
FindItemResponse response = service.FindItem(StandardFolder.Inbox, MessagePropertyPath.AllPropertyPaths, restriction);
*/ PropertySet itempropertyset = new PropertySet(BasePropertySet.FirstClassProperties);
itempropertyset.RequestedBodyType = BodyType.Text;
ItemView itemview = new ItemView(1000);
itemview.PropertySet = itempropertyset;
//FindItemsResults&lt;Item&gt; findResults = service.FindItems(WellKnownFolderName.Inbox, &quot;subject:TODO&quot;, itemview);
//FindItemsResults&lt;Item&gt; findResults = service.FindItems(WellKnownFolderName.Inbox, &quot;Subject:Fwd: THESIS PRESENTATION&quot;, new ItemView( 1000 ));
/**/ // SearchFilter sf = new SearchFilter.SearchFilterCollection(LogicalOperator.And, new SearchFilter.IsEqualTo(EmailMessageSchema.IsRead, false));
/* FindItemsResults&lt;Item&gt; findResults = service.FindItems( WellKnownFolderName.Inbox, new ItemView( 10 ));
*/ FindItemsResults&lt;Item&gt; findResults = service.FindItems(WellKnownFolderName.Inbox, sf, new ItemView(1000));
//Item item = findResults.FirstOrDefault();
//Item item = findResults.Item;
//_________________________________ //___________________________________ foreach ( Item item in findResults.Items ) {
    EmailMessage mes = (EmailMessage)item;
    from_m=mes.Sender.Name;
    item.Load(itempropertyset);
    //Console.WriteLine(item.Body);
    body_h=item.Body;
    sub=item.Subject;
    asub=sub;
    //if( sub==&quot;Fwd: THESIS PRESENTATION&quot;) {
        body_h=item.Body;
        row = table.NewRow();
        //row[&quot;Subject&quot;] = body_h;
        row[&quot;Subject&quot;] =sub;
        row[&quot;Sender&quot;] =from_m;
        row[&quot;Body&quot;] =body_h;
        table.Rows.Add(row);
    }

}
Call3=table;"
                            data-title="Mail-EWS / unread mails / Code4">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>Millicom - Collection Utility</td>
                <td>Copy SubString</td>
                <td>Generate Sub Field</td>
                <td>csharp</td>
                <td>143</td>
                <!--<td style="font-family: monospace;">8088eedea01f1d911852c45b157a3e42756829b00d143cd449ccfbc8463a2f87</td>-->
                <td>—</td>
                <!--<td>// Validate Key_Column is in collection. if(!Collection.Columns.Contains(Key_Column)) throw new Exception(&quot;Collection does not contain key column &#x27;&quot; + Key_Column + &quot;&#x27;.&quot;); else if(!Collection.Columns.Contains(Destination_Column)) throw new Exception(&quot;Destination Column does not contain the field &#x27;&quot; +...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="// Validate Key_Column is in collection. if(!Collection.Columns.Contains(Key_Column)) throw new Exception(&quot;Collection does not contain key column &#x27;&quot; + Key_Column + &quot;&#x27;.&quot;);
else if(!Collection.Columns.Contains(Destination_Column)) throw new Exception(&quot;Destination Column does not contain the field &#x27;&quot; + Destination_Column + &quot;&#x27;.&quot;);
// Create Output Collection DataTable temp = new DataTable();
foreach(DataColumn Column in Collection.Columns) {
    temp.Columns.Add(Column.ColumnName, Column.DataType);
}
// Cycle through the collection and add the value. foreach(DataRow Row in Collection.Rows) {
    if ((Fill_Only_Empty &amp;&amp; (Row[Destination_Column].ToString() == &quot;&quot;)) || !Fill_Only_Empty) {
        if (Values_Like.Length &gt; 0) {
            if(Row[Key_Column].ToString().Trim().Contains(Values_Like)) {
                if (Starts_With.Length &gt; 0) {
                    if(Row[Key_Column].ToString().Trim().StartsWith(Starts_With)) {
                        if (Starts_Without.Length &gt; 0) {
                            if(!Row[Key_Column].ToString().Trim().StartsWith(Starts_Without)) {
                                if (Values_not_Like.Length &gt; 0) {
                                    if(!Row[Key_Column].ToString().Trim().Contains(Values_not_Like)) Row[Destination_Column] = Row[Key_Column].ToString().Trim().Substring(Decimal.ToInt32(Initial_Char_Position),Decimal.ToInt32(String_Len));
                                }
                            else
                            {
                                Row[Destination_Column] = Row[Key_Column].ToString().Trim().Substring(Decimal.ToInt32(Initial_Char_Position),Decimal.ToInt32(String_Len));
                            }

                    }

            }
        else
        {
            if (Values_not_Like.Length &gt; 0) {
                if(!Row[Key_Column].ToString().Trim().Contains(Values_not_Like)) Row[Destination_Column] = Row[Key_Column].ToString().Trim().Substring(Decimal.ToInt32(Initial_Char_Position),Decimal.ToInt32(String_Len));
            }
        else
        {
            Row[Destination_Column] = Row[Key_Column].ToString().Trim().Substring(Decimal.ToInt32(Initial_Char_Position),Decimal.ToInt32(String_Len));
        }

}

}

}
else
{
    if (Starts_Without.Length &gt; 0) {
        if(!Row[Key_Column].ToString().Trim().StartsWith(Starts_Without)) {
            if (Values_not_Like.Length &gt; 0) {
                if(!Row[Key_Column].ToString().Trim().Contains(Values_not_Like)) Row[Destination_Column] = Row[Key_Column].ToString().Trim().Substring(Decimal.ToInt32(Initial_Char_Position),Decimal.ToInt32(String_Len));
            }
        else
        {
            Row[Destination_Column] = Row[Key_Column].ToString().Trim().Substring(Decimal.ToInt32(Initial_Char_Position),Decimal.ToInt32(String_Len));
        }

}

}
else
{
    if (Values_not_Like.Length &gt; 0) {
        if(!Row[Key_Column].ToString().Trim().Contains(Values_not_Like)) Row[Destination_Column] = Row[Key_Column].ToString().Trim().Substring(Decimal.ToInt32(Initial_Char_Position),Decimal.ToInt32(String_Len));
    }
else
{
    Row[Destination_Column] = Row[Key_Column].ToString().Trim().Substring(Decimal.ToInt32(Initial_Char_Position),Decimal.ToInt32(String_Len));
}

}

}

}

}
else
{
    if (Starts_With.Length &gt; 0) {
        if(Row[Key_Column].ToString().Trim().StartsWith(Starts_With)) {
            if (Starts_Without.Length &gt; 0) {
                if(!Row[Key_Column].ToString().Trim().StartsWith(Starts_Without)) {
                    if (Values_not_Like.Length &gt; 0) {
                        if(!Row[Key_Column].ToString().Trim().Contains(Values_not_Like)) Row[Destination_Column] = Row[Key_Column].ToString().Trim().Substring(Decimal.ToInt32(Initial_Char_Position),Decimal.ToInt32(String_Len));
                    }
                else
                {
                    Row[Destination_Column] = Row[Key_Column].ToString().Trim().Substring(Decimal.ToInt32(Initial_Char_Position),Decimal.ToInt32(String_Len));
                }

        }

}
else
{
    if (Values_not_Like.Length &gt; 0) {
        if(!Row[Key_Column].ToString().Trim().Contains(Values_not_Like)) Row[Destination_Column] = Row[Key_Column].ToString().Trim().Substring(Decimal.ToInt32(Initial_Char_Position),Decimal.ToInt32(String_Len));
    }
else
{
    Row[Destination_Column] = Row[Key_Column].ToString().Trim().Substring(Decimal.ToInt32(Initial_Char_Position),Decimal.ToInt32(String_Len));
}

}

}

}
else
{
    if (Starts_Without.Length &gt; 0) {
        if(!Row[Key_Column].ToString().Trim().StartsWith(Starts_Without)) {
            if (Values_not_Like.Length &gt; 0) {
                if(!Row[Key_Column].ToString().Trim().Contains(Values_not_Like)) Row[Destination_Column] = Row[Key_Column].ToString().Trim().Substring(Decimal.ToInt32(Initial_Char_Position),Decimal.ToInt32(String_Len));
            }
        else
        {
            Row[Destination_Column] = Row[Key_Column].ToString().Trim().Substring(Decimal.ToInt32(Initial_Char_Position),Decimal.ToInt32(String_Len));
        }

}

}
else
{
    if (Values_not_Like.Length &gt; 0) {
        if(!Row[Key_Column].ToString().Trim().Contains(Values_not_Like)) Row[Destination_Column] = Row[Key_Column].ToString().Trim().Substring(Decimal.ToInt32(Initial_Char_Position),Decimal.ToInt32(String_Len));
    }
else
{
    Row[Destination_Column] = Row[Key_Column].ToString().Trim().Substring(Decimal.ToInt32(Initial_Char_Position),Decimal.ToInt32(String_Len));
}

}

}

}

}
DataRow New_Row = temp.NewRow();
foreach(DataColumn dColumn in Collection.Columns) {
    New_Row[dColumn.ColumnName] = Row[dColumn.ColumnName];
}
temp.Rows.Add(New_Row);
}
New_Collection = temp;"
                            data-title="Millicom - Collection Utility / Copy SubString / Generate Sub Field">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>Millicom - Collection Utility</td>
                <td>Distinct</td>
                <td>Distinct</td>
                <td>csharp</td>
                <td>24</td>
                <!--<td style="font-family: monospace;">9150378cdbfba3653c2d7a6869ca2ce44d402749d7eb9397fae498843da1360d</td>-->
                <td>—</td>
                <!--<td>// Validate Key_Column is in collection. if(!Collection.Columns.Contains(Key_Column)) throw new Exception(&quot;Collection does not contain key column &#x27;&quot; + Key_Column + &quot;&#x27;.&quot;); DataView view = new DataView(Collection); DataTable UniqueValues = view.ToTable(true,Key_Column); DataTable dt = new DataTable();...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="// Validate Key_Column is in collection. if(!Collection.Columns.Contains(Key_Column)) throw new Exception(&quot;Collection does not contain key column &#x27;&quot; + Key_Column + &quot;&#x27;.&quot;);
DataView view = new DataView(Collection);
DataTable UniqueValues = view.ToTable(true,Key_Column);
DataTable dt = new DataTable();
dt.Columns.Add(Key_Column, typeof(string));
dt.Columns.Add(&quot;Count&quot;, typeof(int));
int count;
Count_Distinct = 0;
// Cycle through the collection and add the value. foreach(DataRow UniqueRow in UniqueValues.Rows) {
    count = 0;
    foreach(DataRow Row in Collection.Rows) {
        if(String.Equals(Row[Key_Column].ToString(), UniqueRow[Key_Column].ToString())) {
            count += 1;
        }

}
Count_Distinct += 1;
// Add item. DataRow FinalRow = dt.NewRow();
FinalRow.ItemArray = new object[] {
    UniqueRow[Key_Column].ToString(), count
}
dt.Rows.Add(FinalRow);
}
Distinct = dt;"
                            data-title="Millicom - Collection Utility / Distinct / Distinct">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>Millicom - Collection Utility</td>
                <td>Get Aggregate Functions</td>
                <td>Get Aggregate Functions</td>
                <td>csharp</td>
                <td>28</td>
                <!--<td style="font-family: monospace;">99a43067628667721df905a4196e4e91be0c72883eb3beaa5bc76f75afab7cdb</td>-->
                <td>—</td>
                <!--<td>// Validate Key_Field is in collection. if(!Collection.Columns.Contains(Key_Field)) throw new Exception(&quot;Collection does not contain key field &#x27;&quot; + Key_Field + &quot;&#x27;.&quot;); Warning = &quot;Error validating Field name &#x27;&quot; + Key_Field + &quot;&#x27;.&quot;; decimal temp_sum = 0; decimal temp_count = 0; decimal temp_avg = 0; dec...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="// Validate Key_Field is in collection. if(!Collection.Columns.Contains(Key_Field)) throw new Exception(&quot;Collection does not contain key field &#x27;&quot; + Key_Field + &quot;&#x27;.&quot;);
Warning = &quot;Error validating Field name &#x27;&quot; + Key_Field + &quot;&#x27;.&quot;;
decimal temp_sum = 0;
decimal temp_count = 0;
decimal temp_avg = 0;
decimal minValue = decimal.MaxValue;
decimal maxValue = decimal.MinValue;
decimal temp = 0;
Warning = &quot;&quot;;
// Cycle through the collection and add the value. foreach(DataRow Row in Collection.Rows) {
    try {
        temp_sum += decimal.Parse(Row[Key_Field].ToString());
        temp = decimal.Parse(Row[Key_Field].ToString());
        minValue = Math.Min(minValue, temp);
        maxValue = Math.Max(maxValue, temp);
    }
catch(FormatException) {
    Warning = &quot;One or more rows has not a number value.&quot;;
}
temp_count+= 1;
}
// AVG calculation if(temp_count &gt; 0) temp_avg = temp_sum / temp_count;
else temp_avg = 0;
// ASIGN FINAL RESULT Count = Int32.Parse(temp_count.ToString());
Sum = decimal.Parse(temp_sum.ToString());
Avg = decimal.Parse(temp_avg.ToString());
Min = decimal.Parse(minValue.ToString());
Max = decimal.Parse(maxValue.ToString());"
                            data-title="Millicom - Collection Utility / Get Aggregate Functions / Get Aggregate Functions">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>Millicom - Collection Utility</td>
                <td>Group By</td>
                <td>Group by</td>
                <td>csharp</td>
                <td>47</td>
                <!--<td style="font-family: monospace;">e847232eed2c3942f1ffadeeeeab256e6ce91f7a11288778020a6cf79725c883</td>-->
                <td>—</td>
                <!--<td>// Validate Key_Column is in collection. if(!Collection.Columns.Contains(Key_Column)) throw new Exception(&quot;Collection does not contain key column &#x27;&quot; + Key_Column + &quot;&#x27;.&quot;); // Validate Field_to_Sum is in collection. if(!Collection.Columns.Contains(Field_to_Calculate)) throw new Exception(&quot;Collection d...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="// Validate Key_Column is in collection. if(!Collection.Columns.Contains(Key_Column)) throw new Exception(&quot;Collection does not contain key column &#x27;&quot; + Key_Column + &quot;&#x27;.&quot;);
// Validate Field_to_Sum is in collection. if(!Collection.Columns.Contains(Field_to_Calculate)) throw new Exception(&quot;Collection does not contain Field to sum &#x27;&quot; + Field_to_Calculate + &quot;&#x27;.&quot;);
DataView view = new DataView(Collection);
DataTable UniqueValues = view.ToTable(true,Key_Column);
DataTable dt = new DataTable();
dt.Columns.Add(Key_Column, typeof(string));
dt.Columns.Add(&quot;Count&quot;, typeof(int));
dt.Columns.Add(&quot;Sum&quot;, typeof(decimal));
dt.Columns.Add(&quot;Avg&quot;, typeof(decimal));
dt.Columns.Add(&quot;Min&quot;, typeof(decimal));
dt.Columns.Add(&quot;Max&quot;, typeof(decimal));
int count;
decimal sum;
decimal avg;
decimal min;
decimal max;
decimal value;
// Cycle through the collection and add the value. foreach(DataRow UniqueRow in UniqueValues.Rows) {
    sum = 0;
    value = 0;
    avg = 0;
    count = 0;
    min = decimal.MaxValue;
    max = decimal.MinValue;
    foreach(DataRow Row in Collection.Rows) {
        if(String.Equals(Row[Key_Column].ToString(), UniqueRow[Key_Column].ToString())) {
            try {
                sum += decimal.Parse(Row[Field_to_Calculate].ToString());
                value = decimal.Parse(Row[Field_to_Calculate].ToString());
                min = Math.Min(min, value);
                max = Math.Max(max, value);
            }
        catch(FormatException) {
            // Nothing to do here yet.
        }
    count += 1;
}

}
// calculate avg if(count &gt; 0) avg = sum / count;
// Add item. DataRow FinalRow = dt.NewRow();
FinalRow.ItemArray = new object[] {
    UniqueRow[Key_Column].ToString(), count, sum, avg, min, max
}
dt.Rows.Add(FinalRow);
}
Group_By = dt;"
                            data-title="Millicom - Collection Utility / Group By / Group by">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>Millicom - Collection Utility</td>
                <td>IN Operator</td>
                <td>IN operator</td>
                <td>csharp</td>
                <td>26</td>
                <!--<td style="font-family: monospace;">5656ebb4c93ae3bf90454e51c77d4ac2da0f0e50998ddf04241fe9bc0bd5367d</td>-->
                <td>—</td>
                <!--<td>// Build the Collection_Out columns and validate Key_Field is in both collections. if(!Collection.Columns.Contains(Key_Field)) throw new Exception(&quot;Collection does not contain the field &#x27;&quot; + Key_Field + &quot;&#x27;.&quot;); else if(!IN_Collection.Columns.Contains(IN_Field)) throw new Exception(&quot;IN Collection does...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="// Build the Collection_Out columns and validate Key_Field is in both collections. if(!Collection.Columns.Contains(Key_Field)) throw new Exception(&quot;Collection does not contain the field &#x27;&quot; + Key_Field + &quot;&#x27;.&quot;);
else if(!IN_Collection.Columns.Contains(IN_Field)) throw new Exception(&quot;IN Collection does not contain the field &#x27;&quot; + IN_Field + &quot;&#x27;.&quot;);
DataTable temp = new DataTable();
foreach(DataColumn Column in Collection.Columns) {
    temp.Columns.Add(Column.ColumnName, Column.DataType);
}
// Cycle through the left collection and add any associated information from the right collection. foreach(DataRow OuterRow in Collection.Rows) {
    DataRow[] MatchingRows = IN_Collection.Select(&quot;[&quot; + IN_Field + &quot;] = &#x27;&quot; + OuterRow[Key_Field] + &quot;&#x27;&quot;);
    if(MatchingRows.Length &gt; 0) {
        foreach(DataRow Match in MatchingRows) {
            DataRow New_Row = temp.NewRow();
            foreach(DataColumn dColumn in Collection.Columns) {
                New_Row[dColumn.ColumnName] = OuterRow[dColumn.ColumnName];
            }
        temp.Rows.Add(New_Row);
        break;
    }

}
else
{
    // Empty space due IN operator logic
}

}
Collection_Out = temp;"
                            data-title="Millicom - Collection Utility / IN Operator / IN operator">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>Millicom - Collection Utility</td>
                <td>Join</td>
                <td>Join</td>
                <td>csharp</td>
                <td>37</td>
                <!--<td style="font-family: monospace;">e224592f5471c4af7f95051663c31bb2c8bca64acef8dbe5e2493fa3c4b060e1</td>-->
                <td>—</td>
                <!--<td>// Build the Collection_Out columns and validate Key_Field is in both collections. if(!Left_Collection.Columns.Contains(Key_Field)) throw new Exception(&quot;Left Collection does not contain the field &#x27;&quot; + Key_Field + &quot;&#x27;.&quot;); else if(!Right_Collection.Columns.Contains(Key_Field)) throw new Exception(&quot;Righ...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="// Build the Collection_Out columns and validate Key_Field is in both collections. if(!Left_Collection.Columns.Contains(Key_Field)) throw new Exception(&quot;Left Collection does not contain the field &#x27;&quot; + Key_Field + &quot;&#x27;.&quot;);
else if(!Right_Collection.Columns.Contains(Key_Field)) throw new Exception(&quot;Right Collection does not contain the field &#x27;&quot; + Key_Field + &quot;&#x27;.&quot;);
DataTable temp = new DataTable();
foreach(DataColumn Column in Left_Collection.Columns) {
    temp.Columns.Add(Column.ColumnName, Column.DataType);
}
foreach(DataColumn Column in Right_Collection.Columns) {
    if(Column.ColumnName == Key_Field) {
        // Do Nothing
    }
else if(temp.Columns.Contains(Column.ColumnName)) {
    throw new Exception(&quot;Collections contain non-key duplicate field (&#x27;&quot; + Column.ColumnName + &quot;&#x27;).&quot;);
}
else temp.Columns.Add(Column.ColumnName, Column.DataType);
}
// Cycle through the left collection and add any associated information from the right collection. foreach(DataRow OuterRow in Left_Collection.Rows) {
    DataRow[] MatchingRows = Right_Collection.Select(&quot;[&quot; + Key_Field + &quot;] = &#x27;&quot; + OuterRow[Key_Field] + &quot;&#x27;&quot;);
    if(MatchingRows.Length &gt; 0) {
        foreach(DataRow Match in MatchingRows) {
            DataRow New_Row = temp.NewRow();
            foreach(DataColumn dColumn in Left_Collection.Columns) {
                New_Row[dColumn.ColumnName] = OuterRow[dColumn.ColumnName];
            }
        foreach(DataColumn dColumn in Right_Collection.Columns) {
            New_Row[dColumn.ColumnName] = Match[dColumn.ColumnName];
        }
    temp.Rows.Add(New_Row);
}

}
else
{
    // Empty space due to JOIN logic
}

}
Collection_Out = temp;"
                            data-title="Millicom - Collection Utility / Join / Join">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>Millicom - Collection Utility</td>
                <td>Left Outer Join</td>
                <td>Left Outer Join</td>
                <td>csharp</td>
                <td>41</td>
                <!--<td style="font-family: monospace;">b25a12266f66b4874e347ab69da029e3beb7a7326594c0f407c824b9416bbfc2</td>-->
                <td>—</td>
                <!--<td>// Build the Collection_Out columns and validate Key_Field is in both collections. if(!Left_Collection.Columns.Contains(Key_Field)) throw new Exception(&quot;Left Collection does not contain the field &#x27;&quot; + Key_Field + &quot;&#x27;.&quot;); else if(!Right_Collection.Columns.Contains(Key_Field)) throw new Exception(&quot;Righ...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="// Build the Collection_Out columns and validate Key_Field is in both collections. if(!Left_Collection.Columns.Contains(Key_Field)) throw new Exception(&quot;Left Collection does not contain the field &#x27;&quot; + Key_Field + &quot;&#x27;.&quot;);
else if(!Right_Collection.Columns.Contains(Key_Field)) throw new Exception(&quot;Right Collection does not contain the field &#x27;&quot; + Key_Field + &quot;&#x27;.&quot;);
DataTable temp = new DataTable();
foreach(DataColumn Column in Left_Collection.Columns) {
    temp.Columns.Add(Column.ColumnName, Column.DataType);
}
foreach(DataColumn Column in Right_Collection.Columns) {
    if(Column.ColumnName == Key_Field) {
        // Do Nothing
    }
else if(temp.Columns.Contains(Column.ColumnName)) {
    throw new Exception(&quot;Collections contain non-key duplicate field (&#x27;&quot; + Column.ColumnName + &quot;&#x27;).&quot;);
}
else temp.Columns.Add(Column.ColumnName, Column.DataType);
}
// Cycle through the left collection and add any associated information from the right collection. foreach(DataRow OuterRow in Left_Collection.Rows) {
    DataRow[] MatchingRows = Right_Collection.Select(&quot;[&quot; + Key_Field + &quot;] = &#x27;&quot; + OuterRow[Key_Field] + &quot;&#x27;&quot;);
    if(MatchingRows.Length &gt; 0) {
        foreach(DataRow Match in MatchingRows) {
            DataRow New_Row = temp.NewRow();
            foreach(DataColumn dColumn in Left_Collection.Columns) {
                New_Row[dColumn.ColumnName] = OuterRow[dColumn.ColumnName];
            }
        foreach(DataColumn dColumn in Right_Collection.Columns) {
            New_Row[dColumn.ColumnName] = Match[dColumn.ColumnName];
        }
    temp.Rows.Add(New_Row);
}

}
else
{
    // No matching rows, but since it&#x27;s an outer join, append the left row. DataRow New_Row = temp.NewRow();
    foreach(DataColumn dColumn in Left_Collection.Columns) {
        New_Row[dColumn.ColumnName] = OuterRow[dColumn.ColumnName];
    }
temp.Rows.Add(New_Row);
}

}
Collection_Out = temp;"
                            data-title="Millicom - Collection Utility / Left Outer Join / Left Outer Join">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>Millicom - Collection Utility</td>
                <td>NOT IN Operator</td>
                <td>NOT IN operator</td>
                <td>csharp</td>
                <td>22</td>
                <!--<td style="font-family: monospace;">6f5e9fef0358b22b08812b656d328c309a63ac1f2f0dd681295bdb9dc796bccd</td>-->
                <td>—</td>
                <!--<td>// Build the Collection_Out columns and validate Key_Field is in both collections. if(!Collection.Columns.Contains(Key_Field)) throw new Exception(&quot;Collection does not contain the field &#x27;&quot; + Key_Field + &quot;&#x27;.&quot;); else if(!NOT_IN_Collection.Columns.Contains(NOT_IN_Field)) throw new Exception(&quot;NOT IN Col...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="// Build the Collection_Out columns and validate Key_Field is in both collections. if(!Collection.Columns.Contains(Key_Field)) throw new Exception(&quot;Collection does not contain the field &#x27;&quot; + Key_Field + &quot;&#x27;.&quot;);
else if(!NOT_IN_Collection.Columns.Contains(NOT_IN_Field)) throw new Exception(&quot;NOT IN Collection does not contain the field &#x27;&quot; + NOT_IN_Field + &quot;&#x27;.&quot;);
DataTable temp = new DataTable();
foreach(DataColumn Column in Collection.Columns) {
    temp.Columns.Add(Column.ColumnName, Column.DataType);
}
// Cycle through the left collection and add any associated information from the right collection. foreach(DataRow OuterRow in Collection.Rows) {
    DataRow[] MatchingRows = NOT_IN_Collection.Select(&quot;[&quot; + NOT_IN_Field + &quot;] = &#x27;&quot; + OuterRow[Key_Field] + &quot;&#x27;&quot;);
    if(MatchingRows.Length &gt; 0) {
        // Empty space due NOT IN operator logic.
    }
else
{
    DataRow New_Row = temp.NewRow();
    foreach(DataColumn dColumn in Collection.Columns) {
        New_Row[dColumn.ColumnName] = OuterRow[dColumn.ColumnName];
    }
temp.Rows.Add(New_Row);
}

}
Collection_Out = temp;"
                            data-title="Millicom - Collection Utility / NOT IN Operator / NOT IN operator">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>Millicom - Collection Utility</td>
                <td>Replace Value</td>
                <td>Replace Value</td>
                <td>csharp</td>
                <td>276</td>
                <!--<td style="font-family: monospace;">5bdbf8735dd4b1a468e851e831657da0f97c729fbc9ec38c703153f836b78c17</td>-->
                <td>—</td>
                <!--<td>// Validate Key_Column is in collection. if(!Collection.Columns.Contains(Key_Column)) throw new Exception(&quot;Collection does not contain key column &#x27;&quot; + Key_Column + &quot;&#x27;.&quot;); else if(!Collection.Columns.Contains(Destination_Column)) throw new Exception(&quot;Destination Column does not contain the field &#x27;&quot; +...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="// Validate Key_Column is in collection. if(!Collection.Columns.Contains(Key_Column)) throw new Exception(&quot;Collection does not contain key column &#x27;&quot; + Key_Column + &quot;&#x27;.&quot;);
else if(!Collection.Columns.Contains(Destination_Column)) throw new Exception(&quot;Destination Column does not contain the field &#x27;&quot; + Destination_Column + &quot;&#x27;.&quot;);
// Create Output Collection DataTable temp = new DataTable();
foreach(DataColumn Column in Collection.Columns) {
    temp.Columns.Add(Column.ColumnName, Column.DataType);
}
// Cycle through the collection and add the value. foreach(DataRow Row in Collection.Rows) {
    if (Values_Like.Length &gt; 0) {
        if(Row[Key_Column].ToString().Trim().Contains(Values_Like)) {
            if (Starts_With.Length &gt; 0) {
                if(Row[Key_Column].ToString().Trim().StartsWith(Starts_With)) {
                    if (Starts_Without.Length &gt; 0) {
                        if(!Row[Key_Column].ToString().Trim().StartsWith(Starts_Without)) {
                            if (Values_not_Like.Length &gt; 0) {
                                if(!Row[Key_Column].ToString().Trim().Contains(Values_not_Like)) {
                                    if (Full_Replace) {
                                        Row[Destination_Column] = New_Text;
                                    }
                                else
                                {
                                    Row[Destination_Column] = Row[Key_Column].ToString().Trim().Replace(Text_to_Replace,New_Text);
                                }

                        }

                }
            else
            {
                if (Full_Replace) {
                    Row[Destination_Column] = New_Text;
                }
            else
            {
                Row[Destination_Column] = Row[Key_Column].ToString().Trim().Replace(Text_to_Replace,New_Text);
            }

    }

}

}
else
{
    if (Values_not_Like.Length &gt; 0) {
        if(!Row[Key_Column].ToString().Trim().Contains(Values_not_Like)) {
            if (Full_Replace) {
                Row[Destination_Column] = New_Text;
            }
        else
        {
            Row[Destination_Column] = Row[Key_Column].ToString().Trim().Replace(Text_to_Replace,New_Text);
        }

}

}
else
{
    if (Full_Replace) {
        Row[Destination_Column] = New_Text;
    }
else
{
    Row[Destination_Column] = Row[Key_Column].ToString().Trim().Replace(Text_to_Replace,New_Text);
}

}

}

}

}
else
{
    if (Starts_Without.Length &gt; 0) {
        if(!Row[Key_Column].ToString().Trim().StartsWith(Starts_Without)) {
            if (Values_not_Like.Length &gt; 0) {
                if(!Row[Key_Column].ToString().Trim().Contains(Values_not_Like)) {
                    if (Full_Replace) {
                        Row[Destination_Column] = New_Text;
                    }
                else
                {
                    Row[Destination_Column] = Row[Key_Column].ToString().Trim().Replace(Text_to_Replace,New_Text);
                }

        }

}
else
{
    if (Full_Replace) {
        Row[Destination_Column] = New_Text;
    }
else
{
    Row[Destination_Column] = Row[Key_Column].ToString().Trim().Replace(Text_to_Replace,New_Text);
}

}

}

}
else
{
    if (Values_not_Like.Length &gt; 0) {
        if(!Row[Key_Column].ToString().Trim().Contains(Values_not_Like)) {
            if (Full_Replace) {
                Row[Destination_Column] = New_Text;
            }
        else
        {
            Row[Destination_Column] = Row[Key_Column].ToString().Trim().Replace(Text_to_Replace,New_Text);
        }

}

}
else
{
    if (Full_Replace) {
        Row[Destination_Column] = New_Text;
    }
else
{
    Row[Destination_Column] = Row[Key_Column].ToString().Trim().Replace(Text_to_Replace,New_Text);
}

}

}

}

}

}
else
{
    if (Starts_With.Length &gt; 0) {
        if(Row[Key_Column].ToString().Trim().StartsWith(Starts_With)) {
            if (Starts_Without.Length &gt; 0) {
                if(!Row[Key_Column].ToString().Trim().StartsWith(Starts_Without)) {
                    if (Values_not_Like.Length &gt; 0) {
                        if(!Row[Key_Column].ToString().Trim().Contains(Values_not_Like)) {
                            if (Full_Replace) {
                                Row[Destination_Column] = New_Text;
                            }
                        else
                        {
                            Row[Destination_Column] = Row[Key_Column].ToString().Trim().Replace(Text_to_Replace,New_Text);
                        }

                }

        }
    else
    {
        if (Full_Replace) {
            Row[Destination_Column] = New_Text;
        }
    else
    {
        Row[Destination_Column] = Row[Key_Column].ToString().Trim().Replace(Text_to_Replace,New_Text);
    }

}

}

}
else
{
    if (Values_not_Like.Length &gt; 0) {
        if(!Row[Key_Column].ToString().Trim().Contains(Values_not_Like)) {
            if (Full_Replace) {
                Row[Destination_Column] = New_Text;
            }
        else
        {
            Row[Destination_Column] = Row[Key_Column].ToString().Trim().Replace(Text_to_Replace,New_Text);
        }

}

}
else
{
    if (Full_Replace) {
        Row[Destination_Column] = New_Text;
    }
else
{
    Row[Destination_Column] = Row[Key_Column].ToString().Trim().Replace(Text_to_Replace,New_Text);
}

}

}

}

}
else
{
    if (Starts_Without.Length &gt; 0) {
        if(!Row[Key_Column].ToString().Trim().StartsWith(Starts_Without)) {
            if (Values_not_Like.Length &gt; 0) {
                if(!Row[Key_Column].ToString().Trim().Contains(Values_not_Like)) {
                    if (Full_Replace) {
                        Row[Destination_Column] = New_Text;
                    }
                else
                {
                    Row[Destination_Column] = Row[Key_Column].ToString().Trim().Replace(Text_to_Replace,New_Text);
                }

        }

}
else
{
    if (Full_Replace) {
        Row[Destination_Column] = New_Text;
    }
else
{
    Row[Destination_Column] = Row[Key_Column].ToString().Trim().Replace(Text_to_Replace,New_Text);
}

}

}

}
else
{
    if (Values_not_Like.Length &gt; 0) {
        if(!Row[Key_Column].ToString().Trim().Contains(Values_not_Like)) {
            if (Full_Replace) {
                Row[Destination_Column] = New_Text;
            }
        else
        {
            Row[Destination_Column] = Row[Key_Column].ToString().Trim().Replace(Text_to_Replace,New_Text);
        }

}

}
else
{
    if (Full_Replace) {
        Row[Destination_Column] = New_Text;
    }
else
{
    Row[Destination_Column] = Row[Key_Column].ToString().Trim().Replace(Text_to_Replace,New_Text);
}

}

}

}

}
DataRow New_Row = temp.NewRow();
foreach(DataColumn dColumn in Collection.Columns) {
    New_Row[dColumn.ColumnName] = Row[dColumn.ColumnName];
}
temp.Rows.Add(New_Row);
}
New_Collection = temp;"
                            data-title="Millicom - Collection Utility / Replace Value / Replace Value">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>Millicom - Collection Utility</td>
                <td>Select one of two Fields</td>
                <td>Select one of two fields</td>
                <td>csharp</td>
                <td>19</td>
                <!--<td style="font-family: monospace;">6d4b2359bc2160016d913ca24a8f1533222a967fd6905a1b7f951570f4647d40</td>-->
                <td>—</td>
                <!--<td>// Validate Key_Column is in collection. if(!Collection.Columns.Contains(Column_1)) throw new Exception(&quot;Collection does not contain key column &#x27;&quot; + Column_1 + &quot;&#x27;.&quot;); if(!Collection.Columns.Contains(Column_2)) throw new Exception(&quot;Collection does not contain key column &#x27;&quot; + Column_2 + &quot;&#x27;.&quot;); if(!Col...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="// Validate Key_Column is in collection. if(!Collection.Columns.Contains(Column_1)) throw new Exception(&quot;Collection does not contain key column &#x27;&quot; + Column_1 + &quot;&#x27;.&quot;);
if(!Collection.Columns.Contains(Column_2)) throw new Exception(&quot;Collection does not contain key column &#x27;&quot; + Column_2 + &quot;&#x27;.&quot;);
if(!Collection.Columns.Contains(Destination_Column)) throw new Exception(&quot;Destination Column does not contain the field &#x27;&quot; + Destination_Column + &quot;&#x27;.&quot;);
// Create Output Collection DataTable temp = new DataTable();
foreach(DataColumn Column in Collection.Columns) {
    temp.Columns.Add(Column.ColumnName, Column.DataType);
}
// Cycle through the collection and add the value. foreach(DataRow Row in Collection.Rows) {
    if ((Fill_Only_Empty &amp;&amp; (Row[Destination_Column].ToString() == &quot;&quot;)) || !Fill_Only_Empty) {
        if (Row[Column_1].ToString().Trim() != &quot;&quot;) Row[Destination_Column] = Row[Column_1].ToString();
        else if (Row[Column_2].ToString().Trim() != &quot;&quot;) Row[Destination_Column] = Row[Column_2].ToString();
    }
DataRow New_Row = temp.NewRow();
foreach(DataColumn dColumn in Collection.Columns) {
    New_Row[dColumn.ColumnName] = Row[dColumn.ColumnName];
}
temp.Rows.Add(New_Row);
}
New_Collection = temp;"
                            data-title="Millicom - Collection Utility / Select one of two Fields / Select one of two fields">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>Millicom - Collection Utility</td>
                <td>VLookUP</td>
                <td>VLookUP</td>
                <td>csharp</td>
                <td>44</td>
                <!--<td style="font-family: monospace;">8bafc3dcd36ba392574f3d18e45e49e7ac5896dd785077654369d0e03ee3bfad</td>-->
                <td>—</td>
                <!--<td>//Validate Fields is in both collections. if(!Collection_1.Columns.Contains(Key_Field_1)) throw new Exception(&quot;&#x27;&quot; + Key_Field_1 + &quot;&#x27; does not exist in Collection 1.&quot;); else if(!Collection_2.Columns.Contains(Key_Field_2)) throw new Exception(&quot;&#x27;&quot; + Key_Field_2 + &quot;&#x27; does not exist in Collection 2.&quot;); e...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="//Validate Fields is in both collections. if(!Collection_1.Columns.Contains(Key_Field_1)) throw new Exception(&quot;&#x27;&quot; + Key_Field_1 + &quot;&#x27; does not exist in Collection 1.&quot;);
else if(!Collection_2.Columns.Contains(Key_Field_2)) throw new Exception(&quot;&#x27;&quot; + Key_Field_2 + &quot;&#x27; does not exist in Collection 2.&quot;);
else if(!Collection_2.Columns.Contains(Field_to_Retrieve)) throw new Exception(&quot;&#x27;&quot; + Field_to_Retrieve + &quot;&#x27; does not exist in Collection 2.&quot;);
// Create Temporary DataTable DataTable temp = new DataTable();
// Copy columns from Collection 1 foreach(DataColumn Column in Collection_1.Columns) {
    temp.Columns.Add(Column.ColumnName, Column.DataType);
}
// Copy columns from Collection 2 foreach(DataColumn Column in Collection_2.Columns) {
    try {
        if(Column.ColumnName == Field_to_Retrieve) temp.Columns.Add(Column.ColumnName, Column.DataType);
    }
catch(Exception e) {

}

}
// Iterate collection 1 and add the field to retrieve from the collection 2. foreach(DataRow OuterRow in Collection_1.Rows) {
    DataRow[] MatchingRows = Collection_2.Select(&quot;[&quot; + Key_Field_2 + &quot;] = &#x27;&quot; + OuterRow[Key_Field_1] + &quot;&#x27;&quot;);
    if(MatchingRows.Length &gt; 0) {
        foreach(DataRow Match in MatchingRows) {
            DataRow New_Row = temp.NewRow();
            foreach(DataColumn dColumn in Collection_1.Columns) {
                New_Row[dColumn.ColumnName] = OuterRow[dColumn.ColumnName];
            }
        foreach(DataColumn dColumn in Collection_2.Columns) {
            if(dColumn.ColumnName == Field_to_Retrieve) New_Row[dColumn.ColumnName] = Match[dColumn.ColumnName];
        }
    temp.Rows.Add(New_Row);
    break;
    // Set values at the first occurrence to avoid duplicates.
}

}
else
{
    DataRow New_Row = temp.NewRow();
    foreach(DataColumn dColumn in Collection_1.Columns) {
        New_Row[dColumn.ColumnName] = OuterRow[dColumn.ColumnName];
    }
temp.Rows.Add(New_Row);
}

}
Collection_Out = temp;"
                            data-title="Millicom - Collection Utility / VLookUP / VLookUP">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>Screenshot</td>
                <td>Screenshot</td>
                <td>Get Screenshot</td>
                <td>csharp</td>
                <td>14</td>
                <!--<td style="font-family: monospace;">d6627056ffd44a5b64c2b8e4c34270ef31fd631548f392bdf06e807ae0b6ef44</td>-->
                <td>—</td>
                <!--<td>try {     Bitmap printscr = new Bitmap(Screen.PrimaryScreen.Bounds.Width, Screen.PrimaryScreen.Bounds.Height, PixelFormat.Format32bppArgb);     Graphics graphics = Graphics.FromImage(printscr as Image);     graphics.CopyFromScreen(0,0,0,0,printscr.Size);     printscr.Save(@Path,ImageFormat.Jpeg);   ...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="try {
    Bitmap printscr = new Bitmap(Screen.PrimaryScreen.Bounds.Width, Screen.PrimaryScreen.Bounds.Height, PixelFormat.Format32bppArgb);
    Graphics graphics = Graphics.FromImage(printscr as Image);
    graphics.CopyFromScreen(0,0,0,0,printscr.Size);
    printscr.Save(@Path,ImageFormat.Jpeg);
    Flag = true;
    Screenshot1 = printscr;
    msg = &quot;Success&quot;;
}
catch(Exception ex) {
    Flag = false;
    msg = ex.ToString();
    Screenshot1 = null;
}"
                            data-title="Screenshot / Screenshot / Get Screenshot">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>UWCA_Balloon_Refinance_CTF_V1.0</td>
                <td>Get Salary Dates</td>
                <td>Get Dates</td>
                <td>visualbasic</td>
                <td>31</td>
                <!--<td style="font-family: monospace;">59adff665d7ee68717ed4bf3f8147ebb360cc7a5959b90a53c75822935a2dd17</td>-->
                <td>sql_keywords, reflection</td>
                <!--<td>Dim HDRString As String = &quot;No&quot; If First_Line_Is_Header Then     HDRSTring = &quot;Yes&quot; End If Dim Folder as String = nothing Dim FileName As String = Nothing Dim Tempdate as Date Dim HijiryColl as DataTable HijiryCollOut.Columns.Add(&quot;Date&quot;,Type.GetType(&quot;System.String&quot;))  &#x27;Read Dates from CSV file and put...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Dim HDRString As String = &quot;No&quot;
If First_Line_Is_Header Then
    HDRSTring = &quot;Yes&quot;
End If
Dim Folder as String = nothing
Dim FileName As String = Nothing
Dim Tempdate as Date
Dim HijiryColl as DataTable HijiryCollOut.Columns.Add(&quot;Date&quot;,Type.GetType(&quot;System.String&quot;))  &#x27;Read Dates from CSV file and put into Hijri collection  Folder = Path.GetDirectoryName(CSV_Location) Filename = Path.GetFileName(CSV_Location) &#x27;
Dim cn As New OleDbConnection(&quot;Provider=Microsoft.Jet.OLEDB.4.0; Data Source=&quot; &amp; Folder &amp; &quot;;Extended Properties=&quot;&quot;Text;HDR=&quot; &amp; HDRString &amp; &quot;;FMT=Delimited&quot;&quot;&quot;)
Dim cn As New OleDbConnection(&quot;Provider=Microsoft.ACE.OLEDB.12.0; Data Source=&quot; &amp; Folder &amp; &quot;;Extended Properties=&quot;&quot;Text;HDR=&quot; &amp; HDRString &amp; &quot;;FMT=Delimited&quot;&quot;&quot;)
Dim da As New OleDbDataAdapter()
Dim ds As New DataSet()
Dim cd As New OleDbCommand(&quot;SELECT * FROM [&quot; &amp; Filename &amp; &quot;]&quot;, cn) cn.Open() da.SelectCommand = cd ds.Clear() da.Fill(ds, &quot;CSV&quot;) HijiryColl = ds.Tables(0) cn.Close()  &#x27;Remove empty rows and the dates which are grater than current date
For i as integer =HijiryColl.Rows.Count-1 to 0 step -1
    if HijiryColl.Rows(i)(&quot;Date&quot;)Is Nothing then
    else           Tempdate=HijiryColl.Rows(i)(&quot;Date&quot;)         if(HijiryColl.Rows(i)(&quot;Date&quot;)&lt; Now())then             HijiryColl.Rows(i)(&quot;Date&quot;)= Tempdate
    else             HijiryColl.Rows.Remove(HijiryColl.Rows(i))
        end
        if
        End
        if
    Next  &#x27; read last four salary dates put into SD1,SD2,SD3 and SD4. add last 3 salary dates to output collection
    If HijiryColl.Rows.Count &gt;4 Then
        HijiryColl.DefaultView.Sort =  &quot;Date DESC&quot;     HijiryColl = HijiryColl.DefaultView.ToTable     SD1=HijiryColl.Rows(0)(&quot;Date&quot;)     SD2=HijiryColl.Rows(1)(&quot;Date&quot;)     SD3=HijiryColl.Rows(2)(&quot;Date&quot;)     SD4=HijiryColl.Rows(3)(&quot;Date&quot;)
    End If
    Dim dr1 as DataRow=HijiryCollOut.NewRow()     dr1(&quot;Date&quot;)=SD1     HijiryCollOut.Rows.Add(dr1)
    Dim dr2 as DataRow=HijiryCollOut.NewRow()     dr2(&quot;Date&quot;)=SD2     HijiryCollOut.Rows.Add(dr2)
    Dim dr3 as DataRow=HijiryCollOut.NewRow()     dr3(&quot;Date&quot;)=SD3     HijiryCollOut.Rows.Add(SD3)     &#x27;
    For i as integer =HijiryColl.Rows.Count-1 to 3 Step -1     &#x27;HijiryColl.Rows.Remove(HijiryColl.Rows(i))     &#x27;
    Next
End If"
                            data-title="UWCA_Balloon_Refinance_CTF_V1.0 / Get Salary Dates / Get Dates">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>UWCA_Balloon_Refinance_CTF_V1.0</td>
                <td>GetOneMonthFull Salary</td>
                <td>Filter Collection1</td>
                <td>visualbasic</td>
                <td>6</td>
                <!--<td style="font-family: monospace;">c923c99415a4cd6045d25f97a6cbb1a13207cdf1baf5dc8c1df087012e26e633</td>-->
                <td>—</td>
                <!--<td>Dim NewRow As DataRow Dim Amount as Decimal =0 Collection_Out = Collection_In.Clone For Each parentRow As DataRow In Collection_In.Select(Select_Condition)     NewRow = Collection_Out.NewRow     For Each c As DataColumn In NewRow.Table.Columns         NewRow(c.ColumnName) = parentRow(c.ColumnName)  ...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Dim NewRow As DataRow
Dim Amount as Decimal =0 Collection_Out = Collection_In.Clone
For Each parentRow As DataRow In Collection_In.Select(Select_Condition)     NewRow = Collection_Out.NewRow
    For Each c As DataColumn In NewRow.Table.Columns         NewRow(c.ColumnName) = parentRow(c.ColumnName)
    Next     Collection_Out.Rows.Add(NewRow)
Next NewRow = Nothing Collection_In = Nothing"
                            data-title="UWCA_Balloon_Refinance_CTF_V1.0 / GetOneMonthFull Salary / Filter Collection1">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>UWCA_Balloon_Refinance_CTF_V1.0</td>
                <td>GetOneMonthFull Salary</td>
                <td>Filter Collection2</td>
                <td>visualbasic</td>
                <td>6</td>
                <!--<td style="font-family: monospace;">c923c99415a4cd6045d25f97a6cbb1a13207cdf1baf5dc8c1df087012e26e633</td>-->
                <td>—</td>
                <!--<td>Dim NewRow As DataRow Dim Amount as Decimal =0 Collection_Out = Collection_In.Clone For Each parentRow As DataRow In Collection_In.Select(Select_Condition)     NewRow = Collection_Out.NewRow     For Each c As DataColumn In NewRow.Table.Columns         NewRow(c.ColumnName) = parentRow(c.ColumnName)  ...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Dim NewRow As DataRow
Dim Amount as Decimal =0 Collection_Out = Collection_In.Clone
For Each parentRow As DataRow In Collection_In.Select(Select_Condition)     NewRow = Collection_Out.NewRow
    For Each c As DataColumn In NewRow.Table.Columns         NewRow(c.ColumnName) = parentRow(c.ColumnName)
    Next     Collection_Out.Rows.Add(NewRow)
Next NewRow = Nothing Collection_In = Nothing"
                            data-title="UWCA_Balloon_Refinance_CTF_V1.0 / GetOneMonthFull Salary / Filter Collection2">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>UWCA_Balloon_Refinance_CTF_V1.0</td>
                <td>GetOneMonthFull Salary</td>
                <td>Filter Collection3</td>
                <td>visualbasic</td>
                <td>6</td>
                <!--<td style="font-family: monospace;">c923c99415a4cd6045d25f97a6cbb1a13207cdf1baf5dc8c1df087012e26e633</td>-->
                <td>—</td>
                <!--<td>Dim NewRow As DataRow Dim Amount as Decimal =0 Collection_Out = Collection_In.Clone For Each parentRow As DataRow In Collection_In.Select(Select_Condition)     NewRow = Collection_Out.NewRow     For Each c As DataColumn In NewRow.Table.Columns         NewRow(c.ColumnName) = parentRow(c.ColumnName)  ...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Dim NewRow As DataRow
Dim Amount as Decimal =0 Collection_Out = Collection_In.Clone
For Each parentRow As DataRow In Collection_In.Select(Select_Condition)     NewRow = Collection_Out.NewRow
    For Each c As DataColumn In NewRow.Table.Columns         NewRow(c.ColumnName) = parentRow(c.ColumnName)
    Next     Collection_Out.Rows.Add(NewRow)
Next NewRow = Nothing Collection_In = Nothing"
                            data-title="UWCA_Balloon_Refinance_CTF_V1.0 / GetOneMonthFull Salary / Filter Collection3">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>UWCA_Balloon_Refinance_CTF_V1.0</td>
                <td>GetOneMonthFull Salary</td>
                <td>Filter Collection5</td>
                <td>visualbasic</td>
                <td>6</td>
                <!--<td style="font-family: monospace;">c923c99415a4cd6045d25f97a6cbb1a13207cdf1baf5dc8c1df087012e26e633</td>-->
                <td>—</td>
                <!--<td>Dim NewRow As DataRow Dim Amount as Decimal =0 Collection_Out = Collection_In.Clone For Each parentRow As DataRow In Collection_In.Select(Select_Condition)     NewRow = Collection_Out.NewRow     For Each c As DataColumn In NewRow.Table.Columns         NewRow(c.ColumnName) = parentRow(c.ColumnName)  ...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Dim NewRow As DataRow
Dim Amount as Decimal =0 Collection_Out = Collection_In.Clone
For Each parentRow As DataRow In Collection_In.Select(Select_Condition)     NewRow = Collection_Out.NewRow
    For Each c As DataColumn In NewRow.Table.Columns         NewRow(c.ColumnName) = parentRow(c.ColumnName)
    Next     Collection_Out.Rows.Add(NewRow)
Next NewRow = Nothing Collection_In = Nothing"
                            data-title="UWCA_Balloon_Refinance_CTF_V1.0 / GetOneMonthFull Salary / Filter Collection5">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>UWCA_Balloon_Refinance_CTF_V1.0</td>
                <td>GetOneMonthFull Salary</td>
                <td>Filter Collection6</td>
                <td>visualbasic</td>
                <td>6</td>
                <!--<td style="font-family: monospace;">c923c99415a4cd6045d25f97a6cbb1a13207cdf1baf5dc8c1df087012e26e633</td>-->
                <td>—</td>
                <!--<td>Dim NewRow As DataRow Dim Amount as Decimal =0 Collection_Out = Collection_In.Clone For Each parentRow As DataRow In Collection_In.Select(Select_Condition)     NewRow = Collection_Out.NewRow     For Each c As DataColumn In NewRow.Table.Columns         NewRow(c.ColumnName) = parentRow(c.ColumnName)  ...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Dim NewRow As DataRow
Dim Amount as Decimal =0 Collection_Out = Collection_In.Clone
For Each parentRow As DataRow In Collection_In.Select(Select_Condition)     NewRow = Collection_Out.NewRow
    For Each c As DataColumn In NewRow.Table.Columns         NewRow(c.ColumnName) = parentRow(c.ColumnName)
    Next     Collection_Out.Rows.Add(NewRow)
Next NewRow = Nothing Collection_In = Nothing"
                            data-title="UWCA_Balloon_Refinance_CTF_V1.0 / GetOneMonthFull Salary / Filter Collection6">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>UWCA_Balloon_Refinance_CTF_V1.0</td>
                <td>GetOneMonthFull Salary</td>
                <td>Filter Collection7</td>
                <td>visualbasic</td>
                <td>6</td>
                <!--<td style="font-family: monospace;">c923c99415a4cd6045d25f97a6cbb1a13207cdf1baf5dc8c1df087012e26e633</td>-->
                <td>—</td>
                <!--<td>Dim NewRow As DataRow Dim Amount as Decimal =0 Collection_Out = Collection_In.Clone For Each parentRow As DataRow In Collection_In.Select(Select_Condition)     NewRow = Collection_Out.NewRow     For Each c As DataColumn In NewRow.Table.Columns         NewRow(c.ColumnName) = parentRow(c.ColumnName)  ...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Dim NewRow As DataRow
Dim Amount as Decimal =0 Collection_Out = Collection_In.Clone
For Each parentRow As DataRow In Collection_In.Select(Select_Condition)     NewRow = Collection_Out.NewRow
    For Each c As DataColumn In NewRow.Table.Columns         NewRow(c.ColumnName) = parentRow(c.ColumnName)
    Next     Collection_Out.Rows.Add(NewRow)
Next NewRow = Nothing Collection_In = Nothing"
                            data-title="UWCA_Balloon_Refinance_CTF_V1.0 / GetOneMonthFull Salary / Filter Collection7">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>UWCA_Balloon_Refinance_CTF_V1.0</td>
                <td>GetOneMonthFull Salary</td>
                <td>Filter With Payment Date</td>
                <td>visualbasic</td>
                <td>6</td>
                <!--<td style="font-family: monospace;">c923c99415a4cd6045d25f97a6cbb1a13207cdf1baf5dc8c1df087012e26e633</td>-->
                <td>—</td>
                <!--<td>Dim NewRow As DataRow Dim Amount as Decimal =0 Collection_Out = Collection_In.Clone For Each parentRow As DataRow In Collection_In.Select(Select_Condition)     NewRow = Collection_Out.NewRow     For Each c As DataColumn In NewRow.Table.Columns         NewRow(c.ColumnName) = parentRow(c.ColumnName)  ...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Dim NewRow As DataRow
Dim Amount as Decimal =0 Collection_Out = Collection_In.Clone
For Each parentRow As DataRow In Collection_In.Select(Select_Condition)     NewRow = Collection_Out.NewRow
    For Each c As DataColumn In NewRow.Table.Columns         NewRow(c.ColumnName) = parentRow(c.ColumnName)
    Next     Collection_Out.Rows.Add(NewRow)
Next NewRow = Nothing Collection_In = Nothing"
                            data-title="UWCA_Balloon_Refinance_CTF_V1.0 / GetOneMonthFull Salary / Filter With Payment Date">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>UWCA_Balloon_Refinance_CTF_V1.0</td>
                <td>GetOneMonthFull Salary</td>
                <td>Filter With Payment Date 1</td>
                <td>visualbasic</td>
                <td>6</td>
                <!--<td style="font-family: monospace;">c923c99415a4cd6045d25f97a6cbb1a13207cdf1baf5dc8c1df087012e26e633</td>-->
                <td>—</td>
                <!--<td>Dim NewRow As DataRow Dim Amount as Decimal =0 Collection_Out = Collection_In.Clone For Each parentRow As DataRow In Collection_In.Select(Select_Condition)     NewRow = Collection_Out.NewRow     For Each c As DataColumn In NewRow.Table.Columns         NewRow(c.ColumnName) = parentRow(c.ColumnName)  ...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Dim NewRow As DataRow
Dim Amount as Decimal =0 Collection_Out = Collection_In.Clone
For Each parentRow As DataRow In Collection_In.Select(Select_Condition)     NewRow = Collection_Out.NewRow
    For Each c As DataColumn In NewRow.Table.Columns         NewRow(c.ColumnName) = parentRow(c.ColumnName)
    Next     Collection_Out.Rows.Add(NewRow)
Next NewRow = Nothing Collection_In = Nothing"
                            data-title="UWCA_Balloon_Refinance_CTF_V1.0 / GetOneMonthFull Salary / Filter With Payment Date 1">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>UWCA_Balloon_Refinance_CTF_V1.0</td>
                <td>KYC Code Stage</td>
                <td>KYC Check</td>
                <td>visualbasic</td>
                <td>60</td>
                <!--<td style="font-family: monospace;">986dc4408c5d521ea97031d6fd63eff9474497d42a8213fe643a20455ac932e2</td>-->
                <td>—</td>
                <!--<td>reason=&quot;&quot; If c1.rows(6)(&quot;Column2&quot;)=&quot;OK&quot; AND c1.rows(22)(&quot;Column2&quot;)=&quot;OK&quot; AND c1.rows(37)(&quot;Column2&quot;)=&quot;OK&quot; AND c1.rows(40)(&quot;Column2&quot;)=&quot;OK&quot; AND c1.rows(41)(&quot;Column2&quot;)=&quot;OK&quot; AND c1.rows(42)(&quot;Column2&quot;)=&quot;OK&quot; Then     flag=True End If else flag=False     If c1.rows(6)(&quot;Column2&quot;)&lt;&gt;&quot;OK&quot; Then         reason=c1....</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="reason=&quot;&quot;
If c1.rows(6)(&quot;Column2&quot;)=&quot;OK&quot; AND c1.rows(22)(&quot;Column2&quot;)=&quot;OK&quot; AND c1.rows(37)(&quot;Column2&quot;)=&quot;OK&quot; AND c1.rows(40)(&quot;Column2&quot;)=&quot;OK&quot; AND c1.rows(41)(&quot;Column2&quot;)=&quot;OK&quot; AND c1.rows(42)(&quot;Column2&quot;)=&quot;OK&quot; Then
    flag=True
End If
else flag=False
    If c1.rows(6)(&quot;Column2&quot;)&lt;&gt;&quot;OK&quot; Then
        reason=c1.rows(6)(&quot;Column1&quot;)
    End If
    End
    If
    If c1.rows(22)(&quot;Column2&quot;)&lt;&gt;&quot;OK&quot; then
        If reason=&quot;&quot; Then
            reason=c1.rows(22)(&quot;Column1&quot;)
        End If
    else             reason=reason+&quot;,&quot;+c1.rows(22)(&quot;Column1&quot;)
        End
        If
        End
        If
        If c1.rows(37)(&quot;Column2&quot;)&lt;&gt;&quot;OK&quot; then
            If reason=&quot;&quot; Then
                reason=c1.rows(37)(&quot;Column1&quot;)
            End If
        else             reason=reason+&quot;,&quot;+c1.rows(37)(&quot;Column1&quot;)
            End
            If
            End
            If
            If c1.rows(40)(&quot;Column2&quot;)&lt;&gt;&quot;OK&quot; then
                If reason=&quot;&quot; Then
                    reason=c1.rows(40)(&quot;Column1&quot;)
                End If
            else             reason=reason+&quot;,&quot;+c1.rows(40)(&quot;Column1&quot;)
                End
                If
                End
                If
                If c1.rows(41)(&quot;Column2&quot;)&lt;&gt;&quot;OK&quot; then
                    If reason=&quot;&quot; Then
                        reason=c1.rows(41)(&quot;Column1&quot;)
                    End If
                else             reason=reason+&quot;,&quot;+c1.rows(41)(&quot;Column1&quot;)
                    End
                    If
                    End
                    If
                    If c1.rows(42)(&quot;Column2&quot;)&lt;&gt;&quot;OK&quot; then
                        If reason=&quot;&quot; Then
                            reason=c1.rows(42)(&quot;Column1&quot;)
                        End If
                    else             reason=reason+&quot;,&quot;+c1.rows(42)(&quot;Column1&quot;)
                        End
                        If
                        End
                        If
                        End
                        IF
                        If c1.rows(25)(&quot;Column4&quot;)=&quot;6-&quot; OR c1.rows(25)(&quot;Column4&quot;)=&quot;6+&quot; OR c1.rows(25)(&quot;Column4&quot;)=&quot;7&quot; OR c1.rows(25)(&quot;Column4&quot;)=&quot;7-&quot; OR c1.rows(25)(&quot;Column4&quot;)=&quot;7+&quot; score_flag=True
                        else score_flag=False
                        End IF"
                            data-title="UWCA_Balloon_Refinance_CTF_V1.0 / KYC Code Stage / KYC Check">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>UWCA_Balloon_Refinance_CTF_V1.0</td>
                <td>New Salary Logic</td>
                <td>Description check1</td>
                <td>visualbasic</td>
                <td>44</td>
                <!--<td style="font-family: monospace;">505c18455afbdcc4175f340a000f39bf489f06216f90625741364c65be733b9a</td>-->
                <td>—</td>
                <!--<td>try     Dim description as string     Dim TempDataRow As DataRow = DescriptionCollection.NewRow     Dim Dflag as integer =0     Dim precount as integer =0     Dim count as integer =0     Dim CollOut as DataTable =InputCollection.Clone     Dim Buffer as DataTable=InputCollection.Clone     Dim out1,ou...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="try
    Dim description as string
    Dim TempDataRow As DataRow = DescriptionCollection.NewRow
    Dim Dflag as integer =0
    Dim precount as integer =0
    Dim count as integer =0
    Dim CollOut as DataTable =InputCollection.Clone
    Dim Buffer as DataTable=InputCollection.Clone
    Dim out1,out2 as String  &#x27;Add Description and Count of Description in to DescriptionCollection
    For r As Integer = 0 To InputCollection.Rows.Count-1     description=InputCollection.Rows(r)(&quot;Description&quot;)     Dflag=0
        for i as integer=0 To DescriptionCollection.Rows.Count-1
            If DescriptionCollection.Rows(i)(&quot;Description&quot;)=description Then
                Dflag=1             DescriptionCollection.Rows(i)(&quot;Count&quot;)=DescriptionCollection.Rows(i)(&quot;Count&quot;)+1
            End If
            end
            if
        next
        If Dflag=0 Then
            TempDataRow(&quot;Description&quot;) = description         TempDataRow(&quot;Count&quot;)=1         DescriptionCollection.Rows.Add(TempDataRow)         TempDataRow= DescriptionCollection.NewRow         out1 = &quot;O1&quot;
        End If
        end
        if
    Next  DescriptionCollection.DefaultView.Sort =  &quot;Count DESC&quot; DescriptionCollection=DescriptionCollection.DefaultView.ToTable    &#x27;Get Max Repeated DescriptionCollection
    For r As Integer = 0 To DescriptionCollection.Rows.Count-1     description=DescriptionCollection.Rows(r)(&quot;Description&quot;)     CollOut=Nothing     CollOut=InputCollection.Clone
        For Each parentRow As DataRow In InputCollection.Select(&quot;Description=&#x27;&quot;+description+&quot;&#x27;&quot;)         TempDataRow = CollOut.NewRow
            For Each c As DataColumn In TempDataRow.Table.Columns             TempDataRow(c.ColumnName) = parentRow(c.ColumnName)
            Next         CollOut.Rows.Add(TempDataRow)
        Next     count=CollOut.Rows.Count
        If count&gt;precount Then
            Buffer=Nothing         Buffer = CollOut.Clone         Buffer=CollOut         precount=count         ReassignFlag=0         out2 = &quot;O2&quot;
        End If
    else
        if count = Precount             ReassignFlag=1             Status=&quot;Salary cannot be identified since there mode are equal&quot;
            end
            if
        next
        If precount&lt;=2 Then
            ReassignFlag=1     Status=&quot;Salary cannot be identified since there mode is &lt; 3&quot;
        End If
        end
        if FilteredDescCollection=Buffer D0=DescriptionCollection
        catch e as Exception         ReassignFlag=1         Status=&quot;Code Error:&quot;+e.ToString
            end
            try"
                            data-title="UWCA_Balloon_Refinance_CTF_V1.0 / New Salary Logic / Description check1">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>UWCA_Balloon_Refinance_CTF_V1.0</td>
                <td>New Salary Logic</td>
                <td>Filter Salay with +5 and -5 Days1</td>
                <td>visualbasic</td>
                <td>41</td>
                <!--<td style="font-family: monospace;">749d00c0bc02ea23c0044597bec933f59ae16266faad401782621f6dbdf48e4f</td>-->
                <td>—</td>
                <!--<td>try     Dim TempCollection as DataTable=FilteredDescCollection.Clone     Dim TempRow As DataRow = FilteredDescCollection.NewRow &#x27;Temp collections to store each month transacation in single collection &#x27;SD stands     for Salary Date         Dim TempCollectionSD1 as DataTable=FilteredDescCollection.Clo...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="try
    Dim TempCollection as DataTable=FilteredDescCollection.Clone
    Dim TempRow As DataRow = FilteredDescCollection.NewRow &#x27;Temp collections to store each month transacation in single collection &#x27;SD stands
    for Salary Date
        Dim TempCollectionSD1 as DataTable=FilteredDescCollection.Clone
        Dim TempCollectionSD2 as DataTable=FilteredDescCollection.Clone
        Dim TempCollectionSD3 as DataTable=FilteredDescCollection.Clone &#x27;
        Dim TempCollectionSD4 as DataTable=FilteredDescCollection.Clone
        Dim TempOutCollection as DataTable=FilteredDescCollection.Clone   &#x27;Adding +5 &amp; -5 days
        Dim SD1p as Date=SD1.AddDays(5)
        Dim SD1m as Date=SD1.AddDays(-5)
        Dim SD2p as Date=SD2.AddDays(5)
        Dim SD2m as Date=SD2.AddDays(-5)
        Dim SD3p as Date=SD3.AddDays(5)
        Dim SD3m as Date=SD3.AddDays(-5)     &#x27;
        Dim SD4p as Date=SD4.AddDays(5)     &#x27;
        Dim SD4m as Date=SD4.AddDays(-5)  &#x27;Fiter the collection based on above criteria (+5 &amp; -5) to get each month one collection
        For r As Integer = 0 To FilteredDescCollection.Rows.Count-1             if(SD1m&lt;=FilteredDescCollection.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=FilteredDescCollection.Rows(r)(&quot;Account date&quot;) AND FilteredDescCollection.Rows(r)(&quot;Sal&quot;)&gt;0 ) then                 TempRow= FilteredDescCollection.Rows(r)                 TempCollectionSD1.ImportRow(TempRow)                 TempRow=TempCollectionSD1.NewRow
        end if                            if(SD2m&lt;=FilteredDescCollection.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=FilteredDescCollection.Rows(r)(&quot;Account date&quot;)AND FilteredDescCollection.Rows(r)(&quot;Sal&quot;)&gt;0 ) then                     TempRow= FilteredDescCollection.Rows(r)                     TempCollectionSD2.ImportRow(TempRow)                     TempRow=TempCollectionSD2.NewRow
    end if                      if(SD3m&lt;=FilteredDescCollection.Rows(r)(&quot;Account date&quot;) AND SD3p&gt;=FilteredDescCollection.Rows(r)(&quot;Account date&quot;)AND FilteredDescCollection.Rows(r)(&quot;Sal&quot;)&gt;0 ) then                     TempRow= FilteredDescCollection.Rows(r)                     TempCollectionSD3.ImportRow(TempRow)                     TempRow=TempCollectionSD3.NewRow
end if                  &#x27;if(SD4m&lt;=FilteredDescCollection.Rows(r)(&quot;Account date&quot;) AND SD4p&gt;=FilteredDescCollection.Rows(r)(&quot;Account date&quot;) AND FilteredDescCollection.Rows(r)(&quot;Sal&quot;)&gt;0 ) then             &#x27;        TempRow= FilteredDescCollection.Rows(r)             &#x27;        TempCollectionSD4.ImportRow(TempRow)             &#x27;        TempRow=TempCollectionSD4.NewRow                          &#x27;
end if
next &#x27;sort all the collection in desc order      TempCollectionSD1.DefaultView.Sort =  &quot;Sal DESC&quot;     TempCollectionSD2.DefaultView.Sort =  &quot;Sal DESC&quot;     TempCollectionSD3.DefaultView.Sort =  &quot;Sal DESC&quot;     &#x27;TempCollectionSD4.DefaultView.Sort =  &quot;Sal DESC&quot;  &#x27;converting collection into DataTable      TempCollectionSD1=TempCollectionSD1.DefaultView.ToTable     TempCollectionSD2=TempCollectionSD2.DefaultView.ToTable     TempCollectionSD3=TempCollectionSD3.DefaultView.ToTable     &#x27;TempCollectionSD4=TempCollectionSD4.DefaultView.ToTable  &#x27;add only max salary to Output collection from each month collection         if(TempCollectionSD1.Rows.Count&gt;0)then             TempOutCollection.ImportRow(TempCollectionSD1.Rows(0))
else             ReassignFlag=1             Status=&quot;Current month salary not found&quot;
    return
    end
    if                  if(TempCollectionSD2.Rows.Count&gt;0)then             TempOutCollection.ImportRow(TempCollectionSD2.Rows(0))
    else             ReassignFlag=1             Status=&quot; Current month -1 salary not found&quot;
        return
        end
        if                      if(TempCollectionSD3.Rows.Count&gt;0)then             TempOutCollection.ImportRow(TempCollectionSD3.Rows(0))
        else             ReassignFlag=1             Status=&quot; Current month -2 salary not found&quot;
            return
            end
            if                      &#x27;if(TempCollectionSD4.Rows.Count&gt;0)then         &#x27;    TempOutCollection.ImportRow(TempCollectionSD4.Rows(0))         &#x27;
            else         &#x27;    ReassignFlag=1         &#x27;    Status=&quot; 4th month salary not found&quot;         &#x27;
                end
                if  &#x27;TempOutCollection.DefaultView.Sort =  &quot;Account date ASC&quot; TempOutCollection=TempOutCollection.DefaultView.ToTable FilterDateCollection=TempOutCollection
                catch e as Exception         ReassignFlag=1         Status=&quot;Code Error:&quot;+e.ToString
                    end
                    try"
                            data-title="UWCA_Balloon_Refinance_CTF_V1.0 / New Salary Logic / Filter Salay with +5 and -5 Days1">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>UWCA_Balloon_Refinance_CTF_V1.0</td>
                <td>New Salary Logic</td>
                <td>Filter Salay with +5 and -5 Days1 With Payment Date</td>
                <td>visualbasic</td>
                <td>41</td>
                <!--<td style="font-family: monospace;">749d00c0bc02ea23c0044597bec933f59ae16266faad401782621f6dbdf48e4f</td>-->
                <td>—</td>
                <!--<td>try     Dim TempCollection as DataTable=FilteredDescCollection.Clone     Dim TempRow As DataRow = FilteredDescCollection.NewRow &#x27;Temp collections to store each month transacation in single collection &#x27;SD stands     for Salary Date         Dim TempCollectionSD1 as DataTable=FilteredDescCollection.Clo...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="try
    Dim TempCollection as DataTable=FilteredDescCollection.Clone
    Dim TempRow As DataRow = FilteredDescCollection.NewRow &#x27;Temp collections to store each month transacation in single collection &#x27;SD stands
    for Salary Date
        Dim TempCollectionSD1 as DataTable=FilteredDescCollection.Clone
        Dim TempCollectionSD2 as DataTable=FilteredDescCollection.Clone
        Dim TempCollectionSD3 as DataTable=FilteredDescCollection.Clone &#x27;
        Dim TempCollectionSD4 as DataTable=FilteredDescCollection.Clone
        Dim TempOutCollection as DataTable=FilteredDescCollection.Clone   &#x27;Adding +5 &amp; -5 days
        Dim SD1p as Date=SD1.AddDays(5)
        Dim SD1m as Date=SD1.AddDays(-5)
        Dim SD2p as Date=SD2.AddDays(5)
        Dim SD2m as Date=SD2.AddDays(-5)
        Dim SD3p as Date=SD3.AddDays(5)
        Dim SD3m as Date=SD3.AddDays(-5)     &#x27;
        Dim SD4p as Date=SD4.AddDays(5)     &#x27;
        Dim SD4m as Date=SD4.AddDays(-5)  &#x27;Fiter the collection based on above criteria (+5 &amp; -5) to get each month one collection
        For r As Integer = 0 To FilteredDescCollection.Rows.Count-1             if(SD1m&lt;=FilteredDescCollection.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=FilteredDescCollection.Rows(r)(&quot;Account date&quot;) AND FilteredDescCollection.Rows(r)(&quot;Sal&quot;)&gt;0 ) then                 TempRow= FilteredDescCollection.Rows(r)                 TempCollectionSD1.ImportRow(TempRow)                 TempRow=TempCollectionSD1.NewRow
        end if                            if(SD2m&lt;=FilteredDescCollection.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=FilteredDescCollection.Rows(r)(&quot;Account date&quot;)AND FilteredDescCollection.Rows(r)(&quot;Sal&quot;)&gt;0 ) then                     TempRow= FilteredDescCollection.Rows(r)                     TempCollectionSD2.ImportRow(TempRow)                     TempRow=TempCollectionSD2.NewRow
    end if                      if(SD3m&lt;=FilteredDescCollection.Rows(r)(&quot;Account date&quot;) AND SD3p&gt;=FilteredDescCollection.Rows(r)(&quot;Account date&quot;)AND FilteredDescCollection.Rows(r)(&quot;Sal&quot;)&gt;0 ) then                     TempRow= FilteredDescCollection.Rows(r)                     TempCollectionSD3.ImportRow(TempRow)                     TempRow=TempCollectionSD3.NewRow
end if                  &#x27;if(SD4m&lt;=FilteredDescCollection.Rows(r)(&quot;Account date&quot;) AND SD4p&gt;=FilteredDescCollection.Rows(r)(&quot;Account date&quot;) AND FilteredDescCollection.Rows(r)(&quot;Sal&quot;)&gt;0 ) then             &#x27;        TempRow= FilteredDescCollection.Rows(r)             &#x27;        TempCollectionSD4.ImportRow(TempRow)             &#x27;        TempRow=TempCollectionSD4.NewRow                          &#x27;
end if
next &#x27;sort all the collection in desc order      TempCollectionSD1.DefaultView.Sort =  &quot;Sal DESC&quot;     TempCollectionSD2.DefaultView.Sort =  &quot;Sal DESC&quot;     TempCollectionSD3.DefaultView.Sort =  &quot;Sal DESC&quot;     &#x27;TempCollectionSD4.DefaultView.Sort =  &quot;Sal DESC&quot;  &#x27;converting collection into DataTable      TempCollectionSD1=TempCollectionSD1.DefaultView.ToTable     TempCollectionSD2=TempCollectionSD2.DefaultView.ToTable     TempCollectionSD3=TempCollectionSD3.DefaultView.ToTable     &#x27;TempCollectionSD4=TempCollectionSD4.DefaultView.ToTable  &#x27;add only max salary to Output collection from each month collection         if(TempCollectionSD1.Rows.Count&gt;0)then             TempOutCollection.ImportRow(TempCollectionSD1.Rows(0))
else             ReassignFlag=1             Status=&quot;Current month salary not found&quot;
    return
    end
    if                  if(TempCollectionSD2.Rows.Count&gt;0)then             TempOutCollection.ImportRow(TempCollectionSD2.Rows(0))
    else             ReassignFlag=1             Status=&quot; Current month -1 salary not found&quot;
        return
        end
        if                      if(TempCollectionSD3.Rows.Count&gt;0)then             TempOutCollection.ImportRow(TempCollectionSD3.Rows(0))
        else             ReassignFlag=1             Status=&quot; Current month -2 salary not found&quot;
            return
            end
            if                      &#x27;if(TempCollectionSD4.Rows.Count&gt;0)then         &#x27;    TempOutCollection.ImportRow(TempCollectionSD4.Rows(0))         &#x27;
            else         &#x27;    ReassignFlag=1         &#x27;    Status=&quot; 4th month salary not found&quot;         &#x27;
                end
                if  &#x27;TempOutCollection.DefaultView.Sort =  &quot;Account date ASC&quot; TempOutCollection=TempOutCollection.DefaultView.ToTable FilterDateCollection=TempOutCollection
                catch e as Exception         ReassignFlag=1         Status=&quot;Code Error:&quot;+e.ToString
                    end
                    try"
                            data-title="UWCA_Balloon_Refinance_CTF_V1.0 / New Salary Logic / Filter Salay with +5 and -5 Days1 With Payment Date">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>UWCA_Balloon_Refinance_CTF_V1.0</td>
                <td>New Salary Logic</td>
                <td>Filter Salay with +5 and -5 Days2</td>
                <td>visualbasic</td>
                <td>43</td>
                <!--<td style="font-family: monospace;">6f7d183a8e2c904c2a1b07258c1ca2672538371a42209c4fb0005efaee1f9825</td>-->
                <td>—</td>
                <!--<td>try     Dim TempCollection as DataTable=FilteredDescCollection.Clone     Dim TempRow As DataRow = FilteredDescCollection.NewRow &#x27;Temp collections to store each month transacation in single collection &#x27;SD stands     for Salary Date         Dim TempCollectionSD1 as DataTable=FilteredDescCollection.Clo...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="try
    Dim TempCollection as DataTable=FilteredDescCollection.Clone
    Dim TempRow As DataRow = FilteredDescCollection.NewRow &#x27;Temp collections to store each month transacation in single collection &#x27;SD stands
    for Salary Date
        Dim TempCollectionSD1 as DataTable=FilteredDescCollection.Clone
        Dim TempCollectionSD2 as DataTable=FilteredDescCollection.Clone
        Dim TempCollectionSD3 as DataTable=FilteredDescCollection.Clone &#x27;
        Dim TempCollectionSD4 as DataTable=FilteredDescCollection.Clone
        Dim TempOutCollection as DataTable=FilteredDescCollection.Clone   &#x27;Filtering Transaction colletion with Tran Code column.
        If found Then
            add to corresponding collection.
        End If
        For r As Integer = 0 To FilteredDescCollection.Rows.Count-1                                       if(FilteredDescCollection.Rows(r)(&quot;Tran code&quot;)=&quot;312&quot;) then                     if(SD1=FilteredDescCollection.Rows(r)(&quot;Account date&quot;)) then                         TempRow= FilteredDescCollection.Rows(r)                         TempCollectionSD1.ImportRow(TempRow)                         TempRow=TempCollectionSD1.NewRow
        end if                                      if(SD2=FilteredDescCollection.Rows(r)(&quot;Account date&quot;)) then                             TempRow= FilteredDescCollection.Rows(r)                             TempCollectionSD2.ImportRow(TempRow)                             TempRow=TempCollectionSD2.NewRow
    end if                                      if(SD3=FilteredDescCollection.Rows(r)(&quot;Account date&quot;))then                             TempRow= FilteredDescCollection.Rows(r)                             TempCollectionSD3.ImportRow(TempRow)                             TempRow=TempCollectionSD3.NewRow
    end
    if                                          &#x27;if(SD4=FilteredDescCollection.Rows(r)(&quot;Account date&quot;))then                     &#x27;        TempRow= FilteredDescCollection.Rows(r)                     &#x27;        TempCollectionSD4.ImportRow(TempRow)                     &#x27;        TempRow=TempCollectionSD4.NewRow                                      &#x27;
        end
        if
    else                                          ReassignFlag=1                     Status=&quot;Salary not identified after filter with code&quot;
        return
        end
        if
    next &#x27;sort all the collection in desc order      TempCollectionSD1.DefaultView.Sort =  &quot;Sal DESC&quot;     TempCollectionSD2.DefaultView.Sort =  &quot;Sal DESC&quot;     TempCollectionSD3.DefaultView.Sort =  &quot;Sal DESC&quot;     &#x27;TempCollectionSD4.DefaultView.Sort =  &quot;Sal DESC&quot;  &#x27;converting collection into DataTable      TempCollectionSD1=TempCollectionSD1.DefaultView.ToTable     TempCollectionSD2=TempCollectionSD2.DefaultView.ToTable     TempCollectionSD3=TempCollectionSD3.DefaultView.ToTable     &#x27;TempCollectionSD4=TempCollectionSD4.DefaultView.ToTable  &#x27;add only max salary to Output collection from each month collection         if(TempCollectionSD1.Rows.Count&gt;0)then             TempOutCollection.ImportRow(TempCollectionSD1.Rows(0))
else             ReassignFlag=1             Status=&quot;Current month salary not found&quot;
    return
    end
    if                  if(TempCollectionSD2.Rows.Count&gt;0)then             TempOutCollection.ImportRow(TempCollectionSD2.Rows(0))
    else             ReassignFlag=1             Status=&quot; Current month -1 salary not found&quot;
        return
        end
        if                      if(TempCollectionSD3.Rows.Count&gt;0)then             TempOutCollection.ImportRow(TempCollectionSD3.Rows(0))
        else             ReassignFlag=1             Status=&quot; Current month -2 salary not found&quot;
            return
            end
            if                  &#x27;if(TempCollectionSD4.Rows.Count&gt;0)then         &#x27;    TempOutCollection.ImportRow(TempCollectionSD4.Rows(0))         &#x27;
            else         &#x27;    ReassignFlag=1         &#x27;    Status=&quot; Current month -3 salary not found&quot;         &#x27;
                return         &#x27;
                end
                if           &#x27;TempOutCollection.DefaultView.Sort =  &quot;Account date DESC&quot; TempOutCollection=TempOutCollection.DefaultView.ToTable FilterCodeCollection=TempOutCollection
                catch e as Exception         ReassignFlag=1         Status=&quot;Code Error:&quot;+e.ToString
                    end
                    try"
                            data-title="UWCA_Balloon_Refinance_CTF_V1.0 / New Salary Logic / Filter Salay with +5 and -5 Days2">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>UWCA_Balloon_Refinance_CTF_V1.0</td>
                <td>New Salary Logic</td>
                <td>Salary Logic based on AVG1</td>
                <td>visualbasic</td>
                <td>45</td>
                <!--<td style="font-family: monospace;">d23bb53d21629033ffcd659bab0b51b3e1f16f98113dc1ae4c4164bfc0123a40</td>-->
                <td>—</td>
                <!--<td>try     Dim Amount as Decimal =0     Dim Avg as Decimal=0     Dim Sum as Decimal =0     Dim skip as integer =0     Dim min as Decimal =0     Dim max as Decimal =0     Dim minSal as Decimal =0     Dim minimumSalarySAR as string =Nothing  &#x27;To assign each month salary into one variable     Dim FirstMon...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="try
    Dim Amount as Decimal =0
    Dim Avg as Decimal=0
    Dim Sum as Decimal =0
    Dim skip as integer =0
    Dim min as Decimal =0
    Dim max as Decimal =0
    Dim minSal as Decimal =0
    Dim minimumSalarySAR as string =Nothing  &#x27;To assign each month salary into one variable
    Dim FirstMonthSalary as Decimal=0
    Dim SecondMonthSalary as Decimal=0 &#x27;
    Dim ThirdMonthSalary as Decimal=0
    Dim CurrentMonthSalary as Decimal=0
    Dim ActualSalary as Decimal=0   &#x27;Read salaries from input collection FilterDateCollection CurrentMonthSalary=FilterDateCollection.Rows(0)(&quot;Sal&quot;) FirstMonthSalary=FilterDateCollection.Rows(1)(&quot;Sal&quot;) SecondMonthSalary=FilterDateCollection.Rows(2)(&quot;Sal&quot;) &#x27;ThirdMonthSalary=FilterDateCollection.Rows(3)(&quot;Sal&quot;)   &#x27;Rule2 take avarage of last 3 months salaries and check avg with min(s1,s2,s3)+20%Min(s1,s2,s3)
    If condition is true Then
        take avg as Salary.     max=FilterDateCollection.Rows(0)(&quot;Sal&quot;)     minSal=FilterDateCollection.Rows(0)(&quot;Sal&quot;)
    End If
    For k As Integer = 0 To 2         Sum=Sum+FilterDateCollection.Rows(k)(&quot;Sal&quot;)         if(max&lt;FilterDateCollection.Rows(k)(&quot;Sal&quot;))then                 max=FilterDateCollection.Rows(k)(&quot;Sal&quot;)
        end
        if         if(minSal&gt;FilterDateCollection.Rows(k)(&quot;Sal&quot;))then                 minSal=FilterDateCollection.Rows(k)(&quot;Sal&quot;)
            end
            if
        next           Avg=Sum/3     CurrentMonthSalary = minSal &#x27;Rule1
        If the employeer is Governamet-employee deduct 1000 SAR from his/her salary     &#x27;if(GovFlag)     &#x27;    ActualSalary=CurrentMonthSalary-1000     &#x27;
        else     &#x27;    ActualSalary=CurrentMonthSalary     &#x27;
            end
            if     &#x27;MsgBox(CurrentMonthSalary) &#x27;Rule2
                If Jan Salary less than or equal to (Avg or Avg+10%(Avg)) Then
                    Jan Salary as Salary
                End If
            else Avg as Salary.
                If Math.Round(((Avg-CurrentMonthSalary)/Avg),3)&lt;= 0.2 Then
                    &#x27;AND Math.Round(((Avg-CurrentMonthSalary)/Avg),3)&gt;= -0.1)then     Avg=Sum/3
                End If
            else     Avg=(Sum-max)/2
                End
                If          min=FilterDateorCodeCollection.Rows(0)(&quot;Sal&quot;)
                    For k As Integer = 0 To 2
                        if min &gt;= FilterDateorCodeCollection.Rows(K)(&quot;Sal&quot;)then             min=FilterDateorCodeCollection.Rows(K)(&quot;Sal&quot;)             minimumSalarySAR=FilterDateorCodeCollection.Rows(k)(&quot;Amount&quot;)
                            end
                            if
                        next       Salary=minimumSalarySAR     Other=Replace(Math.Round((Avg-min),2),&quot;.&quot;,&quot;,&quot;)  OutputCollection=FilterDateCollection
                    catch e as Exception         ReassignFlag=1         Status=&quot;Code Error:&quot;+e.ToString
                        end
                        try"
                            data-title="UWCA_Balloon_Refinance_CTF_V1.0 / New Salary Logic / Salary Logic based on AVG1">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>UWCA_Balloon_Refinance_CTF_V1.0</td>
                <td>New Salary Logic</td>
                <td>Salary code requirements1</td>
                <td>visualbasic</td>
                <td>71</td>
                <!--<td style="font-family: monospace;">117c6ffa7ec70f8097b6591c7d92435e40b4bbe9e91d0c89cb7f44bd9da787a1</td>-->
                <td>reflection</td>
                <!--<td>&#x27;Page1 try     If Not c1.Columns.Contains(&quot;Sal&quot;) Then         c1.Columns.Add(&quot;Sal&quot;, Type.GetType(&quot;System.Decimal&quot;))     End If     End     If     For r As Integer = 0 To c1.Rows.Count - 1         c1.Rows(r)(&quot;Sal&quot;) = Replace(Replace(c1.Rows(r)(&quot;Amount&quot;), &quot;.&quot;, &quot;&quot;), &quot;,&quot;, &quot;.&quot;)         c1.Rows(r)(&quot;Sal&quot;)=...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="&#x27;Page1
try
    If Not c1.Columns.Contains(&quot;Sal&quot;) Then
        c1.Columns.Add(&quot;Sal&quot;, Type.GetType(&quot;System.Decimal&quot;))
    End If
    End
    If
    For r As Integer = 0 To c1.Rows.Count - 1         c1.Rows(r)(&quot;Sal&quot;) = Replace(Replace(c1.Rows(r)(&quot;Amount&quot;), &quot;.&quot;, &quot;&quot;), &quot;,&quot;, &quot;.&quot;)         c1.Rows(r)(&quot;Sal&quot;)=Convert.ToDecimal(c1.Rows(r)(&quot;Sal&quot;))
    Next  &#x27;Filtering &lt;1900
    If Not GovFlag then
        Dim NewRow As DataRow  C0 = C1.Clone
        For Each parentRow As DataRow In C1.Select(Select_Condition)         NewRow = C0.NewRow
            For Each c As DataColumn In NewRow.Table.Columns             NewRow(c.ColumnName) = parentRow(c.ColumnName)
            Next         C0.Rows.Add(NewRow)
        Next   NewRow = Nothing C1 = Nothing  &#x27;Page2 C1=C0
        End
        If
        Dim x as integer = 0
        Dim dd,mm,yy as string
        Dim count as integer =0
        dim test,dec
        dim flag as integer=1
        dim days as integer =0 dec=&quot;&quot; dd=&quot;&quot; mm=&quot;&quot; yy=&quot;&quot; &#x27;
        If Not c1.Columns.Contains(&quot;ADate&quot;) Then
            &#x27;    c1.Columns.Add(&quot;ADate&quot;, Type.GetType(&quot;System.String&quot;)) &#x27;
        End If
        End
        if
        If Not c1.Columns.Contains(&quot;Days&quot;) Then
            c1.Columns.Add(&quot;Days&quot;, Type.GetType(&quot;System.DateTime&quot;))
        End If
        End
        if
        For i As Integer = 0 To c1.Rows.Count - 1     c1.Rows(i)(&quot;Description&quot;)=Replace(c1.Rows(i)(&quot;Description&quot;),&quot; &quot;,&quot;&quot;)
            if Left(c1.Rows(i)(&quot;Description&quot;),7) =  &quot;PAYROL/&quot; OR Left(c1.Rows(i)(&quot;Description&quot;),7) =  &quot;SALARY/&quot;         c1.Rows(i)(&quot;Description&quot;) = Replace(Replace(c1.Rows(i)(&quot;Description&quot;),&quot;PAYROL/&quot;,&quot;&quot;),&quot;SALARY/&quot;,&quot;&quot;)
                end
                if     test=c1.Rows(i)(&quot;Description&quot;)
                    do         x = InStr(test, &quot;/&quot;)     if(x&gt;0)             test=Replace(test, Left(test, x),&quot;&quot;)
                        if flag=1         dec=test         flag = 0
                            end
                            if             count = count+1
                            end if
                        loop
                        while x&lt;&gt;0
                            if count&gt;2         c1.Rows(i)(&quot;Description&quot;)= Trim(dec)
                            else &#x27;        dec=&quot;arb: &quot;+c1.Rows(r)(&quot;Description&quot;)
                                Dim R as New Regex(&quot;[A-Z,0-9,/]*(?&lt;Result&gt;[أ-ي,0-9]*)&quot;, RegexOptions.SingleLine)
                                Dim M as Match = R.Match(c1.Rows(i)(&quot;Description&quot;))
                                If M IsNot Nothing AndAlso M.Success Then
                                    dec = M.Groups(&quot;Result&quot;).Value
                                End If
                                End
                                If         c1.Rows(i)(&quot;Description&quot;)= Trim(dec)
                                    end
                                    if     flag=1     count=0     x=0     yy=c1.Rows(i)(&quot;Account date&quot;)
                                        for j as integer =0 to 2         x=Instr(yy,&quot;/&quot;)
                                            If j=0 Then
                                                dd=Left(yy,x-1)             yy=Right(yy,len(yy)-x)
                                            End If
                                        else
                                            if j=1             mm=Left(yy,x-1)             yy=Right(yy,len(yy)-x)
                                                end
                                                if
                                            next
                                            if mm&lt;&gt;&quot;&quot;&#x27;Date.Parse         c1.Rows(i)(&quot;Account date&quot;)=(mm+&quot;/&quot;+dd+&quot;/&quot;+yy)
                                                end
                                                if     &#x27;days=DateDiff(DateInterval.Day,Date.Parse(c1.Rows(i)(&quot;Account date&quot;)),Today())     &#x27;    c1.Rows(i)(&quot;Days&quot;)=days     c1.Rows(i)(&quot;Days&quot;)=DateTime.Parse(c1.Rows(i)(&quot;Account date&quot;))     &#x27;MsgBox(mm+&quot;/&quot;+dd+&quot;/&quot;+yy) dec=&quot;&quot; dd=&quot;&quot; mm=&quot;&quot;  yy=&quot;&quot;
                                                Next  c1.DefaultView.Sort = &quot;Days DESC&quot;  c0 = c1.DefaultView.ToTable
                                            catch e as Exception     &#x27;MsgBox(&quot;error&quot;)         ReassignFlag=1         Status=&quot;Code Error:&quot;+e.ToString
                                                end
                                                try"
                            data-title="UWCA_Balloon_Refinance_CTF_V1.0 / New Salary Logic / Salary code requirements1">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>UWCA_Balloon_Refinance_CTF_V1.0</td>
                <td>New Salary Logic</td>
                <td>Salary code requirements2</td>
                <td>visualbasic</td>
                <td>71</td>
                <!--<td style="font-family: monospace;">6372db1f3d49c20eec036798fe93aef37dd9eeecdc97fc46ed904173b18bff1e</td>-->
                <td>reflection</td>
                <!--<td>&#x27;Page1 try     If Not c1.Columns.Contains(&quot;Sal&quot;) Then         c1.Columns.Add(&quot;Sal&quot;, Type.GetType(&quot;System.Decimal&quot;))     End If     End     If     For r As Integer = 0 To c1.Rows.Count - 1         c1.Rows(r)(&quot;Sal&quot;) = Replace(Replace(c1.Rows(r)(&quot;Amount&quot;), &quot;.&quot;, &quot;&quot;), &quot;,&quot;, &quot;.&quot;)         c1.Rows(r)(&quot;Sal&quot;)=...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="&#x27;Page1
try
    If Not c1.Columns.Contains(&quot;Sal&quot;) Then
        c1.Columns.Add(&quot;Sal&quot;, Type.GetType(&quot;System.Decimal&quot;))
    End If
    End
    If
    For r As Integer = 0 To c1.Rows.Count - 1         c1.Rows(r)(&quot;Sal&quot;) = Replace(Replace(c1.Rows(r)(&quot;Amount&quot;), &quot;.&quot;, &quot;&quot;), &quot;,&quot;, &quot;.&quot;)         c1.Rows(r)(&quot;Sal&quot;)=Convert.ToDecimal(c1.Rows(r)(&quot;Sal&quot;))
    Next  &#x27;Filtering &lt;1900
    If Not GovFlag then
        Dim NewRow As DataRow  C0 = C1.Clone
        For Each parentRow As DataRow In C1.Select(Select_Condition)         NewRow = C0.NewRow
            For Each c As DataColumn In NewRow.Table.Columns             NewRow(c.ColumnName) = parentRow(c.ColumnName)
            Next         C0.Rows.Add(NewRow)
        Next   NewRow = Nothing C1 = Nothing  &#x27;Page2 C1=C0
        End
        If
        Dim x as integer = 0
        Dim dd,mm,yy as string
        Dim count as integer =0
        dim dec
        dim flag as integer=1
        dim days as integer =0 dec=&quot;&quot; dd=&quot;&quot; mm=&quot;&quot; yy=&quot;&quot; &#x27;
        If Not c1.Columns.Contains(&quot;ADate&quot;) Then
            &#x27;    c1.Columns.Add(&quot;ADate&quot;, Type.GetType(&quot;System.String&quot;)) &#x27;
        End If
        End
        if
        If Not c1.Columns.Contains(&quot;Days&quot;) Then
            c1.Columns.Add(&quot;Days&quot;, Type.GetType(&quot;System.DateTime&quot;))
        End If
        End
        if
        For i As Integer = 0 To c1.Rows.Count - 1     &#x27;c1.Rows(i)(&quot;Description&quot;)=Replace(c1.Rows(i)(&quot;Description&quot;),&quot; &quot;,&quot;&quot;)     &#x27;
            if Left(c1.Rows(i)(&quot;Description&quot;),7) =  &quot;PAYR/&quot; OR Left(c1.Rows(i)(&quot;Description&quot;),7) =  &quot;SAL/&quot;         &#x27;c1.Rows(i)(&quot;Description&quot;) = Replace(Replace(c1.Rows(i)(&quot;Description&quot;),&quot;PAYROL/&quot;,&quot;&quot;),&quot;SALARY/&quot;,&quot;&quot;)     &#x27;
                end
                if     &#x27;test=c1.Rows(i)(&quot;Description&quot;)     &#x27;
                    do         &#x27;x = InStr(test, &quot;/&quot;)     &#x27;if(x&gt;0)         &#x27;    test=Replace(test, Left(test, x),&quot;&quot;)     &#x27;
                        if flag=1         &#x27;dec=test         &#x27;flag = 0     &#x27;
                            end
                            if         &#x27;    count = count+1     &#x27;
                            end if         &#x27;
                        loop
                        while x&lt;&gt;0     &#x27;
                            if count&gt;2     &#x27;    c1.Rows(i)(&quot;Description&quot;)= Trim(dec)     &#x27;
                            else &#x27;        dec=&quot;arb: &quot;+c1.Rows(r)(&quot;Description&quot;) &#x27;         &#x27;
                                Dim R as New Regex(&quot;[A-Z,0-9,/]*(?&lt;Result&gt;[أ-ي,0-9]*)&quot;, RegexOptions.SingleLine)         &#x27;
                                Dim M as Match = R.Match(c1.Rows(i)(&quot;Description&quot;))         &#x27;
                                If M IsNot Nothing AndAlso M.Success Then
                                    &#x27;dec = M.Groups(&quot;Result&quot;).Value         &#x27;
                                End If
                                End
                                If         &#x27;c1.Rows(i)(&quot;Description&quot;)= Trim(dec)         &#x27;
                                    end
                                    if     &#x27;flag=1     &#x27;count=0     &#x27;x=0     yy=c1.Rows(i)(&quot;Account date&quot;)
                                        for j as integer =0 to 2         x=Instr(yy,&quot;/&quot;)
                                            If j=0 Then
                                                dd=Left(yy,x-1)             yy=Right(yy,len(yy)-x)
                                            End If
                                        else
                                            if j=1             mm=Left(yy,x-1)             yy=Right(yy,len(yy)-x)
                                                end
                                                if
                                            next
                                            if mm&lt;&gt;&quot;&quot;&#x27;Date.Parse         c1.Rows(i)(&quot;Account date&quot;)=(mm+&quot;/&quot;+dd+&quot;/&quot;+yy)
                                                end
                                                if     &#x27;days=DateDiff(DateInterval.Day,Date.Parse(c1.Rows(i)(&quot;Account date&quot;)),Today())     &#x27;    c1.Rows(i)(&quot;Days&quot;)=days     c1.Rows(i)(&quot;Days&quot;)=DateTime.Parse(c1.Rows(i)(&quot;Account date&quot;))     &#x27;MsgBox(mm+&quot;/&quot;+dd+&quot;/&quot;+yy) dec=&quot;&quot; dd=&quot;&quot; mm=&quot;&quot;  yy=&quot;&quot;
                                                Next  c1.DefaultView.Sort = &quot;Days DESC&quot;  c0 = c1.DefaultView.ToTable
                                            catch e as Exception     &#x27;MsgBox(&quot;error&quot;)         ReassignFlag=1         Status=&quot;Code Error:&quot;+e.ToString
                                                end
                                                try"
                            data-title="UWCA_Balloon_Refinance_CTF_V1.0 / New Salary Logic / Salary code requirements2">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>UWCA_Balloon_Refinance_CTF_V1.0</td>
                <td>Salar logic new</td>
                <td>Salary code requirements2</td>
                <td>visualbasic</td>
                <td>61</td>
                <!--<td style="font-family: monospace;">32bd0a85cddc0a51451264d023591d5b9b12eb75caa12e5e2187593d90580c38</td>-->
                <td>reflection</td>
                <!--<td>&#x27;Page1 If Not c1.Columns.Contains(&quot;Sal&quot;) Then     c1.Columns.Add(&quot;Sal&quot;, Type.GetType(&quot;System.Decimal&quot;)) End If End If For r As Integer = 0 To c1.Rows.Count - 1         c1.Rows(r)(&quot;Sal&quot;) = Replace(Replace(c1.Rows(r)(&quot;Amount&quot;), &quot;.&quot;, &quot;&quot;), &quot;,&quot;, &quot;.&quot;)         c1.Rows(r)(&quot;Sal&quot;)=Convert.ToDecimal(c1.Rows(r)...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="&#x27;Page1
If Not c1.Columns.Contains(&quot;Sal&quot;) Then
    c1.Columns.Add(&quot;Sal&quot;, Type.GetType(&quot;System.Decimal&quot;))
End If
End
If
For r As Integer = 0 To c1.Rows.Count - 1         c1.Rows(r)(&quot;Sal&quot;) = Replace(Replace(c1.Rows(r)(&quot;Amount&quot;), &quot;.&quot;, &quot;&quot;), &quot;,&quot;, &quot;.&quot;)         c1.Rows(r)(&quot;Sal&quot;)=Convert.ToDecimal(c1.Rows(r)(&quot;Sal&quot;))
Next  &#x27;Filter
Dim NewRow As DataRow  C0 = C1.Clone
For Each parentRow As DataRow In C1.Select(Select_Condition)     NewRow = C0.NewRow
    For Each c As DataColumn In NewRow.Table.Columns         NewRow(c.ColumnName) = parentRow(c.ColumnName)
    Next     C0.Rows.Add(NewRow)
Next  NewRow = Nothing C1 = Nothing  &#x27;Page2 C1=C0
Dim x as integer = 0
Dim dd,mm,yy as string
Dim count as integer =0
dim test,dec
dim flag as integer=1
dim days as integer =0 dec=&quot;&quot; dd=&quot;&quot; mm=&quot;&quot; yy=&quot;&quot; &#x27;
If Not c1.Columns.Contains(&quot;ADate&quot;) Then
    &#x27;    c1.Columns.Add(&quot;ADate&quot;, Type.GetType(&quot;System.String&quot;)) &#x27;
End If
End
if
If Not c1.Columns.Contains(&quot;Days&quot;) Then
    c1.Columns.Add(&quot;Days&quot;, Type.GetType(&quot;System.Decimal&quot;))
End If
End
if
For i As Integer = 0 To c1.Rows.Count - 1     test=c1.Rows(i)(&quot;Description&quot;)
    do         x = InStr(test, &quot;/&quot;)     if(x&gt;0)             test=Replace(test, Left(test, x),&quot;&quot;)
        if flag=1         dec=test         flag = 0
            end
            if             count = count+1
            end if
        loop
        while x&lt;&gt;0
            if count&gt;2         c1.Rows(i)(&quot;Description&quot;)= Trim(dec)
            else &#x27;        dec=&quot;arb: &quot;+c1.Rows(r)(&quot;Description&quot;)
                Dim R as New Regex(&quot;[A-Z]*[0-9]*(?&lt;Result&gt;.*)&quot;, RegexOptions.SingleLine)
                Dim M as Match = R.Match(c1.Rows(i)(&quot;Description&quot;))
                If M IsNot Nothing AndAlso M.Success Then
                    dec = M.Groups(&quot;Result&quot;).Value
                End If
                End
                If         c1.Rows(i)(&quot;Description&quot;)= Trim(dec)
                    end
                    if     flag=1     count=0     x=0     yy=c1.Rows(i)(&quot;Account date&quot;)
                        for j as integer =0 to 2         x=Instr(yy,&quot;/&quot;)
                            If j=0 Then
                                dd=Left(yy,x-1)             yy=Right(yy,len(yy)-x)
                            End If
                        else
                            if j=1             mm=Left(yy,x-1)             yy=Right(yy,len(yy)-x)
                                end
                                if
                            next
                            if mm&lt;&gt;&quot;&quot;&#x27;Date.Parse         c1.Rows(i)(&quot;Account date&quot;)=(mm+&quot;/&quot;+dd+&quot;/&quot;+yy)
                                end
                                if     days=DateDiff(DateInterval.Day,Date.Parse(c1.Rows(i)(&quot;Account date&quot;)),Today())         c1.Rows(i)(&quot;Days&quot;)=days dec=&quot;&quot; dd=&quot;&quot; mm=&quot;&quot;  yy=&quot;&quot;
                                Next  c1.DefaultView.Sort = &quot;Days&quot; &amp; &quot; ASC&quot;  c0 = c1.DefaultView.ToTable"
                            data-title="UWCA_Balloon_Refinance_CTF_V1.0 / Salar logic new / Salary code requirements2">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>UWCA_Balloon_Refinance_CTF_V1.0</td>
                <td>Salar logic new</td>
                <td>Universal salary code</td>
                <td>visualbasic</td>
                <td>326</td>
                <!--<td style="font-family: monospace;">d9018d38a95c6937618378b5ff57a6bd4dfdecab074454201b3c73ea262f9765</td>-->
                <td>—</td>
                <!--<td>try     Dim description as string     Dim x As DataRow = D1.NewRow     Dim Dflag as integer =0     Dim precount as integer =0     Dim Amount as integer =0     Dim Avg as Decimal=0     Dim Sum as integer =0     Dim skip as integer =0     Dim min as integer =0     Dim count as integer =0     Dim Av as...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="try
    Dim description as string
    Dim x As DataRow = D1.NewRow
    Dim Dflag as integer =0
    Dim precount as integer =0
    Dim Amount as integer =0
    Dim Avg as Decimal=0
    Dim Sum as integer =0
    Dim skip as integer =0
    Dim min as integer =0
    Dim count as integer =0
    Dim Av as integer =0
    Dim mi as integer =0
    Dim minim as string min=0 count=0 minim=&quot;&quot;
    if c1.Rows.Count&gt;2 then
        For r As Integer = 0 To c1.Rows.Count-1         description=c1.Rows(r)(&quot;Description&quot;)         Dflag=0
            for i as integer=0 To D1.Rows.Count-1
                If D1.Rows(i)(&quot;Description&quot;)=description Then
                    Dflag=1                 D1.Rows(i)(&quot;Count&quot;)=D1.Rows(i)(&quot;Count&quot;)+1
                End If
                end
                if
            next
            If Dflag=0 Then
                x(&quot;Description&quot;) = description             x(&quot;Count&quot;)=1             D1.Rows.Add(x)             x= D1.NewRow
            End If
            end
            if
        Next
        For r As Integer = 0 To D1.Rows.Count-1         description=D1.Rows(r)(&quot;Description&quot;)         CollOut=Nothing         CollOut=c1.Clone
            For Each parentRow As DataRow In c1.Select(&quot;Description=&#x27;&quot;+description+&quot;&#x27;&quot;)             x = CollOut.NewRow
                For Each c As DataColumn In x.Table.Columns                     x(c.ColumnName) = parentRow(c.ColumnName)
                Next             CollOut.Rows.Add(x)
            Next         count=CollOut.Rows.Count
            If count&gt;precount Then
                Buffer=Nothing             Buffer = CollOut.Clone             Buffer=CollOut             precount=count             ReassignFlag=0
            End If
        else
            if count = Precount             ReassignFlag=1             Status=&quot;Salary cannot be identified since there mode are equal&quot;
                end
                if
            next
            Dim SD1p,SD1m,SD2p,SD2m,SD3p,SD3m,SD4p,SD4m as date
            Dim Sflag as integer =0
            Dim Salflag as integer =0
            Dim Lflag as integer =0
            Dim L2flag as integer =0
            Dim LLcheck as integer =0
            Dim BasicSalary as Integer =0
            Dim T as DataTable =Buffer.Clone
            Dim T2 as DataTable=Buffer.Clone
            Dim TX as DataTable=Buffer.Clone
            Dim LL as DataTable=Buffer.Clone
            Dim LL1 as DataTable=Buffer.Clone
            Dim L2 as DataTable=Buffer.Clone
            Dim L21 as DataTable=Buffer.Clone
            Dim L3 as DataTable=Buffer.Clone
            Dim Tcounter as integer =0
            Dim L3counter as integer =0
            Dim T2counter as integer =0
            Dim BSp,BSm as Decimal      Sum=0     minimum=0     Salary=0     Other=0     min=0     SD1p=SD1.AddDays(5)     SD1m=SD1.AddDays(-5)     SD2p=SD2.AddDays(5)     SD2m=SD2.AddDays(-5)     SD3p=SD3.AddDays(5)     SD3m=SD3.AddDays(-5)     SD4p=SD4.AddDays(9)     SD4m=SD4.AddDays(-9)     &#x27;        T=Buffer.Clone
            For r As Integer = 0 To Buffer.Rows.Count-1         if((SD1m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))OR (SD2m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD3m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD3p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD4m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD4p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))) then             x= Buffer.Rows(r)             TX.ImportRow(x)             x=TX.NewRow
            end if
        next     Buffer=TX
        For r As Integer = 0 To Buffer.Rows.Count-1     &#x27;
            If (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3) Then
                if(SD1m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) then             x= Buffer.Rows(r)             LL.ImportRow(x)             x=LL.NewRow             Lflag=Lflag+1
            End If
        end if
    next
    If Lflag&lt;1 Then
        Lflag=0         x=LL1.NewRow
    End If
    For r As Integer = 0 To Buffer.Rows.Count-1             if(SD1=Buffer.Rows(r)(&quot;Account date&quot;)) then                 x= Buffer.Rows(r)                 LL1.ImportRow(x)                 x=LL1.NewRow                 Lflag=Lflag+1
    end if
next         LL=LL1
end
if      LLout=LL &#x27;+++++++++++++++++++++++++++
    If Lflag&gt;0 Then
        &#x27;+++++++++++++++++++++++++++
    End If
    if Lflag=1 then
        For r As Integer = 0 To Buffer.Rows.Count-1                 if(SD2m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) then                     x= Buffer.Rows(r)                     L2.ImportRow(x)                     x=L2.NewRow                     L2flag=L2flag+1
        end if
    next
    If L2flag&gt;0 Then
        test=101
    End If
    If L2flag=1 Then
        test=120
    End If
    If L2.Rows(0)(&quot;Sal&quot;)&gt;=LL.Rows(0)(&quot;Sal&quot;) Then
        salflag=1                         Salary=LL.Rows(0)(&quot;Amount&quot;)                         ReassignFlag=0     test=100
    End If
else                         x=L3.NewRow
    For r As Integer = 0 To Buffer.Rows.Count-1                             if((SD1m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD2m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD3m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD3p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD4m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD4p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))) then                                 x= Buffer.Rows(r)                                 L3.ImportRow(x)                                 x=L3.NewRow                                 L3counter=L3counter+1
    end if
next
If L3counter&gt;2 Then
    min=L3.Rows(0)(&quot;Sal&quot;)+1
End If
For k As Integer = 0 To 2                                 Sum=Sum+L3.Rows(k)(&quot;Sal&quot;)
    If min&gt;L3.Rows(k)(&quot;Sal&quot;) Then
        min=L3.Rows(k)(&quot;Sal&quot;)                                     minimum=L3.Rows(k)(&quot;Amount&quot;)
    End If
    end
    if
next                              Avg=Sum/3
If Avg&lt;1.2*min Then
    Salary=minimum                                 Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)                                 salflag=1
End If
else                                 salflag=0
    end
    if
else                                     salflag=0
    end
    if
    end
    if
else test=110                     L2flag=0                     x=L21.NewRow
    For r As Integer = 0 To Buffer.Rows.Count-1                         if(SD2=Buffer.Rows(r)(&quot;Account date&quot;)) then                             x= Buffer.Rows(r)                             L21.ImportRow(x)                             x=L21.NewRow                             L2flag=L2flag+1
    end if
next                     L2=L21
if L2flag=1 then
    If L2.Rows(0)(&quot;Sal&quot;)&gt;=LL.Rows(0)(&quot;Sal&quot;) Then
        salflag=1                             Salary=LL.Rows(0)(&quot;Amount&quot;)                             ReassignFlag=0
    End If
    end
    if
    end
    if
    end
    if
    If salflag=0 Then
        &#x27;test=102 &#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;                     Sum=0
    End If
    For r As Integer = 0 To Buffer.Rows.Count-1                     &#x27;
        if (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1) then
            If (SD1m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) Then
                Sflag=Sflag+1                             BasicSalary=Buffer.Rows(r)(&quot;Sal&quot;)                             &#x27;AM=BasicSalary
            End If
            end
            if
        Next                     &#x27;AM=BasicSalary
        If Sflag=1 Then
            x=T.NewRow
        End If
        For r As Integer = 0 To Buffer.Rows.Count-1                     &#x27;
            If (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3) Then
                if((SD1m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD2m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD3m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD3p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD4m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD4p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))) then                                 x= Buffer.Rows(r)                                 T.ImportRow(x)                                 x=T.NewRow                                 Tcounter=Tcounter+1
            End If
        end if
    next
    if Tcounter&lt;2                             ReassignFlag=1                             Status=&quot;Total number of feasible transaction is less than 2 after filtering with +/-5 salary date I&quot;
    else                             BSp=BasicSalary+(BasicSalary*20/100)                             BSm=BasicSalary-(BasicSalary*20/100)                             x=T2.NewRow
        for r as integer=0 to T.Rows.count-1                                 if(T.Rows(r)(&quot;Sal&quot;)&gt;=BSm AND T.Rows(r)(&quot;Sal&quot;)&lt;=BSp)                                     x= T.Rows(r)                                     T2.ImportRow(x)                                     x=T2.NewRow                                     T2counter=T2counter+1
            end
            if
        next
        If T2counter&lt;2 Then
            ReassignFlag=1                                 Status=&quot;Total number of feasible transaction is less than 2 after filtering BSm &lt;= Salary &lt;=BSp&quot;
        End If
    else
        if T2counter=2                                 min=T2.Rows(0)(&quot;Sal&quot;)+1
            For k As Integer = 0 To 1                                     Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                    min=T2.Rows(k)(&quot;Sal&quot;)                                         minimum=T2.Rows(k)(&quot;Amount&quot;)
                End If
                end
                if
            next                                 Avg= Sum / 2
            If Avg&lt;1.2*min Then
                test=2                                     Salary=minimum                                     Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
            End If
        else             test=2.1                                     Salary=minimum
            end
            if
        else                                 min=T2.Rows(0)(&quot;Sal&quot;)+1
            For k As Integer = 0 To 2                                     Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                    min=T2.Rows(k)(&quot;Sal&quot;)                                         minimum=T2.Rows(k)(&quot;Amount&quot;)
                End If
                end
                if
            next                                 Avg= Sum / 3
            If Avg&lt;1.2*min Then
                test=2                                     Salary=minimum                                     Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
            End If
        else             test=2.1                                     Salary=minimum
            end
            if
        end if
        end
        if
    else &#x27;=============================================================AA===================================================BEGIN
        Dim T3 as DataTable=Buffer.Clone
        Dim Tcounter2 as integer=0
        for r as integer =0 to Buffer.Rows.Count-1                             if(Buffer.Rows(r)(&quot;Sal&quot;)&gt;=LastApproved) then                                 x=T3.NewRow                                 x=Buffer.Rows(r)                                 T3.ImportRow(x)                                 Tcounter2=Tcounter2+1                                 BasicSalary=Buffer.Rows(r)(&quot;Sal&quot;)
            end
            if
        next                             Cop=Buffer &#x27;===============================================================BB=============================================BEGIN                         if(Tcounter2=1)                             x=T.NewRow
        For r As Integer = 0 To Buffer.Rows.Count-1                                 if((SD1m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))OR (SD2m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD3m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD3p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD4m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD4p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))) then                                     x= Buffer.Rows(r)                                     T.ImportRow(x)                                     x=T.NewRow                                     Tcounter=Tcounter+1
        end if
    next
    if Tcounter&lt;2                                 ReassignFlag=1                                 Status=&quot;Total number of feasible transaction is less than 2 after filtering with +/-5 salary date in AA-BB-Gov I&quot;
    else                                 BSp=BasicSalary+(BasicSalary*20/100)                                 BSm=BasicSalary-(BasicSalary*20/100)                                 x=T2.NewRow
        for r as integer=0 to T.Rows.count-1                                     if(T.Rows(r)(&quot;Sal&quot;)&gt;=BSm AND T.Rows(r)(&quot;Sal&quot;)&lt;=BSp)                                         x= T.Rows(r)                                         T2.ImportRow(x)                                         x=T2.NewRow                                         T2counter=T2counter+1
            end
            if
        next
        If T2counter&lt;2 Then
            ReassignFlag=1                                     Status=&quot;Total number of feasible transaction is less than 2 after filtering with +/-5 salary date in AA-BB-Gov II&quot;
        End If
    else
        if T2counter=2                                     min=T2.Rows(0)(&quot;Sal&quot;)+1
            For k As Integer = 0 To 1                                         Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                    min=T2.Rows(k)(&quot;Sal&quot;)                                             minimum=T2.Rows(k)(&quot;Amount&quot;)
                End If
                end
                if
            next                                     Avg= Sum / 2
            If Avg&lt;1.2*min Then
                test=3                                         Salary=minimum                                         Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
            End If
        else             test=3.1                                         Salary=minimum
            end
            if
        else                                     min=T2.Rows(0)(&quot;Sal&quot;)+1
            For k As Integer = 0 To 2                                         Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                    min=T2.Rows(k)(&quot;Sal&quot;)                                             minimum=T2.Rows(k)(&quot;Amount&quot;)
                End If
                end
                if
            next                                     Avg= Sum / 3
            If Avg&lt;1.2*min Then
                test=3                                         Salary=minimum                                         Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
            End If
        else             test=3.1                                         Salary=minimum
            end
            if
        end if
        end
        if &#x27;===============================================================BB=============================================END
        else
            Dim Count4 as integer=0
            Dim Prev as integer =0
            Dim Base as Decimal=0
            for r as integer=0 to A1.Rows.Count-1
                For j as integer=0 to T3.Rows.Count-1
                    if A1.Rows(r)(&quot;Amount&quot;)=T3.Rows(j)(&quot;Sal&quot;)                                         Count4=Count4+1
                        end
                        if
                    next
                    if prev&lt;Count4                                     BasicSalary=A1.Rows(r)(&quot;Amount&quot;)                                     prev=Count4
                        end
                        if                                 Count4=0
                        next                                             x=T.NewRow
                        For r As Integer = 0 To Buffer.Rows.Count-1                                 if((SD1m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))OR (SD2m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD3m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD3p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD4m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD4p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))) then                                     x= Buffer.Rows(r)                                     T.ImportRow(x)                                     x=T.NewRow                                     Tcounter=Tcounter+1
                        end if
                    next
                    if Tcounter&lt;2                                 ReassignFlag=1                                 Status=&quot;Total number of feasible transaction is less than 2 after filtering with +/-5 salary date in AA-BB-Gov III&quot;
                    else                                 BSp=BasicSalary+(BasicSalary*20/100)                                 BSm=BasicSalary-(BasicSalary*20/100)                                 x=T2.NewRow
                        for r as integer=0 to T.Rows.count-1                                     if(T.Rows(r)(&quot;Sal&quot;)&gt;=BSm AND T.Rows(r)(&quot;Sal&quot;)&lt;=BSp)                                         x= T.Rows(r)                                         T2.ImportRow(x)                                         x=T2.NewRow                                         T2counter=T2counter+1
                            end
                            if
                        next
                        If T2counter&lt;2 Then
                            ReassignFlag=1                                     Status=&quot;Total number of feasible transaction is less than 2 after filtering BSm&lt;= SAL &lt;=BSp in AA-BB-Gov IV&quot;
                        End If
                    else
                        if T2counter=2                                     min=T2.Rows(0)(&quot;Sal&quot;)+1
                            For k As Integer = 0 To 1                                         Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                    min=T2.Rows(k)(&quot;Sal&quot;)                                             minimum=T2.Rows(k)(&quot;Amount&quot;)
                                End If
                                end
                                if
                            next                                     Avg= Sum / 2
                            If Avg&lt;1.2*min Then
                                test=4                                         Salary=minimum                                         Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                            End If
                        else             test=4.1                                         Salary=minimum
                            end
                            if
                        else                                      min=T2.Rows(0)(&quot;Sal&quot;)+1
                            For k As Integer = 0 To 2                                         Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                    min=T2.Rows(k)(&quot;Sal&quot;)                                             minimum=T2.Rows(k)(&quot;Amount&quot;)
                                End If
                                end
                                if
                            next                                     Avg= Sum / 3
                            If Avg&lt;1.2*min Then
                                test=4                                         Salary=minimum                                         Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                            End If
                        else             test=4.1                                         Salary=minimum
                            end
                            if
                        end if
                        end
                        if
                        end
                        if
                        end
                        if
                        end
                        if                 &#x27;
                            end
                            if &#x27;=============================================================AA===================================================    END
                            else                  ReassignFlag=1                 Status=&quot;No transaction available in 2nd last month&quot;
                                end
                                if
                            else              Status=&quot;More than one transaction in +/-5 days of last month salary date&quot;             ReassignFlag=1
                                end
                                if
                            else         Status=&quot;No transaction in of last salary date&quot;         ReassignFlag=1
                                end
                                if
                            else      Status=&quot;Total number of feasible transaction is less than 3&quot;     ReassignFlag=1
                                end
                                if D0=D1 A0=A1
                                catch e as Exception         er=e.ToString         ReassignFlag=1         Status=&quot;Code Error:&quot;+e.ToString
                                    end
                                    try"
                            data-title="UWCA_Balloon_Refinance_CTF_V1.0 / Salar logic new / Universal salary code">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>UWCA_Balloon_Refinance_CTF_V1.0</td>
                <td>SimahLogic</td>
                <td>Simah Code</td>
                <td>visualbasic</td>
                <td>238</td>
                <!--<td style="font-family: monospace;">857631317b0a26fdbac6cbcbdf539d94e940fa89300ef5a93df526d64eea855e</td>-->
                <td>reflection</td>
                <!--<td>&#x27;Simah logic is to check other banks outstanding amout. if any of the cusotmer have more than expected outstanding amout BOT will reassign the case.     Dim Company_Type,Product_Type,Status_W,Status_Hiso     try as String         Dim DefaultProductCode,DefaultStatusCode,DefaultOutStandingAmount,Defa...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="&#x27;Simah logic is to check other banks outstanding amout.
if any of the cusotmer have more than expected outstanding amout BOT will reassign the case.
    Dim Company_Type,Product_Type,Status_W,Status_Hiso
    try as String
        Dim DefaultProductCode,DefaultStatusCode,DefaultOutStandingAmount,DefaultDate,DefaultCredit,TotOutstandingAmount,TotOutStandingAmountNONMobile,TotOutStandingAmountMilitory ,TotOutStandingAmountGov,TotOutStandingAmountPrivate as String
        Dim NSDateDiff as Integer
        Dim Status_Flag as Boolean=False
        Dim Rajb_Flag as Boolean =False
        Dim FlagForSimahApprovalOrRejection as Boolean=False ReassignFlag =&quot;&quot; ReassignReason=&quot;&quot;
        Dim NWtable as new DataTable
        Dim TotalOutstandingAmountNONMobile as Double=0
        Dim TotalOutstandingAmountMilitory as Double=0
        Dim TotalOutstandingAmountGov as Double=0
        Dim TotalOutstandingAmountPrivate as Double=0
        Dim TotalOutstandingAmount as Double=0 NWtable.Columns.Add(&quot;Column1&quot;, Type.GetType(&quot;System.String&quot;)) NWtable.Columns.Add(&quot;Column2&quot;, Type.GetType(&quot;System.String&quot;)) NWtable.Columns.Add(&quot;Column20&quot;, Type.GetType(&quot;System.String&quot;)) NWtable.Columns.Add(&quot;Column14&quot;, Type.GetType(&quot;System.String&quot;))  &#x27;check wether CreditDetails table contain status as W and Company_Type either RAJB or ADFL leave those rows. Other than that add to NWtable.
        If  CreditDetails.Rows.Count&gt;=3 Then
            For i As Integer = 0 To CreditDetails.Rows.Count - 1
                If i&gt;=2 Then
                    Company_Type=CreditDetails.Rows(i)(&quot;Column1&quot;)         Product_Type=CreditDetails.Rows(i)(&quot;Column2&quot;)         Status_W=CreditDetails.Rows(i)(&quot;Column7&quot;)         Status_Hiso
                End If
                try=CreditDetails.Rows(i)(&quot;Column20&quot;)
                    If Status_W=&quot;W&quot; Then
                        Status_Flag=True
                    End If
                else
                    if Company_Type=&quot;RAJB&quot; OR Company_Type=&quot;ADFL&quot; then
                    else         NWtable.Rows.Add(CreditDetails.Rows(i)(&quot;Column1&quot;),CreditDetails.Rows(i)(&quot;Column2&quot;),CreditDetails.Rows(i)(&quot;Column20&quot;),CreditDetails.Rows(i)(&quot;Column14&quot;))
                        end
                        if
                    end if
                Next
                End
                If   &#x27;
                    If Status is W(defaulter) and Defaulter table having more than 2 records. calculate outstanding amount based on the business rules.
                        If DefaultTable.Rows.Count&gt;=3 Then
                            For j As Integer = 0 To DefaultTable.Rows.Count - 1
                                If j &gt;= 2 Then
                                    &#x27;Start If1             DefaultProductCode=Trim(DefaultTable.Rows(j)(&quot;Column1&quot;))             DefaultStatusCode=Trim(DefaultTable.Rows(j)(&quot;Column6&quot;))             DefaultOutStandingAmount=Trim(DefaultTable.Rows(j)(&quot;Column5&quot;))              DefaultDate=DefaultTable.Rows(j)(&quot;Column3&quot;)             DefaultCredit=Trim(DefaultTable.Rows(j)(&quot;Column2&quot;))                 NSDateDiff=DateDiff(&quot;d&quot;,Convert.ToDateTime(DefaultDate),Now())
                                End If
                                If DefaultProductCode=&quot;MBL&quot; OR DefaultProductCode=&quot;LND&quot; OR DefaultProductCode=&quot;NET&quot; OR DefaultProductCode=&quot;RCSR&quot; OR DefaultProductCode=&quot;AQAR&quot; Then
                                    &#x27;Start If2
                                End If
                                If DefaultProductCode=&quot;AQAR&quot; OR DefaultProductCode=&quot;ADFL&quot; Then
                                    &#x27;Start If3                 &#x27;
                                End If
                                If above 2 condition match BOT will continue to take other record.
                                else
                                    If DefaultStatusCode=&quot;OS&quot; OR DefaultStatusCode=&quot;PP&quot; Then
                                        &#x27;Start If4                     TotOutStandingAmount=Replace(Replace(DefaultOutStandingAmount,&quot;.&quot;,&quot;&quot;),&quot;,&quot;,&quot;.&quot;)                                         TotalOutstandingAmount=TotalOutstandingAmount+CDbl(TotOutStandingAmount)
                                    End If
                                else
                                    if DefaultStatusCode=&quot;NS&quot; then
                                        If NSDateDiff&gt;=180 Then
                                            &#x27;Start If5
                                        End If
                                        If MilitoryStatus=True Then
                                            &#x27;Start If6                             TotOutStandingAmountMilitory=Replace(Replace(DefaultOutStandingAmount,&quot;.&quot;,&quot;&quot;),&quot;,&quot;,&quot;.&quot;)                                 TotalOutstandingAmountMilitory=TotalOutstandingAmountMilitory+CDbl(TotOutStandingAmountMilitory)
                                        End If
                                    else
                                        If Gov Then
                                            TotOutStandingAmountGov=Replace(Replace(DefaultOutStandingAmount,&quot;.&quot;,&quot;&quot;),&quot;,&quot;,&quot;.&quot;)                                 TotalOutstandingAmountGov=TotalOutstandingAmountGov+CDbl(TotOutStandingAmountGov)
                                        End If
                                    else                             TotOutStandingAmountPrivate=Replace(Replace(DefaultOutStandingAmount,&quot;.&quot;,&quot;&quot;),&quot;,&quot;,&quot;.&quot;)                                 TotalOutstandingAmountPrivate=TotalOutstandingAmountPrivate+CDbl(TotOutStandingAmountPrivate)
                                        end
                                        If &#x27;
                                        End If6
                                    else                         ReassignFlag=&quot;Reject&quot;                         ReassignReason=&quot;Rejected since simah check failed for the NS date condition&quot;
                                        Return
                                        end
                                        if &#x27;
                                        End If5
                                        End
                                        If &#x27;
                                        End If4
                                        End
                                        If  &#x27;
                                        End If3
                                    else
                                        if DefaultProductCode=&quot;RAJB&quot; then
                                            If DefaultStatusCode=&quot;OS&quot; OR DefaultStatusCode=&quot;PP&quot; OR DefaultStatusCode=&quot;NS&quot; Then
                                                &#x27;Start If7                     Rajb_Flag=True
                                            End If
                                            End
                                            If &#x27;
                                            End If7
                                        else
                                            if DefaultProductCode=&quot;ADFL&quot; then
                                                If DefaultCredit=&quot;RAJB&quot; then&#x27;Start If8
                                                    If DefaultStatusCode=&quot;OS&quot; OR DefaultStatusCode=&quot;PP&quot; OR DefaultStatusCode=&quot;NS&quot; Then
                                                        &#x27;Start If9                         Rajb_Flag=True
                                                    End If
                                                    End
                                                    If &#x27;
                                                    End If9
                                                    end
                                                    If &#x27;
                                                    End If8
                                                else                 &#x27;MsgBox(TotalOutstandingAmountNONMobile.ToString())
                                                    If DefaultStatusCode=&quot;OS&quot; OR DefaultStatusCode=&quot;PP&quot; Then&#x27;Start If10                         TotOutStandingAmountNONMobile=Replace(Replace(DefaultOutStandingAmount,&quot;.&quot;,&quot;&quot;),&quot;,&quot;,&quot;.&quot;)                             TotalOutstandingAmountNONMobile=TotalOutstandingAmountNONMobile+CDbl(TotOutStandingAmountNONMobile)
                                                    else
                                                        if DefaultStatusCode=&quot;NS&quot; then
                                                            If NSDateDiff&gt;=180 Then
                                                                &#x27;Start If11
                                                            End If
                                                            If MilitoryStatus=True Then
                                                                &#x27;Start If12                                 TotOutStandingAmountMilitory=Replace(Replace(DefaultOutStandingAmount,&quot;.&quot;,&quot;&quot;),&quot;,&quot;,&quot;.&quot;)                                     TotalOutstandingAmountMilitory=TotalOutstandingAmountMilitory+CDbl(TotOutStandingAmountMilitory)
                                                            End If
                                                        else
                                                            If Gov Then
                                                                TotOutStandingAmountGov=Replace(Replace(DefaultOutStandingAmount,&quot;.&quot;,&quot;&quot;),&quot;,&quot;,&quot;.&quot;)                                     TotalOutstandingAmountGov=TotalOutstandingAmountGov+CDbl(TotOutStandingAmountGov)
                                                            End If
                                                        else                                 TotOutStandingAmountPrivate=Replace(Replace(DefaultOutStandingAmount,&quot;.&quot;,&quot;&quot;),&quot;,&quot;,&quot;.&quot;)                                     TotalOutstandingAmountPrivate=TotalOutstandingAmountPrivate+CDbl(TotOutStandingAmountPrivate)
                                                            end
                                                            If &#x27;
                                                            End If12
                                                        else                             ReassignFlag=&quot;Reject&quot;                             ReassignReason=&quot;Rejected since simah check failed for the NS date condition&quot;
                                                            Return
                                                        end if    &#x27;
                                                    End If11
                                                    End
                                                    If &#x27;
                                                    End If10
                                                    End
                                                    If &#x27;
                                                    End If2
                                                    end
                                                    if &#x27;
                                                    End If1
                                                Next
                                                End
                                                If   &#x27;
                                                    if any of the outstanding amout greater than expected amout BOt will reject with below comments
                                                        If TotalOutstandingAmountNONMobile &gt;=5000 Then
                                                            ReassignFlag=&quot;Reject&quot; ReassignReason=&quot;Rejected the case since the outstanding amount in simah check the non telecom outstanding amount is greater than 5000&quot;
                                                        End If
                                                        return
                                                    else
                                                        If TotalOutstandingAmount &gt;=20000 Then
                                                            ReassignFlag=&quot;Reject&quot; ReassignReason=&quot;Rejected the case since the outstanding amount in simah check the teleco outstanding balance is greater than 20000&quot;
                                                        End If
                                                        return
                                                    else
                                                        If TotalOutstandingAmountMilitory &gt;=15000 Then
                                                            ReassignFlag=&quot;Reject&quot; ReassignReason=&quot;Rejected since the NS amount for the military category is greater than 15000&quot;
                                                        End If
                                                        return
                                                    else
                                                        If TotalOutstandingAmountGov &gt;=30000 Then
                                                            ReassignFlag=&quot;Reject&quot; ReassignReason=&quot;Rejected since the NS amount for the government category is greater than 30000&quot;
                                                        End If
                                                        return
                                                    else
                                                        If TotalOutstandingAmountPrivate &gt;=10000 Then
                                                            ReassignFlag=&quot;Reject&quot; ReassignReason=&quot;Rejected since the NS amount for the private category is greater than 10000&quot;
                                                        End If
                                                        return
                                                    else
                                                        If Rajb_Flag Then
                                                            ReassignFlag=&quot;Reassign&quot; ReassignReason=&quot;Reassigned the case since there is a RAJB case in simah default list&quot;
                                                        End If
                                                        return
                                                    else
                                                        end
                                                        If
                                                        Dim TelicomCase,StatusHistory,StatusHistory1 as String &#x27;
                                                        If CreditInstrument table have Status with BOT will check that outstanding amout.
                                                            if any of the outstanding amout more than expected BOT will reject the case.
                                                                if NWtable.Rows.Count&gt;=1 then
                                                                    For k As Integer = 0 To NWtable.Rows.Count - 1         TelicomCase=NWtable.Rows(k)(&quot;Column14&quot;)         StatusHistory=NWtable.Rows(k)(&quot;Column20&quot;)         StatusHistory1=Left(StatusHistory,1)         StatusHistory=&quot; &quot;+StatusHistory
                                                                        if StatusHistory1=&quot;0&quot; OR StatusHistory1=&quot;1&quot; OR  StatusHistory1=&quot;2&quot; OR StatusHistory1=&quot;3&quot; OR StatusHistory1=&quot;Q&quot; OR StatusHistory1=&quot;D&quot; then
                                                                        else
                                                                            if StatusHistory1=&quot;M&quot; OR StatusHistory1=&quot;m&quot; Then
                                                                                Dim TempText as String=IsPatternMatch(&quot;(?&lt;Result&gt;[m,M]*)[1-9].*&quot;,StatusHistory)
                                                                                If Trim(TempText)&lt;&gt;&quot;&quot; Then
                                                                                    TempText=IsPatternMatch(&quot;(?&lt;Result&gt;[m,M]*)[1-9].*&quot;,StatusHistory)
                                                                                End If
                                                                                If TempText &lt;&gt; &quot;0&quot; OR TempText &lt;&gt; &quot;1&quot; OR TempText &lt;&gt; &quot;2&quot; OR TempText &lt;&gt; &quot;3&quot; then
                                                                                    If TempText = &quot;4&quot; OR TempText = &quot;5&quot; OR TempText = &quot;6&quot; Then
                                                                                        if Trim(NWtable.Rows(k)(&quot;Column2&quot;))=&quot;MBL&quot; OR Trim(NWtable.Rows(k)(&quot;Column2&quot;))=&quot;LND&quot; OR Trim(NWtable.Rows(k)(&quot;Column2&quot;))=&quot;NET&quot; OR Trim(NWtable.Rows(k)(&quot;Column2&quot;))=&quot;WAT&quot; OR Trim(NWtable.Rows(k)(&quot;Column2&quot;))=&quot;RCSR&quot;  then
                                                                                            If Len(Trim(TelicomCase))&gt; 0 Then
                                                                                                TelicomCase=Replace(Replace(TelicomCase,&quot;.&quot;,&quot;&quot;),&quot;,&quot;,&quot;.&quot;)                                 TotalOutstandingAmount=TotalOutstandingAmount+CDbl(TelicomCase)
                                                                                            End If
                                                                                        else                                 TelicomCase=&quot;0&quot;                                 TotalOutstandingAmount=TotalOutstandingAmount+CDbl(TelicomCase)
                                                                                            end
                                                                                            if
                                                                                            If TotalOutstandingAmount&gt;=20000 Then
                                                                                                ReassignFlag=&quot;Reject&quot;                                 ReassignReason=&quot;Rejected the case since the outstanding amount in simah check since the teleco outstanding balance is greater than 20000&quot;
                                                                                            End If
                                                                                            return
                                                                                            end
                                                                                            if
                                                                                        else                             ReassignFlag=&quot;Reassign&quot;                             ReassignReason=&quot;Reassigned since the simah check failed for the currenmt case&quot;
                                                                                            return
                                                                                            End
                                                                                            If
                                                                                            end
                                                                                            If
                                                                                            end
                                                                                            If
                                                                                            End
                                                                                            If
                                                                                        else
                                                                                            if StatusHistory1=&quot;4&quot; OR StatusHistory1=&quot;5&quot; OR StatusHistory1=&quot;6&quot; then
                                                                                                if Trim(NWtable.Rows(k)(&quot;Column2&quot;))=&quot;MBL&quot; OR Trim(NWtable.Rows(k)(&quot;Column2&quot;))=&quot;LND&quot; OR Trim(NWtable.Rows(k)(&quot;Column2&quot;))=&quot;NET&quot; OR Trim(NWtable.Rows(k)(&quot;Column2&quot;))=&quot;WAT&quot; OR Trim(NWtable.Rows(k)(&quot;Column2&quot;))=&quot;RCSR&quot;  then
                                                                                                    If Len(Trim(TelicomCase))&gt; 0 Then
                                                                                                        TelicomCase=Replace(Replace(TelicomCase,&quot;.&quot;,&quot;&quot;),&quot;,&quot;,&quot;.&quot;)                     TotalOutstandingAmount=TotalOutstandingAmount+CDbl(TelicomCase)
                                                                                                    End If
                                                                                                else                     TelicomCase=&quot;0&quot;                     TotalOutstandingAmount=TotalOutstandingAmount+CDbl(TelicomCase)
                                                                                                    end
                                                                                                    if
                                                                                                    If TotalOutstandingAmount&gt;=20000 Then
                                                                                                        ReassignFlag=&quot;Reject&quot;                     ReassignReason=&quot;Rejected the case since the outstanding amount in simah check since the teleco outstanding balance is greater than 20000&quot;
                                                                                                    End If
                                                                                                    return
                                                                                                    end
                                                                                                    if
                                                                                                else
                                                                                                    if Trim(NWtable.Rows(k)(&quot;Column2&quot;))=&quot;AQAR&quot; OR Trim(NWtable.Rows(k)(&quot;Column2&quot;))=&quot;ADLF&quot; then
                                                                                                    else             FlagForSimahApprovalOrRejection=True
                                                                                                        end
                                                                                                        if
                                                                                                    else
                                                                                                        End
                                                                                                        if
                                                                                                    Next
                                                                                                    End
                                                                                                    if
                                                                                                    If TotalOutstandingAmount&gt;=20000 Then
                                                                                                        ReassignFlag=&quot;Reject&quot; ReassignReason=&quot;Rejected the case since the outstanding amount in simah check since the teleco outstanding balance is greater than 20000&quot;
                                                                                                    End If
                                                                                                    return
                                                                                                    end
                                                                                                    if
                                                                                                    If FlagForSimahApprovalOrRejection = True Then
                                                                                                        ReassignFlag=&quot;Reject&quot; ReassignReason=&quot;Rejected due to Simah check failed since the status history shows rejection code(4,5,6)&quot;
                                                                                                    End If
                                                                                                    return
                                                                                                End If"
                            data-title="UWCA_Balloon_Refinance_CTF_V1.0 / SimahLogic / Simah Code">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>UWCA_Balloon_Refinance_CTF_V1.0</td>
                <td>Yakeen Code Stage</td>
                <td>Yakeen Check Code</td>
                <td>visualbasic</td>
                <td>37</td>
                <!--<td style="font-family: monospace;">d55f86bb7e128049c50ca72e3b640cef6c60cbbcc690109e3bea0f924d4a8e69</td>-->
                <td>—</td>
                <!--<td>reason=&quot;&quot; If y1.rows(9)(&quot;Column2&quot;)=&quot;OK&quot; AND y1.rows(10)(&quot;Column2&quot;)=&quot;OK&quot; AND y1.rows(11)(&quot;Column2&quot;)=&quot;OK&quot; AND y1.rows(12)(&quot;Column2&quot;)=&quot;OK&quot; Then     flag=True End If else flag=False     If y1.rows(9)(&quot;Column2&quot;)&lt;&gt;&quot;OK&quot; Then         reason=y1.rows(9)(&quot;Column1&quot;)     End If     End     If     If y1.rows(10)(...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="reason=&quot;&quot;
If y1.rows(9)(&quot;Column2&quot;)=&quot;OK&quot; AND y1.rows(10)(&quot;Column2&quot;)=&quot;OK&quot; AND y1.rows(11)(&quot;Column2&quot;)=&quot;OK&quot; AND y1.rows(12)(&quot;Column2&quot;)=&quot;OK&quot; Then
    flag=True
End If
else flag=False
    If y1.rows(9)(&quot;Column2&quot;)&lt;&gt;&quot;OK&quot; Then
        reason=y1.rows(9)(&quot;Column1&quot;)
    End If
    End
    If
    If y1.rows(10)(&quot;Column2&quot;)&lt;&gt;&quot;OK&quot; then
        If reason=&quot;&quot; Then
            reason=y1.rows(10)(&quot;Column1&quot;)
        End If
    else             reason=reason+&quot;,&quot;+y1.rows(10)(&quot;Column2&quot;)
        End
        If
        End
        If
        If y1.rows(11)(&quot;Column2&quot;)&lt;&gt;&quot;OK&quot; then
            If reason=&quot;&quot; Then
                reason=y1.rows(11)(&quot;Column1&quot;)
            End If
        else             reason=reason+&quot;,&quot;+y1.rows(11)(&quot;Column2&quot;)
            End
            If
        End If
        If y1.rows(12)(&quot;Column2&quot;)&lt;&gt;&quot;OK&quot; then
            If reason=&quot;&quot; Then
                reason=y1.rows(12)(&quot;Column1&quot;)
            End If
        else             reason=reason+&quot;,&quot;+y1.rows(12)(&quot;Column2&quot;)
            End
            If
            End
            If
        End If"
                            data-title="UWCA_Balloon_Refinance_CTF_V1.0 / Yakeen Code Stage / Yakeen Check Code">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>UWCA_Common_Salary_and_Simah_logic_V1.0</td>
                <td>GetOneMonthFull Salary</td>
                <td>Filter Collection1</td>
                <td>visualbasic</td>
                <td>6</td>
                <!--<td style="font-family: monospace;">c923c99415a4cd6045d25f97a6cbb1a13207cdf1baf5dc8c1df087012e26e633</td>-->
                <td>—</td>
                <!--<td>Dim NewRow As DataRow Dim Amount as Decimal =0 Collection_Out = Collection_In.Clone For Each parentRow As DataRow In Collection_In.Select(Select_Condition)     NewRow = Collection_Out.NewRow     For Each c As DataColumn In NewRow.Table.Columns         NewRow(c.ColumnName) = parentRow(c.ColumnName)  ...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Dim NewRow As DataRow
Dim Amount as Decimal =0 Collection_Out = Collection_In.Clone
For Each parentRow As DataRow In Collection_In.Select(Select_Condition)     NewRow = Collection_Out.NewRow
    For Each c As DataColumn In NewRow.Table.Columns         NewRow(c.ColumnName) = parentRow(c.ColumnName)
    Next     Collection_Out.Rows.Add(NewRow)
Next NewRow = Nothing Collection_In = Nothing"
                            data-title="UWCA_Common_Salary_and_Simah_logic_V1.0 / GetOneMonthFull Salary / Filter Collection1">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>UWCA_Common_Salary_and_Simah_logic_V1.0</td>
                <td>GetOneMonthFull Salary</td>
                <td>Filter Collection2</td>
                <td>visualbasic</td>
                <td>6</td>
                <!--<td style="font-family: monospace;">c923c99415a4cd6045d25f97a6cbb1a13207cdf1baf5dc8c1df087012e26e633</td>-->
                <td>—</td>
                <!--<td>Dim NewRow As DataRow Dim Amount as Decimal =0 Collection_Out = Collection_In.Clone For Each parentRow As DataRow In Collection_In.Select(Select_Condition)     NewRow = Collection_Out.NewRow     For Each c As DataColumn In NewRow.Table.Columns         NewRow(c.ColumnName) = parentRow(c.ColumnName)  ...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Dim NewRow As DataRow
Dim Amount as Decimal =0 Collection_Out = Collection_In.Clone
For Each parentRow As DataRow In Collection_In.Select(Select_Condition)     NewRow = Collection_Out.NewRow
    For Each c As DataColumn In NewRow.Table.Columns         NewRow(c.ColumnName) = parentRow(c.ColumnName)
    Next     Collection_Out.Rows.Add(NewRow)
Next NewRow = Nothing Collection_In = Nothing"
                            data-title="UWCA_Common_Salary_and_Simah_logic_V1.0 / GetOneMonthFull Salary / Filter Collection2">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>UWCA_Common_Salary_and_Simah_logic_V1.0</td>
                <td>GetOneMonthFull Salary</td>
                <td>Filter Collection3</td>
                <td>visualbasic</td>
                <td>6</td>
                <!--<td style="font-family: monospace;">c923c99415a4cd6045d25f97a6cbb1a13207cdf1baf5dc8c1df087012e26e633</td>-->
                <td>—</td>
                <!--<td>Dim NewRow As DataRow Dim Amount as Decimal =0 Collection_Out = Collection_In.Clone For Each parentRow As DataRow In Collection_In.Select(Select_Condition)     NewRow = Collection_Out.NewRow     For Each c As DataColumn In NewRow.Table.Columns         NewRow(c.ColumnName) = parentRow(c.ColumnName)  ...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Dim NewRow As DataRow
Dim Amount as Decimal =0 Collection_Out = Collection_In.Clone
For Each parentRow As DataRow In Collection_In.Select(Select_Condition)     NewRow = Collection_Out.NewRow
    For Each c As DataColumn In NewRow.Table.Columns         NewRow(c.ColumnName) = parentRow(c.ColumnName)
    Next     Collection_Out.Rows.Add(NewRow)
Next NewRow = Nothing Collection_In = Nothing"
                            data-title="UWCA_Common_Salary_and_Simah_logic_V1.0 / GetOneMonthFull Salary / Filter Collection3">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>UWCA_Common_Salary_and_Simah_logic_V1.0</td>
                <td>GetOneMonthFull Salary</td>
                <td>Filter Collection5</td>
                <td>visualbasic</td>
                <td>6</td>
                <!--<td style="font-family: monospace;">c923c99415a4cd6045d25f97a6cbb1a13207cdf1baf5dc8c1df087012e26e633</td>-->
                <td>—</td>
                <!--<td>Dim NewRow As DataRow Dim Amount as Decimal =0 Collection_Out = Collection_In.Clone For Each parentRow As DataRow In Collection_In.Select(Select_Condition)     NewRow = Collection_Out.NewRow     For Each c As DataColumn In NewRow.Table.Columns         NewRow(c.ColumnName) = parentRow(c.ColumnName)  ...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Dim NewRow As DataRow
Dim Amount as Decimal =0 Collection_Out = Collection_In.Clone
For Each parentRow As DataRow In Collection_In.Select(Select_Condition)     NewRow = Collection_Out.NewRow
    For Each c As DataColumn In NewRow.Table.Columns         NewRow(c.ColumnName) = parentRow(c.ColumnName)
    Next     Collection_Out.Rows.Add(NewRow)
Next NewRow = Nothing Collection_In = Nothing"
                            data-title="UWCA_Common_Salary_and_Simah_logic_V1.0 / GetOneMonthFull Salary / Filter Collection5">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>UWCA_Common_Salary_and_Simah_logic_V1.0</td>
                <td>GetOneMonthFull Salary</td>
                <td>Filter Collection6</td>
                <td>visualbasic</td>
                <td>6</td>
                <!--<td style="font-family: monospace;">c923c99415a4cd6045d25f97a6cbb1a13207cdf1baf5dc8c1df087012e26e633</td>-->
                <td>—</td>
                <!--<td>Dim NewRow As DataRow Dim Amount as Decimal =0 Collection_Out = Collection_In.Clone For Each parentRow As DataRow In Collection_In.Select(Select_Condition)     NewRow = Collection_Out.NewRow     For Each c As DataColumn In NewRow.Table.Columns         NewRow(c.ColumnName) = parentRow(c.ColumnName)  ...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Dim NewRow As DataRow
Dim Amount as Decimal =0 Collection_Out = Collection_In.Clone
For Each parentRow As DataRow In Collection_In.Select(Select_Condition)     NewRow = Collection_Out.NewRow
    For Each c As DataColumn In NewRow.Table.Columns         NewRow(c.ColumnName) = parentRow(c.ColumnName)
    Next     Collection_Out.Rows.Add(NewRow)
Next NewRow = Nothing Collection_In = Nothing"
                            data-title="UWCA_Common_Salary_and_Simah_logic_V1.0 / GetOneMonthFull Salary / Filter Collection6">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>UWCA_Common_Salary_and_Simah_logic_V1.0</td>
                <td>GetOneMonthFull Salary</td>
                <td>Filter Collection7</td>
                <td>visualbasic</td>
                <td>6</td>
                <!--<td style="font-family: monospace;">c923c99415a4cd6045d25f97a6cbb1a13207cdf1baf5dc8c1df087012e26e633</td>-->
                <td>—</td>
                <!--<td>Dim NewRow As DataRow Dim Amount as Decimal =0 Collection_Out = Collection_In.Clone For Each parentRow As DataRow In Collection_In.Select(Select_Condition)     NewRow = Collection_Out.NewRow     For Each c As DataColumn In NewRow.Table.Columns         NewRow(c.ColumnName) = parentRow(c.ColumnName)  ...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Dim NewRow As DataRow
Dim Amount as Decimal =0 Collection_Out = Collection_In.Clone
For Each parentRow As DataRow In Collection_In.Select(Select_Condition)     NewRow = Collection_Out.NewRow
    For Each c As DataColumn In NewRow.Table.Columns         NewRow(c.ColumnName) = parentRow(c.ColumnName)
    Next     Collection_Out.Rows.Add(NewRow)
Next NewRow = Nothing Collection_In = Nothing"
                            data-title="UWCA_Common_Salary_and_Simah_logic_V1.0 / GetOneMonthFull Salary / Filter Collection7">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>UWCA_Common_Salary_and_Simah_logic_V1.0</td>
                <td>New Salary Logic</td>
                <td>Description check1</td>
                <td>visualbasic</td>
                <td>44</td>
                <!--<td style="font-family: monospace;">505c18455afbdcc4175f340a000f39bf489f06216f90625741364c65be733b9a</td>-->
                <td>—</td>
                <!--<td>try     Dim description as string     Dim TempDataRow As DataRow = DescriptionCollection.NewRow     Dim Dflag as integer =0     Dim precount as integer =0     Dim count as integer =0     Dim CollOut as DataTable =InputCollection.Clone     Dim Buffer as DataTable=InputCollection.Clone     Dim out1,ou...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="try
    Dim description as string
    Dim TempDataRow As DataRow = DescriptionCollection.NewRow
    Dim Dflag as integer =0
    Dim precount as integer =0
    Dim count as integer =0
    Dim CollOut as DataTable =InputCollection.Clone
    Dim Buffer as DataTable=InputCollection.Clone
    Dim out1,out2 as String  &#x27;Add Description and Count of Description in to DescriptionCollection
    For r As Integer = 0 To InputCollection.Rows.Count-1     description=InputCollection.Rows(r)(&quot;Description&quot;)     Dflag=0
        for i as integer=0 To DescriptionCollection.Rows.Count-1
            If DescriptionCollection.Rows(i)(&quot;Description&quot;)=description Then
                Dflag=1             DescriptionCollection.Rows(i)(&quot;Count&quot;)=DescriptionCollection.Rows(i)(&quot;Count&quot;)+1
            End If
            end
            if
        next
        If Dflag=0 Then
            TempDataRow(&quot;Description&quot;) = description         TempDataRow(&quot;Count&quot;)=1         DescriptionCollection.Rows.Add(TempDataRow)         TempDataRow= DescriptionCollection.NewRow         out1 = &quot;O1&quot;
        End If
        end
        if
    Next  DescriptionCollection.DefaultView.Sort =  &quot;Count DESC&quot; DescriptionCollection=DescriptionCollection.DefaultView.ToTable    &#x27;Get Max Repeated DescriptionCollection
    For r As Integer = 0 To DescriptionCollection.Rows.Count-1     description=DescriptionCollection.Rows(r)(&quot;Description&quot;)     CollOut=Nothing     CollOut=InputCollection.Clone
        For Each parentRow As DataRow In InputCollection.Select(&quot;Description=&#x27;&quot;+description+&quot;&#x27;&quot;)         TempDataRow = CollOut.NewRow
            For Each c As DataColumn In TempDataRow.Table.Columns             TempDataRow(c.ColumnName) = parentRow(c.ColumnName)
            Next         CollOut.Rows.Add(TempDataRow)
        Next     count=CollOut.Rows.Count
        If count&gt;precount Then
            Buffer=Nothing         Buffer = CollOut.Clone         Buffer=CollOut         precount=count         ReassignFlag=0         out2 = &quot;O2&quot;
        End If
    else
        if count = Precount             ReassignFlag=1             Status=&quot;Salary cannot be identified since there mode are equal&quot;
            end
            if
        next
        If precount&lt;=2 Then
            ReassignFlag=1     Status=&quot;Salary cannot be identified since there mode is &lt; 3&quot;
        End If
        end
        if FilteredDescCollection=Buffer D0=DescriptionCollection
        catch e as Exception         ReassignFlag=1         Status=&quot;Code Error:&quot;+e.ToString
            end
            try"
                            data-title="UWCA_Common_Salary_and_Simah_logic_V1.0 / New Salary Logic / Description check1">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>UWCA_Common_Salary_and_Simah_logic_V1.0</td>
                <td>New Salary Logic</td>
                <td>Filter Salay with +5 and -5 Days1</td>
                <td>visualbasic</td>
                <td>41</td>
                <!--<td style="font-family: monospace;">749d00c0bc02ea23c0044597bec933f59ae16266faad401782621f6dbdf48e4f</td>-->
                <td>—</td>
                <!--<td>try     Dim TempCollection as DataTable=FilteredDescCollection.Clone     Dim TempRow As DataRow = FilteredDescCollection.NewRow &#x27;Temp collections to store each month transacation in single collection &#x27;SD stands     for Salary Date         Dim TempCollectionSD1 as DataTable=FilteredDescCollection.Clo...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="try
    Dim TempCollection as DataTable=FilteredDescCollection.Clone
    Dim TempRow As DataRow = FilteredDescCollection.NewRow &#x27;Temp collections to store each month transacation in single collection &#x27;SD stands
    for Salary Date
        Dim TempCollectionSD1 as DataTable=FilteredDescCollection.Clone
        Dim TempCollectionSD2 as DataTable=FilteredDescCollection.Clone
        Dim TempCollectionSD3 as DataTable=FilteredDescCollection.Clone &#x27;
        Dim TempCollectionSD4 as DataTable=FilteredDescCollection.Clone
        Dim TempOutCollection as DataTable=FilteredDescCollection.Clone   &#x27;Adding +5 &amp; -5 days
        Dim SD1p as Date=SD1.AddDays(5)
        Dim SD1m as Date=SD1.AddDays(-5)
        Dim SD2p as Date=SD2.AddDays(5)
        Dim SD2m as Date=SD2.AddDays(-5)
        Dim SD3p as Date=SD3.AddDays(5)
        Dim SD3m as Date=SD3.AddDays(-5)     &#x27;
        Dim SD4p as Date=SD4.AddDays(5)     &#x27;
        Dim SD4m as Date=SD4.AddDays(-5)  &#x27;Fiter the collection based on above criteria (+5 &amp; -5) to get each month one collection
        For r As Integer = 0 To FilteredDescCollection.Rows.Count-1             if(SD1m&lt;=FilteredDescCollection.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=FilteredDescCollection.Rows(r)(&quot;Account date&quot;) AND FilteredDescCollection.Rows(r)(&quot;Sal&quot;)&gt;0 ) then                 TempRow= FilteredDescCollection.Rows(r)                 TempCollectionSD1.ImportRow(TempRow)                 TempRow=TempCollectionSD1.NewRow
        end if                            if(SD2m&lt;=FilteredDescCollection.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=FilteredDescCollection.Rows(r)(&quot;Account date&quot;)AND FilteredDescCollection.Rows(r)(&quot;Sal&quot;)&gt;0 ) then                     TempRow= FilteredDescCollection.Rows(r)                     TempCollectionSD2.ImportRow(TempRow)                     TempRow=TempCollectionSD2.NewRow
    end if                      if(SD3m&lt;=FilteredDescCollection.Rows(r)(&quot;Account date&quot;) AND SD3p&gt;=FilteredDescCollection.Rows(r)(&quot;Account date&quot;)AND FilteredDescCollection.Rows(r)(&quot;Sal&quot;)&gt;0 ) then                     TempRow= FilteredDescCollection.Rows(r)                     TempCollectionSD3.ImportRow(TempRow)                     TempRow=TempCollectionSD3.NewRow
end if                  &#x27;if(SD4m&lt;=FilteredDescCollection.Rows(r)(&quot;Account date&quot;) AND SD4p&gt;=FilteredDescCollection.Rows(r)(&quot;Account date&quot;) AND FilteredDescCollection.Rows(r)(&quot;Sal&quot;)&gt;0 ) then             &#x27;        TempRow= FilteredDescCollection.Rows(r)             &#x27;        TempCollectionSD4.ImportRow(TempRow)             &#x27;        TempRow=TempCollectionSD4.NewRow                          &#x27;
end if
next &#x27;sort all the collection in desc order      TempCollectionSD1.DefaultView.Sort =  &quot;Sal DESC&quot;     TempCollectionSD2.DefaultView.Sort =  &quot;Sal DESC&quot;     TempCollectionSD3.DefaultView.Sort =  &quot;Sal DESC&quot;     &#x27;TempCollectionSD4.DefaultView.Sort =  &quot;Sal DESC&quot;  &#x27;converting collection into DataTable      TempCollectionSD1=TempCollectionSD1.DefaultView.ToTable     TempCollectionSD2=TempCollectionSD2.DefaultView.ToTable     TempCollectionSD3=TempCollectionSD3.DefaultView.ToTable     &#x27;TempCollectionSD4=TempCollectionSD4.DefaultView.ToTable  &#x27;add only max salary to Output collection from each month collection         if(TempCollectionSD1.Rows.Count&gt;0)then             TempOutCollection.ImportRow(TempCollectionSD1.Rows(0))
else             ReassignFlag=1             Status=&quot;Current month salary not found&quot;
    return
    end
    if                  if(TempCollectionSD2.Rows.Count&gt;0)then             TempOutCollection.ImportRow(TempCollectionSD2.Rows(0))
    else             ReassignFlag=1             Status=&quot; Current month -1 salary not found&quot;
        return
        end
        if                      if(TempCollectionSD3.Rows.Count&gt;0)then             TempOutCollection.ImportRow(TempCollectionSD3.Rows(0))
        else             ReassignFlag=1             Status=&quot; Current month -2 salary not found&quot;
            return
            end
            if                      &#x27;if(TempCollectionSD4.Rows.Count&gt;0)then         &#x27;    TempOutCollection.ImportRow(TempCollectionSD4.Rows(0))         &#x27;
            else         &#x27;    ReassignFlag=1         &#x27;    Status=&quot; 4th month salary not found&quot;         &#x27;
                end
                if  &#x27;TempOutCollection.DefaultView.Sort =  &quot;Account date ASC&quot; TempOutCollection=TempOutCollection.DefaultView.ToTable FilterDateCollection=TempOutCollection
                catch e as Exception         ReassignFlag=1         Status=&quot;Code Error:&quot;+e.ToString
                    end
                    try"
                            data-title="UWCA_Common_Salary_and_Simah_logic_V1.0 / New Salary Logic / Filter Salay with +5 and -5 Days1">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>UWCA_Common_Salary_and_Simah_logic_V1.0</td>
                <td>New Salary Logic</td>
                <td>Filter Salay with +5 and -5 Days2</td>
                <td>visualbasic</td>
                <td>43</td>
                <!--<td style="font-family: monospace;">6f7d183a8e2c904c2a1b07258c1ca2672538371a42209c4fb0005efaee1f9825</td>-->
                <td>—</td>
                <!--<td>try     Dim TempCollection as DataTable=FilteredDescCollection.Clone     Dim TempRow As DataRow = FilteredDescCollection.NewRow &#x27;Temp collections to store each month transacation in single collection &#x27;SD stands     for Salary Date         Dim TempCollectionSD1 as DataTable=FilteredDescCollection.Clo...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="try
    Dim TempCollection as DataTable=FilteredDescCollection.Clone
    Dim TempRow As DataRow = FilteredDescCollection.NewRow &#x27;Temp collections to store each month transacation in single collection &#x27;SD stands
    for Salary Date
        Dim TempCollectionSD1 as DataTable=FilteredDescCollection.Clone
        Dim TempCollectionSD2 as DataTable=FilteredDescCollection.Clone
        Dim TempCollectionSD3 as DataTable=FilteredDescCollection.Clone &#x27;
        Dim TempCollectionSD4 as DataTable=FilteredDescCollection.Clone
        Dim TempOutCollection as DataTable=FilteredDescCollection.Clone   &#x27;Filtering Transaction colletion with Tran Code column.
        If found Then
            add to corresponding collection.
        End If
        For r As Integer = 0 To FilteredDescCollection.Rows.Count-1                                       if(FilteredDescCollection.Rows(r)(&quot;Tran code&quot;)=&quot;312&quot;) then                     if(SD1=FilteredDescCollection.Rows(r)(&quot;Account date&quot;)) then                         TempRow= FilteredDescCollection.Rows(r)                         TempCollectionSD1.ImportRow(TempRow)                         TempRow=TempCollectionSD1.NewRow
        end if                                      if(SD2=FilteredDescCollection.Rows(r)(&quot;Account date&quot;)) then                             TempRow= FilteredDescCollection.Rows(r)                             TempCollectionSD2.ImportRow(TempRow)                             TempRow=TempCollectionSD2.NewRow
    end if                                      if(SD3=FilteredDescCollection.Rows(r)(&quot;Account date&quot;))then                             TempRow= FilteredDescCollection.Rows(r)                             TempCollectionSD3.ImportRow(TempRow)                             TempRow=TempCollectionSD3.NewRow
    end
    if                                          &#x27;if(SD4=FilteredDescCollection.Rows(r)(&quot;Account date&quot;))then                     &#x27;        TempRow= FilteredDescCollection.Rows(r)                     &#x27;        TempCollectionSD4.ImportRow(TempRow)                     &#x27;        TempRow=TempCollectionSD4.NewRow                                      &#x27;
        end
        if
    else                                          ReassignFlag=1                     Status=&quot;Salary not identified after filter with code&quot;
        return
        end
        if
    next &#x27;sort all the collection in desc order      TempCollectionSD1.DefaultView.Sort =  &quot;Sal DESC&quot;     TempCollectionSD2.DefaultView.Sort =  &quot;Sal DESC&quot;     TempCollectionSD3.DefaultView.Sort =  &quot;Sal DESC&quot;     &#x27;TempCollectionSD4.DefaultView.Sort =  &quot;Sal DESC&quot;  &#x27;converting collection into DataTable      TempCollectionSD1=TempCollectionSD1.DefaultView.ToTable     TempCollectionSD2=TempCollectionSD2.DefaultView.ToTable     TempCollectionSD3=TempCollectionSD3.DefaultView.ToTable     &#x27;TempCollectionSD4=TempCollectionSD4.DefaultView.ToTable  &#x27;add only max salary to Output collection from each month collection         if(TempCollectionSD1.Rows.Count&gt;0)then             TempOutCollection.ImportRow(TempCollectionSD1.Rows(0))
else             ReassignFlag=1             Status=&quot;Current month salary not found&quot;
    return
    end
    if                  if(TempCollectionSD2.Rows.Count&gt;0)then             TempOutCollection.ImportRow(TempCollectionSD2.Rows(0))
    else             ReassignFlag=1             Status=&quot; Current month -1 salary not found&quot;
        return
        end
        if                      if(TempCollectionSD3.Rows.Count&gt;0)then             TempOutCollection.ImportRow(TempCollectionSD3.Rows(0))
        else             ReassignFlag=1             Status=&quot; Current month -2 salary not found&quot;
            return
            end
            if                  &#x27;if(TempCollectionSD4.Rows.Count&gt;0)then         &#x27;    TempOutCollection.ImportRow(TempCollectionSD4.Rows(0))         &#x27;
            else         &#x27;    ReassignFlag=1         &#x27;    Status=&quot; Current month -3 salary not found&quot;         &#x27;
                return         &#x27;
                end
                if           &#x27;TempOutCollection.DefaultView.Sort =  &quot;Account date DESC&quot; TempOutCollection=TempOutCollection.DefaultView.ToTable FilterCodeCollection=TempOutCollection
                catch e as Exception         ReassignFlag=1         Status=&quot;Code Error:&quot;+e.ToString
                    end
                    try"
                            data-title="UWCA_Common_Salary_and_Simah_logic_V1.0 / New Salary Logic / Filter Salay with +5 and -5 Days2">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>UWCA_Common_Salary_and_Simah_logic_V1.0</td>
                <td>New Salary Logic</td>
                <td>Salary Logic based on AVG1</td>
                <td>visualbasic</td>
                <td>45</td>
                <!--<td style="font-family: monospace;">d23bb53d21629033ffcd659bab0b51b3e1f16f98113dc1ae4c4164bfc0123a40</td>-->
                <td>—</td>
                <!--<td>try     Dim Amount as Decimal =0     Dim Avg as Decimal=0     Dim Sum as Decimal =0     Dim skip as integer =0     Dim min as Decimal =0     Dim max as Decimal =0     Dim minSal as Decimal =0     Dim minimumSalarySAR as string =Nothing  &#x27;To assign each month salary into one variable     Dim FirstMon...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="try
    Dim Amount as Decimal =0
    Dim Avg as Decimal=0
    Dim Sum as Decimal =0
    Dim skip as integer =0
    Dim min as Decimal =0
    Dim max as Decimal =0
    Dim minSal as Decimal =0
    Dim minimumSalarySAR as string =Nothing  &#x27;To assign each month salary into one variable
    Dim FirstMonthSalary as Decimal=0
    Dim SecondMonthSalary as Decimal=0 &#x27;
    Dim ThirdMonthSalary as Decimal=0
    Dim CurrentMonthSalary as Decimal=0
    Dim ActualSalary as Decimal=0   &#x27;Read salaries from input collection FilterDateCollection CurrentMonthSalary=FilterDateCollection.Rows(0)(&quot;Sal&quot;) FirstMonthSalary=FilterDateCollection.Rows(1)(&quot;Sal&quot;) SecondMonthSalary=FilterDateCollection.Rows(2)(&quot;Sal&quot;) &#x27;ThirdMonthSalary=FilterDateCollection.Rows(3)(&quot;Sal&quot;)   &#x27;Rule2 take avarage of last 3 months salaries and check avg with min(s1,s2,s3)+20%Min(s1,s2,s3)
    If condition is true Then
        take avg as Salary.     max=FilterDateCollection.Rows(0)(&quot;Sal&quot;)     minSal=FilterDateCollection.Rows(0)(&quot;Sal&quot;)
    End If
    For k As Integer = 0 To 2         Sum=Sum+FilterDateCollection.Rows(k)(&quot;Sal&quot;)         if(max&lt;FilterDateCollection.Rows(k)(&quot;Sal&quot;))then                 max=FilterDateCollection.Rows(k)(&quot;Sal&quot;)
        end
        if         if(minSal&gt;FilterDateCollection.Rows(k)(&quot;Sal&quot;))then                 minSal=FilterDateCollection.Rows(k)(&quot;Sal&quot;)
            end
            if
        next           Avg=Sum/3     CurrentMonthSalary = minSal &#x27;Rule1
        If the employeer is Governamet-employee deduct 1000 SAR from his/her salary     &#x27;if(GovFlag)     &#x27;    ActualSalary=CurrentMonthSalary-1000     &#x27;
        else     &#x27;    ActualSalary=CurrentMonthSalary     &#x27;
            end
            if     &#x27;MsgBox(CurrentMonthSalary) &#x27;Rule2
                If Jan Salary less than or equal to (Avg or Avg+10%(Avg)) Then
                    Jan Salary as Salary
                End If
            else Avg as Salary.
                If Math.Round(((Avg-CurrentMonthSalary)/Avg),3)&lt;= 0.2 Then
                    &#x27;AND Math.Round(((Avg-CurrentMonthSalary)/Avg),3)&gt;= -0.1)then     Avg=Sum/3
                End If
            else     Avg=(Sum-max)/2
                End
                If          min=FilterDateorCodeCollection.Rows(0)(&quot;Sal&quot;)
                    For k As Integer = 0 To 2
                        if min &gt;= FilterDateorCodeCollection.Rows(K)(&quot;Sal&quot;)then             min=FilterDateorCodeCollection.Rows(K)(&quot;Sal&quot;)             minimumSalarySAR=FilterDateorCodeCollection.Rows(k)(&quot;Amount&quot;)
                            end
                            if
                        next       Salary=minimumSalarySAR     Other=Replace(Math.Round((Avg-min),2),&quot;.&quot;,&quot;,&quot;)  OutputCollection=FilterDateCollection
                    catch e as Exception         ReassignFlag=1         Status=&quot;Code Error:&quot;+e.ToString
                        end
                        try"
                            data-title="UWCA_Common_Salary_and_Simah_logic_V1.0 / New Salary Logic / Salary Logic based on AVG1">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>UWCA_Common_Salary_and_Simah_logic_V1.0</td>
                <td>New Salary Logic</td>
                <td>Salary code requirements1</td>
                <td>visualbasic</td>
                <td>71</td>
                <!--<td style="font-family: monospace;">117c6ffa7ec70f8097b6591c7d92435e40b4bbe9e91d0c89cb7f44bd9da787a1</td>-->
                <td>reflection</td>
                <!--<td>&#x27;Page1 try     If Not c1.Columns.Contains(&quot;Sal&quot;) Then         c1.Columns.Add(&quot;Sal&quot;, Type.GetType(&quot;System.Decimal&quot;))     End If     End     If     For r As Integer = 0 To c1.Rows.Count - 1         c1.Rows(r)(&quot;Sal&quot;) = Replace(Replace(c1.Rows(r)(&quot;Amount&quot;), &quot;.&quot;, &quot;&quot;), &quot;,&quot;, &quot;.&quot;)         c1.Rows(r)(&quot;Sal&quot;)=...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="&#x27;Page1
try
    If Not c1.Columns.Contains(&quot;Sal&quot;) Then
        c1.Columns.Add(&quot;Sal&quot;, Type.GetType(&quot;System.Decimal&quot;))
    End If
    End
    If
    For r As Integer = 0 To c1.Rows.Count - 1         c1.Rows(r)(&quot;Sal&quot;) = Replace(Replace(c1.Rows(r)(&quot;Amount&quot;), &quot;.&quot;, &quot;&quot;), &quot;,&quot;, &quot;.&quot;)         c1.Rows(r)(&quot;Sal&quot;)=Convert.ToDecimal(c1.Rows(r)(&quot;Sal&quot;))
    Next  &#x27;Filtering &lt;1900
    If Not GovFlag then
        Dim NewRow As DataRow  C0 = C1.Clone
        For Each parentRow As DataRow In C1.Select(Select_Condition)         NewRow = C0.NewRow
            For Each c As DataColumn In NewRow.Table.Columns             NewRow(c.ColumnName) = parentRow(c.ColumnName)
            Next         C0.Rows.Add(NewRow)
        Next   NewRow = Nothing C1 = Nothing  &#x27;Page2 C1=C0
        End
        If
        Dim x as integer = 0
        Dim dd,mm,yy as string
        Dim count as integer =0
        dim test,dec
        dim flag as integer=1
        dim days as integer =0 dec=&quot;&quot; dd=&quot;&quot; mm=&quot;&quot; yy=&quot;&quot; &#x27;
        If Not c1.Columns.Contains(&quot;ADate&quot;) Then
            &#x27;    c1.Columns.Add(&quot;ADate&quot;, Type.GetType(&quot;System.String&quot;)) &#x27;
        End If
        End
        if
        If Not c1.Columns.Contains(&quot;Days&quot;) Then
            c1.Columns.Add(&quot;Days&quot;, Type.GetType(&quot;System.DateTime&quot;))
        End If
        End
        if
        For i As Integer = 0 To c1.Rows.Count - 1     c1.Rows(i)(&quot;Description&quot;)=Replace(c1.Rows(i)(&quot;Description&quot;),&quot; &quot;,&quot;&quot;)
            if Left(c1.Rows(i)(&quot;Description&quot;),7) =  &quot;PAYROL/&quot; OR Left(c1.Rows(i)(&quot;Description&quot;),7) =  &quot;SALARY/&quot;         c1.Rows(i)(&quot;Description&quot;) = Replace(Replace(c1.Rows(i)(&quot;Description&quot;),&quot;PAYROL/&quot;,&quot;&quot;),&quot;SALARY/&quot;,&quot;&quot;)
                end
                if     test=c1.Rows(i)(&quot;Description&quot;)
                    do         x = InStr(test, &quot;/&quot;)     if(x&gt;0)             test=Replace(test, Left(test, x),&quot;&quot;)
                        if flag=1         dec=test         flag = 0
                            end
                            if             count = count+1
                            end if
                        loop
                        while x&lt;&gt;0
                            if count&gt;2         c1.Rows(i)(&quot;Description&quot;)= Trim(dec)
                            else &#x27;        dec=&quot;arb: &quot;+c1.Rows(r)(&quot;Description&quot;)
                                Dim R as New Regex(&quot;[A-Z,0-9,/]*(?&lt;Result&gt;[أ-ي,0-9]*)&quot;, RegexOptions.SingleLine)
                                Dim M as Match = R.Match(c1.Rows(i)(&quot;Description&quot;))
                                If M IsNot Nothing AndAlso M.Success Then
                                    dec = M.Groups(&quot;Result&quot;).Value
                                End If
                                End
                                If         c1.Rows(i)(&quot;Description&quot;)= Trim(dec)
                                    end
                                    if     flag=1     count=0     x=0     yy=c1.Rows(i)(&quot;Account date&quot;)
                                        for j as integer =0 to 2         x=Instr(yy,&quot;/&quot;)
                                            If j=0 Then
                                                dd=Left(yy,x-1)             yy=Right(yy,len(yy)-x)
                                            End If
                                        else
                                            if j=1             mm=Left(yy,x-1)             yy=Right(yy,len(yy)-x)
                                                end
                                                if
                                            next
                                            if mm&lt;&gt;&quot;&quot;&#x27;Date.Parse         c1.Rows(i)(&quot;Account date&quot;)=(mm+&quot;/&quot;+dd+&quot;/&quot;+yy)
                                                end
                                                if     &#x27;days=DateDiff(DateInterval.Day,Date.Parse(c1.Rows(i)(&quot;Account date&quot;)),Today())     &#x27;    c1.Rows(i)(&quot;Days&quot;)=days     c1.Rows(i)(&quot;Days&quot;)=DateTime.Parse(c1.Rows(i)(&quot;Account date&quot;))     &#x27;MsgBox(mm+&quot;/&quot;+dd+&quot;/&quot;+yy) dec=&quot;&quot; dd=&quot;&quot; mm=&quot;&quot;  yy=&quot;&quot;
                                                Next  c1.DefaultView.Sort = &quot;Days DESC&quot;  c0 = c1.DefaultView.ToTable
                                            catch e as Exception     &#x27;MsgBox(&quot;error&quot;)         ReassignFlag=1         Status=&quot;Code Error:&quot;+e.ToString
                                                end
                                                try"
                            data-title="UWCA_Common_Salary_and_Simah_logic_V1.0 / New Salary Logic / Salary code requirements1">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>UWCA_Common_Salary_and_Simah_logic_V1.0</td>
                <td>New Salary Logic</td>
                <td>Salary code requirements2</td>
                <td>visualbasic</td>
                <td>71</td>
                <!--<td style="font-family: monospace;">6372db1f3d49c20eec036798fe93aef37dd9eeecdc97fc46ed904173b18bff1e</td>-->
                <td>reflection</td>
                <!--<td>&#x27;Page1 try     If Not c1.Columns.Contains(&quot;Sal&quot;) Then         c1.Columns.Add(&quot;Sal&quot;, Type.GetType(&quot;System.Decimal&quot;))     End If     End     If     For r As Integer = 0 To c1.Rows.Count - 1         c1.Rows(r)(&quot;Sal&quot;) = Replace(Replace(c1.Rows(r)(&quot;Amount&quot;), &quot;.&quot;, &quot;&quot;), &quot;,&quot;, &quot;.&quot;)         c1.Rows(r)(&quot;Sal&quot;)=...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="&#x27;Page1
try
    If Not c1.Columns.Contains(&quot;Sal&quot;) Then
        c1.Columns.Add(&quot;Sal&quot;, Type.GetType(&quot;System.Decimal&quot;))
    End If
    End
    If
    For r As Integer = 0 To c1.Rows.Count - 1         c1.Rows(r)(&quot;Sal&quot;) = Replace(Replace(c1.Rows(r)(&quot;Amount&quot;), &quot;.&quot;, &quot;&quot;), &quot;,&quot;, &quot;.&quot;)         c1.Rows(r)(&quot;Sal&quot;)=Convert.ToDecimal(c1.Rows(r)(&quot;Sal&quot;))
    Next  &#x27;Filtering &lt;1900
    If Not GovFlag then
        Dim NewRow As DataRow  C0 = C1.Clone
        For Each parentRow As DataRow In C1.Select(Select_Condition)         NewRow = C0.NewRow
            For Each c As DataColumn In NewRow.Table.Columns             NewRow(c.ColumnName) = parentRow(c.ColumnName)
            Next         C0.Rows.Add(NewRow)
        Next   NewRow = Nothing C1 = Nothing  &#x27;Page2 C1=C0
        End
        If
        Dim x as integer = 0
        Dim dd,mm,yy as string
        Dim count as integer =0
        dim dec
        dim flag as integer=1
        dim days as integer =0 dec=&quot;&quot; dd=&quot;&quot; mm=&quot;&quot; yy=&quot;&quot; &#x27;
        If Not c1.Columns.Contains(&quot;ADate&quot;) Then
            &#x27;    c1.Columns.Add(&quot;ADate&quot;, Type.GetType(&quot;System.String&quot;)) &#x27;
        End If
        End
        if
        If Not c1.Columns.Contains(&quot;Days&quot;) Then
            c1.Columns.Add(&quot;Days&quot;, Type.GetType(&quot;System.DateTime&quot;))
        End If
        End
        if
        For i As Integer = 0 To c1.Rows.Count - 1     &#x27;c1.Rows(i)(&quot;Description&quot;)=Replace(c1.Rows(i)(&quot;Description&quot;),&quot; &quot;,&quot;&quot;)     &#x27;
            if Left(c1.Rows(i)(&quot;Description&quot;),7) =  &quot;PAYR/&quot; OR Left(c1.Rows(i)(&quot;Description&quot;),7) =  &quot;SAL/&quot;         &#x27;c1.Rows(i)(&quot;Description&quot;) = Replace(Replace(c1.Rows(i)(&quot;Description&quot;),&quot;PAYROL/&quot;,&quot;&quot;),&quot;SALARY/&quot;,&quot;&quot;)     &#x27;
                end
                if     &#x27;test=c1.Rows(i)(&quot;Description&quot;)     &#x27;
                    do         &#x27;x = InStr(test, &quot;/&quot;)     &#x27;if(x&gt;0)         &#x27;    test=Replace(test, Left(test, x),&quot;&quot;)     &#x27;
                        if flag=1         &#x27;dec=test         &#x27;flag = 0     &#x27;
                            end
                            if         &#x27;    count = count+1     &#x27;
                            end if         &#x27;
                        loop
                        while x&lt;&gt;0     &#x27;
                            if count&gt;2     &#x27;    c1.Rows(i)(&quot;Description&quot;)= Trim(dec)     &#x27;
                            else &#x27;        dec=&quot;arb: &quot;+c1.Rows(r)(&quot;Description&quot;) &#x27;         &#x27;
                                Dim R as New Regex(&quot;[A-Z,0-9,/]*(?&lt;Result&gt;[أ-ي,0-9]*)&quot;, RegexOptions.SingleLine)         &#x27;
                                Dim M as Match = R.Match(c1.Rows(i)(&quot;Description&quot;))         &#x27;
                                If M IsNot Nothing AndAlso M.Success Then
                                    &#x27;dec = M.Groups(&quot;Result&quot;).Value         &#x27;
                                End If
                                End
                                If         &#x27;c1.Rows(i)(&quot;Description&quot;)= Trim(dec)         &#x27;
                                    end
                                    if     &#x27;flag=1     &#x27;count=0     &#x27;x=0     yy=c1.Rows(i)(&quot;Account date&quot;)
                                        for j as integer =0 to 2         x=Instr(yy,&quot;/&quot;)
                                            If j=0 Then
                                                dd=Left(yy,x-1)             yy=Right(yy,len(yy)-x)
                                            End If
                                        else
                                            if j=1             mm=Left(yy,x-1)             yy=Right(yy,len(yy)-x)
                                                end
                                                if
                                            next
                                            if mm&lt;&gt;&quot;&quot;&#x27;Date.Parse         c1.Rows(i)(&quot;Account date&quot;)=(mm+&quot;/&quot;+dd+&quot;/&quot;+yy)
                                                end
                                                if     &#x27;days=DateDiff(DateInterval.Day,Date.Parse(c1.Rows(i)(&quot;Account date&quot;)),Today())     &#x27;    c1.Rows(i)(&quot;Days&quot;)=days     c1.Rows(i)(&quot;Days&quot;)=DateTime.Parse(c1.Rows(i)(&quot;Account date&quot;))     &#x27;MsgBox(mm+&quot;/&quot;+dd+&quot;/&quot;+yy) dec=&quot;&quot; dd=&quot;&quot; mm=&quot;&quot;  yy=&quot;&quot;
                                                Next  c1.DefaultView.Sort = &quot;Days DESC&quot;  c0 = c1.DefaultView.ToTable
                                            catch e as Exception     &#x27;MsgBox(&quot;error&quot;)         ReassignFlag=1         Status=&quot;Code Error:&quot;+e.ToString
                                                end
                                                try"
                            data-title="UWCA_Common_Salary_and_Simah_logic_V1.0 / New Salary Logic / Salary code requirements2">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>UWCA_Common_Salary_and_Simah_logic_V1.0</td>
                <td>Simah Logic</td>
                <td>Simah Code</td>
                <td>visualbasic</td>
                <td>213</td>
                <!--<td style="font-family: monospace;">9c042e01d2e549c495d052f07c4a8342e31a9819a974b958904b9d6289afff31</td>-->
                <td>reflection</td>
                <!--<td>&#x27;Simah logic is to check other banks outstanding amout. if any of the cusotmer have more than expected outstanding amout BOT will reassign the case.     Dim Company_Type,Product_Type,Status_W,Status_Hiso     try as String         Dim DefaultProductCode,DefaultStatusCode,DefaultOutStandingAmount,Defa...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="&#x27;Simah logic is to check other banks outstanding amout.
if any of the cusotmer have more than expected outstanding amout BOT will reassign the case.
    Dim Company_Type,Product_Type,Status_W,Status_Hiso
    try as String
        Dim DefaultProductCode,DefaultStatusCode,DefaultOutStandingAmount,DefaultDate,DefaultCredit,TotOutstandingAmount,TotOutStandingAmountNONMobile as String
        Dim NSDateDiff as Integer
        Dim Status_Flag as Boolean=False
        Dim Rajb_Flag as Boolean =False
        Dim FlagForSimahApprovalOrRejection as Boolean=False
        Dim FlagForConsecutiveReject as Boolean=False ReassignFlag =&quot;&quot; ReassignReason=&quot;&quot;
        Dim NWtable as new DataTable
        Dim TotalOutstandingAmountNONMobile as Double=0 &#x27;
        Dim TotalOutstandingAmountMilitory as Double=0  &#x27;
        Dim TotalOutstandingAmountGov as Double=0 &#x27;
        Dim TotalOutstandingAmountPrivate as Double=0
        Dim TotalOutstandingAmount as Double=0 NWtable.Columns.Add(&quot;Column1&quot;, Type.GetType(&quot;System.String&quot;)) NWtable.Columns.Add(&quot;Column2&quot;, Type.GetType(&quot;System.String&quot;)) NWtable.Columns.Add(&quot;Column20&quot;, Type.GetType(&quot;System.String&quot;)) NWtable.Columns.Add(&quot;Column14&quot;, Type.GetType(&quot;System.String&quot;))  &#x27;check wether CreditDetails table contain status as W and Company_Type either RAJB or ADFL leave those rows. Other than that add to NWtable.
        If  CreditDetails.Rows.Count&gt;=3 Then
            For i As Integer = 0 To CreditDetails.Rows.Count - 1
                If i&gt;=2 Then
                    Company_Type=CreditDetails.Rows(i)(&quot;Column1&quot;)         Product_Type=CreditDetails.Rows(i)(&quot;Column2&quot;)         Status_W=CreditDetails.Rows(i)(&quot;Column7&quot;)         Status_Hiso
                End If
                try=CreditDetails.Rows(i)(&quot;Column20&quot;)
                    if Status_W=&quot;A&quot; OR Status_W=&quot;S&quot; Then
                        If (Company_Type=&quot;RAJB&quot; OR Company_Type=&quot;ADFL&quot; OR Company_Type=&quot;GOVR&quot; OR Product_Type=&quot;VRA&quot; OR Company_Type=&quot;UTIL&quot;) Then
                            Status_Flag=True
                        End If
                    else                 NWtable.Rows.Add(CreditDetails.Rows(i)(&quot;Column1&quot;),CreditDetails.Rows(i)(&quot;Column2&quot;),CreditDetails.Rows(i)(&quot;Column20&quot;),CreditDetails.Rows(i)(&quot;Column14&quot;))
                        END
                        IF
                        end
                        if
                    end if
                Next
                End
                If   &#x27;
                    If Status is W(defaulter) and Defaulter table having more than 2 records. calculate outstanding amount based on the business rules.
                        If DefaultTable.Rows.Count&gt;=3 Then
                            For j As Integer = 0 To DefaultTable.Rows.Count - 1
                                If j &gt;= 2 Then
                                    &#x27;Start If1             DefaultProductCode=Trim(DefaultTable.Rows(j)(&quot;Column1&quot;))             DefaultStatusCode=Trim(DefaultTable.Rows(j)(&quot;Column6&quot;))             DefaultOutStandingAmount=Trim(DefaultTable.Rows(j)(&quot;Column5&quot;))              DefaultDate=DefaultTable.Rows(j)(&quot;Column3&quot;)             DefaultCredit=Trim(DefaultTable.Rows(j)(&quot;Column2&quot;))                 NSDateDiff=DateDiff(&quot;d&quot;,Convert.ToDateTime(DefaultDate),Now())
                                End If
                                If  DefaultCredit=&quot;RAJB&quot;   Then
                                    If DefaultStatusCode &lt;&gt; &quot;FS&quot; Then
                                        Rajb_Flag=True
                                    End If
                                    end
                                    if
                                    end
                                    if
                                    If DefaultCredit=&quot;AQAR&quot; OR DefaultCredit=&quot;ADFL&quot; OR DefaultCredit=&quot;SCSB&quot; OR DefaultCredit=&quot;REDF&quot; OR DefaultCredit=&quot;AGDF&quot; OR DefaultProductCode=&quot;VRA&quot;  Then
                                        End
                                        if
                                        If DefaultProductCode=&quot;CDL&quot; OR DefaultProductCode=&quot;BNPL&quot; OR DefaultProductCode=&quot;MBL&quot; OR DefaultProductCode=&quot;LND&quot; OR DefaultProductCode=&quot;NET&quot; OR DefaultProductCode=&quot;RCSR&quot; OR DefaultProductCode=&quot;WAT&quot; Then
                                            &#x27;Start If2
                                        End If
                                        If DefaultCredit=&quot;AQAR&quot; OR DefaultCredit=&quot;ADFL&quot; OR DefaultCredit=&quot;SCSB&quot; OR DefaultCredit=&quot;REDF&quot; OR DefaultCredit=&quot;AGDF&quot; OR DefaultProductCode=&quot;VRA&quot; Then
                                            &#x27;Start If3                 &#x27;
                                        End If
                                        If above 2 condition match BOT will continue to take other record.
                                        else
                                            If DefaultStatusCode=&quot;OS&quot; OR DefaultStatusCode=&quot;PP&quot; Then
                                                &#x27;Start If4                     TotOutStandingAmount=Replace(Replace(DefaultOutStandingAmount,&quot;.&quot;,&quot;&quot;),&quot;,&quot;,&quot;.&quot;)                                         TotalOutstandingAmount=TotalOutstandingAmount+CDbl(TotOutStandingAmount)
                                            End If
                                            End
                                            If &#x27;
                                            End If4
                                            End
                                            If  &#x27;
                                            End If3
                                        else
                                            if DefaultCredit=&quot;RAJB&quot; then
                                                If DefaultStatusCode &lt;&gt; &quot;FS&quot; Then
                                                    &#x27;Start If7                     Rajb_Flag=True
                                                End If
                                                End
                                                If &#x27;
                                                End If7
                                            else
                                                If DefaultCredit=&quot;RAJB&quot; then&#x27;Start If8
                                                    If DefaultStatusCode &lt;&gt; &quot;FS&quot; Then
                                                        &#x27;Start If9                         Rajb_Flag=True
                                                    End If
                                                    End
                                                    If &#x27;
                                                    End If9
                                                else
                                                    If DefaultCredit=&quot;AQAR&quot; OR DefaultCredit=&quot;ADFL&quot; OR DefaultCredit=&quot;SCSB&quot; OR DefaultCredit=&quot;REDF&quot; OR DefaultCredit=&quot;AGDF&quot; OR DefaultProductCode=&quot;VRA&quot; Then
                                                        &#x27;
                                                    End If
                                                    if above condition met
                                                        End
                                                        IF
                                                    else                     &#x27;MsgBox(TotalOutstandingAmountNONMobile.ToString())
                                                        If DefaultStatusCode=&quot;OS&quot; OR DefaultStatusCode=&quot;PP&quot; Then&#x27;Start If10                             TotOutStandingAmountNONMobile=Replace(Replace(DefaultOutStandingAmount,&quot;.&quot;,&quot;&quot;),&quot;,&quot;,&quot;.&quot;)                                 TotalOutstandingAmountNONMobile=TotalOutstandingAmountNONMobile+CDbl(TotOutStandingAmountNONMobile)                         &#x27;
                                                        else
                                                            If DefaultStatusCode=&quot;NS&quot; Then
                                                                &#x27;Deleted the NS Logic here
                                                            End If
                                                            End
                                                            If &#x27;
                                                            End If10
                                                            End
                                                            if
                                                            End
                                                            if
                                                            end
                                                            if &#x27;
                                                            End If1
                                                        Next
                                                        End
                                                        If   &#x27;
                                                            if any of the outstanding amout greater than expected amout BOt will reject with below comments
                                                                If TotalOutstandingAmountNONMobile &gt;=5000 Then
                                                                    ReassignFlag=&quot;Reject&quot; ReassignReason=&quot;Rejected the case since the outstanding amount in simah check the non telecom outstanding amount is greater than 5000&quot;
                                                                End If
                                                                return
                                                            else
                                                                If TotalOutstandingAmount &gt;=20000 Then
                                                                    ReassignFlag=&quot;Reject&quot; ReassignReason=&quot;Rejected the case since the outstanding amount in simah check for UTIL OR BNPL OR CDL is greater than 20000&quot;
                                                                End If
                                                                return
                                                            else
                                                                If Rajb_Flag Then
                                                                    ReassignFlag=&quot;Reassign&quot; ReassignReason=&quot;Reassigned the case since there is a RAJB case in simah Creditor and status not FS in default table&quot;
                                                                End If
                                                                return
                                                            else
                                                                end
                                                                If
                                                                Dim TelicomCase,StatusHistory,StatusHistory1 as String  &#x27;
                                                                If CreditInstrument table have Status with BOT will check that outstanding amout.
                                                                    if any of the outstanding amout more than expected BOT will reject the case.
                                                                        if NWtable.Rows.Count&gt;=1 then
                                                                            For k As Integer = 0 To NWtable.Rows.Count - 1         TelicomCase=NWtable.Rows(k)(&quot;Column14&quot;)         StatusHistory=NWtable.Rows(k)(&quot;Column20&quot;)         StatusHistory1=Left(StatusHistory,1)         StatusHistory=&quot; &quot;+StatusHistory
                                                                                if StatusHistory1=&quot;3&quot; OR StatusHistory1=&quot;4&quot; OR StatusHistory1=&quot;5&quot; OR StatusHistory1=&quot;6&quot; then
                                                                                    If Trim(NWtable.Rows(k)(&quot;Column2&quot;))=&quot;AQAR&quot; OR Trim(NWtable.Rows(k)(&quot;Column2&quot;))=&quot;ADLF&quot; OR Trim(NWtable.Rows(k)(&quot;Column2&quot;))=&quot;SLAN&quot; OR Trim(NWtable.Rows(k)(&quot;Column2&quot;))=&quot;CDL&quot; OR Trim(NWtable.Rows(k)(&quot;Column2&quot;))=&quot;BNPL&quot; Then
                                                                                        &#x27;Ignore line
                                                                                    End If
                                                                                else                 FlagForSimahApprovalOrRejection=True
                                                                                    end
                                                                                    if
                                                                                else
                                                                                    If StatusHistory1=&quot;0&quot; Then
                                                                                        &#x27;Ignore line
                                                                                    End If
                                                                                else
                                                                                    if StatusHistory1=&quot;1&quot; OR  StatusHistory1=&quot;2&quot; OR StatusHistory1=&quot;Q&quot; OR StatusHistory1=&quot;D&quot; OR                  StatusHistory1=&quot;C&quot; OR StatusHistory1=&quot;F&quot; OR StatusHistory1=&quot;R&quot; OR StatusHistory1=&quot;N&quot; Then
                                                                                        Dim out1 as Integer
                                                                                        Dim TempText1 as String=Trim(StatusHistory)                 out1=0
                                                                                        For i as integer=1 to TempText1.Length()
                                                                                            If InStr(&quot;123456789&quot;,Mid(TempText1,i,1))&gt;0 Then
                                                                                                out1=out1+1
                                                                                            End If
                                                                                        else                             out1=0
                                                                                            end
                                                                                            if
                                                                                            If out1=3 Then
                                                                                                FlagForConsecutiveReject=True
                                                                                            End If
                                                                                            exit
                                                                                            For
                                                                                            end
                                                                                            if
                                                                                        Next         &#x27;
                                                                                    else
                                                                                        If (StatusHistory1=&quot;M&quot; OR StatusHistory1=&quot;m&quot;) AND Trim(NWtable.Rows(k)(&quot;Column2&quot;))&lt;&gt;&quot;BNPL&quot; Then
                                                                                            removed during NST &amp; ST Nonapproved changes 12/18/2024
                                                                                        End If
                                                                                    else
                                                                                        If (StatusHistory1=&quot;M&quot; OR StatusHistory1=&quot;m&quot;) Then
                                                                                            &#x27;
                                                                                        End If
                                                                                        Dim TempText as String=IsPatternMatch(&quot;(?&lt;Result&gt;[m,M]*)[0-9].*&quot;,StatusHistory)
                                                                                        Dim out as Integer
                                                                                        Dim TempText as String=Trim(StatusHistory)             out=0  &#x27;=================================================================================================
                                                                                        For i as integer=1 to TempText.Length()
                                                                                            If Mid(TempText,i,1).ToUpper()=&quot;M&quot; Then
                                                                                                out=out+1
                                                                                            End If
                                                                                        else
                                                                                            If InStr(&quot;0123456789&quot;,Mid(TempText,i,1))&gt;0 Then
                                                                                                out=out+CInt(Mid(TempText,i,1))
                                                                                            End If
                                                                                            exit
                                                                                            For
                                                                                        else
                                                                                            exit
                                                                                            For
                                                                                            end
                                                                                            If
                                                                                        Next   &#x27;================================================================================================
                                                                                        If out &gt; 2 Then
                                                                                            ReassignFlag=&quot;Reject&quot;             ReassignReason=&quot;Rejected the case since the Statushistory M check fail&quot;
                                                                                        End If
                                                                                        return
                                                                                    end If
                                                                                else
                                                                                    End
                                                                                    if
                                                                                Next
                                                                                End
                                                                                if
                                                                                If FlagForSimahApprovalOrRejection = True Then
                                                                                    ReassignFlag=&quot;Reject&quot; ReassignReason=&quot;Rejected due to Simah check failed since the status history shows rejection code(3,4,5,6)&quot;
                                                                                End If
                                                                                return
                                                                                End
                                                                                If
                                                                                If FlagForConsecutiveReject = True Then
                                                                                    ReassignFlag=&quot;Reject&quot; ReassignReason=&quot;Rejected due to 3 Consecutive Numbers greater than 0&quot;
                                                                                End If
                                                                                return
                                                                            End If"
                            data-title="UWCA_Common_Salary_and_Simah_logic_V1.0 / Simah Logic / Simah Code">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>UWCA_Common_Salary_and_Simah_logic_V1.0</td>
                <td>Simah Logic - NST NonApproved</td>
                <td>Simah Code NST</td>
                <td>visualbasic</td>
                <td>152</td>
                <!--<td style="font-family: monospace;">d2ace8518f3ae0ed5ecb0de741cbe243ef5681d858a2d88ab88434e62ddcd78b</td>-->
                <td>reflection</td>
                <!--<td>&#x27;Simah logic is to check other banks outstanding amout. if any of the cusotmer have more than expected outstanding amout BOT will reassign the case.     Dim Company_Type,Product_Type,Status_W,Status_Hiso     try as String         Dim DefaultProductCode,DefaultStatusCode,DefaultOutStandingAmount,Defa...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="&#x27;Simah logic is to check other banks outstanding amout.
if any of the cusotmer have more than expected outstanding amout BOT will reassign the case.
    Dim Company_Type,Product_Type,Status_W,Status_Hiso
    try as String
        Dim DefaultProductCode,DefaultStatusCode,DefaultOutStandingAmount,DefaultDate,DefaultCredit,TotOutstandingAmount,TotOutStandingAmountNONMobile as String
        Dim NSDateDiff as Integer  Status_Flag=False
        Dim Rajb_Flag as Boolean =False  ReassignFlag =&quot;&quot; ReassignReason=&quot;&quot;
        Dim NWtable as new DataTable
        Dim TotalOutstandingAmountNONMobile as Double=0 &#x27;
        Dim TotalOutstandingAmountMilitory as Double=0  &#x27;
        Dim TotalOutstandingAmountGov as Double=0 &#x27;
        Dim TotalOutstandingAmountPrivate as Double=0
        Dim TotalOutstandingAmount as Double=0 NWtable.Columns.Add(&quot;Column1&quot;, Type.GetType(&quot;System.String&quot;)) NWtable.Columns.Add(&quot;Column2&quot;, Type.GetType(&quot;System.String&quot;)) NWtable.Columns.Add(&quot;Column20&quot;, Type.GetType(&quot;System.String&quot;)) NWtable.Columns.Add(&quot;Column14&quot;, Type.GetType(&quot;System.String&quot;))  &#x27;check wether CreditDetails table contain status as W and Company_Type either RAJB or ADFL leave those rows. Other than that add to NWtable.
        If  CreditDetails.Rows.Count&gt;=3 Then
            For i As Integer = 0 To CreditDetails.Rows.Count - 1
                If i&gt;=2 Then
                    Company_Type=CreditDetails.Rows(i)(&quot;Column1&quot;)         Product_Type=CreditDetails.Rows(i)(&quot;Column2&quot;)         Status_W=CreditDetails.Rows(i)(&quot;Column7&quot;)         Status_Hiso
                End If
                try=CreditDetails.Rows(i)(&quot;Column20&quot;)          &#x27;
                    if (Status_W=&quot;A&quot; OR Status_W=&quot;S&quot;) AND (Company_Type&lt;&gt;&quot;ADFL&quot; AND Company_Type&lt;&gt;&quot;GOVR&quot; AND Product_Type&lt;&gt;&quot;VRA&quot; AND Company_Type&lt;&gt;&quot;UTIL&quot;) then
                        If (Status_W=&quot;A&quot; OR Status_W=&quot;S&quot;) AND (Company_Type&lt;&gt;&quot;UTIL&quot;) Then
                            Status_Flag=True             NWtable.Rows.Add(CreditDetails.Rows(i)(&quot;Column1&quot;),CreditDetails.Rows(i)(&quot;Column2&quot;),CreditDetails.Rows(i)(&quot;Column20&quot;),CreditDetails.Rows(i)(&quot;Column14&quot;))
                        End If
                        end
                        if
                    end if
                Next
                End
                If   &#x27;
                    If Status is W(defaulter) and Defaulter table having more than 2 records. calculate outstanding amount based on the business rules.
                        If DefaultTable.Rows.Count&gt;=3 Then
                            For j As Integer = 0 To DefaultTable.Rows.Count - 1
                                If j &gt;= 2 Then
                                    &#x27;Start If1             DefaultProductCode=Trim(DefaultTable.Rows(j)(&quot;Column1&quot;))             DefaultStatusCode=Trim(DefaultTable.Rows(j)(&quot;Column6&quot;))             DefaultOutStandingAmount=Trim(DefaultTable.Rows(j)(&quot;Column5&quot;))              DefaultDate=DefaultTable.Rows(j)(&quot;Column3&quot;)             DefaultCredit=Trim(DefaultTable.Rows(j)(&quot;Column2&quot;))                 NSDateDiff=DateDiff(&quot;d&quot;,Convert.ToDateTime(DefaultDate),Now())
                                End If
                                If  DefaultCredit=&quot;RAJB&quot;   Then
                                    If DefaultStatusCode &lt;&gt; &quot;FS&quot; Then
                                        Rajb_Flag=True
                                    End If
                                    end
                                    if
                                    end
                                    if
                                    If DefaultCredit=&quot;AQAR&quot; OR DefaultCredit=&quot;ADFL&quot; OR DefaultCredit=&quot;SCSB&quot; OR DefaultCredit=&quot;REDF&quot; OR DefaultCredit=&quot;AGDF&quot; OR DefaultProductCode=&quot;VRA&quot;  Then
                                        End
                                        if
                                        If DefaultProductCode=&quot;CDL&quot; OR DefaultProductCode=&quot;BNPL&quot; OR DefaultProductCode=&quot;MBL&quot; OR DefaultProductCode=&quot;LND&quot; OR DefaultProductCode=&quot;NET&quot; OR DefaultProductCode=&quot;RCSR&quot; OR DefaultProductCode=&quot;WAT&quot; Then
                                            &#x27;Start If2
                                        End If
                                        If DefaultCredit=&quot;AQAR&quot; OR DefaultCredit=&quot;ADFL&quot; OR DefaultCredit=&quot;SCSB&quot; OR DefaultCredit=&quot;REDF&quot; OR DefaultCredit=&quot;AGDF&quot; OR DefaultProductCode=&quot;VRA&quot; Then
                                            &#x27;Start If3                 &#x27;
                                        End If
                                        If above 2 condition match BOT will continue to take other record.
                                        else                      &#x27;
                                            If DefaultStatusCode=&quot;OS&quot; OR DefaultStatusCode=&quot;PP&quot; Then
                                                &#x27;Start If4                         TotOutStandingAmount=Replace(Replace(DefaultOutStandingAmount,&quot;.&quot;,&quot;&quot;),&quot;,&quot;,&quot;.&quot;)                                             TotalOutstandingAmount=TotalOutstandingAmount+CDbl(TotOutStandingAmount)                     &#x27;
                                            End If
                                            End
                                            If &#x27;
                                            End If4
                                            End
                                            If  &#x27;
                                            End If3
                                        else
                                            if DefaultCredit=&quot;RAJB&quot; then
                                                If DefaultStatusCode &lt;&gt; &quot;FS&quot; Then
                                                    &#x27;Start If7                         Rajb_Flag=True
                                                End If
                                                End
                                                If &#x27;
                                                End If7
                                            else
                                                If DefaultCredit=&quot;RAJB&quot; then&#x27;Start If8
                                                    If DefaultStatusCode &lt;&gt; &quot;FS&quot; Then
                                                        &#x27;Start If9                         Rajb_Flag=True
                                                    End If
                                                    End
                                                    If &#x27;
                                                    End If9
                                                else
                                                    If DefaultCredit=&quot;AQAR&quot; OR DefaultCredit=&quot;ADFL&quot; OR DefaultCredit=&quot;SCSB&quot; OR DefaultCredit=&quot;REDF&quot; OR DefaultCredit=&quot;AGDF&quot; OR DefaultProductCode=&quot;VRA&quot; Then
                                                        &#x27;
                                                    End If
                                                    if above condition met
                                                        End
                                                        IF
                                                    else                     &#x27;MsgBox(TotalOutstandingAmountNONMobile.ToString())                         &#x27;
                                                        If DefaultStatusCode=&quot;OS&quot; OR DefaultStatusCode=&quot;PP&quot; Then&#x27;Start If10                             TotOutStandingAmountNONMobile=Replace(Replace(DefaultOutStandingAmount,&quot;.&quot;,&quot;&quot;),&quot;,&quot;,&quot;.&quot;)                                 TotalOutstandingAmountNONMobile=TotalOutstandingAmountNONMobile+CDbl(TotOutStandingAmountNONMobile)                         &#x27;
                                                        else
                                                            If DefaultStatusCode=&quot;NS&quot; Then
                                                                &#x27;Deleted the NS Logic here                             &#x27;
                                                            End If
                                                            End
                                                            If &#x27;
                                                            End If10
                                                            End
                                                            if
                                                            End
                                                            if
                                                            end
                                                            if &#x27;
                                                            End If1
                                                        Next
                                                        End
                                                        If   &#x27;
                                                            if any of the outstanding amout greater than expected amout BOt will reject with below comments
                                                                If TotalOutstandingAmountNONMobile &gt;=1 Then
                                                                    ReassignFlag=&quot;Reject&quot; ReassignReason=&quot;Rejected the case since the outstanding amount in simah check the non telecom outstanding amount is greater than 1&quot;
                                                                End If
                                                                return
                                                            else
                                                                If TotalOutstandingAmount &gt;=20000 Then
                                                                    ReassignFlag=&quot;Reject&quot; &#x27;ReassignReason=&quot;Rejected the case since the outstanding amount in simah check for UTIL OR BNPL OR CDL is greater than 20000&quot; ReassignReason=&quot;Rejected the case since the outstanding amount in simah check for UTILs is greater than 20000&quot;
                                                                End If
                                                                return
                                                            else
                                                                If Rajb_Flag Then
                                                                    ReassignFlag=&quot;Reassign&quot; ReassignReason=&quot;Reassigned the case since there is a RAJB case in simah Creditor and status not FS in default table&quot;
                                                                End If
                                                                return
                                                            else
                                                                end
                                                                If
                                                                Dim TelicomCase,StatusHistory,StatusHistory1 as String  &#x27;
                                                                If CreditInstrument table have Status with BOT will check that outstanding amout.
                                                                    if any of the outstanding amout more than expected BOT will reject the case.
                                                                        if NWtable.Rows.Count&gt;=1 then
                                                                            For k As Integer = 0 To NWtable.Rows.Count - 1         TelicomCase=NWtable.Rows(k)(&quot;Column14&quot;)         StatusHistory=NWtable.Rows(k)(&quot;Column20&quot;)         StatusHistory1=Left(StatusHistory,1)         StatusHistory=&quot; &quot;+StatusHistory
                                                                                Dim out as Integer         out=0 &#x27;=================================================================================================
                                                                                For i as integer=1 to StatusHistory.Length()
                                                                                    If Mid(StatusHistory,i,1).ToUpper()=&quot;M&quot; Then
                                                                                        out=out+1
                                                                                    End If
                                                                                else
                                                                                    If InStr(&quot;123456789&quot;,Mid(StatusHistory,i,1))&gt;0 Then
                                                                                        out=out+CInt(Mid(StatusHistory,i,1))
                                                                                    End If
                                                                                    end
                                                                                    If
                                                                                    if i=12 Then
                                                                                        exit
                                                                                        For
                                                                                        end
                                                                                        if
                                                                                    Next  &#x27;================================================================================================
                                                                                    If out &gt;= 2 Then
                                                                                        ReassignFlag=&quot;Reject&quot;             ReassignReason=&quot;Rejected the case since the Statushistory M check fail&quot;
                                                                                    End If
                                                                                    return
                                                                                end If
                                                                            Next
                                                                        End if"
                            data-title="UWCA_Common_Salary_and_Simah_logic_V1.0 / Simah Logic - NST NonApproved / Simah Code NST">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>UWCA_Common_Salary_and_Simah_logic_V2.0</td>
                <td>GetOneMonthFull Salary</td>
                <td>Filter Collection1</td>
                <td>visualbasic</td>
                <td>6</td>
                <!--<td style="font-family: monospace;">c923c99415a4cd6045d25f97a6cbb1a13207cdf1baf5dc8c1df087012e26e633</td>-->
                <td>—</td>
                <!--<td>Dim NewRow As DataRow Dim Amount as Decimal =0 Collection_Out = Collection_In.Clone For Each parentRow As DataRow In Collection_In.Select(Select_Condition)     NewRow = Collection_Out.NewRow     For Each c As DataColumn In NewRow.Table.Columns         NewRow(c.ColumnName) = parentRow(c.ColumnName)  ...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Dim NewRow As DataRow
Dim Amount as Decimal =0 Collection_Out = Collection_In.Clone
For Each parentRow As DataRow In Collection_In.Select(Select_Condition)     NewRow = Collection_Out.NewRow
    For Each c As DataColumn In NewRow.Table.Columns         NewRow(c.ColumnName) = parentRow(c.ColumnName)
    Next     Collection_Out.Rows.Add(NewRow)
Next NewRow = Nothing Collection_In = Nothing"
                            data-title="UWCA_Common_Salary_and_Simah_logic_V2.0 / GetOneMonthFull Salary / Filter Collection1">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>UWCA_Common_Salary_and_Simah_logic_V2.0</td>
                <td>GetOneMonthFull Salary</td>
                <td>Filter Collection2</td>
                <td>visualbasic</td>
                <td>6</td>
                <!--<td style="font-family: monospace;">c923c99415a4cd6045d25f97a6cbb1a13207cdf1baf5dc8c1df087012e26e633</td>-->
                <td>—</td>
                <!--<td>Dim NewRow As DataRow Dim Amount as Decimal =0 Collection_Out = Collection_In.Clone For Each parentRow As DataRow In Collection_In.Select(Select_Condition)     NewRow = Collection_Out.NewRow     For Each c As DataColumn In NewRow.Table.Columns         NewRow(c.ColumnName) = parentRow(c.ColumnName)  ...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Dim NewRow As DataRow
Dim Amount as Decimal =0 Collection_Out = Collection_In.Clone
For Each parentRow As DataRow In Collection_In.Select(Select_Condition)     NewRow = Collection_Out.NewRow
    For Each c As DataColumn In NewRow.Table.Columns         NewRow(c.ColumnName) = parentRow(c.ColumnName)
    Next     Collection_Out.Rows.Add(NewRow)
Next NewRow = Nothing Collection_In = Nothing"
                            data-title="UWCA_Common_Salary_and_Simah_logic_V2.0 / GetOneMonthFull Salary / Filter Collection2">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>UWCA_Common_Salary_and_Simah_logic_V2.0</td>
                <td>GetOneMonthFull Salary</td>
                <td>Filter Collection3</td>
                <td>visualbasic</td>
                <td>6</td>
                <!--<td style="font-family: monospace;">c923c99415a4cd6045d25f97a6cbb1a13207cdf1baf5dc8c1df087012e26e633</td>-->
                <td>—</td>
                <!--<td>Dim NewRow As DataRow Dim Amount as Decimal =0 Collection_Out = Collection_In.Clone For Each parentRow As DataRow In Collection_In.Select(Select_Condition)     NewRow = Collection_Out.NewRow     For Each c As DataColumn In NewRow.Table.Columns         NewRow(c.ColumnName) = parentRow(c.ColumnName)  ...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Dim NewRow As DataRow
Dim Amount as Decimal =0 Collection_Out = Collection_In.Clone
For Each parentRow As DataRow In Collection_In.Select(Select_Condition)     NewRow = Collection_Out.NewRow
    For Each c As DataColumn In NewRow.Table.Columns         NewRow(c.ColumnName) = parentRow(c.ColumnName)
    Next     Collection_Out.Rows.Add(NewRow)
Next NewRow = Nothing Collection_In = Nothing"
                            data-title="UWCA_Common_Salary_and_Simah_logic_V2.0 / GetOneMonthFull Salary / Filter Collection3">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>UWCA_Common_Salary_and_Simah_logic_V2.0</td>
                <td>GetOneMonthFull Salary</td>
                <td>Filter Collection5</td>
                <td>visualbasic</td>
                <td>6</td>
                <!--<td style="font-family: monospace;">c923c99415a4cd6045d25f97a6cbb1a13207cdf1baf5dc8c1df087012e26e633</td>-->
                <td>—</td>
                <!--<td>Dim NewRow As DataRow Dim Amount as Decimal =0 Collection_Out = Collection_In.Clone For Each parentRow As DataRow In Collection_In.Select(Select_Condition)     NewRow = Collection_Out.NewRow     For Each c As DataColumn In NewRow.Table.Columns         NewRow(c.ColumnName) = parentRow(c.ColumnName)  ...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Dim NewRow As DataRow
Dim Amount as Decimal =0 Collection_Out = Collection_In.Clone
For Each parentRow As DataRow In Collection_In.Select(Select_Condition)     NewRow = Collection_Out.NewRow
    For Each c As DataColumn In NewRow.Table.Columns         NewRow(c.ColumnName) = parentRow(c.ColumnName)
    Next     Collection_Out.Rows.Add(NewRow)
Next NewRow = Nothing Collection_In = Nothing"
                            data-title="UWCA_Common_Salary_and_Simah_logic_V2.0 / GetOneMonthFull Salary / Filter Collection5">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>UWCA_Common_Salary_and_Simah_logic_V2.0</td>
                <td>GetOneMonthFull Salary</td>
                <td>Filter Collection6</td>
                <td>visualbasic</td>
                <td>6</td>
                <!--<td style="font-family: monospace;">c923c99415a4cd6045d25f97a6cbb1a13207cdf1baf5dc8c1df087012e26e633</td>-->
                <td>—</td>
                <!--<td>Dim NewRow As DataRow Dim Amount as Decimal =0 Collection_Out = Collection_In.Clone For Each parentRow As DataRow In Collection_In.Select(Select_Condition)     NewRow = Collection_Out.NewRow     For Each c As DataColumn In NewRow.Table.Columns         NewRow(c.ColumnName) = parentRow(c.ColumnName)  ...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Dim NewRow As DataRow
Dim Amount as Decimal =0 Collection_Out = Collection_In.Clone
For Each parentRow As DataRow In Collection_In.Select(Select_Condition)     NewRow = Collection_Out.NewRow
    For Each c As DataColumn In NewRow.Table.Columns         NewRow(c.ColumnName) = parentRow(c.ColumnName)
    Next     Collection_Out.Rows.Add(NewRow)
Next NewRow = Nothing Collection_In = Nothing"
                            data-title="UWCA_Common_Salary_and_Simah_logic_V2.0 / GetOneMonthFull Salary / Filter Collection6">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>UWCA_Common_Salary_and_Simah_logic_V2.0</td>
                <td>GetOneMonthFull Salary</td>
                <td>Filter Collection7</td>
                <td>visualbasic</td>
                <td>6</td>
                <!--<td style="font-family: monospace;">c923c99415a4cd6045d25f97a6cbb1a13207cdf1baf5dc8c1df087012e26e633</td>-->
                <td>—</td>
                <!--<td>Dim NewRow As DataRow Dim Amount as Decimal =0 Collection_Out = Collection_In.Clone For Each parentRow As DataRow In Collection_In.Select(Select_Condition)     NewRow = Collection_Out.NewRow     For Each c As DataColumn In NewRow.Table.Columns         NewRow(c.ColumnName) = parentRow(c.ColumnName)  ...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Dim NewRow As DataRow
Dim Amount as Decimal =0 Collection_Out = Collection_In.Clone
For Each parentRow As DataRow In Collection_In.Select(Select_Condition)     NewRow = Collection_Out.NewRow
    For Each c As DataColumn In NewRow.Table.Columns         NewRow(c.ColumnName) = parentRow(c.ColumnName)
    Next     Collection_Out.Rows.Add(NewRow)
Next NewRow = Nothing Collection_In = Nothing"
                            data-title="UWCA_Common_Salary_and_Simah_logic_V2.0 / GetOneMonthFull Salary / Filter Collection7">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>UWCA_Common_Salary_and_Simah_logic_V2.0</td>
                <td>GetOneMonthFull Salary</td>
                <td>Filter With Payment Date</td>
                <td>visualbasic</td>
                <td>6</td>
                <!--<td style="font-family: monospace;">c923c99415a4cd6045d25f97a6cbb1a13207cdf1baf5dc8c1df087012e26e633</td>-->
                <td>—</td>
                <!--<td>Dim NewRow As DataRow Dim Amount as Decimal =0 Collection_Out = Collection_In.Clone For Each parentRow As DataRow In Collection_In.Select(Select_Condition)     NewRow = Collection_Out.NewRow     For Each c As DataColumn In NewRow.Table.Columns         NewRow(c.ColumnName) = parentRow(c.ColumnName)  ...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Dim NewRow As DataRow
Dim Amount as Decimal =0 Collection_Out = Collection_In.Clone
For Each parentRow As DataRow In Collection_In.Select(Select_Condition)     NewRow = Collection_Out.NewRow
    For Each c As DataColumn In NewRow.Table.Columns         NewRow(c.ColumnName) = parentRow(c.ColumnName)
    Next     Collection_Out.Rows.Add(NewRow)
Next NewRow = Nothing Collection_In = Nothing"
                            data-title="UWCA_Common_Salary_and_Simah_logic_V2.0 / GetOneMonthFull Salary / Filter With Payment Date">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>UWCA_Common_Salary_and_Simah_logic_V2.0</td>
                <td>GetOneMonthFull Salary</td>
                <td>Filter With Payment Date 1</td>
                <td>visualbasic</td>
                <td>6</td>
                <!--<td style="font-family: monospace;">c923c99415a4cd6045d25f97a6cbb1a13207cdf1baf5dc8c1df087012e26e633</td>-->
                <td>—</td>
                <!--<td>Dim NewRow As DataRow Dim Amount as Decimal =0 Collection_Out = Collection_In.Clone For Each parentRow As DataRow In Collection_In.Select(Select_Condition)     NewRow = Collection_Out.NewRow     For Each c As DataColumn In NewRow.Table.Columns         NewRow(c.ColumnName) = parentRow(c.ColumnName)  ...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Dim NewRow As DataRow
Dim Amount as Decimal =0 Collection_Out = Collection_In.Clone
For Each parentRow As DataRow In Collection_In.Select(Select_Condition)     NewRow = Collection_Out.NewRow
    For Each c As DataColumn In NewRow.Table.Columns         NewRow(c.ColumnName) = parentRow(c.ColumnName)
    Next     Collection_Out.Rows.Add(NewRow)
Next NewRow = Nothing Collection_In = Nothing"
                            data-title="UWCA_Common_Salary_and_Simah_logic_V2.0 / GetOneMonthFull Salary / Filter With Payment Date 1">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>UWCA_Common_Salary_and_Simah_logic_V2.0</td>
                <td>New Salary Logic</td>
                <td>Description check1</td>
                <td>visualbasic</td>
                <td>44</td>
                <!--<td style="font-family: monospace;">505c18455afbdcc4175f340a000f39bf489f06216f90625741364c65be733b9a</td>-->
                <td>—</td>
                <!--<td>try     Dim description as string     Dim TempDataRow As DataRow = DescriptionCollection.NewRow     Dim Dflag as integer =0     Dim precount as integer =0     Dim count as integer =0     Dim CollOut as DataTable =InputCollection.Clone     Dim Buffer as DataTable=InputCollection.Clone     Dim out1,ou...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="try
    Dim description as string
    Dim TempDataRow As DataRow = DescriptionCollection.NewRow
    Dim Dflag as integer =0
    Dim precount as integer =0
    Dim count as integer =0
    Dim CollOut as DataTable =InputCollection.Clone
    Dim Buffer as DataTable=InputCollection.Clone
    Dim out1,out2 as String  &#x27;Add Description and Count of Description in to DescriptionCollection
    For r As Integer = 0 To InputCollection.Rows.Count-1     description=InputCollection.Rows(r)(&quot;Description&quot;)     Dflag=0
        for i as integer=0 To DescriptionCollection.Rows.Count-1
            If DescriptionCollection.Rows(i)(&quot;Description&quot;)=description Then
                Dflag=1             DescriptionCollection.Rows(i)(&quot;Count&quot;)=DescriptionCollection.Rows(i)(&quot;Count&quot;)+1
            End If
            end
            if
        next
        If Dflag=0 Then
            TempDataRow(&quot;Description&quot;) = description         TempDataRow(&quot;Count&quot;)=1         DescriptionCollection.Rows.Add(TempDataRow)         TempDataRow= DescriptionCollection.NewRow         out1 = &quot;O1&quot;
        End If
        end
        if
    Next  DescriptionCollection.DefaultView.Sort =  &quot;Count DESC&quot; DescriptionCollection=DescriptionCollection.DefaultView.ToTable    &#x27;Get Max Repeated DescriptionCollection
    For r As Integer = 0 To DescriptionCollection.Rows.Count-1     description=DescriptionCollection.Rows(r)(&quot;Description&quot;)     CollOut=Nothing     CollOut=InputCollection.Clone
        For Each parentRow As DataRow In InputCollection.Select(&quot;Description=&#x27;&quot;+description+&quot;&#x27;&quot;)         TempDataRow = CollOut.NewRow
            For Each c As DataColumn In TempDataRow.Table.Columns             TempDataRow(c.ColumnName) = parentRow(c.ColumnName)
            Next         CollOut.Rows.Add(TempDataRow)
        Next     count=CollOut.Rows.Count
        If count&gt;precount Then
            Buffer=Nothing         Buffer = CollOut.Clone         Buffer=CollOut         precount=count         ReassignFlag=0         out2 = &quot;O2&quot;
        End If
    else
        if count = Precount             ReassignFlag=1             Status=&quot;Salary cannot be identified since there mode are equal&quot;
            end
            if
        next
        If precount&lt;=2 Then
            ReassignFlag=1     Status=&quot;Salary cannot be identified since there mode is &lt; 3&quot;
        End If
        end
        if FilteredDescCollection=Buffer D0=DescriptionCollection
        catch e as Exception         ReassignFlag=1         Status=&quot;Code Error:&quot;+e.ToString
            end
            try"
                            data-title="UWCA_Common_Salary_and_Simah_logic_V2.0 / New Salary Logic / Description check1">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>UWCA_Common_Salary_and_Simah_logic_V2.0</td>
                <td>New Salary Logic</td>
                <td>Filter Salay with +5 and -5 Days1</td>
                <td>visualbasic</td>
                <td>41</td>
                <!--<td style="font-family: monospace;">749d00c0bc02ea23c0044597bec933f59ae16266faad401782621f6dbdf48e4f</td>-->
                <td>—</td>
                <!--<td>try     Dim TempCollection as DataTable=FilteredDescCollection.Clone     Dim TempRow As DataRow = FilteredDescCollection.NewRow &#x27;Temp collections to store each month transacation in single collection &#x27;SD stands     for Salary Date         Dim TempCollectionSD1 as DataTable=FilteredDescCollection.Clo...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="try
    Dim TempCollection as DataTable=FilteredDescCollection.Clone
    Dim TempRow As DataRow = FilteredDescCollection.NewRow &#x27;Temp collections to store each month transacation in single collection &#x27;SD stands
    for Salary Date
        Dim TempCollectionSD1 as DataTable=FilteredDescCollection.Clone
        Dim TempCollectionSD2 as DataTable=FilteredDescCollection.Clone
        Dim TempCollectionSD3 as DataTable=FilteredDescCollection.Clone &#x27;
        Dim TempCollectionSD4 as DataTable=FilteredDescCollection.Clone
        Dim TempOutCollection as DataTable=FilteredDescCollection.Clone   &#x27;Adding +5 &amp; -5 days
        Dim SD1p as Date=SD1.AddDays(5)
        Dim SD1m as Date=SD1.AddDays(-5)
        Dim SD2p as Date=SD2.AddDays(5)
        Dim SD2m as Date=SD2.AddDays(-5)
        Dim SD3p as Date=SD3.AddDays(5)
        Dim SD3m as Date=SD3.AddDays(-5)     &#x27;
        Dim SD4p as Date=SD4.AddDays(5)     &#x27;
        Dim SD4m as Date=SD4.AddDays(-5)  &#x27;Fiter the collection based on above criteria (+5 &amp; -5) to get each month one collection
        For r As Integer = 0 To FilteredDescCollection.Rows.Count-1             if(SD1m&lt;=FilteredDescCollection.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=FilteredDescCollection.Rows(r)(&quot;Account date&quot;) AND FilteredDescCollection.Rows(r)(&quot;Sal&quot;)&gt;0 ) then                 TempRow= FilteredDescCollection.Rows(r)                 TempCollectionSD1.ImportRow(TempRow)                 TempRow=TempCollectionSD1.NewRow
        end if                            if(SD2m&lt;=FilteredDescCollection.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=FilteredDescCollection.Rows(r)(&quot;Account date&quot;)AND FilteredDescCollection.Rows(r)(&quot;Sal&quot;)&gt;0 ) then                     TempRow= FilteredDescCollection.Rows(r)                     TempCollectionSD2.ImportRow(TempRow)                     TempRow=TempCollectionSD2.NewRow
    end if                      if(SD3m&lt;=FilteredDescCollection.Rows(r)(&quot;Account date&quot;) AND SD3p&gt;=FilteredDescCollection.Rows(r)(&quot;Account date&quot;)AND FilteredDescCollection.Rows(r)(&quot;Sal&quot;)&gt;0 ) then                     TempRow= FilteredDescCollection.Rows(r)                     TempCollectionSD3.ImportRow(TempRow)                     TempRow=TempCollectionSD3.NewRow
end if                  &#x27;if(SD4m&lt;=FilteredDescCollection.Rows(r)(&quot;Account date&quot;) AND SD4p&gt;=FilteredDescCollection.Rows(r)(&quot;Account date&quot;) AND FilteredDescCollection.Rows(r)(&quot;Sal&quot;)&gt;0 ) then             &#x27;        TempRow= FilteredDescCollection.Rows(r)             &#x27;        TempCollectionSD4.ImportRow(TempRow)             &#x27;        TempRow=TempCollectionSD4.NewRow                          &#x27;
end if
next &#x27;sort all the collection in desc order      TempCollectionSD1.DefaultView.Sort =  &quot;Sal DESC&quot;     TempCollectionSD2.DefaultView.Sort =  &quot;Sal DESC&quot;     TempCollectionSD3.DefaultView.Sort =  &quot;Sal DESC&quot;     &#x27;TempCollectionSD4.DefaultView.Sort =  &quot;Sal DESC&quot;  &#x27;converting collection into DataTable      TempCollectionSD1=TempCollectionSD1.DefaultView.ToTable     TempCollectionSD2=TempCollectionSD2.DefaultView.ToTable     TempCollectionSD3=TempCollectionSD3.DefaultView.ToTable     &#x27;TempCollectionSD4=TempCollectionSD4.DefaultView.ToTable  &#x27;add only max salary to Output collection from each month collection         if(TempCollectionSD1.Rows.Count&gt;0)then             TempOutCollection.ImportRow(TempCollectionSD1.Rows(0))
else             ReassignFlag=1             Status=&quot;Current month salary not found&quot;
    return
    end
    if                  if(TempCollectionSD2.Rows.Count&gt;0)then             TempOutCollection.ImportRow(TempCollectionSD2.Rows(0))
    else             ReassignFlag=1             Status=&quot; Current month -1 salary not found&quot;
        return
        end
        if                      if(TempCollectionSD3.Rows.Count&gt;0)then             TempOutCollection.ImportRow(TempCollectionSD3.Rows(0))
        else             ReassignFlag=1             Status=&quot; Current month -2 salary not found&quot;
            return
            end
            if                      &#x27;if(TempCollectionSD4.Rows.Count&gt;0)then         &#x27;    TempOutCollection.ImportRow(TempCollectionSD4.Rows(0))         &#x27;
            else         &#x27;    ReassignFlag=1         &#x27;    Status=&quot; 4th month salary not found&quot;         &#x27;
                end
                if  &#x27;TempOutCollection.DefaultView.Sort =  &quot;Account date ASC&quot; TempOutCollection=TempOutCollection.DefaultView.ToTable FilterDateCollection=TempOutCollection
                catch e as Exception         ReassignFlag=1         Status=&quot;Code Error:&quot;+e.ToString
                    end
                    try"
                            data-title="UWCA_Common_Salary_and_Simah_logic_V2.0 / New Salary Logic / Filter Salay with +5 and -5 Days1">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>UWCA_Common_Salary_and_Simah_logic_V2.0</td>
                <td>New Salary Logic</td>
                <td>Filter Salay with +5 and -5 Days1 With Payment Date</td>
                <td>visualbasic</td>
                <td>41</td>
                <!--<td style="font-family: monospace;">749d00c0bc02ea23c0044597bec933f59ae16266faad401782621f6dbdf48e4f</td>-->
                <td>—</td>
                <!--<td>try     Dim TempCollection as DataTable=FilteredDescCollection.Clone     Dim TempRow As DataRow = FilteredDescCollection.NewRow &#x27;Temp collections to store each month transacation in single collection &#x27;SD stands     for Salary Date         Dim TempCollectionSD1 as DataTable=FilteredDescCollection.Clo...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="try
    Dim TempCollection as DataTable=FilteredDescCollection.Clone
    Dim TempRow As DataRow = FilteredDescCollection.NewRow &#x27;Temp collections to store each month transacation in single collection &#x27;SD stands
    for Salary Date
        Dim TempCollectionSD1 as DataTable=FilteredDescCollection.Clone
        Dim TempCollectionSD2 as DataTable=FilteredDescCollection.Clone
        Dim TempCollectionSD3 as DataTable=FilteredDescCollection.Clone &#x27;
        Dim TempCollectionSD4 as DataTable=FilteredDescCollection.Clone
        Dim TempOutCollection as DataTable=FilteredDescCollection.Clone   &#x27;Adding +5 &amp; -5 days
        Dim SD1p as Date=SD1.AddDays(5)
        Dim SD1m as Date=SD1.AddDays(-5)
        Dim SD2p as Date=SD2.AddDays(5)
        Dim SD2m as Date=SD2.AddDays(-5)
        Dim SD3p as Date=SD3.AddDays(5)
        Dim SD3m as Date=SD3.AddDays(-5)     &#x27;
        Dim SD4p as Date=SD4.AddDays(5)     &#x27;
        Dim SD4m as Date=SD4.AddDays(-5)  &#x27;Fiter the collection based on above criteria (+5 &amp; -5) to get each month one collection
        For r As Integer = 0 To FilteredDescCollection.Rows.Count-1             if(SD1m&lt;=FilteredDescCollection.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=FilteredDescCollection.Rows(r)(&quot;Account date&quot;) AND FilteredDescCollection.Rows(r)(&quot;Sal&quot;)&gt;0 ) then                 TempRow= FilteredDescCollection.Rows(r)                 TempCollectionSD1.ImportRow(TempRow)                 TempRow=TempCollectionSD1.NewRow
        end if                            if(SD2m&lt;=FilteredDescCollection.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=FilteredDescCollection.Rows(r)(&quot;Account date&quot;)AND FilteredDescCollection.Rows(r)(&quot;Sal&quot;)&gt;0 ) then                     TempRow= FilteredDescCollection.Rows(r)                     TempCollectionSD2.ImportRow(TempRow)                     TempRow=TempCollectionSD2.NewRow
    end if                      if(SD3m&lt;=FilteredDescCollection.Rows(r)(&quot;Account date&quot;) AND SD3p&gt;=FilteredDescCollection.Rows(r)(&quot;Account date&quot;)AND FilteredDescCollection.Rows(r)(&quot;Sal&quot;)&gt;0 ) then                     TempRow= FilteredDescCollection.Rows(r)                     TempCollectionSD3.ImportRow(TempRow)                     TempRow=TempCollectionSD3.NewRow
end if                  &#x27;if(SD4m&lt;=FilteredDescCollection.Rows(r)(&quot;Account date&quot;) AND SD4p&gt;=FilteredDescCollection.Rows(r)(&quot;Account date&quot;) AND FilteredDescCollection.Rows(r)(&quot;Sal&quot;)&gt;0 ) then             &#x27;        TempRow= FilteredDescCollection.Rows(r)             &#x27;        TempCollectionSD4.ImportRow(TempRow)             &#x27;        TempRow=TempCollectionSD4.NewRow                          &#x27;
end if
next &#x27;sort all the collection in desc order      TempCollectionSD1.DefaultView.Sort =  &quot;Sal DESC&quot;     TempCollectionSD2.DefaultView.Sort =  &quot;Sal DESC&quot;     TempCollectionSD3.DefaultView.Sort =  &quot;Sal DESC&quot;     &#x27;TempCollectionSD4.DefaultView.Sort =  &quot;Sal DESC&quot;  &#x27;converting collection into DataTable      TempCollectionSD1=TempCollectionSD1.DefaultView.ToTable     TempCollectionSD2=TempCollectionSD2.DefaultView.ToTable     TempCollectionSD3=TempCollectionSD3.DefaultView.ToTable     &#x27;TempCollectionSD4=TempCollectionSD4.DefaultView.ToTable  &#x27;add only max salary to Output collection from each month collection         if(TempCollectionSD1.Rows.Count&gt;0)then             TempOutCollection.ImportRow(TempCollectionSD1.Rows(0))
else             ReassignFlag=1             Status=&quot;Current month salary not found&quot;
    return
    end
    if                  if(TempCollectionSD2.Rows.Count&gt;0)then             TempOutCollection.ImportRow(TempCollectionSD2.Rows(0))
    else             ReassignFlag=1             Status=&quot; Current month -1 salary not found&quot;
        return
        end
        if                      if(TempCollectionSD3.Rows.Count&gt;0)then             TempOutCollection.ImportRow(TempCollectionSD3.Rows(0))
        else             ReassignFlag=1             Status=&quot; Current month -2 salary not found&quot;
            return
            end
            if                      &#x27;if(TempCollectionSD4.Rows.Count&gt;0)then         &#x27;    TempOutCollection.ImportRow(TempCollectionSD4.Rows(0))         &#x27;
            else         &#x27;    ReassignFlag=1         &#x27;    Status=&quot; 4th month salary not found&quot;         &#x27;
                end
                if  &#x27;TempOutCollection.DefaultView.Sort =  &quot;Account date ASC&quot; TempOutCollection=TempOutCollection.DefaultView.ToTable FilterDateCollection=TempOutCollection
                catch e as Exception         ReassignFlag=1         Status=&quot;Code Error:&quot;+e.ToString
                    end
                    try"
                            data-title="UWCA_Common_Salary_and_Simah_logic_V2.0 / New Salary Logic / Filter Salay with +5 and -5 Days1 With Payment Date">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>UWCA_Common_Salary_and_Simah_logic_V2.0</td>
                <td>New Salary Logic</td>
                <td>Filter Salay with +5 and -5 Days2</td>
                <td>visualbasic</td>
                <td>43</td>
                <!--<td style="font-family: monospace;">6f7d183a8e2c904c2a1b07258c1ca2672538371a42209c4fb0005efaee1f9825</td>-->
                <td>—</td>
                <!--<td>try     Dim TempCollection as DataTable=FilteredDescCollection.Clone     Dim TempRow As DataRow = FilteredDescCollection.NewRow &#x27;Temp collections to store each month transacation in single collection &#x27;SD stands     for Salary Date         Dim TempCollectionSD1 as DataTable=FilteredDescCollection.Clo...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="try
    Dim TempCollection as DataTable=FilteredDescCollection.Clone
    Dim TempRow As DataRow = FilteredDescCollection.NewRow &#x27;Temp collections to store each month transacation in single collection &#x27;SD stands
    for Salary Date
        Dim TempCollectionSD1 as DataTable=FilteredDescCollection.Clone
        Dim TempCollectionSD2 as DataTable=FilteredDescCollection.Clone
        Dim TempCollectionSD3 as DataTable=FilteredDescCollection.Clone &#x27;
        Dim TempCollectionSD4 as DataTable=FilteredDescCollection.Clone
        Dim TempOutCollection as DataTable=FilteredDescCollection.Clone   &#x27;Filtering Transaction colletion with Tran Code column.
        If found Then
            add to corresponding collection.
        End If
        For r As Integer = 0 To FilteredDescCollection.Rows.Count-1                                       if(FilteredDescCollection.Rows(r)(&quot;Tran code&quot;)=&quot;312&quot;) then                     if(SD1=FilteredDescCollection.Rows(r)(&quot;Account date&quot;)) then                         TempRow= FilteredDescCollection.Rows(r)                         TempCollectionSD1.ImportRow(TempRow)                         TempRow=TempCollectionSD1.NewRow
        end if                                      if(SD2=FilteredDescCollection.Rows(r)(&quot;Account date&quot;)) then                             TempRow= FilteredDescCollection.Rows(r)                             TempCollectionSD2.ImportRow(TempRow)                             TempRow=TempCollectionSD2.NewRow
    end if                                      if(SD3=FilteredDescCollection.Rows(r)(&quot;Account date&quot;))then                             TempRow= FilteredDescCollection.Rows(r)                             TempCollectionSD3.ImportRow(TempRow)                             TempRow=TempCollectionSD3.NewRow
    end
    if                                          &#x27;if(SD4=FilteredDescCollection.Rows(r)(&quot;Account date&quot;))then                     &#x27;        TempRow= FilteredDescCollection.Rows(r)                     &#x27;        TempCollectionSD4.ImportRow(TempRow)                     &#x27;        TempRow=TempCollectionSD4.NewRow                                      &#x27;
        end
        if
    else                                          ReassignFlag=1                     Status=&quot;Salary not identified after filter with code&quot;
        return
        end
        if
    next &#x27;sort all the collection in desc order      TempCollectionSD1.DefaultView.Sort =  &quot;Sal DESC&quot;     TempCollectionSD2.DefaultView.Sort =  &quot;Sal DESC&quot;     TempCollectionSD3.DefaultView.Sort =  &quot;Sal DESC&quot;     &#x27;TempCollectionSD4.DefaultView.Sort =  &quot;Sal DESC&quot;  &#x27;converting collection into DataTable      TempCollectionSD1=TempCollectionSD1.DefaultView.ToTable     TempCollectionSD2=TempCollectionSD2.DefaultView.ToTable     TempCollectionSD3=TempCollectionSD3.DefaultView.ToTable     &#x27;TempCollectionSD4=TempCollectionSD4.DefaultView.ToTable  &#x27;add only max salary to Output collection from each month collection         if(TempCollectionSD1.Rows.Count&gt;0)then             TempOutCollection.ImportRow(TempCollectionSD1.Rows(0))
else             ReassignFlag=1             Status=&quot;Current month salary not found&quot;
    return
    end
    if                  if(TempCollectionSD2.Rows.Count&gt;0)then             TempOutCollection.ImportRow(TempCollectionSD2.Rows(0))
    else             ReassignFlag=1             Status=&quot; Current month -1 salary not found&quot;
        return
        end
        if                      if(TempCollectionSD3.Rows.Count&gt;0)then             TempOutCollection.ImportRow(TempCollectionSD3.Rows(0))
        else             ReassignFlag=1             Status=&quot; Current month -2 salary not found&quot;
            return
            end
            if                  &#x27;if(TempCollectionSD4.Rows.Count&gt;0)then         &#x27;    TempOutCollection.ImportRow(TempCollectionSD4.Rows(0))         &#x27;
            else         &#x27;    ReassignFlag=1         &#x27;    Status=&quot; Current month -3 salary not found&quot;         &#x27;
                return         &#x27;
                end
                if           &#x27;TempOutCollection.DefaultView.Sort =  &quot;Account date DESC&quot; TempOutCollection=TempOutCollection.DefaultView.ToTable FilterCodeCollection=TempOutCollection
                catch e as Exception         ReassignFlag=1         Status=&quot;Code Error:&quot;+e.ToString
                    end
                    try"
                            data-title="UWCA_Common_Salary_and_Simah_logic_V2.0 / New Salary Logic / Filter Salay with +5 and -5 Days2">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>UWCA_Common_Salary_and_Simah_logic_V2.0</td>
                <td>New Salary Logic</td>
                <td>Salary Logic based on AVG1</td>
                <td>visualbasic</td>
                <td>45</td>
                <!--<td style="font-family: monospace;">d23bb53d21629033ffcd659bab0b51b3e1f16f98113dc1ae4c4164bfc0123a40</td>-->
                <td>—</td>
                <!--<td>try     Dim Amount as Decimal =0     Dim Avg as Decimal=0     Dim Sum as Decimal =0     Dim skip as integer =0     Dim min as Decimal =0     Dim max as Decimal =0     Dim minSal as Decimal =0     Dim minimumSalarySAR as string =Nothing  &#x27;To assign each month salary into one variable     Dim FirstMon...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="try
    Dim Amount as Decimal =0
    Dim Avg as Decimal=0
    Dim Sum as Decimal =0
    Dim skip as integer =0
    Dim min as Decimal =0
    Dim max as Decimal =0
    Dim minSal as Decimal =0
    Dim minimumSalarySAR as string =Nothing  &#x27;To assign each month salary into one variable
    Dim FirstMonthSalary as Decimal=0
    Dim SecondMonthSalary as Decimal=0 &#x27;
    Dim ThirdMonthSalary as Decimal=0
    Dim CurrentMonthSalary as Decimal=0
    Dim ActualSalary as Decimal=0   &#x27;Read salaries from input collection FilterDateCollection CurrentMonthSalary=FilterDateCollection.Rows(0)(&quot;Sal&quot;) FirstMonthSalary=FilterDateCollection.Rows(1)(&quot;Sal&quot;) SecondMonthSalary=FilterDateCollection.Rows(2)(&quot;Sal&quot;) &#x27;ThirdMonthSalary=FilterDateCollection.Rows(3)(&quot;Sal&quot;)   &#x27;Rule2 take avarage of last 3 months salaries and check avg with min(s1,s2,s3)+20%Min(s1,s2,s3)
    If condition is true Then
        take avg as Salary.     max=FilterDateCollection.Rows(0)(&quot;Sal&quot;)     minSal=FilterDateCollection.Rows(0)(&quot;Sal&quot;)
    End If
    For k As Integer = 0 To 2         Sum=Sum+FilterDateCollection.Rows(k)(&quot;Sal&quot;)         if(max&lt;FilterDateCollection.Rows(k)(&quot;Sal&quot;))then                 max=FilterDateCollection.Rows(k)(&quot;Sal&quot;)
        end
        if         if(minSal&gt;FilterDateCollection.Rows(k)(&quot;Sal&quot;))then                 minSal=FilterDateCollection.Rows(k)(&quot;Sal&quot;)
            end
            if
        next           Avg=Sum/3     CurrentMonthSalary = minSal &#x27;Rule1
        If the employeer is Governamet-employee deduct 1000 SAR from his/her salary     &#x27;if(GovFlag)     &#x27;    ActualSalary=CurrentMonthSalary-1000     &#x27;
        else     &#x27;    ActualSalary=CurrentMonthSalary     &#x27;
            end
            if     &#x27;MsgBox(CurrentMonthSalary) &#x27;Rule2
                If Jan Salary less than or equal to (Avg or Avg+10%(Avg)) Then
                    Jan Salary as Salary
                End If
            else Avg as Salary.
                If Math.Round(((Avg-CurrentMonthSalary)/Avg),3)&lt;= 0.2 Then
                    &#x27;AND Math.Round(((Avg-CurrentMonthSalary)/Avg),3)&gt;= -0.1)then     Avg=Sum/3
                End If
            else     Avg=(Sum-max)/2
                End
                If          min=FilterDateorCodeCollection.Rows(0)(&quot;Sal&quot;)
                    For k As Integer = 0 To 2
                        if min &gt;= FilterDateorCodeCollection.Rows(K)(&quot;Sal&quot;)then             min=FilterDateorCodeCollection.Rows(K)(&quot;Sal&quot;)             minimumSalarySAR=FilterDateorCodeCollection.Rows(k)(&quot;Amount&quot;)
                            end
                            if
                        next       Salary=minimumSalarySAR     Other=Replace(Math.Round((Avg-min),2),&quot;.&quot;,&quot;,&quot;)  OutputCollection=FilterDateCollection
                    catch e as Exception         ReassignFlag=1         Status=&quot;Code Error:&quot;+e.ToString
                        end
                        try"
                            data-title="UWCA_Common_Salary_and_Simah_logic_V2.0 / New Salary Logic / Salary Logic based on AVG1">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>UWCA_Common_Salary_and_Simah_logic_V2.0</td>
                <td>New Salary Logic</td>
                <td>Salary code requirements1</td>
                <td>visualbasic</td>
                <td>71</td>
                <!--<td style="font-family: monospace;">117c6ffa7ec70f8097b6591c7d92435e40b4bbe9e91d0c89cb7f44bd9da787a1</td>-->
                <td>reflection</td>
                <!--<td>&#x27;Page1 try     If Not c1.Columns.Contains(&quot;Sal&quot;) Then         c1.Columns.Add(&quot;Sal&quot;, Type.GetType(&quot;System.Decimal&quot;))     End If     End     If     For r As Integer = 0 To c1.Rows.Count - 1         c1.Rows(r)(&quot;Sal&quot;) = Replace(Replace(c1.Rows(r)(&quot;Amount&quot;), &quot;.&quot;, &quot;&quot;), &quot;,&quot;, &quot;.&quot;)         c1.Rows(r)(&quot;Sal&quot;)=...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="&#x27;Page1
try
    If Not c1.Columns.Contains(&quot;Sal&quot;) Then
        c1.Columns.Add(&quot;Sal&quot;, Type.GetType(&quot;System.Decimal&quot;))
    End If
    End
    If
    For r As Integer = 0 To c1.Rows.Count - 1         c1.Rows(r)(&quot;Sal&quot;) = Replace(Replace(c1.Rows(r)(&quot;Amount&quot;), &quot;.&quot;, &quot;&quot;), &quot;,&quot;, &quot;.&quot;)         c1.Rows(r)(&quot;Sal&quot;)=Convert.ToDecimal(c1.Rows(r)(&quot;Sal&quot;))
    Next  &#x27;Filtering &lt;1900
    If Not GovFlag then
        Dim NewRow As DataRow  C0 = C1.Clone
        For Each parentRow As DataRow In C1.Select(Select_Condition)         NewRow = C0.NewRow
            For Each c As DataColumn In NewRow.Table.Columns             NewRow(c.ColumnName) = parentRow(c.ColumnName)
            Next         C0.Rows.Add(NewRow)
        Next   NewRow = Nothing C1 = Nothing  &#x27;Page2 C1=C0
        End
        If
        Dim x as integer = 0
        Dim dd,mm,yy as string
        Dim count as integer =0
        dim test,dec
        dim flag as integer=1
        dim days as integer =0 dec=&quot;&quot; dd=&quot;&quot; mm=&quot;&quot; yy=&quot;&quot; &#x27;
        If Not c1.Columns.Contains(&quot;ADate&quot;) Then
            &#x27;    c1.Columns.Add(&quot;ADate&quot;, Type.GetType(&quot;System.String&quot;)) &#x27;
        End If
        End
        if
        If Not c1.Columns.Contains(&quot;Days&quot;) Then
            c1.Columns.Add(&quot;Days&quot;, Type.GetType(&quot;System.DateTime&quot;))
        End If
        End
        if
        For i As Integer = 0 To c1.Rows.Count - 1     c1.Rows(i)(&quot;Description&quot;)=Replace(c1.Rows(i)(&quot;Description&quot;),&quot; &quot;,&quot;&quot;)
            if Left(c1.Rows(i)(&quot;Description&quot;),7) =  &quot;PAYROL/&quot; OR Left(c1.Rows(i)(&quot;Description&quot;),7) =  &quot;SALARY/&quot;         c1.Rows(i)(&quot;Description&quot;) = Replace(Replace(c1.Rows(i)(&quot;Description&quot;),&quot;PAYROL/&quot;,&quot;&quot;),&quot;SALARY/&quot;,&quot;&quot;)
                end
                if     test=c1.Rows(i)(&quot;Description&quot;)
                    do         x = InStr(test, &quot;/&quot;)     if(x&gt;0)             test=Replace(test, Left(test, x),&quot;&quot;)
                        if flag=1         dec=test         flag = 0
                            end
                            if             count = count+1
                            end if
                        loop
                        while x&lt;&gt;0
                            if count&gt;2         c1.Rows(i)(&quot;Description&quot;)= Trim(dec)
                            else &#x27;        dec=&quot;arb: &quot;+c1.Rows(r)(&quot;Description&quot;)
                                Dim R as New Regex(&quot;[A-Z,0-9,/]*(?&lt;Result&gt;[أ-ي,0-9]*)&quot;, RegexOptions.SingleLine)
                                Dim M as Match = R.Match(c1.Rows(i)(&quot;Description&quot;))
                                If M IsNot Nothing AndAlso M.Success Then
                                    dec = M.Groups(&quot;Result&quot;).Value
                                End If
                                End
                                If         c1.Rows(i)(&quot;Description&quot;)= Trim(dec)
                                    end
                                    if     flag=1     count=0     x=0     yy=c1.Rows(i)(&quot;Account date&quot;)
                                        for j as integer =0 to 2         x=Instr(yy,&quot;/&quot;)
                                            If j=0 Then
                                                dd=Left(yy,x-1)             yy=Right(yy,len(yy)-x)
                                            End If
                                        else
                                            if j=1             mm=Left(yy,x-1)             yy=Right(yy,len(yy)-x)
                                                end
                                                if
                                            next
                                            if mm&lt;&gt;&quot;&quot;&#x27;Date.Parse         c1.Rows(i)(&quot;Account date&quot;)=(mm+&quot;/&quot;+dd+&quot;/&quot;+yy)
                                                end
                                                if     &#x27;days=DateDiff(DateInterval.Day,Date.Parse(c1.Rows(i)(&quot;Account date&quot;)),Today())     &#x27;    c1.Rows(i)(&quot;Days&quot;)=days     c1.Rows(i)(&quot;Days&quot;)=DateTime.Parse(c1.Rows(i)(&quot;Account date&quot;))     &#x27;MsgBox(mm+&quot;/&quot;+dd+&quot;/&quot;+yy) dec=&quot;&quot; dd=&quot;&quot; mm=&quot;&quot;  yy=&quot;&quot;
                                                Next  c1.DefaultView.Sort = &quot;Days DESC&quot;  c0 = c1.DefaultView.ToTable
                                            catch e as Exception     &#x27;MsgBox(&quot;error&quot;)         ReassignFlag=1         Status=&quot;Code Error:&quot;+e.ToString
                                                end
                                                try"
                            data-title="UWCA_Common_Salary_and_Simah_logic_V2.0 / New Salary Logic / Salary code requirements1">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>UWCA_Common_Salary_and_Simah_logic_V2.0</td>
                <td>New Salary Logic</td>
                <td>Salary code requirements2</td>
                <td>visualbasic</td>
                <td>71</td>
                <!--<td style="font-family: monospace;">6372db1f3d49c20eec036798fe93aef37dd9eeecdc97fc46ed904173b18bff1e</td>-->
                <td>reflection</td>
                <!--<td>&#x27;Page1 try     If Not c1.Columns.Contains(&quot;Sal&quot;) Then         c1.Columns.Add(&quot;Sal&quot;, Type.GetType(&quot;System.Decimal&quot;))     End If     End     If     For r As Integer = 0 To c1.Rows.Count - 1         c1.Rows(r)(&quot;Sal&quot;) = Replace(Replace(c1.Rows(r)(&quot;Amount&quot;), &quot;.&quot;, &quot;&quot;), &quot;,&quot;, &quot;.&quot;)         c1.Rows(r)(&quot;Sal&quot;)=...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="&#x27;Page1
try
    If Not c1.Columns.Contains(&quot;Sal&quot;) Then
        c1.Columns.Add(&quot;Sal&quot;, Type.GetType(&quot;System.Decimal&quot;))
    End If
    End
    If
    For r As Integer = 0 To c1.Rows.Count - 1         c1.Rows(r)(&quot;Sal&quot;) = Replace(Replace(c1.Rows(r)(&quot;Amount&quot;), &quot;.&quot;, &quot;&quot;), &quot;,&quot;, &quot;.&quot;)         c1.Rows(r)(&quot;Sal&quot;)=Convert.ToDecimal(c1.Rows(r)(&quot;Sal&quot;))
    Next  &#x27;Filtering &lt;1900
    If Not GovFlag then
        Dim NewRow As DataRow  C0 = C1.Clone
        For Each parentRow As DataRow In C1.Select(Select_Condition)         NewRow = C0.NewRow
            For Each c As DataColumn In NewRow.Table.Columns             NewRow(c.ColumnName) = parentRow(c.ColumnName)
            Next         C0.Rows.Add(NewRow)
        Next   NewRow = Nothing C1 = Nothing  &#x27;Page2 C1=C0
        End
        If
        Dim x as integer = 0
        Dim dd,mm,yy as string
        Dim count as integer =0
        dim dec
        dim flag as integer=1
        dim days as integer =0 dec=&quot;&quot; dd=&quot;&quot; mm=&quot;&quot; yy=&quot;&quot; &#x27;
        If Not c1.Columns.Contains(&quot;ADate&quot;) Then
            &#x27;    c1.Columns.Add(&quot;ADate&quot;, Type.GetType(&quot;System.String&quot;)) &#x27;
        End If
        End
        if
        If Not c1.Columns.Contains(&quot;Days&quot;) Then
            c1.Columns.Add(&quot;Days&quot;, Type.GetType(&quot;System.DateTime&quot;))
        End If
        End
        if
        For i As Integer = 0 To c1.Rows.Count - 1     &#x27;c1.Rows(i)(&quot;Description&quot;)=Replace(c1.Rows(i)(&quot;Description&quot;),&quot; &quot;,&quot;&quot;)     &#x27;
            if Left(c1.Rows(i)(&quot;Description&quot;),7) =  &quot;PAYR/&quot; OR Left(c1.Rows(i)(&quot;Description&quot;),7) =  &quot;SAL/&quot;         &#x27;c1.Rows(i)(&quot;Description&quot;) = Replace(Replace(c1.Rows(i)(&quot;Description&quot;),&quot;PAYROL/&quot;,&quot;&quot;),&quot;SALARY/&quot;,&quot;&quot;)     &#x27;
                end
                if     &#x27;test=c1.Rows(i)(&quot;Description&quot;)     &#x27;
                    do         &#x27;x = InStr(test, &quot;/&quot;)     &#x27;if(x&gt;0)         &#x27;    test=Replace(test, Left(test, x),&quot;&quot;)     &#x27;
                        if flag=1         &#x27;dec=test         &#x27;flag = 0     &#x27;
                            end
                            if         &#x27;    count = count+1     &#x27;
                            end if         &#x27;
                        loop
                        while x&lt;&gt;0     &#x27;
                            if count&gt;2     &#x27;    c1.Rows(i)(&quot;Description&quot;)= Trim(dec)     &#x27;
                            else &#x27;        dec=&quot;arb: &quot;+c1.Rows(r)(&quot;Description&quot;) &#x27;         &#x27;
                                Dim R as New Regex(&quot;[A-Z,0-9,/]*(?&lt;Result&gt;[أ-ي,0-9]*)&quot;, RegexOptions.SingleLine)         &#x27;
                                Dim M as Match = R.Match(c1.Rows(i)(&quot;Description&quot;))         &#x27;
                                If M IsNot Nothing AndAlso M.Success Then
                                    &#x27;dec = M.Groups(&quot;Result&quot;).Value         &#x27;
                                End If
                                End
                                If         &#x27;c1.Rows(i)(&quot;Description&quot;)= Trim(dec)         &#x27;
                                    end
                                    if     &#x27;flag=1     &#x27;count=0     &#x27;x=0     yy=c1.Rows(i)(&quot;Account date&quot;)
                                        for j as integer =0 to 2         x=Instr(yy,&quot;/&quot;)
                                            If j=0 Then
                                                dd=Left(yy,x-1)             yy=Right(yy,len(yy)-x)
                                            End If
                                        else
                                            if j=1             mm=Left(yy,x-1)             yy=Right(yy,len(yy)-x)
                                                end
                                                if
                                            next
                                            if mm&lt;&gt;&quot;&quot;&#x27;Date.Parse         c1.Rows(i)(&quot;Account date&quot;)=(mm+&quot;/&quot;+dd+&quot;/&quot;+yy)
                                                end
                                                if     &#x27;days=DateDiff(DateInterval.Day,Date.Parse(c1.Rows(i)(&quot;Account date&quot;)),Today())     &#x27;    c1.Rows(i)(&quot;Days&quot;)=days     c1.Rows(i)(&quot;Days&quot;)=DateTime.Parse(c1.Rows(i)(&quot;Account date&quot;))     &#x27;MsgBox(mm+&quot;/&quot;+dd+&quot;/&quot;+yy) dec=&quot;&quot; dd=&quot;&quot; mm=&quot;&quot;  yy=&quot;&quot;
                                                Next  c1.DefaultView.Sort = &quot;Days DESC&quot;  c0 = c1.DefaultView.ToTable
                                            catch e as Exception     &#x27;MsgBox(&quot;error&quot;)         ReassignFlag=1         Status=&quot;Code Error:&quot;+e.ToString
                                                end
                                                try"
                            data-title="UWCA_Common_Salary_and_Simah_logic_V2.0 / New Salary Logic / Salary code requirements2">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>UWCA_Common_Salary_and_Simah_logic_V2.0</td>
                <td>Salary Date Formating</td>
                <td>Formate Date</td>
                <td>visualbasic</td>
                <td>73</td>
                <!--<td style="font-family: monospace;">afdfc8cb49128a566d3240232e3cfe39647223621f9b42168a9d3b8339ef1509</td>-->
                <td>reflection</td>
                <!--<td>&#x27;Page1 try     If Not c1.Columns.Contains(&quot;Sal&quot;) Then         c1.Columns.Add(&quot;Sal&quot;, Type.GetType(&quot;System.Decimal&quot;))     End If     End     If     For r As Integer = 0 To c1.Rows.Count - 1         c1.Rows(r)(&quot;Sal&quot;) = Replace(Replace(c1.Rows(r)(&quot;Amount&quot;), &quot;.&quot;, &quot;&quot;), &quot;,&quot;, &quot;.&quot;)         c1.Rows(r)(&quot;Sal&quot;)=...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="&#x27;Page1
try
    If Not c1.Columns.Contains(&quot;Sal&quot;) Then
        c1.Columns.Add(&quot;Sal&quot;, Type.GetType(&quot;System.Decimal&quot;))
    End If
    End
    If
    For r As Integer = 0 To c1.Rows.Count - 1         c1.Rows(r)(&quot;Sal&quot;) = Replace(Replace(c1.Rows(r)(&quot;Amount&quot;), &quot;.&quot;, &quot;&quot;), &quot;,&quot;, &quot;.&quot;)         c1.Rows(r)(&quot;Sal&quot;)=Convert.ToDecimal(c1.Rows(r)(&quot;Sal&quot;))
    Next  &#x27;Filtering &lt;1900 &#x27;
    If Not GovFlag Then
        &#x27;
    End If
    Dim NewRow As DataRow  &#x27;C0 = C1.Clone &#x27;
    For Each parentRow As DataRow In C1.Select(Select_Condition) &#x27;        NewRow = C0.NewRow &#x27;
        For Each c As DataColumn In NewRow.Table.Columns &#x27;            NewRow(c.ColumnName) = parentRow(c.ColumnName) &#x27;
        Next &#x27;        C0.Rows.Add(NewRow) &#x27;
    Next &#x27;  &#x27;NewRow = Nothing &#x27;C1 = Nothing  &#x27;Page2 &#x27;C1=C0 &#x27;
    End
    If
    Dim x as integer = 0
    Dim dd,mm,yy as string
    Dim count as integer =0
    dim test,dec
    dim flag as integer=1
    dim days as integer =0 dec=&quot;&quot; dd=&quot;&quot; mm=&quot;&quot; yy=&quot;&quot; &#x27;
    If Not c1.Columns.Contains(&quot;ADate&quot;) Then
        &#x27;    c1.Columns.Add(&quot;ADate&quot;, Type.GetType(&quot;System.String&quot;)) &#x27;
    End If
    End
    if
    If Not c1.Columns.Contains(&quot;Days&quot;) Then
        c1.Columns.Add(&quot;Days&quot;, Type.GetType(&quot;System.DateTime&quot;))
    End If
    End
    if
    For i As Integer = 0 To c1.Rows.Count - 1     c1.Rows(i)(&quot;Description&quot;)=Replace(c1.Rows(i)(&quot;Description&quot;),&quot; &quot;,&quot;&quot;)
        if Left(c1.Rows(i)(&quot;Description&quot;),7) =  &quot;PAYROLL&quot; OR Left(c1.Rows(i)(&quot;Description&quot;),7) =  &quot;SALARY&quot;         &#x27;c1.Rows(i)(&quot;Description&quot;) = Replace(Replace(c1.Rows(i)(&quot;Description&quot;),&quot;PAYROL&quot;,&quot;&quot;),&quot;SALARY&quot;,&quot;&quot;)
            end
            if     test=c1.Rows(i)(&quot;Description&quot;)
                do         x = InStr(test, &quot;/&quot;)     if(x&gt;0)             test=Replace(test, Left(test, x),&quot;&quot;)
                    if flag=1         dec=test         flag = 0
                        end
                        if             count = count+1
                        end if
                    loop
                    while x&lt;&gt;0 &#x27;
                        if count&gt;2 &#x27;        c1.Rows(i)(&quot;Description&quot;)= Trim(dec) &#x27;
                        else &#x27;        dec=&quot;arb: &quot;+c1.Rows(r)(&quot;Description&quot;)  &#x27;
                            Dim R as New Regex(&quot;[A-Z,0-9,/]*(?&lt;Result&gt;[أ-ي,0-9]*)&quot;, RegexOptions.SingleLine) &#x27;
                            Dim M as Match = R.Match(c1.Rows(i)(&quot;Description&quot;)) &#x27;
                            If M IsNot Nothing AndAlso M.Success Then
                                &#x27;            dec = M.Groups(&quot;Result&quot;).Value &#x27;
                            End If
                            End
                            If &#x27;        c1.Rows(i)(&quot;Description&quot;)= Trim(dec)     &#x27;
                                end
                                if     flag=1     count=0     x=0     yy=c1.Rows(i)(&quot;Account date&quot;)
                                    for j as integer =0 to 2         x=Instr(yy,&quot;/&quot;)
                                        If j=0 Then
                                            dd=Left(yy,x-1)             yy=Right(yy,len(yy)-x)
                                        End If
                                    else
                                        if j=1             mm=Left(yy,x-1)             yy=Right(yy,len(yy)-x)
                                            end
                                            if
                                        next
                                        if mm&lt;&gt;&quot;&quot;&#x27;Date.Parse         c1.Rows(i)(&quot;Account date&quot;)=(mm+&quot;/&quot;+dd+&quot;/&quot;+yy)
                                            end
                                            if     &#x27;days=DateDiff(DateInterval.Day,Date.Parse(c1.Rows(i)(&quot;Account date&quot;)),Today())     &#x27;    c1.Rows(i)(&quot;Days&quot;)=days     c1.Rows(i)(&quot;Days&quot;)=DateTime.Parse(c1.Rows(i)(&quot;Account date&quot;))     &#x27;MsgBox(mm+&quot;/&quot;+dd+&quot;/&quot;+yy) dec=&quot;&quot; dd=&quot;&quot; mm=&quot;&quot;  yy=&quot;&quot;
                                            Next  c1.DefaultView.Sort = &quot;Days DESC&quot;  c0 = c1.DefaultView.ToTable
                                        catch e as Exception     &#x27;MsgBox(&quot;error&quot;)         ReassignFlag=1         Status=&quot;Code Error:&quot;+e.ToString
                                            end
                                            try"
                            data-title="UWCA_Common_Salary_and_Simah_logic_V2.0 / Salary Date Formating / Formate Date">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>UWCA_Common_Salary_and_Simah_logic_V2.0</td>
                <td>Simah Logic</td>
                <td>Simah Code</td>
                <td>visualbasic</td>
                <td>178</td>
                <!--<td style="font-family: monospace;">05fd9cc5afa4b8cc6cd0b1b1dfbb83ec35ccfd03273e298b31a3855efc58c708</td>-->
                <td>reflection</td>
                <!--<td>&#x27;Simah logic is to check other banks outstanding amout. if any of the cusotmer have more than expected outstanding amout BOT will reassign the case.     Dim Company_Type,Product_Type,Status_W,Status_Hiso     try as String         Dim DefaultProductCode,DefaultStatusCode,DefaultOutStandingAmount,Defa...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="&#x27;Simah logic is to check other banks outstanding amout.
if any of the cusotmer have more than expected outstanding amout BOT will reassign the case.
    Dim Company_Type,Product_Type,Status_W,Status_Hiso
    try as String
        Dim DefaultProductCode,DefaultStatusCode,DefaultOutStandingAmount,DefaultDate,DefaultCredit,TotOutstandingAmount,TotOutStandingAmountNONMobile as String
        Dim NSDateDiff as Integer
        Dim Status_Flag as Boolean=False
        Dim Rajb_Flag as Boolean =False
        Dim FlagForSimahApprovalOrRejection as Boolean=False ReassignFlag =&quot;&quot; ReassignReason=&quot;&quot;
        Dim NWtable as new DataTable
        Dim TotalOutstandingAmountNONMobile as Double=0 &#x27;
        Dim TotalOutstandingAmountMilitory as Double=0  &#x27;
        Dim TotalOutstandingAmountGov as Double=0 &#x27;
        Dim TotalOutstandingAmountPrivate as Double=0
        Dim TotalOutstandingAmount as Double=0 NWtable.Columns.Add(&quot;Column1&quot;, Type.GetType(&quot;System.String&quot;)) NWtable.Columns.Add(&quot;Column2&quot;, Type.GetType(&quot;System.String&quot;)) NWtable.Columns.Add(&quot;Column20&quot;, Type.GetType(&quot;System.String&quot;)) NWtable.Columns.Add(&quot;Column14&quot;, Type.GetType(&quot;System.String&quot;))  &#x27;check wether CreditDetails table contain status as W and Company_Type either RAJB or ADFL leave those rows. Other than that add to NWtable.
        If  CreditDetails.Rows.Count&gt;=3 Then
            For i As Integer = 0 To CreditDetails.Rows.Count - 1
                If i&gt;=2 Then
                    Company_Type=CreditDetails.Rows(i)(&quot;Column1&quot;)         Product_Type=CreditDetails.Rows(i)(&quot;Column2&quot;)         Status_W=CreditDetails.Rows(i)(&quot;Column7&quot;)         Status_Hiso
                End If
                try=CreditDetails.Rows(i)(&quot;Column20&quot;)
                    If Status_W=&quot;W&quot; Then
                        Status_Flag=True
                    End If
                else
                    if Company_Type=&quot;RAJB&quot; OR Company_Type=&quot;ADFL&quot; OR Company_Type=&quot;GOVR&quot; OR Company_Type=&quot;VRA&quot; OR Product_Type=&quot;VRA&quot; OR Company_Type=&quot;UTIL&quot; OR                 Product_Type=&quot;MBL&quot; OR Product_Type=&quot;LND&quot; OR Product_Type=&quot;NET&quot; OR Product_Type=&quot;WAT&quot; OR Product_Type=&quot;RCSR&quot; then
                    else         NWtable.Rows.Add(CreditDetails.Rows(i)(&quot;Column1&quot;),CreditDetails.Rows(i)(&quot;Column2&quot;),CreditDetails.Rows(i)(&quot;Column20&quot;),CreditDetails.Rows(i)(&quot;Column14&quot;))
                        end
                        if
                    end if
                Next
                End
                If   &#x27;
                    If Status is W(defaulter) and Defaulter table having more than 2 records. calculate outstanding amount based on the business rules.
                        If DefaultTable.Rows.Count&gt;=3 Then
                            For j As Integer = 0 To DefaultTable.Rows.Count - 1
                                If j &gt;= 2 Then
                                    &#x27;Start If1             DefaultProductCode=Trim(DefaultTable.Rows(j)(&quot;Column1&quot;))             DefaultStatusCode=Trim(DefaultTable.Rows(j)(&quot;Column6&quot;))             DefaultOutStandingAmount=Trim(DefaultTable.Rows(j)(&quot;Column5&quot;))              DefaultDate=DefaultTable.Rows(j)(&quot;Column3&quot;)             DefaultCredit=Trim(DefaultTable.Rows(j)(&quot;Column2&quot;))                 NSDateDiff=DateDiff(&quot;d&quot;,Convert.ToDateTime(DefaultDate),Now())
                                End If
                                If  DefaultCredit=&quot;RAJB&quot;   Then
                                    If DefaultStatusCode &lt;&gt; &quot;FS&quot; Then
                                        Rajb_Flag=True
                                    End If
                                    end
                                    if
                                    end
                                    if
                                    If DefaultCredit=&quot;AQAR&quot; OR DefaultCredit=&quot;ADFL&quot; OR DefaultCredit=&quot;SCSB&quot; OR DefaultCredit=&quot;REDF&quot; OR DefaultCredit=&quot;AGDF&quot; OR DefaultProductCode=&quot;VRA&quot;  Then
                                        End
                                        if
                                        If DefaultProductCode=&quot;MBL&quot; OR DefaultProductCode=&quot;LND&quot; OR DefaultProductCode=&quot;NET&quot; OR DefaultProductCode=&quot;RCSR&quot; OR DefaultProductCode=&quot;WAT&quot; Then
                                            &#x27;Start If2
                                        End If
                                        If DefaultCredit=&quot;AQAR&quot; OR DefaultCredit=&quot;ADFL&quot; OR DefaultCredit=&quot;SCSB&quot; OR DefaultCredit=&quot;REDF&quot; OR DefaultCredit=&quot;AGDF&quot; OR DefaultProductCode=&quot;VRA&quot; Then
                                            &#x27;Start If3                 &#x27;
                                        End If
                                        If above 2 condition match BOT will continue to take other record.
                                        else
                                            If DefaultStatusCode=&quot;OS&quot; OR DefaultStatusCode=&quot;PP&quot; Then
                                                &#x27;Start If4                     TotOutStandingAmount=Replace(Replace(DefaultOutStandingAmount,&quot;.&quot;,&quot;&quot;),&quot;,&quot;,&quot;.&quot;)                                         TotalOutstandingAmount=TotalOutstandingAmount+CDbl(TotOutStandingAmount)
                                            End If
                                            End
                                            If &#x27;
                                            End If4
                                            End
                                            If  &#x27;
                                            End If3
                                        else
                                            if DefaultCredit=&quot;RAJB&quot; then
                                                If DefaultStatusCode &lt;&gt; &quot;FS&quot; Then
                                                    &#x27;Start If7                     Rajb_Flag=True
                                                End If
                                                End
                                                If &#x27;
                                                End If7
                                            else
                                                If DefaultCredit=&quot;RAJB&quot; then&#x27;Start If8
                                                    If DefaultStatusCode &lt;&gt; &quot;FS&quot; Then
                                                        &#x27;Start If9                         Rajb_Flag=True
                                                    End If
                                                    End
                                                    If &#x27;
                                                    End If9
                                                else
                                                    If DefaultCredit=&quot;AQAR&quot; OR DefaultCredit=&quot;ADFL&quot; OR DefaultCredit=&quot;SCSB&quot; OR DefaultCredit=&quot;REDF&quot; OR DefaultCredit=&quot;AGDF&quot; OR DefaultProductCode=&quot;VRA&quot; Then
                                                        &#x27;
                                                    End If
                                                    if above condition met
                                                        End
                                                        IF
                                                    else             &#x27;MsgBox(TotalOutstandingAmountNONMobile.ToString())
                                                        If DefaultStatusCode=&quot;OS&quot; OR DefaultStatusCode=&quot;PP&quot; Then&#x27;Start If10                         TotOutStandingAmountNONMobile=Replace(Replace(DefaultOutStandingAmount,&quot;.&quot;,&quot;&quot;),&quot;,&quot;,&quot;.&quot;)                             TotalOutstandingAmountNONMobile=TotalOutstandingAmountNONMobile+CDbl(TotOutStandingAmountNONMobile)                     &#x27;
                                                        else
                                                            If DefaultStatusCode=&quot;NS&quot; Then
                                                                &#x27;Deleted the NS Logic here
                                                            End If
                                                            End
                                                            If &#x27;
                                                            End If10
                                                            End
                                                            if
                                                            End
                                                            if
                                                            end
                                                            if &#x27;
                                                            End If1
                                                        Next
                                                        End
                                                        If   &#x27;
                                                            if any of the outstanding amout greater than expected amout BOt will reject with below comments
                                                                If TotalOutstandingAmountNONMobile &gt;=5000 Then
                                                                    ReassignFlag=&quot;Reject&quot; ReassignReason=&quot;Rejected the case since the outstanding amount in simah check the non telecom outstanding amount is greater than 5000&quot;
                                                                End If
                                                                return &#x27;
                                                            else
                                                                If TotalOutstandingAmount &gt;=20000 Then
                                                                    &#x27;ReassignFlag=&quot;Reject&quot; &#x27;ReassignReason=&quot;Rejected the case since the outstanding amount in simah check the teleco outstanding balance is greater than 20000&quot; &#x27;
                                                                End If
                                                                return
                                                            else
                                                                If Rajb_Flag Then
                                                                    ReassignFlag=&quot;Reassign&quot; ReassignReason=&quot;Reassigned the case since there is a RAJB case in simah Creditor and status not FS in default table&quot;
                                                                End If
                                                                return
                                                            else
                                                                end
                                                                If
                                                                Dim TelicomCase,StatusHistory,StatusHistory1 as String  &#x27;
                                                                If CreditInstrument table have Status with BOT will check that outstanding amout.
                                                                    if any of the outstanding amout more than expected BOT will reject the case.
                                                                        if NWtable.Rows.Count&gt;=1 then
                                                                            For k As Integer = 0 To NWtable.Rows.Count - 1         TelicomCase=NWtable.Rows(k)(&quot;Column14&quot;)         StatusHistory=NWtable.Rows(k)(&quot;Column20&quot;)         StatusHistory1=Left(StatusHistory,1)         StatusHistory=&quot; &quot;+StatusHistory
                                                                                if StatusHistory1=&quot;0&quot; OR StatusHistory1=&quot;1&quot; OR  StatusHistory1=&quot;2&quot; OR StatusHistory1=&quot;3&quot; OR StatusHistory1=&quot;Q&quot; OR StatusHistory1=&quot;D&quot; OR            StatusHistory1=&quot;C&quot; OR StatusHistory1=&quot;F&quot; OR StatusHistory1=&quot;R&quot; OR StatusHistory1=&quot;N&quot;  then
                                                                                else
                                                                                    if StatusHistory1=&quot;4&quot; OR StatusHistory1=&quot;5&quot; OR StatusHistory1=&quot;6&quot; then
                                                                                        if Trim(NWtable.Rows(k)(&quot;Column2&quot;))=&quot;AQAR&quot; OR Trim(NWtable.Rows(k)(&quot;Column2&quot;))=&quot;ADLF&quot; OR Trim(NWtable.Rows(k)(&quot;Column2&quot;))=&quot;SLAN&quot; then
                                                                                        else             FlagForSimahApprovalOrRejection=True
                                                                                            end
                                                                                            if
                                                                                        else
                                                                                            If StatusHistory1=&quot;M&quot; OR StatusHistory1=&quot;m&quot; Then
                                                                                                &#x27;
                                                                                            End If
                                                                                            Dim TempText as String=IsPatternMatch(&quot;(?&lt;Result&gt;[m,M]*)[0-9].*&quot;,StatusHistory)
                                                                                            Dim out as Integer
                                                                                            Dim TempText as String=Trim(StatusHistory)             out=0  &#x27;=================================================================================================
                                                                                            For i as integer=1 to TempText.Length()
                                                                                                If Mid(TempText,i,1).ToUpper()=&quot;M&quot; Then
                                                                                                    out=out+1
                                                                                                End If
                                                                                            else
                                                                                                If InStr(&quot;0123456789&quot;,Mid(TempText,i,1))&gt;0 Then
                                                                                                    out=out+CInt(Mid(TempText,i,1))
                                                                                                End If
                                                                                                exit
                                                                                                For
                                                                                            else
                                                                                                exit
                                                                                                For
                                                                                                end
                                                                                                If
                                                                                            Next   &#x27;================================================================================================
                                                                                            If out &gt; 3 Then
                                                                                                ReassignFlag=&quot;Reject&quot;             ReassignReason=&quot;Rejected the case since the Statushistory M check fail&quot;
                                                                                            End If
                                                                                            return
                                                                                        end If
                                                                                    else
                                                                                        End
                                                                                        if
                                                                                    Next
                                                                                    End
                                                                                    if
                                                                                    If FlagForSimahApprovalOrRejection = True Then
                                                                                        ReassignFlag=&quot;Reject&quot; ReassignReason=&quot;Rejected due to Simah check failed since the status history shows rejection code(4,5,6)&quot;
                                                                                    End If
                                                                                    return
                                                                                End If"
                            data-title="UWCA_Common_Salary_and_Simah_logic_V2.0 / Simah Logic / Simah Code">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>UWCA_MRCC_CTF_V1.0</td>
                <td>Get Salary Dates</td>
                <td>Get Dates</td>
                <td>visualbasic</td>
                <td>31</td>
                <!--<td style="font-family: monospace;">59adff665d7ee68717ed4bf3f8147ebb360cc7a5959b90a53c75822935a2dd17</td>-->
                <td>sql_keywords, reflection</td>
                <!--<td>Dim HDRString As String = &quot;No&quot; If First_Line_Is_Header Then     HDRSTring = &quot;Yes&quot; End If Dim Folder as String = nothing Dim FileName As String = Nothing Dim Tempdate as Date Dim HijiryColl as DataTable HijiryCollOut.Columns.Add(&quot;Date&quot;,Type.GetType(&quot;System.String&quot;))  &#x27;Read Dates from CSV file and put...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Dim HDRString As String = &quot;No&quot;
If First_Line_Is_Header Then
    HDRSTring = &quot;Yes&quot;
End If
Dim Folder as String = nothing
Dim FileName As String = Nothing
Dim Tempdate as Date
Dim HijiryColl as DataTable HijiryCollOut.Columns.Add(&quot;Date&quot;,Type.GetType(&quot;System.String&quot;))  &#x27;Read Dates from CSV file and put into Hijri collection  Folder = Path.GetDirectoryName(CSV_Location) Filename = Path.GetFileName(CSV_Location) &#x27;
Dim cn As New OleDbConnection(&quot;Provider=Microsoft.Jet.OLEDB.4.0; Data Source=&quot; &amp; Folder &amp; &quot;;Extended Properties=&quot;&quot;Text;HDR=&quot; &amp; HDRString &amp; &quot;;FMT=Delimited&quot;&quot;&quot;)
Dim cn As New OleDbConnection(&quot;Provider=Microsoft.ACE.OLEDB.12.0; Data Source=&quot; &amp; Folder &amp; &quot;;Extended Properties=&quot;&quot;Text;HDR=&quot; &amp; HDRString &amp; &quot;;FMT=Delimited&quot;&quot;&quot;)
Dim da As New OleDbDataAdapter()
Dim ds As New DataSet()
Dim cd As New OleDbCommand(&quot;SELECT * FROM [&quot; &amp; Filename &amp; &quot;]&quot;, cn) cn.Open() da.SelectCommand = cd ds.Clear() da.Fill(ds, &quot;CSV&quot;) HijiryColl = ds.Tables(0) cn.Close()  &#x27;Remove empty rows and the dates which are grater than current date
For i as integer =HijiryColl.Rows.Count-1 to 0 step -1
    if HijiryColl.Rows(i)(&quot;Date&quot;)Is Nothing then
    else           Tempdate=HijiryColl.Rows(i)(&quot;Date&quot;)         if(HijiryColl.Rows(i)(&quot;Date&quot;)&lt; Now())then             HijiryColl.Rows(i)(&quot;Date&quot;)= Tempdate
    else             HijiryColl.Rows.Remove(HijiryColl.Rows(i))
        end
        if
        End
        if
    Next  &#x27; read last four salary dates put into SD1,SD2,SD3 and SD4. add last 3 salary dates to output collection
    If HijiryColl.Rows.Count &gt;4 Then
        HijiryColl.DefaultView.Sort =  &quot;Date DESC&quot;     HijiryColl = HijiryColl.DefaultView.ToTable     SD1=HijiryColl.Rows(0)(&quot;Date&quot;)     SD2=HijiryColl.Rows(1)(&quot;Date&quot;)     SD3=HijiryColl.Rows(2)(&quot;Date&quot;)     SD4=HijiryColl.Rows(3)(&quot;Date&quot;)
    End If
    Dim dr1 as DataRow=HijiryCollOut.NewRow()     dr1(&quot;Date&quot;)=SD1     HijiryCollOut.Rows.Add(dr1)
    Dim dr2 as DataRow=HijiryCollOut.NewRow()     dr2(&quot;Date&quot;)=SD2     HijiryCollOut.Rows.Add(dr2)
    Dim dr3 as DataRow=HijiryCollOut.NewRow()     dr3(&quot;Date&quot;)=SD3     HijiryCollOut.Rows.Add(SD3)     &#x27;
    For i as integer =HijiryColl.Rows.Count-1 to 3 Step -1     &#x27;HijiryColl.Rows.Remove(HijiryColl.Rows(i))     &#x27;
    Next
End If"
                            data-title="UWCA_MRCC_CTF_V1.0 / Get Salary Dates / Get Dates">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>UWCA_MRCC_CTF_V1.0</td>
                <td>Get six Salary Dates</td>
                <td>Get six Salary Dates</td>
                <td>visualbasic</td>
                <td>31</td>
                <!--<td style="font-family: monospace;">c4e330fef38ac58f558021a06652fefcb4d82a60d18719b385cf125fdb308463</td>-->
                <td>sql_keywords, reflection</td>
                <!--<td>Dim HDRString As String = &quot;No&quot; If First_Line_Is_Header Then     HDRSTring = &quot;Yes&quot; End If Dim Folder as String = nothing Dim FileName As String = Nothing Dim Tempdate as Date Dim HijiryColl as DataTable HijiryCollOut.Columns.Add(&quot;Date&quot;,Type.GetType(&quot;System.String&quot;))  &#x27;Read Dates from CSV file and put...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Dim HDRString As String = &quot;No&quot;
If First_Line_Is_Header Then
    HDRSTring = &quot;Yes&quot;
End If
Dim Folder as String = nothing
Dim FileName As String = Nothing
Dim Tempdate as Date
Dim HijiryColl as DataTable HijiryCollOut.Columns.Add(&quot;Date&quot;,Type.GetType(&quot;System.String&quot;))  &#x27;Read Dates from CSV file and put into Hijri collection  Folder = Path.GetDirectoryName(CSV_Location) Filename = Path.GetFileName(CSV_Location) &#x27;
Dim cn As New OleDbConnection(&quot;Provider=Microsoft.Jet.OLEDB.4.0; Data Source=&quot; &amp; Folder &amp; &quot;;Extended Properties=&quot;&quot;Text;HDR=&quot; &amp; HDRString &amp; &quot;;FMT=Delimited&quot;&quot;&quot;)
Dim cn As New OleDbConnection(&quot;Provider=Microsoft.ACE.OLEDB.12.0; Data Source=&quot; &amp; Folder &amp; &quot;;Extended Properties=&quot;&quot;Text;HDR=&quot; &amp; HDRString &amp; &quot;;FMT=Delimited&quot;&quot;&quot;)
Dim da As New OleDbDataAdapter()
Dim ds As New DataSet()
Dim cd As New OleDbCommand(&quot;SELECT * FROM [&quot; &amp; Filename &amp; &quot;]&quot;, cn) cn.Open() da.SelectCommand = cd ds.Clear() da.Fill(ds, &quot;CSV&quot;) HijiryColl = ds.Tables(0) cn.Close()  &#x27;Remove empty rows and the dates which are grater than current date
For i as integer =HijiryColl.Rows.Count-1 to 0 step -1
    if HijiryColl.Rows(i)(&quot;Date&quot;)Is Nothing then
    else           Tempdate=HijiryColl.Rows(i)(&quot;Date&quot;)         if(HijiryColl.Rows(i)(&quot;Date&quot;)&lt; Now())then             HijiryColl.Rows(i)(&quot;Date&quot;)= Tempdate
    else             HijiryColl.Rows.Remove(HijiryColl.Rows(i))
        end
        if
        End
        if
    Next  &#x27; read last four salary dates put into SD1,SD2,SD3 and SD4. add last 3 salary dates to output collection
    If HijiryColl.Rows.Count &gt;6 Then
        HijiryColl.DefaultView.Sort =  &quot;Date DESC&quot;     HijiryColl = HijiryColl.DefaultView.ToTable     SD1=HijiryColl.Rows(0)(&quot;Date&quot;)     SD2=HijiryColl.Rows(1)(&quot;Date&quot;)     SD3=HijiryColl.Rows(2)(&quot;Date&quot;)     SD4=HijiryColl.Rows(3)(&quot;Date&quot;)     SD5=HijiryColl.Rows(4)(&quot;Date&quot;)     SD6=HijiryColl.Rows(5)(&quot;Date&quot;)
    End If
    Dim dr1 as DataRow=HijiryCollOut.NewRow()     dr1(&quot;Date&quot;)=SD1     HijiryCollOut.Rows.Add(dr1)
    Dim dr2 as DataRow=HijiryCollOut.NewRow()     dr2(&quot;Date&quot;)=SD2     HijiryCollOut.Rows.Add(dr2)
    Dim dr3 as DataRow=HijiryCollOut.NewRow()     dr3(&quot;Date&quot;)=SD3     HijiryCollOut.Rows.Add(SD3)     &#x27;
    For i as integer =HijiryColl.Rows.Count-1 to 3 Step -1     &#x27;HijiryColl.Rows.Remove(HijiryColl.Rows(i))     &#x27;
    Next
End If"
                            data-title="UWCA_MRCC_CTF_V1.0 / Get six Salary Dates / Get six Salary Dates">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>UWCA_MRCC_CTF_V1.0</td>
                <td>GetOneMonthFull Salary</td>
                <td>Filter Collection1</td>
                <td>visualbasic</td>
                <td>6</td>
                <!--<td style="font-family: monospace;">c923c99415a4cd6045d25f97a6cbb1a13207cdf1baf5dc8c1df087012e26e633</td>-->
                <td>—</td>
                <!--<td>Dim NewRow As DataRow Dim Amount as Decimal =0 Collection_Out = Collection_In.Clone For Each parentRow As DataRow In Collection_In.Select(Select_Condition)     NewRow = Collection_Out.NewRow     For Each c As DataColumn In NewRow.Table.Columns         NewRow(c.ColumnName) = parentRow(c.ColumnName)  ...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Dim NewRow As DataRow
Dim Amount as Decimal =0 Collection_Out = Collection_In.Clone
For Each parentRow As DataRow In Collection_In.Select(Select_Condition)     NewRow = Collection_Out.NewRow
    For Each c As DataColumn In NewRow.Table.Columns         NewRow(c.ColumnName) = parentRow(c.ColumnName)
    Next     Collection_Out.Rows.Add(NewRow)
Next NewRow = Nothing Collection_In = Nothing"
                            data-title="UWCA_MRCC_CTF_V1.0 / GetOneMonthFull Salary / Filter Collection1">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>UWCA_MRCC_CTF_V1.0</td>
                <td>GetOneMonthFull Salary</td>
                <td>Filter Collection5</td>
                <td>visualbasic</td>
                <td>6</td>
                <!--<td style="font-family: monospace;">c923c99415a4cd6045d25f97a6cbb1a13207cdf1baf5dc8c1df087012e26e633</td>-->
                <td>—</td>
                <!--<td>Dim NewRow As DataRow Dim Amount as Decimal =0 Collection_Out = Collection_In.Clone For Each parentRow As DataRow In Collection_In.Select(Select_Condition)     NewRow = Collection_Out.NewRow     For Each c As DataColumn In NewRow.Table.Columns         NewRow(c.ColumnName) = parentRow(c.ColumnName)  ...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Dim NewRow As DataRow
Dim Amount as Decimal =0 Collection_Out = Collection_In.Clone
For Each parentRow As DataRow In Collection_In.Select(Select_Condition)     NewRow = Collection_Out.NewRow
    For Each c As DataColumn In NewRow.Table.Columns         NewRow(c.ColumnName) = parentRow(c.ColumnName)
    Next     Collection_Out.Rows.Add(NewRow)
Next NewRow = Nothing Collection_In = Nothing"
                            data-title="UWCA_MRCC_CTF_V1.0 / GetOneMonthFull Salary / Filter Collection5">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>UWCA_MRCC_CTF_V1.0</td>
                <td>GetOneMonthFull Salary</td>
                <td>Filter Collection6</td>
                <td>visualbasic</td>
                <td>6</td>
                <!--<td style="font-family: monospace;">c923c99415a4cd6045d25f97a6cbb1a13207cdf1baf5dc8c1df087012e26e633</td>-->
                <td>—</td>
                <!--<td>Dim NewRow As DataRow Dim Amount as Decimal =0 Collection_Out = Collection_In.Clone For Each parentRow As DataRow In Collection_In.Select(Select_Condition)     NewRow = Collection_Out.NewRow     For Each c As DataColumn In NewRow.Table.Columns         NewRow(c.ColumnName) = parentRow(c.ColumnName)  ...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Dim NewRow As DataRow
Dim Amount as Decimal =0 Collection_Out = Collection_In.Clone
For Each parentRow As DataRow In Collection_In.Select(Select_Condition)     NewRow = Collection_Out.NewRow
    For Each c As DataColumn In NewRow.Table.Columns         NewRow(c.ColumnName) = parentRow(c.ColumnName)
    Next     Collection_Out.Rows.Add(NewRow)
Next NewRow = Nothing Collection_In = Nothing"
                            data-title="UWCA_MRCC_CTF_V1.0 / GetOneMonthFull Salary / Filter Collection6">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>UWCA_MRCC_CTF_V1.0</td>
                <td>GetOneMonthFull Salary</td>
                <td>Filter Collection7</td>
                <td>visualbasic</td>
                <td>6</td>
                <!--<td style="font-family: monospace;">c923c99415a4cd6045d25f97a6cbb1a13207cdf1baf5dc8c1df087012e26e633</td>-->
                <td>—</td>
                <!--<td>Dim NewRow As DataRow Dim Amount as Decimal =0 Collection_Out = Collection_In.Clone For Each parentRow As DataRow In Collection_In.Select(Select_Condition)     NewRow = Collection_Out.NewRow     For Each c As DataColumn In NewRow.Table.Columns         NewRow(c.ColumnName) = parentRow(c.ColumnName)  ...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Dim NewRow As DataRow
Dim Amount as Decimal =0 Collection_Out = Collection_In.Clone
For Each parentRow As DataRow In Collection_In.Select(Select_Condition)     NewRow = Collection_Out.NewRow
    For Each c As DataColumn In NewRow.Table.Columns         NewRow(c.ColumnName) = parentRow(c.ColumnName)
    Next     Collection_Out.Rows.Add(NewRow)
Next NewRow = Nothing Collection_In = Nothing"
                            data-title="UWCA_MRCC_CTF_V1.0 / GetOneMonthFull Salary / Filter Collection7">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>UWCA_MRCC_CTF_V1.0</td>
                <td>New Salary Logic</td>
                <td>Description check1</td>
                <td>visualbasic</td>
                <td>44</td>
                <!--<td style="font-family: monospace;">505c18455afbdcc4175f340a000f39bf489f06216f90625741364c65be733b9a</td>-->
                <td>—</td>
                <!--<td>try     Dim description as string     Dim TempDataRow As DataRow = DescriptionCollection.NewRow     Dim Dflag as integer =0     Dim precount as integer =0     Dim count as integer =0     Dim CollOut as DataTable =InputCollection.Clone     Dim Buffer as DataTable=InputCollection.Clone     Dim out1,ou...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="try
    Dim description as string
    Dim TempDataRow As DataRow = DescriptionCollection.NewRow
    Dim Dflag as integer =0
    Dim precount as integer =0
    Dim count as integer =0
    Dim CollOut as DataTable =InputCollection.Clone
    Dim Buffer as DataTable=InputCollection.Clone
    Dim out1,out2 as String  &#x27;Add Description and Count of Description in to DescriptionCollection
    For r As Integer = 0 To InputCollection.Rows.Count-1     description=InputCollection.Rows(r)(&quot;Description&quot;)     Dflag=0
        for i as integer=0 To DescriptionCollection.Rows.Count-1
            If DescriptionCollection.Rows(i)(&quot;Description&quot;)=description Then
                Dflag=1             DescriptionCollection.Rows(i)(&quot;Count&quot;)=DescriptionCollection.Rows(i)(&quot;Count&quot;)+1
            End If
            end
            if
        next
        If Dflag=0 Then
            TempDataRow(&quot;Description&quot;) = description         TempDataRow(&quot;Count&quot;)=1         DescriptionCollection.Rows.Add(TempDataRow)         TempDataRow= DescriptionCollection.NewRow         out1 = &quot;O1&quot;
        End If
        end
        if
    Next  DescriptionCollection.DefaultView.Sort =  &quot;Count DESC&quot; DescriptionCollection=DescriptionCollection.DefaultView.ToTable    &#x27;Get Max Repeated DescriptionCollection
    For r As Integer = 0 To DescriptionCollection.Rows.Count-1     description=DescriptionCollection.Rows(r)(&quot;Description&quot;)     CollOut=Nothing     CollOut=InputCollection.Clone
        For Each parentRow As DataRow In InputCollection.Select(&quot;Description=&#x27;&quot;+description+&quot;&#x27;&quot;)         TempDataRow = CollOut.NewRow
            For Each c As DataColumn In TempDataRow.Table.Columns             TempDataRow(c.ColumnName) = parentRow(c.ColumnName)
            Next         CollOut.Rows.Add(TempDataRow)
        Next     count=CollOut.Rows.Count
        If count&gt;precount Then
            Buffer=Nothing         Buffer = CollOut.Clone         Buffer=CollOut         precount=count         ReassignFlag=0         out2 = &quot;O2&quot;
        End If
    else
        if count = Precount             ReassignFlag=1             Status=&quot;Salary cannot be identified since there mode are equal&quot;
            end
            if
        next
        If precount&lt;=2 Then
            ReassignFlag=1     Status=&quot;Salary cannot be identified since there mode is &lt; 3&quot;
        End If
        end
        if FilteredDescCollection=Buffer D0=DescriptionCollection
        catch e as Exception         ReassignFlag=1         Status=&quot;Code Error:&quot;+e.ToString
            end
            try"
                            data-title="UWCA_MRCC_CTF_V1.0 / New Salary Logic / Description check1">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>UWCA_MRCC_CTF_V1.0</td>
                <td>New Salary Logic</td>
                <td>Filter Salay with +5 and -5 Days1</td>
                <td>visualbasic</td>
                <td>41</td>
                <!--<td style="font-family: monospace;">749d00c0bc02ea23c0044597bec933f59ae16266faad401782621f6dbdf48e4f</td>-->
                <td>—</td>
                <!--<td>try     Dim TempCollection as DataTable=FilteredDescCollection.Clone     Dim TempRow As DataRow = FilteredDescCollection.NewRow &#x27;Temp collections to store each month transacation in single collection &#x27;SD stands     for Salary Date         Dim TempCollectionSD1 as DataTable=FilteredDescCollection.Clo...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="try
    Dim TempCollection as DataTable=FilteredDescCollection.Clone
    Dim TempRow As DataRow = FilteredDescCollection.NewRow &#x27;Temp collections to store each month transacation in single collection &#x27;SD stands
    for Salary Date
        Dim TempCollectionSD1 as DataTable=FilteredDescCollection.Clone
        Dim TempCollectionSD2 as DataTable=FilteredDescCollection.Clone
        Dim TempCollectionSD3 as DataTable=FilteredDescCollection.Clone &#x27;
        Dim TempCollectionSD4 as DataTable=FilteredDescCollection.Clone
        Dim TempOutCollection as DataTable=FilteredDescCollection.Clone   &#x27;Adding +5 &amp; -5 days
        Dim SD1p as Date=SD1.AddDays(5)
        Dim SD1m as Date=SD1.AddDays(-5)
        Dim SD2p as Date=SD2.AddDays(5)
        Dim SD2m as Date=SD2.AddDays(-5)
        Dim SD3p as Date=SD3.AddDays(5)
        Dim SD3m as Date=SD3.AddDays(-5)     &#x27;
        Dim SD4p as Date=SD4.AddDays(5)     &#x27;
        Dim SD4m as Date=SD4.AddDays(-5)  &#x27;Fiter the collection based on above criteria (+5 &amp; -5) to get each month one collection
        For r As Integer = 0 To FilteredDescCollection.Rows.Count-1             if(SD1m&lt;=FilteredDescCollection.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=FilteredDescCollection.Rows(r)(&quot;Account date&quot;) AND FilteredDescCollection.Rows(r)(&quot;Sal&quot;)&gt;0 ) then                 TempRow= FilteredDescCollection.Rows(r)                 TempCollectionSD1.ImportRow(TempRow)                 TempRow=TempCollectionSD1.NewRow
        end if                            if(SD2m&lt;=FilteredDescCollection.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=FilteredDescCollection.Rows(r)(&quot;Account date&quot;)AND FilteredDescCollection.Rows(r)(&quot;Sal&quot;)&gt;0 ) then                     TempRow= FilteredDescCollection.Rows(r)                     TempCollectionSD2.ImportRow(TempRow)                     TempRow=TempCollectionSD2.NewRow
    end if                      if(SD3m&lt;=FilteredDescCollection.Rows(r)(&quot;Account date&quot;) AND SD3p&gt;=FilteredDescCollection.Rows(r)(&quot;Account date&quot;)AND FilteredDescCollection.Rows(r)(&quot;Sal&quot;)&gt;0 ) then                     TempRow= FilteredDescCollection.Rows(r)                     TempCollectionSD3.ImportRow(TempRow)                     TempRow=TempCollectionSD3.NewRow
end if                  &#x27;if(SD4m&lt;=FilteredDescCollection.Rows(r)(&quot;Account date&quot;) AND SD4p&gt;=FilteredDescCollection.Rows(r)(&quot;Account date&quot;) AND FilteredDescCollection.Rows(r)(&quot;Sal&quot;)&gt;0 ) then             &#x27;        TempRow= FilteredDescCollection.Rows(r)             &#x27;        TempCollectionSD4.ImportRow(TempRow)             &#x27;        TempRow=TempCollectionSD4.NewRow                          &#x27;
end if
next &#x27;sort all the collection in desc order      TempCollectionSD1.DefaultView.Sort =  &quot;Sal DESC&quot;     TempCollectionSD2.DefaultView.Sort =  &quot;Sal DESC&quot;     TempCollectionSD3.DefaultView.Sort =  &quot;Sal DESC&quot;     &#x27;TempCollectionSD4.DefaultView.Sort =  &quot;Sal DESC&quot;  &#x27;converting collection into DataTable      TempCollectionSD1=TempCollectionSD1.DefaultView.ToTable     TempCollectionSD2=TempCollectionSD2.DefaultView.ToTable     TempCollectionSD3=TempCollectionSD3.DefaultView.ToTable     &#x27;TempCollectionSD4=TempCollectionSD4.DefaultView.ToTable  &#x27;add only max salary to Output collection from each month collection         if(TempCollectionSD1.Rows.Count&gt;0)then             TempOutCollection.ImportRow(TempCollectionSD1.Rows(0))
else             ReassignFlag=1             Status=&quot;Current month salary not found&quot;
    return
    end
    if                  if(TempCollectionSD2.Rows.Count&gt;0)then             TempOutCollection.ImportRow(TempCollectionSD2.Rows(0))
    else             ReassignFlag=1             Status=&quot; Current month -1 salary not found&quot;
        return
        end
        if                      if(TempCollectionSD3.Rows.Count&gt;0)then             TempOutCollection.ImportRow(TempCollectionSD3.Rows(0))
        else             ReassignFlag=1             Status=&quot; Current month -2 salary not found&quot;
            return
            end
            if                      &#x27;if(TempCollectionSD4.Rows.Count&gt;0)then         &#x27;    TempOutCollection.ImportRow(TempCollectionSD4.Rows(0))         &#x27;
            else         &#x27;    ReassignFlag=1         &#x27;    Status=&quot; 4th month salary not found&quot;         &#x27;
                end
                if  &#x27;TempOutCollection.DefaultView.Sort =  &quot;Account date ASC&quot; TempOutCollection=TempOutCollection.DefaultView.ToTable FilterDateCollection=TempOutCollection
                catch e as Exception         ReassignFlag=1         Status=&quot;Code Error:&quot;+e.ToString
                    end
                    try"
                            data-title="UWCA_MRCC_CTF_V1.0 / New Salary Logic / Filter Salay with +5 and -5 Days1">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>UWCA_MRCC_CTF_V1.0</td>
                <td>New Salary Logic</td>
                <td>Filter Salay with +5 and -5 Days2</td>
                <td>visualbasic</td>
                <td>43</td>
                <!--<td style="font-family: monospace;">6f7d183a8e2c904c2a1b07258c1ca2672538371a42209c4fb0005efaee1f9825</td>-->
                <td>—</td>
                <!--<td>try     Dim TempCollection as DataTable=FilteredDescCollection.Clone     Dim TempRow As DataRow = FilteredDescCollection.NewRow &#x27;Temp collections to store each month transacation in single collection &#x27;SD stands     for Salary Date         Dim TempCollectionSD1 as DataTable=FilteredDescCollection.Clo...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="try
    Dim TempCollection as DataTable=FilteredDescCollection.Clone
    Dim TempRow As DataRow = FilteredDescCollection.NewRow &#x27;Temp collections to store each month transacation in single collection &#x27;SD stands
    for Salary Date
        Dim TempCollectionSD1 as DataTable=FilteredDescCollection.Clone
        Dim TempCollectionSD2 as DataTable=FilteredDescCollection.Clone
        Dim TempCollectionSD3 as DataTable=FilteredDescCollection.Clone &#x27;
        Dim TempCollectionSD4 as DataTable=FilteredDescCollection.Clone
        Dim TempOutCollection as DataTable=FilteredDescCollection.Clone   &#x27;Filtering Transaction colletion with Tran Code column.
        If found Then
            add to corresponding collection.
        End If
        For r As Integer = 0 To FilteredDescCollection.Rows.Count-1                                       if(FilteredDescCollection.Rows(r)(&quot;Tran code&quot;)=&quot;312&quot;) then                     if(SD1=FilteredDescCollection.Rows(r)(&quot;Account date&quot;)) then                         TempRow= FilteredDescCollection.Rows(r)                         TempCollectionSD1.ImportRow(TempRow)                         TempRow=TempCollectionSD1.NewRow
        end if                                      if(SD2=FilteredDescCollection.Rows(r)(&quot;Account date&quot;)) then                             TempRow= FilteredDescCollection.Rows(r)                             TempCollectionSD2.ImportRow(TempRow)                             TempRow=TempCollectionSD2.NewRow
    end if                                      if(SD3=FilteredDescCollection.Rows(r)(&quot;Account date&quot;))then                             TempRow= FilteredDescCollection.Rows(r)                             TempCollectionSD3.ImportRow(TempRow)                             TempRow=TempCollectionSD3.NewRow
    end
    if                                          &#x27;if(SD4=FilteredDescCollection.Rows(r)(&quot;Account date&quot;))then                     &#x27;        TempRow= FilteredDescCollection.Rows(r)                     &#x27;        TempCollectionSD4.ImportRow(TempRow)                     &#x27;        TempRow=TempCollectionSD4.NewRow                                      &#x27;
        end
        if
    else                                          ReassignFlag=1                     Status=&quot;Salary not identified after filter with code&quot;
        return
        end
        if
    next &#x27;sort all the collection in desc order      TempCollectionSD1.DefaultView.Sort =  &quot;Sal DESC&quot;     TempCollectionSD2.DefaultView.Sort =  &quot;Sal DESC&quot;     TempCollectionSD3.DefaultView.Sort =  &quot;Sal DESC&quot;     &#x27;TempCollectionSD4.DefaultView.Sort =  &quot;Sal DESC&quot;  &#x27;converting collection into DataTable      TempCollectionSD1=TempCollectionSD1.DefaultView.ToTable     TempCollectionSD2=TempCollectionSD2.DefaultView.ToTable     TempCollectionSD3=TempCollectionSD3.DefaultView.ToTable     &#x27;TempCollectionSD4=TempCollectionSD4.DefaultView.ToTable  &#x27;add only max salary to Output collection from each month collection         if(TempCollectionSD1.Rows.Count&gt;0)then             TempOutCollection.ImportRow(TempCollectionSD1.Rows(0))
else             ReassignFlag=1             Status=&quot;Current month salary not found&quot;
    return
    end
    if                  if(TempCollectionSD2.Rows.Count&gt;0)then             TempOutCollection.ImportRow(TempCollectionSD2.Rows(0))
    else             ReassignFlag=1             Status=&quot; Current month -1 salary not found&quot;
        return
        end
        if                      if(TempCollectionSD3.Rows.Count&gt;0)then             TempOutCollection.ImportRow(TempCollectionSD3.Rows(0))
        else             ReassignFlag=1             Status=&quot; Current month -2 salary not found&quot;
            return
            end
            if                  &#x27;if(TempCollectionSD4.Rows.Count&gt;0)then         &#x27;    TempOutCollection.ImportRow(TempCollectionSD4.Rows(0))         &#x27;
            else         &#x27;    ReassignFlag=1         &#x27;    Status=&quot; Current month -3 salary not found&quot;         &#x27;
                return         &#x27;
                end
                if           &#x27;TempOutCollection.DefaultView.Sort =  &quot;Account date DESC&quot; TempOutCollection=TempOutCollection.DefaultView.ToTable FilterCodeCollection=TempOutCollection
                catch e as Exception         ReassignFlag=1         Status=&quot;Code Error:&quot;+e.ToString
                    end
                    try"
                            data-title="UWCA_MRCC_CTF_V1.0 / New Salary Logic / Filter Salay with +5 and -5 Days2">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>UWCA_MRCC_CTF_V1.0</td>
                <td>New Salary Logic</td>
                <td>Salary Logic based on AVG1</td>
                <td>visualbasic</td>
                <td>45</td>
                <!--<td style="font-family: monospace;">d31e2014428dbdffea8631998d34bde183b26e20389c99928776572f8c2db1e6</td>-->
                <td>—</td>
                <!--<td>try     Dim Amount as Decimal =0     Dim Avg as Decimal=0     Dim Sum as Decimal =0     Dim skip as integer =0     Dim min as Decimal =0     Dim max as Decimal =0     Dim minSal as Decimal =0     Dim minimumSalarySAR as string =Nothing  &#x27;To assign each month salary into one variable     Dim FirstMon...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="try
    Dim Amount as Decimal =0
    Dim Avg as Decimal=0
    Dim Sum as Decimal =0
    Dim skip as integer =0
    Dim min as Decimal =0
    Dim max as Decimal =0
    Dim minSal as Decimal =0
    Dim minimumSalarySAR as string =Nothing  &#x27;To assign each month salary into one variable
    Dim FirstMonthSalary as Decimal=0
    Dim SecondMonthSalary as Decimal=0 &#x27;
    Dim ThirdMonthSalary as Decimal=0
    Dim CurrentMonthSalary as Decimal=0
    Dim ActualSalary as Decimal=0   &#x27;Read salaries from input collection FilterDateCollection CurrentMonthSalary=FilterDateCollection.Rows(0)(&quot;Sal&quot;) FirstMonthSalary=FilterDateCollection.Rows(1)(&quot;Sal&quot;) SecondMonthSalary=FilterDateCollection.Rows(2)(&quot;Sal&quot;) &#x27;ThirdMonthSalary=FilterDateCollection.Rows(3)(&quot;Sal&quot;)   &#x27;Rule2 take avarage of last 3 months salaries and check avg with min(s1,s2,s3)+20%Min(s1,s2,s3)
    If condition is true Then
        take avg as Salary.     max=FilterDateCollection.Rows(0)(&quot;Sal&quot;)     minSal=FilterDateCollection.Rows(0)(&quot;Sal&quot;)
    End If
    For k As Integer = 0 To 2         Sum=Sum+FilterDateCollection.Rows(k)(&quot;Sal&quot;)         if(max&lt;FilterDateCollection.Rows(k)(&quot;Sal&quot;))then                 max=FilterDateCollection.Rows(k)(&quot;Sal&quot;)
        end
        if         if(minSal&gt;FilterDateCollection.Rows(k)(&quot;Sal&quot;))then                 minSal=FilterDateCollection.Rows(k)(&quot;Sal&quot;)
            end
            if
        next           Avg=Sum/3     CurrentMonthSalary=minSal  &#x27;Rule1
        If the employeer is Governamet-employee deduct 1000 SAR from his/her salary     &#x27;if(GovFlag)     &#x27;    ActualSalary=CurrentMonthSalary-1000     &#x27;
        else     &#x27;    ActualSalary=CurrentMonthSalary     &#x27;
            end
            if     &#x27;MsgBox(CurrentMonthSalary) &#x27;Rule2
                If Jan Salary less than or equal to (Avg or Avg+10%(Avg)) Then
                    Jan Salary as Salary
                End If
            else Avg as Salary.
                If Math.Round(((Avg-CurrentMonthSalary)/Avg),3)&lt;= 0.2 Then
                    &#x27;AND Math.Round(((Avg-CurrentMonthSalary)/Avg),3)&gt;= -0.1)then     Avg=Sum/3
                End If
            else     Avg=(Sum-max)/2
                End
                If          min=FilterDateorCodeCollection.Rows(0)(&quot;Sal&quot;)
                    For k As Integer = 0 To 2
                        if min &gt;= FilterDateorCodeCollection.Rows(K)(&quot;Sal&quot;)then             min=FilterDateorCodeCollection.Rows(K)(&quot;Sal&quot;)             minimumSalarySAR=FilterDateorCodeCollection.Rows(k)(&quot;Amount&quot;)
                            end
                            if
                        next       Salary=minimumSalarySAR     Other=Replace(Math.Round((Avg-min),2),&quot;.&quot;,&quot;,&quot;)  OutputCollection=FilterDateCollection
                    catch e as Exception         ReassignFlag=1         Status=&quot;Code Error:&quot;+e.ToString
                        end
                        try"
                            data-title="UWCA_MRCC_CTF_V1.0 / New Salary Logic / Salary Logic based on AVG1">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>UWCA_MRCC_CTF_V1.0</td>
                <td>New Salary Logic</td>
                <td>Salary code requirements1</td>
                <td>visualbasic</td>
                <td>71</td>
                <!--<td style="font-family: monospace;">117c6ffa7ec70f8097b6591c7d92435e40b4bbe9e91d0c89cb7f44bd9da787a1</td>-->
                <td>reflection</td>
                <!--<td>&#x27;Page1 try     If Not c1.Columns.Contains(&quot;Sal&quot;) Then         c1.Columns.Add(&quot;Sal&quot;, Type.GetType(&quot;System.Decimal&quot;))     End If     End     If     For r As Integer = 0 To c1.Rows.Count - 1         c1.Rows(r)(&quot;Sal&quot;) = Replace(Replace(c1.Rows(r)(&quot;Amount&quot;), &quot;.&quot;, &quot;&quot;), &quot;,&quot;, &quot;.&quot;)         c1.Rows(r)(&quot;Sal&quot;)=...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="&#x27;Page1
try
    If Not c1.Columns.Contains(&quot;Sal&quot;) Then
        c1.Columns.Add(&quot;Sal&quot;, Type.GetType(&quot;System.Decimal&quot;))
    End If
    End
    If
    For r As Integer = 0 To c1.Rows.Count - 1         c1.Rows(r)(&quot;Sal&quot;) = Replace(Replace(c1.Rows(r)(&quot;Amount&quot;), &quot;.&quot;, &quot;&quot;), &quot;,&quot;, &quot;.&quot;)         c1.Rows(r)(&quot;Sal&quot;)=Convert.ToDecimal(c1.Rows(r)(&quot;Sal&quot;))
    Next  &#x27;Filtering &lt;1900
    If Not GovFlag then
        Dim NewRow As DataRow  C0 = C1.Clone
        For Each parentRow As DataRow In C1.Select(Select_Condition)         NewRow = C0.NewRow
            For Each c As DataColumn In NewRow.Table.Columns             NewRow(c.ColumnName) = parentRow(c.ColumnName)
            Next         C0.Rows.Add(NewRow)
        Next   NewRow = Nothing C1 = Nothing  &#x27;Page2 C1=C0
        End
        If
        Dim x as integer = 0
        Dim dd,mm,yy as string
        Dim count as integer =0
        dim test,dec
        dim flag as integer=1
        dim days as integer =0 dec=&quot;&quot; dd=&quot;&quot; mm=&quot;&quot; yy=&quot;&quot; &#x27;
        If Not c1.Columns.Contains(&quot;ADate&quot;) Then
            &#x27;    c1.Columns.Add(&quot;ADate&quot;, Type.GetType(&quot;System.String&quot;)) &#x27;
        End If
        End
        if
        If Not c1.Columns.Contains(&quot;Days&quot;) Then
            c1.Columns.Add(&quot;Days&quot;, Type.GetType(&quot;System.DateTime&quot;))
        End If
        End
        if
        For i As Integer = 0 To c1.Rows.Count - 1     c1.Rows(i)(&quot;Description&quot;)=Replace(c1.Rows(i)(&quot;Description&quot;),&quot; &quot;,&quot;&quot;)
            if Left(c1.Rows(i)(&quot;Description&quot;),7) =  &quot;PAYROL/&quot; OR Left(c1.Rows(i)(&quot;Description&quot;),7) =  &quot;SALARY/&quot;         c1.Rows(i)(&quot;Description&quot;) = Replace(Replace(c1.Rows(i)(&quot;Description&quot;),&quot;PAYROL/&quot;,&quot;&quot;),&quot;SALARY/&quot;,&quot;&quot;)
                end
                if     test=c1.Rows(i)(&quot;Description&quot;)
                    do         x = InStr(test, &quot;/&quot;)     if(x&gt;0)             test=Replace(test, Left(test, x),&quot;&quot;)
                        if flag=1         dec=test         flag = 0
                            end
                            if             count = count+1
                            end if
                        loop
                        while x&lt;&gt;0
                            if count&gt;2         c1.Rows(i)(&quot;Description&quot;)= Trim(dec)
                            else &#x27;        dec=&quot;arb: &quot;+c1.Rows(r)(&quot;Description&quot;)
                                Dim R as New Regex(&quot;[A-Z,0-9,/]*(?&lt;Result&gt;[أ-ي,0-9]*)&quot;, RegexOptions.SingleLine)
                                Dim M as Match = R.Match(c1.Rows(i)(&quot;Description&quot;))
                                If M IsNot Nothing AndAlso M.Success Then
                                    dec = M.Groups(&quot;Result&quot;).Value
                                End If
                                End
                                If         c1.Rows(i)(&quot;Description&quot;)= Trim(dec)
                                    end
                                    if     flag=1     count=0     x=0     yy=c1.Rows(i)(&quot;Account date&quot;)
                                        for j as integer =0 to 2         x=Instr(yy,&quot;/&quot;)
                                            If j=0 Then
                                                dd=Left(yy,x-1)             yy=Right(yy,len(yy)-x)
                                            End If
                                        else
                                            if j=1             mm=Left(yy,x-1)             yy=Right(yy,len(yy)-x)
                                                end
                                                if
                                            next
                                            if mm&lt;&gt;&quot;&quot;&#x27;Date.Parse         c1.Rows(i)(&quot;Account date&quot;)=(mm+&quot;/&quot;+dd+&quot;/&quot;+yy)
                                                end
                                                if     &#x27;days=DateDiff(DateInterval.Day,Date.Parse(c1.Rows(i)(&quot;Account date&quot;)),Today())     &#x27;    c1.Rows(i)(&quot;Days&quot;)=days     c1.Rows(i)(&quot;Days&quot;)=DateTime.Parse(c1.Rows(i)(&quot;Account date&quot;))     &#x27;MsgBox(mm+&quot;/&quot;+dd+&quot;/&quot;+yy) dec=&quot;&quot; dd=&quot;&quot; mm=&quot;&quot;  yy=&quot;&quot;
                                                Next  c1.DefaultView.Sort = &quot;Days DESC&quot;  c0 = c1.DefaultView.ToTable
                                            catch e as Exception     &#x27;MsgBox(&quot;error&quot;)         ReassignFlag=1         Status=&quot;Code Error:&quot;+e.ToString
                                                end
                                                try"
                            data-title="UWCA_MRCC_CTF_V1.0 / New Salary Logic / Salary code requirements1">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>UWCA_MRCC_CTF_V1.0</td>
                <td>New Salary Logic</td>
                <td>Salary code requirements3</td>
                <td>visualbasic</td>
                <td>71</td>
                <!--<td style="font-family: monospace;">6372db1f3d49c20eec036798fe93aef37dd9eeecdc97fc46ed904173b18bff1e</td>-->
                <td>reflection</td>
                <!--<td>&#x27;Page1 try     If Not c1.Columns.Contains(&quot;Sal&quot;) Then         c1.Columns.Add(&quot;Sal&quot;, Type.GetType(&quot;System.Decimal&quot;))     End If     End     If     For r As Integer = 0 To c1.Rows.Count - 1         c1.Rows(r)(&quot;Sal&quot;) = Replace(Replace(c1.Rows(r)(&quot;Amount&quot;), &quot;.&quot;, &quot;&quot;), &quot;,&quot;, &quot;.&quot;)         c1.Rows(r)(&quot;Sal&quot;)=...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="&#x27;Page1
try
    If Not c1.Columns.Contains(&quot;Sal&quot;) Then
        c1.Columns.Add(&quot;Sal&quot;, Type.GetType(&quot;System.Decimal&quot;))
    End If
    End
    If
    For r As Integer = 0 To c1.Rows.Count - 1         c1.Rows(r)(&quot;Sal&quot;) = Replace(Replace(c1.Rows(r)(&quot;Amount&quot;), &quot;.&quot;, &quot;&quot;), &quot;,&quot;, &quot;.&quot;)         c1.Rows(r)(&quot;Sal&quot;)=Convert.ToDecimal(c1.Rows(r)(&quot;Sal&quot;))
    Next  &#x27;Filtering &lt;1900
    If Not GovFlag then
        Dim NewRow As DataRow  C0 = C1.Clone
        For Each parentRow As DataRow In C1.Select(Select_Condition)         NewRow = C0.NewRow
            For Each c As DataColumn In NewRow.Table.Columns             NewRow(c.ColumnName) = parentRow(c.ColumnName)
            Next         C0.Rows.Add(NewRow)
        Next   NewRow = Nothing C1 = Nothing  &#x27;Page2 C1=C0
        End
        If
        Dim x as integer = 0
        Dim dd,mm,yy as string
        Dim count as integer =0
        dim dec
        dim flag as integer=1
        dim days as integer =0 dec=&quot;&quot; dd=&quot;&quot; mm=&quot;&quot; yy=&quot;&quot; &#x27;
        If Not c1.Columns.Contains(&quot;ADate&quot;) Then
            &#x27;    c1.Columns.Add(&quot;ADate&quot;, Type.GetType(&quot;System.String&quot;)) &#x27;
        End If
        End
        if
        If Not c1.Columns.Contains(&quot;Days&quot;) Then
            c1.Columns.Add(&quot;Days&quot;, Type.GetType(&quot;System.DateTime&quot;))
        End If
        End
        if
        For i As Integer = 0 To c1.Rows.Count - 1     &#x27;c1.Rows(i)(&quot;Description&quot;)=Replace(c1.Rows(i)(&quot;Description&quot;),&quot; &quot;,&quot;&quot;)     &#x27;
            if Left(c1.Rows(i)(&quot;Description&quot;),7) =  &quot;PAYR/&quot; OR Left(c1.Rows(i)(&quot;Description&quot;),7) =  &quot;SAL/&quot;         &#x27;c1.Rows(i)(&quot;Description&quot;) = Replace(Replace(c1.Rows(i)(&quot;Description&quot;),&quot;PAYROL/&quot;,&quot;&quot;),&quot;SALARY/&quot;,&quot;&quot;)     &#x27;
                end
                if     &#x27;test=c1.Rows(i)(&quot;Description&quot;)     &#x27;
                    do         &#x27;x = InStr(test, &quot;/&quot;)     &#x27;if(x&gt;0)         &#x27;    test=Replace(test, Left(test, x),&quot;&quot;)     &#x27;
                        if flag=1         &#x27;dec=test         &#x27;flag = 0     &#x27;
                            end
                            if         &#x27;    count = count+1     &#x27;
                            end if         &#x27;
                        loop
                        while x&lt;&gt;0     &#x27;
                            if count&gt;2     &#x27;    c1.Rows(i)(&quot;Description&quot;)= Trim(dec)     &#x27;
                            else &#x27;        dec=&quot;arb: &quot;+c1.Rows(r)(&quot;Description&quot;) &#x27;         &#x27;
                                Dim R as New Regex(&quot;[A-Z,0-9,/]*(?&lt;Result&gt;[أ-ي,0-9]*)&quot;, RegexOptions.SingleLine)         &#x27;
                                Dim M as Match = R.Match(c1.Rows(i)(&quot;Description&quot;))         &#x27;
                                If M IsNot Nothing AndAlso M.Success Then
                                    &#x27;dec = M.Groups(&quot;Result&quot;).Value         &#x27;
                                End If
                                End
                                If         &#x27;c1.Rows(i)(&quot;Description&quot;)= Trim(dec)         &#x27;
                                    end
                                    if     &#x27;flag=1     &#x27;count=0     &#x27;x=0     yy=c1.Rows(i)(&quot;Account date&quot;)
                                        for j as integer =0 to 2         x=Instr(yy,&quot;/&quot;)
                                            If j=0 Then
                                                dd=Left(yy,x-1)             yy=Right(yy,len(yy)-x)
                                            End If
                                        else
                                            if j=1             mm=Left(yy,x-1)             yy=Right(yy,len(yy)-x)
                                                end
                                                if
                                            next
                                            if mm&lt;&gt;&quot;&quot;&#x27;Date.Parse         c1.Rows(i)(&quot;Account date&quot;)=(mm+&quot;/&quot;+dd+&quot;/&quot;+yy)
                                                end
                                                if     &#x27;days=DateDiff(DateInterval.Day,Date.Parse(c1.Rows(i)(&quot;Account date&quot;)),Today())     &#x27;    c1.Rows(i)(&quot;Days&quot;)=days     c1.Rows(i)(&quot;Days&quot;)=DateTime.Parse(c1.Rows(i)(&quot;Account date&quot;))     &#x27;MsgBox(mm+&quot;/&quot;+dd+&quot;/&quot;+yy) dec=&quot;&quot; dd=&quot;&quot; mm=&quot;&quot;  yy=&quot;&quot;
                                                Next  c1.DefaultView.Sort = &quot;Days DESC&quot;  c0 = c1.DefaultView.ToTable
                                            catch e as Exception     &#x27;MsgBox(&quot;error&quot;)         ReassignFlag=1         Status=&quot;Code Error:&quot;+e.ToString
                                                end
                                                try"
                            data-title="UWCA_MRCC_CTF_V1.0 / New Salary Logic / Salary code requirements3">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>UWCA_MRCC_CTF_V1.0</td>
                <td>R-Asci Number</td>
                <td>Read Asci Number1</td>
                <td>visualbasic</td>
                <td>12</td>
                <!--<td style="font-family: monospace;">388384cffb7d00936e0fa37d2802d37e86394c97b8edd392faa1aba03dc3479c</td>-->
                <td>—</td>
                <!--<td>Dim result Dim i Dim length  asciNumber = True length = Len(text) For i = 1 To length     result = Asc(Mid(text,i,1))     If result &lt; 48 Or result &gt; 117 Then         asciNumber = False     End If     Exit     For     End     If Next</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Dim result
Dim i
Dim length  asciNumber = True length = Len(text)
For i = 1 To length     result = Asc(Mid(text,i,1))
    If result &lt; 48 Or result &gt; 117 Then
        asciNumber = False
    End If
    Exit
    For
    End
    If
Next"
                            data-title="UWCA_MRCC_CTF_V1.0 / R-Asci Number / Read Asci Number1">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>UWCA_MRCC_CTF_V1.0</td>
                <td>Salary code</td>
                <td>Salary Calculation(new)1</td>
                <td>visualbasic</td>
                <td>402</td>
                <!--<td style="font-family: monospace;">44158352a9672044246cf3818de9f1e124a77dc5e746f36ca33573afe2728a44</td>-->
                <td>—</td>
                <!--<td>try     Dim description as string     Dim x As DataRow = D1.NewRow     Dim Dflag as integer =0     Dim precount as integer =0     Dim Amount as integer =0     Dim Avg as integer     Dim Sum as integer =0     Dim skip as integer =0     Dim min as integer =0     Dim count as integer =0 min=0 count=0  ...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="try
    Dim description as string
    Dim x As DataRow = D1.NewRow
    Dim Dflag as integer =0
    Dim precount as integer =0
    Dim Amount as integer =0
    Dim Avg as integer
    Dim Sum as integer =0
    Dim skip as integer =0
    Dim min as integer =0
    Dim count as integer =0 min=0 count=0
    if c1.Rows.Count&gt;2 then
        For r As Integer = 0 To c1.Rows.Count-1         description=c1.Rows(r)(&quot;Description&quot;)         Dflag=0
            for i as integer=0 To D1.Rows.Count-1
                If D1.Rows(i)(&quot;Description&quot;)=description Then
                    Dflag=1
                End If
                end
                if
            next
            If Dflag=0 Then
                x(&quot;Description&quot;) = description             D1.Rows.Add(x)             x= D1.NewRow
            End If
            end
            if
        Next
        For r As Integer = 0 To D1.Rows.Count-1         description=D1.Rows(r)(&quot;Description&quot;)         CollOut=Nothing         CollOut=c1.Clone
            For Each parentRow As DataRow In c1.Select(&quot;Description=&#x27;&quot;+description+&quot;&#x27;&quot;)             x = CollOut.NewRow
                For Each c As DataColumn In x.Table.Columns                     x(c.ColumnName) = parentRow(c.ColumnName)
                Next             CollOut.Rows.Add(x)
            Next         count=CollOut.Rows.Count
            If count&gt;precount Then
                Buffer=Nothing             Buffer = CollOut.Clone             Buffer=CollOut             precount=count             ReassignFlag=0
            End If
        else
            if count = Precount             ReassignFlag=1             Status=&quot;Salary cannot be identified since there mode are equal&quot;
                end
                if
            next
            If Buffer.Rows.Count &gt;2 Then
                ReassignFlag=0
            End If
            if ReassignFlag=0             ReassignFlag=1
                For r As Integer = 0 To Buffer.Rows.Count-1
                    If Buffer.Rows(r)(&quot;Days&quot;)&lt;=TimePeriod Then
                        ReassignFlag=0
                    End If
                    exit
                    for
                    end
                    if
                next
                end
                if
                if ReassignFlag=0             Status=&quot;&quot;
                    For r As Integer = 0 To Buffer.Rows.Count-1                 Amount=Buffer.Rows(r)(&quot;Sal&quot;)                 Dflag=0
                        for i as integer=0 To A1.Rows.Count-1
                            If A1.Rows(i)(&quot;Amount&quot;)=Amount Then
                                Dflag=1                         A1.Rows(i)(&quot;Count&quot;)=A1.Rows(i)(&quot;Count&quot;)+1
                            End If
                            end
                            if
                        next
                        If Dflag=0 Then
                            x= A1.NewRow                     x(&quot;Amount&quot;) = Amount                     x(&quot;Count&quot;)=1                     x(&quot;Salary&quot;)=Buffer.Rows(r)(&quot;Amount&quot;)                     A1.Rows.Add(x)
                        End If
                        end
                        if
                    Next             min=Buffer.Rows(0)(&quot;Sal&quot;)+1
                    For k As Integer = 0 To 2                 Sum=Sum+Buffer.Rows(k)(&quot;Sal&quot;)
                        If min&gt;Buffer.Rows(k)(&quot;Sal&quot;) Then
                            min=Buffer.Rows(k)(&quot;Sal&quot;)                     minimum=Buffer.Rows(k)(&quot;Amount&quot;)
                        End If
                        end
                        if
                    next             Avg= Sum / 3
                    If Avg&lt;1.2*min Then
                        test=1 Cop=A1                 Salary=minimum                 Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                    End If
                else
                    For r As Integer = 0 To A1.Rows.Count-1
                        If (A1.Rows(r)(&quot;Count&quot;)*100/(Buffer.Rows.Count))&gt;60 Then
                            Salary=A1.Rows(r)(&quot;Salary&quot;)                         skip=1
                        End If
                        end
                        if
                    next
                    If skip=0 Then
                        &#x27;vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvPage2vvvvvvvvvvvvvvvvvvvvvvvvvvv
                    End If
                    if Govt=True then
                        Dim SD1p,SD1m,SD2p,SD2m,SD3p,SD3m as date
                        Dim Sflag as integer =0
                        Dim BasicSalary as Integer =0
                        Dim T as DataTable =Buffer.Clone
                        Dim T2 as DataTable=Buffer.Clone
                        Dim TX as DataTable=Buffer.Clone
                        Dim Tcounter as integer =0
                        Dim T2counter as integer =0
                        Dim BSp,BSm as Decimal                          Sum=0                         minimum=0                         Salary=0                         Other=0                         min=0                         SD1p=SD1.AddDays(5)                         SD1m=SD1.AddDays(-5)                         SD2p=SD2.AddDays(5)                         SD2m=SD2.AddDays(-5)                         SD3p=SD3.AddDays(5)                         SD3m=SD3.AddDays(-5)                 &#x27;        T=Buffer.Clone
                        For r As Integer = 0 To Buffer.Rows.Count-1 &#x27;
                            If (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3) Then
                                if((SD1m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))OR (SD2m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD3m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD3p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))) then                                 x= Buffer.Rows(r)                                 TX.ImportRow(x)                                 x=TX.NewRow
                            End If
                        end if
                    next                         Buffer=TX
                    For r As Integer = 0 To Buffer.Rows.Count-1                 &#x27;
                        if (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1) then
                            If (SD1m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) Then
                                Sflag=Sflag+1                                 BasicSalary=Buffer.Rows(r)(&quot;Sal&quot;)                                 &#x27;AM=BasicSalary
                            End If
                            end
                            if
                        Next                         &#x27;AM=BasicSalary
                        If Sflag=1 Then
                            x=T.NewRow
                        End If
                        For r As Integer = 0 To Buffer.Rows.Count-1                 &#x27;
                            If (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3) Then
                                if((SD1m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))OR (SD2m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD3m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD3p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))) then                                     x= Buffer.Rows(r)                                     T.ImportRow(x)                                     x=T.NewRow                                     Tcounter=Tcounter+1
                            End If
                        end if
                    next
                    if Tcounter&lt;3                                 ReassignFlag=1                                 Status=&quot;Total number of feasible transaction is less than 3 after filtering with +/-5 salary date I&quot;
                    else                                 BSp=BasicSalary+(BasicSalary*20/100)                                 BSm=BasicSalary-(BasicSalary*20/100)                                 x=T2.NewRow
                        for r as integer=0 to T.Rows.count-1                                     if(T.Rows(r)(&quot;Sal&quot;)&gt;=BSm AND T.Rows(r)(&quot;Sal&quot;)&lt;=BSp)                                         x= T.Rows(r)                                         T2.ImportRow(x)                                         x=T2.NewRow                                         T2counter=T2counter+1
                            end
                            if
                        next
                        If T2counter&lt;3 Then
                            ReassignFlag=1                                     Status=&quot;Total number of feasible transaction is less than 3 after filtering BSm &lt;= Salary &lt;=BSp&quot;
                        End If
                    else
                        if T2counter=3                                     min=T2.Rows(0)(&quot;Sal&quot;)+1
                            For k As Integer = 0 To 2                                         Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                    min=T2.Rows(k)(&quot;Sal&quot;)                                             minimum=T2.Rows(k)(&quot;Amount&quot;)
                                End If
                                end
                                if
                            next                                     Avg= Sum / 3
                            If Avg&lt;1.2*min Then
                                test=2                                         Salary=minimum                                         Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                            End If
                        else                                         Salary=minimum                                         Other=0
                            end
                            if
                        end if
                        end
                        if                     &#x27;    test=T                     &#x27;    testT=Tcounter
                        else &#x27;=============================================================AA===================================================BEGIN
                            Dim T3 as DataTable=Buffer.Clone
                            Dim Tcounter2 as integer=0
                            for r as integer =0 to Buffer.Rows.Count-1                                 if(Buffer.Rows(r)(&quot;Sal&quot;)&gt;=LastApproved) then                                     x=T3.NewRow                                     x=Buffer.Rows(r)                                     T3.ImportRow(x)                                     Tcounter2=Tcounter2+1                                     BasicSalary=Buffer.Rows(r)(&quot;Sal&quot;)
                                end
                                if
                            next                                 Buffer=Nothing                             Buffer=T3 &#x27;===============================================================BB=============================================BEGIN                             if(Tcounter2=1)                                 x=T.NewRow
                            For r As Integer = 0 To Buffer.Rows.Count-1                 &#x27;
                                If (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3) Then
                                    if((SD1m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))OR (SD2m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD3m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD3p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))) then                                         x= Buffer.Rows(r)                                         T.ImportRow(x)                                         x=T.NewRow                                         Tcounter=Tcounter+1
                                End If
                            end if
                        next
                        if Tcounter&lt;3                                     ReassignFlag=1                                     Status=&quot;Total number of feasible transaction is less than 3 after filtering with +/-5 salary date in AA-BB-Gov I&quot;
                        else                                     BSp=BasicSalary+(BasicSalary*20/100)                                     BSm=BasicSalary-(BasicSalary*20/100)                                     x=T2.NewRow
                            for r as integer=0 to T.Rows.count-1                                         if(T.Rows(r)(&quot;Sal&quot;)&gt;=BSm AND T.Rows(r)(&quot;Sal&quot;)&lt;=BSp)                                             x= T.Rows(r)                                             T2.ImportRow(x)                                             x=T2.NewRow                                             T2counter=T2counter+1
                                end
                                if
                            next
                            If T2counter&lt;3 Then
                                ReassignFlag=1                                         Status=&quot;Total number of feasible transaction is less than 3 after filtering with +/-5 salary date in AA-BB-Gov II&quot;
                            End If
                        else
                            if T2counter=3                                         min=T2.Rows(0)(&quot;Sal&quot;)+1
                                For k As Integer = 0 To 2                                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                    If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                        min=T2.Rows(k)(&quot;Sal&quot;)                                                 minimum=T2.Rows(k)(&quot;Amount&quot;)
                                    End If
                                    end
                                    if
                                next                                         Avg= Sum / 3
                                If Avg&lt;1.2*min Then
                                    test=3                                             Salary=minimum                                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                End If
                            else                                             Salary=minimum                                             Other=0
                                end
                                if
                            end if
                            end
                            if &#x27;===============================================================BB=============================================END
                            else
                                Dim Count4 as integer=0
                                Dim Prev as integer =0
                                Dim Base as Decimal=0
                                for r as integer=0 to A1.Rows.Count-1
                                    For j as integer=0 to T3.Rows.Count-1
                                        if A1.Rows(r)(&quot;Amount&quot;)=T3.Rows(j)(&quot;Sal&quot;)                                             Count4=Count4+1
                                            end
                                            if
                                        next
                                        if prev&lt;Count4                                         BasicSalary=A1.Rows(r)(&quot;Amount&quot;)                                         prev=Count4
                                            end
                                            if                                     Count4=0
                                            next                                                 x=T.NewRow
                                            For r As Integer = 0 To Buffer.Rows.Count-1                 &#x27;
                                                If (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3) Then
                                                    if((SD1m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))OR (SD2m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD3m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD3p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))) then                                         x= Buffer.Rows(r)                                         T.ImportRow(x)                                         x=T.NewRow                                         Tcounter=Tcounter+1
                                                End If
                                            end if
                                        next
                                        if Tcounter&lt;3                                     ReassignFlag=1                                     Status=&quot;Total number of feasible transaction is less than 3 after filtering with +/-5 salary date in AA-BB-Gov III&quot;
                                        else                                     BSp=BasicSalary+(BasicSalary*20/100)                                     BSm=BasicSalary-(BasicSalary*20/100)                                     x=T2.NewRow
                                            for r as integer=0 to T.Rows.count-1                                         if(T.Rows(r)(&quot;Sal&quot;)&gt;=BSm AND T.Rows(r)(&quot;Sal&quot;)&lt;=BSp)                                             x= T.Rows(r)                                             T2.ImportRow(x)                                             x=T2.NewRow                                             T2counter=T2counter+1
                                                end
                                                if
                                            next
                                            If T2counter&lt;3 Then
                                                ReassignFlag=1                                         Status=&quot;Total number of feasible transaction is less than 3 after filtering BSm&lt;= SAL &lt;=BSp in AA-BB-Gov IV&quot;
                                            End If
                                        else
                                            if T2counter=3                                         min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                For k As Integer = 0 To 2                                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                    If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                        min=T2.Rows(k)(&quot;Sal&quot;)                                                 minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                    End If
                                                    end
                                                    if
                                                next                                         Avg= Sum / 3
                                                If Avg&lt;1.2*min Then
                                                    test=4                                             Salary=minimum                                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                End If
                                            else                                             Salary=minimum                                             Other=0
                                                end
                                                if
                                            end if
                                            end
                                            if
                                            end
                                            if  &#x27;=============================================================AA===================================================    END
                                                end
                                                if
                                            else &#x27;==========================================================================B===================================BEGIN
                                                Dim Sflag as integer =0
                                                Dim BasicSalary as Integer =0
                                                Dim T as DataTable =Buffer.Clone
                                                Dim T2 as DataTable=Buffer.Clone
                                                Dim Tcounter as integer =0
                                                Dim T2counter as integer =0
                                                Dim BSp,BSm as Decimal
                                                Dim BaseDays as Decimal =0
                                                Dim Dayz as decimal=0                         Sum=0                         minimum=0                         Salary=0                         Sflag=0                         Other=0                         min=0
                                                For r As Integer = 0 To Buffer.Rows.Count-1
                                                    If (Buffer.Rows(r)(&quot;Days&quot;)&lt;=30) Then
                                                        Sflag=Sflag+1                                 BasicSalary=Buffer.Rows(r)(&quot;Sal&quot;)                                 x=T.NewRow                                 x= Buffer.Rows(r)                                 T.ImportRow(x)                                 Tcounter=1                                 BaseDays=Buffer.Rows(r)(&quot;Days&quot;)
                                                    End If
                                                    end
                                                    if
                                                Next &#x27;=======================================================================================BB=================================================BEGIN
                                                If Sflag=1 Then
                                                    x=T.NewRow
                                                End If
                                                For r As Integer = 0 To Buffer.Rows.Count-1                                     Dayz=Buffer.Rows(r)(&quot;Days&quot;)                                 Dayz=Dayz-BaseDays
                                                    If ((Dayz&gt;=25 AND Dayz&lt;=35) OR (Dayz&gt;=55 AND Dayz&lt;=65) ) Then
                                                        x= Buffer.Rows(r)                                     T.ImportRow(x)                                     x=T.NewRow                                     Tcounter=Tcounter+1
                                                    End If
                                                end if
                                            next                             &#x27;testT=Tcounter /checked
                                            if Tcounter&lt;3                                 ReassignFlag=1                                 Status=&quot;Total number of feasible transaction is less than 3 after filtering with -30 salary date in non-Gov I&quot;
                                            else                                 BSp=BasicSalary+(BasicSalary*20/100)                                 BSm=BasicSalary-(BasicSalary*20/100)                                 x=T2.NewRow
                                                for r as integer=0 to T.Rows.count-1                                     if(T.Rows(r)(&quot;Sal&quot;)&gt;=BSm AND T.Rows(r)(&quot;Sal&quot;)&lt;=BSp)                                         x= T.Rows(r)                                         T2.ImportRow(x)                                         x=T2.NewRow                                         T2counter=T2counter+1
                                                    end
                                                    if
                                                next
                                                If T2counter&lt;3 Then
                                                    ReassignFlag=1                                     Status=&quot;Total number of feasible transaction is less than 3 after filtering BSm&lt;=SAL&lt;=BSp BB-non Gov II&quot;
                                                End If
                                            else
                                                if T2counter=3                                     min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                    For k As Integer = 0 To 2                                         Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                        If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                            min=T2.Rows(k)(&quot;Sal&quot;)                                             minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                        End If
                                                        end
                                                        if
                                                    next                                      Avg= Sum / 3
                                                    If Avg&lt;1.2*min Then
                                                        Salary=minimum                                         Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                    End If
                                                else                                          Salary=minimum                                         Other=0
                                                    end
                                                    if
                                                end if
                                                end
                                                if                         &#x27;test=T2                         &#x27;testT=Tcounter
                                                else &#x27;++++++++++++++++++++++AA+++++++++ &#x27;=============================================================AA===================================================BEGIN
                                                    Dim T3 as DataTable=Buffer.Clone
                                                    Dim Tcounter2 as integer=0
                                                    for r as integer =0 to Buffer.Rows.Count-1                                 if(Buffer.Rows(r)(&quot;Sal&quot;)&gt;=LastApproved) then                                     x=T3.NewRow                                     x=Buffer.Rows(r)                                     T3.ImportRow(x)                                     Tcounter2=Tcounter2+1                                     BasicSalary=Buffer.Rows(r)(&quot;Sal&quot;)
                                                        end
                                                        if
                                                    next                                 Buffer=Nothing                             Buffer=T3 &#x27;===============================================================BB=============================================BEGIN                             if(Tcounter2=1)                                 x=T.NewRow
                                                    For r As Integer = 0 To Buffer.Rows.Count-1                                         Dayz=Buffer.Rows(r)(&quot;Days&quot;)                                     Dayz=Dayz-BaseDays
                                                        If ((Dayz&gt;=25 AND Dayz&lt;=35) OR (Dayz&gt;=55 AND Dayz&lt;=65) ) Then
                                                            x= Buffer.Rows(r)                                         T.ImportRow(x)                                         x=T.NewRow                                         Tcounter=Tcounter+1
                                                        End If
                                                    end if
                                                next                                 &#x27;testT=Tcounter /checked
                                                if Tcounter&lt;3                                     ReassignFlag=1                                     Status=&quot;Total number of feasible transaction is less than 3 after filtering with 25-35 and 55 to 65 in AA-BB-nonGov III&quot;
                                                else                                     BSp=BasicSalary+(BasicSalary*20/100)                                     BSm=BasicSalary-(BasicSalary*20/100)                                     x=T2.NewRow
                                                    for r as integer=0 to T.Rows.count-1                                         if(T.Rows(r)(&quot;Sal&quot;)&gt;=BSm AND T.Rows(r)(&quot;Sal&quot;)&lt;=BSp)                                             x= T.Rows(r)                                             T2.ImportRow(x)                                             x=T2.NewRow                                             T2counter=T2counter+1
                                                        end
                                                        if
                                                    next
                                                    If T2counter&lt;3 Then
                                                        ReassignFlag=1                                         Status=&quot;Total number of feasible transaction is less than 3 after filtering BSm&lt;SAL&lt;BSp in AA-BB-nonGov IV&quot;
                                                    End If
                                                else
                                                    if T2counter=3                                         min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                        For k As Integer = 0 To 2                                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                            If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                min=T2.Rows(k)(&quot;Sal&quot;)                                                 minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                            End If
                                                            end
                                                            if
                                                        next                                          Avg= Sum / 3
                                                        If Avg&lt;1.2*min Then
                                                            Salary=minimum                                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                        End If
                                                    else                                              Salary=minimum                                             Other=0
                                                        end
                                                        if
                                                    end if
                                                    end
                                                    if  &#x27;===============================================================BB=============================================END
                                                    else
                                                        Dim Count4 as integer=0
                                                        Dim Prev as integer =0
                                                        Dim Base as Decimal=0
                                                        for r as integer=0 to A1.Rows.Count-1
                                                            For j as integer=0 to T3.Rows.Count-1
                                                                if A1.Rows(r)(&quot;Amount&quot;)=T3.Rows(j)(&quot;Sal&quot;)                                             Count4=Count4+1
                                                                    end
                                                                    if
                                                                next
                                                                if prev&lt;Count4                                         BasicSalary=A1.Rows(r)(&quot;Amount&quot;)
                                                                    end
                                                                    if
                                                                next &#x27;============================================================BB=============================================BEGIN                                             x=T.NewRow
                                                                For r As Integer = 0 To Buffer.Rows.Count-1                                         Dayz=Buffer.Rows(r)(&quot;Days&quot;)                                     Dayz=Dayz-BaseDays
                                                                    If ((Dayz&gt;=25 AND Dayz&lt;=35) OR (Dayz&gt;=55 AND Dayz&lt;=65) ) Then
                                                                        x= Buffer.Rows(r)                                         T.ImportRow(x)                                         x=T.NewRow                                         Tcounter=Tcounter+1
                                                                    End If
                                                                end if
                                                            next                                 &#x27;testT=Tcounter /checked
                                                            if Tcounter&lt;3                                     ReassignFlag=1                                     Status=&quot;Total number of feasible transaction is less than 3 after filtering 25-35 and 55-65 in AA-BB-nonGov V&quot;
                                                            else                                     BSp=BasicSalary+(BasicSalary*20/100)                                     BSm=BasicSalary-(BasicSalary*20/100)                                     x=T2.NewRow
                                                                for r as integer=0 to T.Rows.count-1                                         if(T.Rows(r)(&quot;Sal&quot;)&gt;=BSm AND T.Rows(r)(&quot;Sal&quot;)&lt;=BSp)                                             x= T.Rows(r)                                             T2.ImportRow(x)                                             x=T2.NewRow                                             T2counter=T2counter+1
                                                                    end
                                                                    if
                                                                next
                                                                If T2counter&lt;3 Then
                                                                    ReassignFlag=1                                         Status=&quot;Total number of feasible transaction is less than 3 after filtering BSp&lt;=SAL&lt;=BSp in AA-BB-nonGov VI&quot;
                                                                End If
                                                            else                                          min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                                For k As Integer = 0 To 2                                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                                    If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                        min=T2.Rows(k)(&quot;Sal&quot;)                                                 minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                                    End If
                                                                    end
                                                                    if
                                                                next                                          Avg= Sum / 3
                                                                If Avg&lt;1.2*min Then
                                                                    Salary=minimum                                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                                End If
                                                            else                                              Salary=minimum                                             Other=0
                                                                end
                                                                if
                                                            end if
                                                            end
                                                            if &#x27;===========================================================BB======================================================END
                                                                end
                                                                if &#x27;=============================================================AA===================================================    END
                                                                    end
                                                                    if &#x27;==============================================================BB============================================END                      &#x27;==============================================================B=============================================END
                                                                        end
                                                                        if &#x27;^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^Page2^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                                                            end
                                                                            if
                                                                            end
                                                                            if
                                                                        else             Status=&quot;Salary cannot be identified since there is no transaction in the past &quot;+TimePeriod.ToString+&quot; days&quot;             ReassignFlag=1
                                                                            end
                                                                            if
                                                                        else         ReassignFlag=1         Status=&quot;Total number of feasible transaction is less than 3&quot;
                                                                            end
                                                                            if
                                                                        else      Status=&quot;Total number of feasible transaction is less than 3&quot;     ReassignFlag=1
                                                                            end
                                                                            if D0=D1 A0=A1
                                                                            catch e as Exception         er=e.ToString         ReassignFlag=1         Status=&quot;Code Error:&quot;+e.ToString
                                                                                end
                                                                                try"
                            data-title="UWCA_MRCC_CTF_V1.0 / Salary code / Salary Calculation(new)1">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>UWCA_MRCC_CTF_V1.0</td>
                <td>Salary code</td>
                <td>Salary Calculation(new)10</td>
                <td>visualbasic</td>
                <td>946</td>
                <!--<td style="font-family: monospace;">769d4413b0abb191035a240f3050f2b49d2df5feb2175bec5b5de55079d26abb</td>-->
                <td>—</td>
                <!--<td>try     Dim description as string     Dim x As DataRow = D1.NewRow     Dim Dflag as integer =0     Dim precount as integer =0     Dim Amount as integer =0     Dim Avg as Decimal=0     Dim Sum as integer =0     Dim skip as integer =0     Dim min as integer =0     Dim count as integer =0     Dim Av as...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="try
    Dim description as string
    Dim x As DataRow = D1.NewRow
    Dim Dflag as integer =0
    Dim precount as integer =0
    Dim Amount as integer =0
    Dim Avg as Decimal=0
    Dim Sum as integer =0
    Dim skip as integer =0
    Dim min as integer =0
    Dim count as integer =0
    Dim Av as integer =0
    Dim mi as integer =0
    Dim minim as string min=0 count=0 minim=&quot;&quot;
    if c1.Rows.Count&gt;2 then
        For r As Integer = 0 To c1.Rows.Count-1         description=c1.Rows(r)(&quot;Description&quot;)         Dflag=0
            for i as integer=0 To D1.Rows.Count-1
                If D1.Rows(i)(&quot;Description&quot;)=description Then
                    Dflag=1                 D1.Rows(i)(&quot;Count&quot;)=D1.Rows(i)(&quot;Count&quot;)+1
                End If
                end
                if
            next
            If Dflag=0 Then
                x(&quot;Description&quot;) = description             x(&quot;Count&quot;)=1             D1.Rows.Add(x)             x= D1.NewRow
            End If
            end
            if
        Next
        For r As Integer = 0 To D1.Rows.Count-1         description=D1.Rows(r)(&quot;Description&quot;)         CollOut=Nothing         CollOut=c1.Clone
            For Each parentRow As DataRow In c1.Select(&quot;Description=&#x27;&quot;+description+&quot;&#x27;&quot;)             x = CollOut.NewRow
                For Each c As DataColumn In x.Table.Columns                     x(c.ColumnName) = parentRow(c.ColumnName)
                Next             CollOut.Rows.Add(x)
            Next         count=CollOut.Rows.Count
            If count&gt;precount Then
                Buffer=Nothing             Buffer = CollOut.Clone             Buffer=CollOut             precount=count             ReassignFlag=0
            End If
        else
            if count = Precount             ReassignFlag=1             Status=&quot;Salary cannot be identified since there mode are equal&quot;
                end
                if
            next &#x27;+++++++++++++++++++++++++
            If Govt= False AND EF= False Then
                &#x27;+++++++++++++++++++++++++
            End If
            If Buffer.Rows.Count &gt;2 Then
                ReassignFlag=0
            End If
            if ReassignFlag=0             ReassignFlag=1
                For r As Integer = 0 To Buffer.Rows.Count-1
                    If Buffer.Rows(r)(&quot;Days&quot;)&lt;=TimePeriod Then
                        ReassignFlag=0
                    End If
                    exit
                    for
                    end
                    if
                next
                end
                if
                if ReassignFlag=0             Status=&quot;&quot;
                    For r As Integer = 0 To Buffer.Rows.Count-1                 Amount=Buffer.Rows(r)(&quot;Sal&quot;)                 Dflag=0
                        for i as integer=0 To A1.Rows.Count-1
                            If A1.Rows(i)(&quot;Amount&quot;)=Amount Then
                                Dflag=1                         A1.Rows(i)(&quot;Count&quot;)=A1.Rows(i)(&quot;Count&quot;)+1
                            End If
                            end
                            if
                        next
                        If Dflag=0 Then
                            x= A1.NewRow                     x(&quot;Amount&quot;) = Amount                     x(&quot;Count&quot;)=1                     x(&quot;Salary&quot;)=Buffer.Rows(r)(&quot;Amount&quot;)                     A1.Rows.Add(x)
                        End If
                        end
                        if
                    Next             min=Buffer.Rows(0)(&quot;Sal&quot;)+1
                    For k As Integer = 0 To 2                 Sum=Sum+Buffer.Rows(k)(&quot;Sal&quot;)
                        If min&gt;Buffer.Rows(k)(&quot;Sal&quot;) Then
                            min=Buffer.Rows(k)(&quot;Sal&quot;)                     minimum=Buffer.Rows(k)(&quot;Amount&quot;)
                        End If
                        end
                        if
                        if k=1                     Av=Sum/2                     mi=min                     minim=minimum
                            end
                            if
                        next             Avg= Sum / 3
                        If Avg&lt;1.2*min Then
                            test=1 Cop=A1                 Salary=minimum                 Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                        End If
                    else
                        If Av&lt;1.2*mi Then
                            minimum=minim                 Salary=minimum                 Other=Replace((Av-mi),&quot;.&quot;,&quot;,&quot;)
                        End If
                    else
                        For r As Integer = 0 To A1.Rows.Count-1
                            If (A1.Rows(r)(&quot;Count&quot;)*100/(Buffer.Rows.Count))&gt;60 Then
                                Salary=A1.Rows(r)(&quot;Salary&quot;)                         skip=1
                            End If
                            end
                            if
                        next
                        If skip=0 Then
                            &#x27;vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvPage2vvvvvvvvvvvvvvvvvvvvvvvvvvv
                        End If
                        if Govt=True then
                            Dim SD1p,SD1m,SD2p,SD2m,SD3p,SD3m as date
                            Dim Sflag as integer =0
                            Dim BasicSalary as Integer =0
                            Dim T as DataTable =Buffer.Clone
                            Dim T2 as DataTable=Buffer.Clone
                            Dim TX as DataTable=Buffer.Clone
                            Dim Tcounter as integer =0
                            Dim T2counter as integer =0
                            Dim BSp,BSm as Decimal                          Sum=0                         minimum=0                         Salary=0                         Other=0                         min=0                         SD1p=SD1.AddDays(5)                         SD1m=SD1.AddDays(-5)                         SD2p=SD2.AddDays(5)                         SD2m=SD2.AddDays(-5)                         SD3p=SD3.AddDays(5)                         SD3m=SD3.AddDays(-5)                 &#x27;        T=Buffer.Clone
                            For r As Integer = 0 To Buffer.Rows.Count-1 &#x27;
                                If (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3) Then
                                    if((SD1m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))OR (SD2m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD3m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD3p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))) then                                 x= Buffer.Rows(r)                                 TX.ImportRow(x)                                 x=TX.NewRow
                                End If
                            end if
                        next                         Buffer=TX
                        For r As Integer = 0 To Buffer.Rows.Count-1                 &#x27;
                            if (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1) then
                                If (SD1m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) Then
                                    Sflag=Sflag+1                                 BasicSalary=Buffer.Rows(r)(&quot;Sal&quot;)                                 &#x27;AM=BasicSalary
                                End If
                                end
                                if
                            Next                         &#x27;AM=BasicSalary
                            If Sflag=1 Then
                                x=T.NewRow
                            End If
                            For r As Integer = 0 To Buffer.Rows.Count-1                 &#x27;
                                If (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3) Then
                                    if((SD1m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))OR (SD2m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD3m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD3p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))) then                                     x= Buffer.Rows(r)                                     T.ImportRow(x)                                     x=T.NewRow                                     Tcounter=Tcounter+1
                                End If
                            end if
                        next
                        if Tcounter&lt;3                                 ReassignFlag=1                                 Status=&quot;Total number of feasible transaction is less than 3 after filtering with +/-5 salary date I&quot;
                        else                                 BSp=BasicSalary+(BasicSalary*20/100)                                 BSm=BasicSalary-(BasicSalary*20/100)                                 x=T2.NewRow
                            for r as integer=0 to T.Rows.count-1                                     if(T.Rows(r)(&quot;Sal&quot;)&gt;=BSm AND T.Rows(r)(&quot;Sal&quot;)&lt;=BSp)                                         x= T.Rows(r)                                         T2.ImportRow(x)                                         x=T2.NewRow                                         T2counter=T2counter+1
                                end
                                if
                            next
                            If T2counter&lt;2 Then
                                ReassignFlag=1                                     Status=&quot;Total number of feasible transaction is less than 2 after filtering BSm &lt;= Salary &lt;=BSp&quot;
                            End If
                        else
                            if T2counter=2                                     min=T2.Rows(0)(&quot;Sal&quot;)+1
                                For k As Integer = 0 To 1                                         Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                    If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                        min=T2.Rows(k)(&quot;Sal&quot;)                                             minimum=T2.Rows(k)(&quot;Amount&quot;)
                                    End If
                                    end
                                    if
                                next                                     Avg= Sum / 2
                                If Avg&lt;1.2*min Then
                                    test=2                                         Salary=minimum                                         Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                End If
                            else                                         Salary=minimum                                         Other=0
                                end
                                if
                            else                                     min=T2.Rows(0)(&quot;Sal&quot;)+1
                                For k As Integer = 0 To 2                                         Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                    If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                        min=T2.Rows(k)(&quot;Sal&quot;)                                             minimum=T2.Rows(k)(&quot;Amount&quot;)
                                    End If
                                    end
                                    if
                                next                                     Avg= Sum / 3
                                If Avg&lt;1.2*min Then
                                    test=2                                         Salary=minimum                                         Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                End If
                            else                                         Salary=minimum                                         Other=0
                                end
                                if
                            end if
                            end
                            if                     &#x27;    test=T                     &#x27;    testT=Tcounter
                            else &#x27;=============================================================AA===================================================BEGIN
                                Dim T3 as DataTable=Buffer.Clone
                                Dim Tcounter2 as integer=0
                                for r as integer =0 to Buffer.Rows.Count-1                                 if(Buffer.Rows(r)(&quot;Sal&quot;)&gt;=LastApproved) then                                     x=T3.NewRow                                     x=Buffer.Rows(r)                                     T3.ImportRow(x)                                     Tcounter2=Tcounter2+1                                     BasicSalary=Buffer.Rows(r)(&quot;Sal&quot;)
                                    end
                                    if
                                next                             &#x27;    Buffer=Nothing                         &#x27;    Buffer=T3 Cop=Buffer &#x27;===============================================================BB=============================================BEGIN                             if(Tcounter2=1)                                 x=T.NewRow
                                For r As Integer = 0 To Buffer.Rows.Count-1                 &#x27;
                                    If (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3) Then
                                        if((SD1m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))OR (SD2m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD3m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD3p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))) then                                         x= Buffer.Rows(r)                                         T.ImportRow(x)                                         x=T.NewRow                                         Tcounter=Tcounter+1
                                    End If
                                end if
                            next
                            if Tcounter&lt;3                                     ReassignFlag=1                                     Status=&quot;Total number of feasible transaction is less than 3 after filtering with +/-5 salary date in AA-BB-Gov I&quot;
                            else                                     BSp=BasicSalary+(BasicSalary*20/100)                                     BSm=BasicSalary-(BasicSalary*20/100)                                     x=T2.NewRow
                                for r as integer=0 to T.Rows.count-1                                         if(T.Rows(r)(&quot;Sal&quot;)&gt;=BSm AND T.Rows(r)(&quot;Sal&quot;)&lt;=BSp)                                             x= T.Rows(r)                                             T2.ImportRow(x)                                             x=T2.NewRow                                             T2counter=T2counter+1
                                    end
                                    if
                                next
                                If T2counter&lt;2 Then
                                    ReassignFlag=1                                         Status=&quot;Total number of feasible transaction is less than 2 after filtering with +/-5 salary date in AA-BB-Gov II&quot;
                                End If
                            else
                                if T2counter=2                                         min=T2.Rows(0)(&quot;Sal&quot;)+1
                                    For k As Integer = 0 To 1                                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                        If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                            min=T2.Rows(k)(&quot;Sal&quot;)                                                 minimum=T2.Rows(k)(&quot;Amount&quot;)
                                        End If
                                        end
                                        if
                                    next                                         Avg= Sum / 2
                                    If Avg&lt;1.2*min Then
                                        test=3                                             Salary=minimum                                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                    End If
                                else                                             Salary=minimum                                             Other=0
                                    end
                                    if
                                else                                         min=T2.Rows(0)(&quot;Sal&quot;)+1
                                    For k As Integer = 0 To 2                                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                        If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                            min=T2.Rows(k)(&quot;Sal&quot;)                                                 minimum=T2.Rows(k)(&quot;Amount&quot;)
                                        End If
                                        end
                                        if
                                    next                                         Avg= Sum / 3
                                    If Avg&lt;1.2*min Then
                                        test=3                                             Salary=minimum                                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                    End If
                                else                                             Salary=minimum                                             Other=0
                                    end
                                    if
                                end if
                                end
                                if &#x27;===============================================================BB=============================================END
                                else
                                    Dim Count4 as integer=0
                                    Dim Prev as integer =0
                                    Dim Base as Decimal=0
                                    for r as integer=0 to A1.Rows.Count-1
                                        For j as integer=0 to T3.Rows.Count-1
                                            if A1.Rows(r)(&quot;Amount&quot;)=T3.Rows(j)(&quot;Sal&quot;)                                             Count4=Count4+1
                                                end
                                                if
                                            next
                                            if prev&lt;Count4                                         BasicSalary=A1.Rows(r)(&quot;Amount&quot;)                                         prev=Count4
                                                end
                                                if                                     Count4=0
                                                next                                                 x=T.NewRow
                                                For r As Integer = 0 To Buffer.Rows.Count-1                 &#x27;
                                                    If (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3) Then
                                                        if((SD1m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))OR (SD2m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD3m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD3p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))) then                                         x= Buffer.Rows(r)                                         T.ImportRow(x)                                         x=T.NewRow                                         Tcounter=Tcounter+1
                                                    End If
                                                end if
                                            next
                                            if Tcounter&lt;3                                     ReassignFlag=1                                     Status=&quot;Total number of feasible transaction is less than 3 after filtering with +/-5 salary date in AA-BB-Gov III&quot;
                                            else                                     BSp=BasicSalary+(BasicSalary*20/100)                                     BSm=BasicSalary-(BasicSalary*20/100)                                     x=T2.NewRow
                                                for r as integer=0 to T.Rows.count-1                                         if(T.Rows(r)(&quot;Sal&quot;)&gt;=BSm AND T.Rows(r)(&quot;Sal&quot;)&lt;=BSp)                                             x= T.Rows(r)                                             T2.ImportRow(x)                                             x=T2.NewRow                                             T2counter=T2counter+1
                                                    end
                                                    if
                                                next
                                                If T2counter&lt;2 Then
                                                    ReassignFlag=1                                         Status=&quot;Total number of feasible transaction is less than 2 after filtering BSm&lt;= SAL &lt;=BSp in AA-BB-Gov IV&quot;
                                                End If
                                            else
                                                if T2counter=2                                         min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                    For k As Integer = 0 To 1                                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                        If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                            min=T2.Rows(k)(&quot;Sal&quot;)                                                 minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                        End If
                                                        end
                                                        if
                                                    next                                         Avg= Sum / 2
                                                    If Avg&lt;1.2*min Then
                                                        test=4                                             Salary=minimum                                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                    End If
                                                else                                             Salary=minimum                                             Other=0
                                                    end
                                                    if
                                                else                                          min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                    For k As Integer = 0 To 2                                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                        If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                            min=T2.Rows(k)(&quot;Sal&quot;)                                                 minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                        End If
                                                        end
                                                        if
                                                    next                                         Avg= Sum / 3
                                                    If Avg&lt;1.2*min Then
                                                        test=4                                             Salary=minimum                                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                    End If
                                                else                                             Salary=minimum                                             Other=0
                                                    end
                                                    if
                                                end if
                                                end
                                                if
                                                end
                                                if  &#x27;=============================================================AA===================================================    END
                                                    end
                                                    if
                                                else &#x27;==========================================================================B===================================BEGIN
                                                    Dim Sflag as integer =0
                                                    Dim BasicSalary as Integer =0
                                                    Dim T as DataTable =Buffer.Clone
                                                    Dim T2 as DataTable=Buffer.Clone
                                                    Dim Tcounter as integer =0
                                                    Dim T2counter as integer =0
                                                    Dim BSp,BSm as Decimal
                                                    Dim BaseDays as Decimal =0
                                                    Dim Dayz as decimal=0                         Sum=0                         minimum=0                         Salary=0                         Sflag=0                         Other=0                         min=0
                                                    For r As Integer = 0 To Buffer.Rows.Count-1
                                                        If (Buffer.Rows(r)(&quot;Days&quot;)&lt;=TimePeriod) Then
                                                            Sflag=Sflag+1                                 BasicSalary=Buffer.Rows(r)(&quot;Sal&quot;)                                 x=T.NewRow                                 x= Buffer.Rows(r)                                 T.ImportRow(x)                                 Tcounter=1                                 BaseDays=Buffer.Rows(r)(&quot;Days&quot;)
                                                        End If
                                                        end
                                                        if
                                                    Next &#x27;=======================================================================================BB=================================================BEGIN
                                                    If Sflag=1 Then
                                                        x=T.NewRow
                                                    End If
                                                    For r As Integer = 0 To Buffer.Rows.Count-1                                     Dayz=Buffer.Rows(r)(&quot;Days&quot;)                                 Dayz=Dayz-BaseDays
                                                        If ((Dayz&gt;=25 AND Dayz&lt;=35) OR (Dayz&gt;=55 AND Dayz&lt;=65) ) Then
                                                            x= Buffer.Rows(r)                                     T.ImportRow(x)                                     x=T.NewRow                                     Tcounter=Tcounter+1
                                                        End If
                                                    end if
                                                next                             &#x27;testT=Tcounter /checked
                                                if Tcounter&lt;3                                 ReassignFlag=1                                 Status=&quot;Total number of feasible transaction is less than 3 after filtering with 25-35 and 55 to 65 in AA-BB-nonGov II&quot;
                                                else                                 BSp=BasicSalary+(BasicSalary*20/100)                                 BSm=BasicSalary-(BasicSalary*20/100)                                 x=T2.NewRow
                                                    for r as integer=0 to T.Rows.count-1                                     if(T.Rows(r)(&quot;Sal&quot;)&gt;=BSm AND T.Rows(r)(&quot;Sal&quot;)&lt;=BSp)                                         x= T.Rows(r)                                         T2.ImportRow(x)                                         x=T2.NewRow                                         T2counter=T2counter+1
                                                        end
                                                        if
                                                    next
                                                    If T2counter&lt;2 Then
                                                        ReassignFlag=1                                     Status=&quot;Total number of feasible transaction is less than 2 after filtering BSm&lt;=SAL&lt;=BSp BB-non Gov II&quot;
                                                    End If
                                                else
                                                    if T2counter=2
                                                        For k As Integer = 0 To 1                                         Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                            If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                min=T2.Rows(k)(&quot;Sal&quot;)                                             minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                            End If
                                                            end
                                                            if
                                                        next                                      Avg= Sum / 2
                                                        If Avg&lt;1.2*min Then
                                                            Salary=minimum                                         Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                        End If
                                                    else                                          Salary=minimum                                         Other=0
                                                        end
                                                        if
                                                    else                                       min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                        For k As Integer = 0 To 2                                         Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                            If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                min=T2.Rows(k)(&quot;Sal&quot;)                                             minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                            End If
                                                            end
                                                            if
                                                        next                                      Avg= Sum / 3
                                                        If Avg&lt;1.2*min Then
                                                            Salary=minimum                                         Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                        End If
                                                    else                                          Salary=minimum                                         Other=0
                                                        end
                                                        if
                                                    end if
                                                    end
                                                    if                         &#x27;test=T2                         &#x27;testT=Tcounter
                                                    else &#x27;++++++++++++++++++++++AA+++++++++ &#x27;=============================================================AA===================================================BEGIN
                                                        Dim T3 as DataTable=Buffer.Clone
                                                        Dim Tcounter2 as integer=0
                                                        for r as integer =0 to Buffer.Rows.Count-1                                 if(Buffer.Rows(r)(&quot;Sal&quot;)&gt;=LastApproved) then                                     x=T3.NewRow                                     x=Buffer.Rows(r)                                     T3.ImportRow(x)                                     Tcounter2=Tcounter2+1                                     BasicSalary=Buffer.Rows(r)(&quot;Sal&quot;)
                                                            end
                                                            if
                                                        next                                 Buffer=Nothing                             Buffer=T3 &#x27;===============================================================BB=============================================BEGIN                             if(Tcounter2=1)                                 x=T.NewRow
                                                        For r As Integer = 0 To Buffer.Rows.Count-1                                         Dayz=Buffer.Rows(r)(&quot;Days&quot;)                                     Dayz=Dayz-BaseDays
                                                            If ((Dayz&gt;=25 AND Dayz&lt;=35) OR (Dayz&gt;=55 AND Dayz&lt;=65) ) Then
                                                                x= Buffer.Rows(r)                                         T.ImportRow(x)                                         x=T.NewRow                                         Tcounter=Tcounter+1
                                                            End If
                                                        end if
                                                    next                                 &#x27;testT=Tcounter /checked
                                                    if Tcounter&lt;3                                     ReassignFlag=1                                     Status=&quot;Total number of feasible transaction is less than 3 after filtering with 25-35 and 55 to 65 in AA-BB-nonGov III&quot;
                                                    else                                     BSp=BasicSalary+(BasicSalary*20/100)                                     BSm=BasicSalary-(BasicSalary*20/100)                                     x=T2.NewRow
                                                        for r as integer=0 to T.Rows.count-1                                         if(T.Rows(r)(&quot;Sal&quot;)&gt;=BSm AND T.Rows(r)(&quot;Sal&quot;)&lt;=BSp)                                             x= T.Rows(r)                                             T2.ImportRow(x)                                             x=T2.NewRow                                             T2counter=T2counter+1
                                                            end
                                                            if
                                                        next
                                                        If T2counter&lt;2 Then
                                                            ReassignFlag=1                                         Status=&quot;Total number of feasible transaction is less than 2 after filtering BSm&lt;SAL&lt;BSp in AA-BB-nonGov IV&quot;
                                                        End If
                                                    else
                                                        if T2counter=2                                         min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                            For k As Integer = 0 To 1                                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                                If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                    min=T2.Rows(k)(&quot;Sal&quot;)                                                 minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                                End If
                                                                end
                                                                if
                                                            next                                          Avg= Sum / 2
                                                            If Avg&lt;1.2*min Then
                                                                Salary=minimum                                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                            End If
                                                        else                                              Salary=minimum                                             Other=0
                                                            end
                                                            if
                                                        else                                         min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                            For k As Integer = 0 To 2                                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                                If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                    min=T2.Rows(k)(&quot;Sal&quot;)                                                 minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                                End If
                                                                end
                                                                if
                                                            next                                          Avg= Sum / 3
                                                            If Avg&lt;1.2*min Then
                                                                Salary=minimum                                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                            End If
                                                        else                                              Salary=minimum                                             Other=0
                                                            end
                                                            if
                                                        end if
                                                        end
                                                        if  &#x27;===============================================================BB=============================================END
                                                        else
                                                            Dim Count4 as integer=0
                                                            Dim Prev as integer =0
                                                            Dim Base as Decimal=0
                                                            for r as integer=0 to A1.Rows.Count-1
                                                                For j as integer=0 to T3.Rows.Count-1
                                                                    if A1.Rows(r)(&quot;Amount&quot;)=T3.Rows(j)(&quot;Sal&quot;)                                             Count4=Count4+1
                                                                        end
                                                                        if
                                                                    next
                                                                    if prev&lt;Count4                                         BasicSalary=A1.Rows(r)(&quot;Amount&quot;)
                                                                        end
                                                                        if
                                                                    next &#x27;============================================================BB=============================================BEGIN                                             x=T.NewRow
                                                                    For r As Integer = 0 To Buffer.Rows.Count-1                                         Dayz=Buffer.Rows(r)(&quot;Days&quot;)                                     Dayz=Dayz-BaseDays
                                                                        If ((Dayz&gt;=25 AND Dayz&lt;=35) OR (Dayz&gt;=55 AND Dayz&lt;=65) ) Then
                                                                            x= Buffer.Rows(r)                                         T.ImportRow(x)                                         x=T.NewRow                                         Tcounter=Tcounter+1
                                                                        End If
                                                                    end if
                                                                next                                 &#x27;testT=Tcounter /checked
                                                                if Tcounter&lt;3                                     ReassignFlag=1                                     Status=&quot;Total number of feasible transaction is less than 3 after filtering 25-35 and 55-65 in AA-BB-nonGov V&quot;
                                                                else                                     BSp=BasicSalary+(BasicSalary*20/100)                                     BSm=BasicSalary-(BasicSalary*20/100)                                     x=T2.NewRow
                                                                    for r as integer=0 to T.Rows.count-1                                         if(T.Rows(r)(&quot;Sal&quot;)&gt;=BSm AND T.Rows(r)(&quot;Sal&quot;)&lt;=BSp)                                             x= T.Rows(r)                                             T2.ImportRow(x)                                             x=T2.NewRow                                             T2counter=T2counter+1
                                                                        end
                                                                        if
                                                                    next
                                                                    If T2counter&lt;2 Then
                                                                        ReassignFlag=1                                         Status=&quot;Total number of feasible transaction is less than 2 after filtering BSp&lt;=SAL&lt;=BSp in AA-BB-nonGov VI&quot;
                                                                    End If
                                                                else
                                                                    if T2counter=2                                         min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                                        For k As Integer = 0 To 1                                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                                            If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                                min=T2.Rows(k)(&quot;Sal&quot;)                                                 minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                                            End If
                                                                            end
                                                                            if
                                                                        next                                          Avg= Sum / 2
                                                                        If Avg&lt;1.2*min Then
                                                                            Salary=minimum                                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                                        End If
                                                                    else                                              Salary=minimum                                             Other=0
                                                                        end
                                                                        if
                                                                    else                                          min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                                        For k As Integer = 0 To 2                                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                                            If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                                min=T2.Rows(k)(&quot;Sal&quot;)                                                 minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                                            End If
                                                                            end
                                                                            if
                                                                        next                                          Avg= Sum / 3
                                                                        If Avg&lt;1.2*min Then
                                                                            Salary=minimum                                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                                        End If
                                                                    else                                              Salary=minimum                                             Other=0
                                                                        end
                                                                        if
                                                                    end if
                                                                    end
                                                                    if &#x27;===========================================================BB======================================================END
                                                                        end
                                                                        if &#x27;=============================================================AA===================================================    END
                                                                            end
                                                                            if &#x27;==============================================================BB============================================END                      &#x27;==============================================================B=============================================END
                                                                                end
                                                                                if &#x27;^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^Page2^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                                                                    end
                                                                                    if
                                                                                    end
                                                                                    if
                                                                                else             Status=&quot;Salary cannot be identified since there is no transaction in the past &quot;+TimePeriod.ToString+&quot; days&quot;             ReassignFlag=1
                                                                                    end
                                                                                    if
                                                                                else         ReassignFlag=1         Status=&quot;Total number of feasible transaction is less than 3&quot;
                                                                                    end
                                                                                    if
                                                                                else
                                                                                    Dim SD1p,SD1m,SD2p,SD2m,SD3p,SD3m,SD4p,SD4m as date
                                                                                    Dim Sflag as integer =0
                                                                                    Dim Salflag as integer =0
                                                                                    Dim Lflag as integer =0
                                                                                    Dim L2flag as integer =0
                                                                                    Dim LLcheck as integer =0
                                                                                    Dim BasicSalary as Integer =0
                                                                                    Dim T as DataTable =Buffer.Clone
                                                                                    Dim T2 as DataTable=Buffer.Clone
                                                                                    Dim TX as DataTable=Buffer.Clone
                                                                                    Dim LL as DataTable=Buffer.Clone
                                                                                    Dim LL1 as DataTable=Buffer.Clone
                                                                                    Dim L2 as DataTable=Buffer.Clone
                                                                                    Dim L21 as DataTable=Buffer.Clone
                                                                                    Dim L3 as DataTable=Buffer.Clone
                                                                                    Dim Tcounter as integer =0
                                                                                    Dim L3counter as integer =0
                                                                                    Dim T2counter as integer =0
                                                                                    Dim BSp,BSm as Decimal          Sum=0         minimum=0         Salary=0         Other=0         min=0         SD1p=SD1.AddDays(5)         SD1m=SD1.AddDays(-5)         SD2p=SD2.AddDays(5)         SD2m=SD2.AddDays(-5)         SD3p=SD3.AddDays(5)         SD3m=SD3.AddDays(-5)         SD4p=SD4.AddDays(5)         SD4m=SD4.AddDays(-5)         &#x27;        T=Buffer.Clone
                                                                                    For r As Integer = 0 To Buffer.Rows.Count-1         &#x27;
                                                                                        If (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3) Then
                                                                                            if((SD1m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))OR (SD2m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD3m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD3p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD4m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD4p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))) then                 x= Buffer.Rows(r)                 TX.ImportRow(x)                 x=TX.NewRow
                                                                                        End If
                                                                                    end if
                                                                                next         Buffer=TX
                                                                                For r As Integer = 0 To Buffer.Rows.Count-1         &#x27;
                                                                                    If (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3) Then
                                                                                        if(SD1m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) then                 x= Buffer.Rows(r)                 LL.ImportRow(x)                 x=LL.NewRow                 Lflag=Lflag+1
                                                                                    End If
                                                                                end if
                                                                            next
                                                                            If Lflag&lt;1 Then
                                                                                Lflag=0             x=LL1.NewRow
                                                                            End If
                                                                            For r As Integer = 0 To Buffer.Rows.Count-1                 if(SD1=Buffer.Rows(r)(&quot;Account date&quot;)) then                     x= Buffer.Rows(r)                     LL1.ImportRow(x)                     x=LL1.NewRow                     Lflag=Lflag+1
                                                                            end if
                                                                        next             LL=LL1
                                                                        end
                                                                        if          LLout=LL &#x27;+++++++++++++++++++++++++++
                                                                            If Lflag&gt;0 Then
                                                                                &#x27;+++++++++++++++++++++++++++
                                                                            End If
                                                                            if Lflag=1 then
                                                                                For r As Integer = 0 To Buffer.Rows.Count-1                     if(SD2m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) then                         x= Buffer.Rows(r)                         L2.ImportRow(x)                         x=L2.NewRow                         L2flag=L2flag+1
                                                                                end if
                                                                            next
                                                                            If L2flag&gt;0 Then
                                                                                test=101
                                                                            End If
                                                                            If L2flag=1 Then
                                                                                test=120
                                                                            End If
                                                                            If L2.Rows(0)(&quot;Sal&quot;)&gt;=LL.Rows(0)(&quot;Sal&quot;) Then
                                                                                salflag=1                             Salary=LL.Rows(0)(&quot;Amount&quot;)                             ReassignFlag=0         test=100
                                                                            End If
                                                                        else                             x=L3.NewRow
                                                                            For r As Integer = 0 To Buffer.Rows.Count-1                                 if((SD2m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD3m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD3p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD4m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD4p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))) then                                     x= Buffer.Rows(r)                                     L3.ImportRow(x)                                     x=L3.NewRow                                     L3counter=L3counter+1
                                                                            end if
                                                                        next
                                                                        If L3counter&gt;2 Then
                                                                            min=L3.Rows(0)(&quot;Sal&quot;)+1
                                                                        End If
                                                                        For k As Integer = 0 To 2                                     Sum=Sum+L3.Rows(k)(&quot;Sal&quot;)
                                                                            If min&gt;L3.Rows(k)(&quot;Sal&quot;) Then
                                                                                min=L3.Rows(k)(&quot;Sal&quot;)                                         minimum=L3.Rows(k)(&quot;Amount&quot;)
                                                                            End If
                                                                            end
                                                                            if
                                                                        next                                  Avg=Sum/3
                                                                        If Avg&lt;1.2*min Then
                                                                            Salary=minimum                                     Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)                                     salflag=1
                                                                        End If
                                                                    else                                     salflag=0
                                                                        end
                                                                        if
                                                                    else                                         salflag=0
                                                                        end
                                                                        if
                                                                        end
                                                                        if
                                                                    else test=110                         L2flag=0                         x=L21.NewRow
                                                                        For r As Integer = 0 To Buffer.Rows.Count-1                             if(SD2=Buffer.Rows(r)(&quot;Account date&quot;)) then                                 x= Buffer.Rows(r)                                 L21.ImportRow(x)                                 x=L21.NewRow                                 L2flag=L2flag+1
                                                                        end if
                                                                    next                         L2=L21
                                                                    if L2flag=1 then
                                                                        If L2.Rows(0)(&quot;Sal&quot;)&gt;=LL.Rows(0)(&quot;Sal&quot;) Then
                                                                            salflag=1                                 Salary=LL.Rows(0)(&quot;Amount&quot;)                                 ReassignFlag=0
                                                                        End If
                                                                        end
                                                                        if
                                                                        end
                                                                        if
                                                                        end
                                                                        if
                                                                        If salflag=0 Then
                                                                            &#x27;test=102 &#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;                         Sum=0
                                                                        End If
                                                                        For r As Integer = 0 To Buffer.Rows.Count-1                         &#x27;
                                                                            if (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1) then
                                                                                If (SD2m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) Then
                                                                                    Sflag=Sflag+1                                 BasicSalary=Buffer.Rows(r)(&quot;Sal&quot;)                                 &#x27;AM=BasicSalary
                                                                                End If
                                                                                end
                                                                                if
                                                                            Next                         &#x27;AM=BasicSalary
                                                                            If Sflag=1 Then
                                                                                x=T.NewRow
                                                                            End If
                                                                            For r As Integer = 0 To Buffer.Rows.Count-1                         &#x27;
                                                                                If (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3) Then
                                                                                    if((SD2m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD3m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD3p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD4m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD4p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))) then                                     x= Buffer.Rows(r)                                     T.ImportRow(x)                                     x=T.NewRow                                     Tcounter=Tcounter+1
                                                                                End If
                                                                            end if
                                                                        next
                                                                        if Tcounter&lt;2                                 ReassignFlag=1                                 Status=&quot;Total number of feasible transaction is less than 2 after filtering with +/-5 salary date I&quot;
                                                                        else                                 BSp=BasicSalary+(BasicSalary*20/100)                                 BSm=BasicSalary-(BasicSalary*20/100)                                 x=T2.NewRow
                                                                            for r as integer=0 to T.Rows.count-1                                     if(T.Rows(r)(&quot;Sal&quot;)&gt;=BSm AND T.Rows(r)(&quot;Sal&quot;)&lt;=BSp)                                         x= T.Rows(r)                                         T2.ImportRow(x)                                         x=T2.NewRow                                         T2counter=T2counter+1
                                                                                end
                                                                                if
                                                                            next
                                                                            If T2counter&lt;2 Then
                                                                                ReassignFlag=1                                     Status=&quot;Total number of feasible transaction is less than 2 after filtering BSm &lt;= Salary &lt;=BSp&quot;
                                                                            End If
                                                                        else
                                                                            if T2counter=2                                     min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                                                For k As Integer = 0 To 1                                         Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                                                    If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                                        min=T2.Rows(k)(&quot;Sal&quot;)                                             minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                                                    End If
                                                                                    end
                                                                                    if
                                                                                next                                     Avg= Sum / 2
                                                                                If Avg&lt;1.2*min Then
                                                                                    test=2                 &#x27;
                                                                                End If
                                                                                For r As Integer = 0 To LL.Rows.Count-1                 &#x27;                            if(LL.Rows(r)(&quot;Sal&quot;)&gt;=Avg*0.65) then                 &#x27;
                                                                                    If LLcheck=0 Then
                                                                                        &#x27;                                    LLcheck=1                 &#x27;                                    if(Math.Floor(LL.Rows(r)(&quot;Sal&quot;))&lt;=Avg) then                 &#x27;                                        Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                    End If
                                                                                else if(LL.Rows(r)(&quot;Sal&quot;)&lt;=Avg*1.2) then                 &#x27;                                        Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                else                     &#x27;                                        ReassignFlag=1                 &#x27;                                        Status=&quot;Salary not identified sincee one transaction in last month is grater than selected salary&quot;                 &#x27;
                                                                                    end
                                                                                    if                 &#x27;
                                                                                    else                  &#x27;                                    ReassignFlag=1                 &#x27;                                    Status=&quot;More than one transaction is grater then 65% of selected salary&quot;                 &#x27;
                                                                                        end
                                                                                        if                 &#x27;
                                                                                        end if                     &#x27;
                                                                                    next                                         Salary=minimum                                         Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                                                else                 &#x27;
                                                                                    For r As Integer = 0 To LL.Rows.Count-1                 &#x27;                            if(LL.Rows(r)(&quot;Sal&quot;)&gt;=min*0.65) then                 &#x27;
                                                                                        If LLcheck=0 Then
                                                                                            &#x27;                                    LLcheck=1                 &#x27;                                    if(Math.Floor(LL.Rows(r)(&quot;Sal&quot;))&lt;=min) then                 &#x27;                                        Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                        End If
                                                                                    else if(LL.Rows(r)(&quot;Sal&quot;)&lt;min*1.2) then                 &#x27;                                        Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                    else                 &#x27;                                        ReassignFlag=1                 &#x27;                                        Status=&quot;Salary not identified sincee one transaction in last month is grater than selected salary&quot;                 &#x27;
                                                                                        end
                                                                                        if                 &#x27;
                                                                                        else                  &#x27;                                    ReassignFlag=1                 &#x27;                                    Status=&quot;More than one transaction is grater then 65% of selected salary&quot;                 &#x27;
                                                                                            end
                                                                                            if                 &#x27;
                                                                                            end if                     &#x27;
                                                                                        next                 test=2.1                                         Salary=minimum
                                                                                        end
                                                                                        if
                                                                                    else                                     min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                                                        For k As Integer = 0 To 2                                         Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                                                            If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                                                min=T2.Rows(k)(&quot;Sal&quot;)                                             minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                                                            End If
                                                                                            end
                                                                                            if
                                                                                        next                                     Avg= Sum / 3
                                                                                        If Avg&lt;1.2*min Then
                                                                                            test=2                 &#x27;
                                                                                        End If
                                                                                        For r As Integer = 0 To LL.Rows.Count-1                 &#x27;                            if(LL.Rows(r)(&quot;Sal&quot;)&gt;=Avg*0.65) then                 &#x27;
                                                                                            If LLcheck=0 Then
                                                                                                &#x27;                                    LLcheck=1                 &#x27;                                    if(Math.Floor(LL.Rows(r)(&quot;Sal&quot;))&lt;=Avg) then                 &#x27;                                        Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                            End If
                                                                                        else if(LL.Rows(r)(&quot;Sal&quot;)&lt;Avg*1.2) then                 &#x27;                                        Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                        else                 &#x27;er=Avg                 &#x27;Buffer=T2                 &#x27;                                        ReassignFlag=1                 &#x27;                                        Status=&quot;Salary not identified sincee one transaction in last month is grater than selected salary&quot;                 &#x27;
                                                                                            end
                                                                                            if                 &#x27;
                                                                                            else                  &#x27;                                    ReassignFlag=1                 &#x27;                                    Status=&quot;More than one transaction is grater then 65% of selected salary&quot;                 &#x27;
                                                                                                end
                                                                                                if                 &#x27;
                                                                                                end if                     &#x27;
                                                                                            next                                         Salary=minimum                                         Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                                                        else                 &#x27;
                                                                                            For r As Integer = 0 To LL.Rows.Count-1                 &#x27;                            if(LL.Rows(r)(&quot;Sal&quot;)&gt;=min*0.65) then                 &#x27;
                                                                                                If LLcheck=0 Then
                                                                                                    &#x27;                                    LLcheck=1                 &#x27;                                    if(Math.Floor(LL.Rows(r)(&quot;Sal&quot;))&lt;=min) then                 &#x27;                                        Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                                End If
                                                                                            else if(LL.Rows(r)(&quot;Sal&quot;)&lt;=min*1.2) then                 &#x27;                                        Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                            else                 &#x27;                                        ReassignFlag=1                 &#x27;                                        Status=&quot;Salary not identified sincee one transaction in last month is grater than selected salary&quot;                 &#x27;
                                                                                                end
                                                                                                if                 &#x27;
                                                                                                else                  &#x27;                                    ReassignFlag=1                 &#x27;                                    Status=&quot;More than one transaction is grater then 65% of selected salary&quot;                 &#x27;
                                                                                                    end
                                                                                                    if                 &#x27;
                                                                                                    end if                     &#x27;
                                                                                                next                 test=2.1                                         Salary=minimum
                                                                                                end
                                                                                                if
                                                                                            end if
                                                                                            end
                                                                                            if                         &#x27;    test=T                         &#x27;    testT=Tcounter
                                                                                            else &#x27;=============================================================AA===================================================BEGIN
                                                                                                Dim T3 as DataTable=Buffer.Clone
                                                                                                Dim Tcounter2 as integer=0
                                                                                                for r as integer =0 to Buffer.Rows.Count-1                                 if(Buffer.Rows(r)(&quot;Sal&quot;)&gt;=LastApproved) then                                     x=T3.NewRow                                     x=Buffer.Rows(r)                                     T3.ImportRow(x)                                     Tcounter2=Tcounter2+1                                     BasicSalary=Buffer.Rows(r)(&quot;Sal&quot;)
                                                                                                    end
                                                                                                    if
                                                                                                next                             &#x27;    Buffer=Nothing                         &#x27;    Buffer=T3                             Cop=Buffer &#x27;===============================================================BB=============================================BEGIN                             if(Tcounter2=1)                                 x=T.NewRow
                                                                                                For r As Integer = 0 To Buffer.Rows.Count-1                         &#x27;
                                                                                                    If (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3) Then
                                                                                                        if((SD1m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))OR (SD2m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD3m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD3p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD4m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD4p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))) then                                         x= Buffer.Rows(r)                                         T.ImportRow(x)                                         x=T.NewRow                                         Tcounter=Tcounter+1
                                                                                                    End If
                                                                                                end if
                                                                                            next
                                                                                            if Tcounter&lt;2                                     ReassignFlag=1                                     Status=&quot;Total number of feasible transaction is less than 2 after filtering with +/-5 salary date in AA-BB-Gov I&quot;
                                                                                            else                                     BSp=BasicSalary+(BasicSalary*20/100)                                     BSm=BasicSalary-(BasicSalary*20/100)                                     x=T2.NewRow
                                                                                                for r as integer=0 to T.Rows.count-1                                         if(T.Rows(r)(&quot;Sal&quot;)&gt;=BSm AND T.Rows(r)(&quot;Sal&quot;)&lt;=BSp)                                             x= T.Rows(r)                                             T2.ImportRow(x)                                             x=T2.NewRow                                             T2counter=T2counter+1
                                                                                                    end
                                                                                                    if
                                                                                                next
                                                                                                If T2counter&lt;2 Then
                                                                                                    ReassignFlag=1                                         Status=&quot;Total number of feasible transaction is less than 2 after filtering with +/-5 salary date in AA-BB-Gov II&quot;
                                                                                                End If
                                                                                            else
                                                                                                if T2counter=2                                         min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                                                                    For k As Integer = 0 To 1                                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                                                                        If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                                                            min=T2.Rows(k)(&quot;Sal&quot;)                                                 minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                                                                        End If
                                                                                                        end
                                                                                                        if
                                                                                                    next                                         Avg= Sum / 2
                                                                                                    If Avg&lt;1.2*min Then
                                                                                                        test=3                 &#x27;
                                                                                                    End If
                                                                                                    For r As Integer = 0 To LL.Rows.Count-1                 &#x27;                                if(LL.Rows(r)(&quot;Sal&quot;)&gt;=Avg*0.65) then                 &#x27;
                                                                                                        If LLcheck=0 Then
                                                                                                            &#x27;                                        LLcheck=1                 &#x27;                                        if(Math.Floor(LL.Rows(r)(&quot;Sal&quot;))&lt;=Avg) then                 &#x27;                                            Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                                        End If
                                                                                                    else if(LL.Rows(r)(&quot;Sal&quot;)&lt;=Avg*1.2) then                 &#x27;                                            Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                                    else                 &#x27;                                            ReassignFlag=1                 &#x27;                                            Status=&quot;Salary not identified sincee one transaction in last month is grater than selected salary&quot;                 &#x27;
                                                                                                        end
                                                                                                        if                 &#x27;
                                                                                                        else                  &#x27;                                        ReassignFlag=1                 &#x27;                                        Status=&quot;More than one transaction is grater then 65% of selected salary&quot;                 &#x27;
                                                                                                            end
                                                                                                            if                 &#x27;
                                                                                                            end if                     &#x27;
                                                                                                        next                                             Salary=minimum                                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                                                                    else                 &#x27;
                                                                                                        For r As Integer = 0 To LL.Rows.Count-1                 &#x27;                                if(LL.Rows(r)(&quot;Sal&quot;)&gt;=min*0.65) then                 &#x27;
                                                                                                            If LLcheck=0 Then
                                                                                                                &#x27;                                        LLcheck=1                 &#x27;                                        if(Math.Floor(LL.Rows(r)(&quot;Sal&quot;))&lt;=min) then                 &#x27;                                            Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                                            End If
                                                                                                        else if(LL.Rows(r)(&quot;Sal&quot;)&lt;=min*1.2) then                 &#x27;                                            Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                                        else                 &#x27;                                            ReassignFlag=1                 &#x27;                                            Status=&quot;Salary not identified sincee one transaction in last month is grater than selected salary&quot;                 &#x27;
                                                                                                            end
                                                                                                            if                 &#x27;
                                                                                                            else                  &#x27;                                        ReassignFlag=1                 &#x27;                                        Status=&quot;More than one transaction is grater then 65% of selected salary&quot;                 &#x27;
                                                                                                                end
                                                                                                                if                 &#x27;
                                                                                                                end if                     &#x27;
                                                                                                            next                 test=3.1                                             Salary=minimum
                                                                                                            end
                                                                                                            if
                                                                                                        else                                         min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                                                                            For k As Integer = 0 To 2                                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                                                                                If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                                                                    min=T2.Rows(k)(&quot;Sal&quot;)                                                 minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                                                                                End If
                                                                                                                end
                                                                                                                if
                                                                                                            next                                         Avg= Sum / 3
                                                                                                            If Avg&lt;1.2*min Then
                                                                                                                test=3                 &#x27;
                                                                                                            End If
                                                                                                            For r As Integer = 0 To LL.Rows.Count-1                 &#x27;                                if(LL.Rows(r)(&quot;Sal&quot;)&gt;=Avg*0.65) then                 &#x27;
                                                                                                                If LLcheck=0 Then
                                                                                                                    &#x27;                                        LLcheck=1                 &#x27;                                        if(Math.Floor(LL.Rows(r)(&quot;Sal&quot;))&lt;=Avg) then                 &#x27;                                            Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                                                End If
                                                                                                            else if(LL.Rows(r)(&quot;Sal&quot;)&lt;=Avg*1.2) then                 &#x27;                                            Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                                            else                 &#x27;                                            ReassignFlag=1                 &#x27;                                            Status=&quot;Salary not identified sincee one transaction in last month is grater than selected salary&quot;                 &#x27;
                                                                                                                end
                                                                                                                if                 &#x27;
                                                                                                                else                  &#x27;                                        ReassignFlag=1                 &#x27;                                        Status=&quot;More than one transaction is grater then 65% of selected salary&quot;                 &#x27;
                                                                                                                    end
                                                                                                                    if                 &#x27;
                                                                                                                    end if                     &#x27;
                                                                                                                next                                             Salary=minimum                                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                                                                            else                 &#x27;
                                                                                                                For r As Integer = 0 To LL.Rows.Count-1                 &#x27;                                if(LL.Rows(r)(&quot;Sal&quot;)&gt;=min*0.65) then                 &#x27;
                                                                                                                    If LLcheck=0 Then
                                                                                                                        &#x27;                                        LLcheck=1                 &#x27;                                        if(Math.Floor(LL.Rows(r)(&quot;Sal&quot;))&lt;=min) then                 &#x27;                                            Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                                                    End If
                                                                                                                else if(LL.Rows(r)(&quot;Sal&quot;)&lt;=min*1.2) then                 &#x27;                                            Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                                                else                 &#x27;                                            ReassignFlag=1                 &#x27;                                            Status=&quot;Salary not identified since one transaction in last month is grater than selected salary&quot;                 &#x27;
                                                                                                                    end
                                                                                                                    if                 &#x27;
                                                                                                                    else                  &#x27;                                        ReassignFlag=1                 &#x27;                                        Status=&quot;More than one transaction is grater then 65% of selected salary&quot;                 &#x27;
                                                                                                                        end
                                                                                                                        if                 &#x27;
                                                                                                                        end if                     &#x27;
                                                                                                                    next                 test=3.1                                             Salary=minimum
                                                                                                                    end
                                                                                                                    if
                                                                                                                end if
                                                                                                                end
                                                                                                                if &#x27;===============================================================BB=============================================END
                                                                                                                else
                                                                                                                    Dim Count4 as integer=0
                                                                                                                    Dim Prev as integer =0
                                                                                                                    Dim Base as Decimal=0
                                                                                                                    for r as integer=0 to A1.Rows.Count-1
                                                                                                                        For j as integer=0 to T3.Rows.Count-1
                                                                                                                            if A1.Rows(r)(&quot;Amount&quot;)=T3.Rows(j)(&quot;Sal&quot;)                                             Count4=Count4+1
                                                                                                                                end
                                                                                                                                if
                                                                                                                            next
                                                                                                                            if prev&lt;Count4                                         BasicSalary=A1.Rows(r)(&quot;Amount&quot;)                                         prev=Count4
                                                                                                                                end
                                                                                                                                if                                     Count4=0
                                                                                                                                next                                                 x=T.NewRow
                                                                                                                                For r As Integer = 0 To Buffer.Rows.Count-1                         &#x27;
                                                                                                                                    If (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3) Then
                                                                                                                                        if((SD1m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))OR (SD2m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD3m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD3p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD4m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD4p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))) then                                         x= Buffer.Rows(r)                                         T.ImportRow(x)                                         x=T.NewRow                                         Tcounter=Tcounter+1
                                                                                                                                    End If
                                                                                                                                end if
                                                                                                                            next
                                                                                                                            if Tcounter&lt;2                                     ReassignFlag=1                                     Status=&quot;Total number of feasible transaction is less than 2 after filtering with +/-5 salary date in AA-BB-Gov III&quot;
                                                                                                                            else                                     BSp=BasicSalary+(BasicSalary*20/100)                                     BSm=BasicSalary-(BasicSalary*20/100)                                     x=T2.NewRow
                                                                                                                                for r as integer=0 to T.Rows.count-1                                         if(T.Rows(r)(&quot;Sal&quot;)&gt;=BSm AND T.Rows(r)(&quot;Sal&quot;)&lt;=BSp)                                             x= T.Rows(r)                                             T2.ImportRow(x)                                             x=T2.NewRow                                             T2counter=T2counter+1
                                                                                                                                    end
                                                                                                                                    if
                                                                                                                                next
                                                                                                                                If T2counter&lt;2 Then
                                                                                                                                    ReassignFlag=1                                         Status=&quot;Total number of feasible transaction is less than 2 after filtering BSm&lt;= SAL &lt;=BSp in AA-BB-Gov IV&quot;
                                                                                                                                End If
                                                                                                                            else
                                                                                                                                if T2counter=2                                         min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                                                                                                    For k As Integer = 0 To 1                                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                                                                                                        If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                                                                                            min=T2.Rows(k)(&quot;Sal&quot;)                                                 minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                                                                                                        End If
                                                                                                                                        end
                                                                                                                                        if
                                                                                                                                    next                                         Avg= Sum / 2
                                                                                                                                    If Avg&lt;1.2*min Then
                                                                                                                                        test=4                 &#x27;
                                                                                                                                    End If
                                                                                                                                    For r As Integer = 0 To LL.Rows.Count-1                 &#x27;                                if(LL.Rows(r)(&quot;Sal&quot;)&gt;=Avg*0.65) then                 &#x27;
                                                                                                                                        If LLcheck=0 Then
                                                                                                                                            &#x27;                                        LLcheck=1                 &#x27;                                        if(Math.Floor(LL.Rows(r)(&quot;Sal&quot;))&lt;=Avg) then                 &#x27;                                            Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                                                                        End If
                                                                                                                                    else if(LL.Rows(r)(&quot;Sal&quot;)&lt;=Avg*1.2) then                 &#x27;                                            Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                                                                    else                 &#x27;                                            ReassignFlag=1                 &#x27;                                            Status=&quot;Salary not identified sincee one transaction in last month is grater than selected salary&quot;                 &#x27;
                                                                                                                                        end
                                                                                                                                        if                 &#x27;
                                                                                                                                        else                  &#x27;                                        ReassignFlag=1                 &#x27;                                        Status=&quot;More than one transaction is grater then 65% of selected salary&quot;                 &#x27;
                                                                                                                                            end
                                                                                                                                            if                 &#x27;
                                                                                                                                            end if                     &#x27;
                                                                                                                                        next                                             Salary=minimum                                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                                                                                                    else                 &#x27;
                                                                                                                                        For r As Integer = 0 To LL.Rows.Count-1                 &#x27;                                if(LL.Rows(r)(&quot;Sal&quot;)&gt;=min*0.65) then                 &#x27;
                                                                                                                                            If LLcheck=0 Then
                                                                                                                                                &#x27;                                        LLcheck=1                 &#x27;                                        if(Math.Floor(LL.Rows(r)(&quot;Sal&quot;))&lt;=min) then                 &#x27;                                            Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                                                                            End If
                                                                                                                                        else if(LL.Rows(r)(&quot;Sal&quot;)&lt;=min*1.2) then                 &#x27;                                            Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                                                                        else                 &#x27;                                            ReassignFlag=1                 &#x27;                                            Status=&quot;Salary not identified sincee one transaction in last month is grater than selected salary&quot;                 &#x27;
                                                                                                                                            end
                                                                                                                                            if                 &#x27;
                                                                                                                                            else                  &#x27;                                        ReassignFlag=1                 &#x27;                                        Status=&quot;More than one transaction is grater then 65% of selected salary&quot;                 &#x27;
                                                                                                                                                end
                                                                                                                                                if                 &#x27;
                                                                                                                                                end if                     &#x27;
                                                                                                                                            next                 test=4.1                                             Salary=minimum
                                                                                                                                            end
                                                                                                                                            if
                                                                                                                                        else                                          min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                                                                                                            For k As Integer = 0 To 2                                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                                                                                                                If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                                                                                                    min=T2.Rows(k)(&quot;Sal&quot;)                                                 minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                                                                                                                End If
                                                                                                                                                end
                                                                                                                                                if
                                                                                                                                            next                                         Avg= Sum / 3
                                                                                                                                            If Avg&lt;1.2*min Then
                                                                                                                                                test=4                 &#x27;
                                                                                                                                            End If
                                                                                                                                            For r As Integer = 0 To LL.Rows.Count-1                 &#x27;                                if(LL.Rows(r)(&quot;Sal&quot;)&gt;=Avg*0.65) then                 &#x27;
                                                                                                                                                If LLcheck=0 Then
                                                                                                                                                    &#x27;                                        LLcheck=1                 &#x27;                                        if(Math.Floor(LL.Rows(r)(&quot;Sal&quot;))&lt;=Avg) then                 &#x27;                                            Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                                                                                End If
                                                                                                                                            else if(LL.Rows(r)(&quot;Sal&quot;)&lt;=Avg*1.2) then                 &#x27;                                            Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                                                                            else                 &#x27;                                            ReassignFlag=1                 &#x27;                                            Status=&quot;Salary not identified sincee one transaction in last month is grater than selected salary&quot;                 &#x27;
                                                                                                                                                end
                                                                                                                                                if                 &#x27;
                                                                                                                                                else                  &#x27;                                        ReassignFlag=1                 &#x27;                                        Status=&quot;More than one transaction is grater then 65% of selected salary&quot;                 &#x27;
                                                                                                                                                    end
                                                                                                                                                    if                 &#x27;
                                                                                                                                                    end if                     &#x27;
                                                                                                                                                next                                             Salary=minimum                                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                                                                                                            else                 &#x27;
                                                                                                                                                For r As Integer = 0 To LL.Rows.Count-1                 &#x27;                                if(LL.Rows(r)(&quot;Sal&quot;)&gt;=min*0.65) then                 &#x27;
                                                                                                                                                    If LLcheck=0 Then
                                                                                                                                                        &#x27;                                        LLcheck=1                 &#x27;                                        if(Math.Floor(LL.Rows(r)(&quot;Sal&quot;))&lt;=min) then                 &#x27;                                            Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                                                                                    End If
                                                                                                                                                else if(LL.Rows(r)(&quot;Sal&quot;)&lt;=min*1.2) then                 &#x27;                                            Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                                                                                else                 &#x27;                                            ReassignFlag=1                 &#x27;                                            Status=&quot;Salary not identified sincee one transaction in last month is grater than selected salary&quot;                 &#x27;
                                                                                                                                                    end
                                                                                                                                                    if                 &#x27;
                                                                                                                                                    else                  &#x27;                                        ReassignFlag=1                 &#x27;                                        Status=&quot;More than one transaction is grater then 65% of selected salary&quot;                 &#x27;
                                                                                                                                                        end
                                                                                                                                                        if                 &#x27;
                                                                                                                                                        end if                     &#x27;
                                                                                                                                                    next                 test=4.1                                             Salary=minimum
                                                                                                                                                    end
                                                                                                                                                    if
                                                                                                                                                end if
                                                                                                                                                end
                                                                                                                                                if
                                                                                                                                                end
                                                                                                                                                if
                                                                                                                                                end
                                                                                                                                                if
                                                                                                                                                end
                                                                                                                                                if                     &#x27;
                                                                                                                                                    end
                                                                                                                                                    if &#x27;=============================================================AA===================================================    END
                                                                                                                                                    else                      ReassignFlag=1                     Status=&quot;No transaction available in 2nd last month&quot;
                                                                                                                                                        end
                                                                                                                                                        if
                                                                                                                                                    else                  Status=&quot;More than one transaction in +/-5 days of last month salary date&quot;                 ReassignFlag=1
                                                                                                                                                        end
                                                                                                                                                        if
                                                                                                                                                    else             Status=&quot;No transaction in of last salary date&quot;             ReassignFlag=1
                                                                                                                                                        end
                                                                                                                                                        if
                                                                                                                                                        end
                                                                                                                                                        if
                                                                                                                                                    else      Status=&quot;Total number of feasible transaction is less than 3&quot;     ReassignFlag=1
                                                                                                                                                        end
                                                                                                                                                        if D0=D1 A0=A1
                                                                                                                                                        catch e as Exception         er=e.ToString         ReassignFlag=1         Status=&quot;Code Error:&quot;+e.ToString
                                                                                                                                                            end
                                                                                                                                                            try"
                            data-title="UWCA_MRCC_CTF_V1.0 / Salary code / Salary Calculation(new)10">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>UWCA_MRCC_CTF_V1.0</td>
                <td>Salary code</td>
                <td>Salary Calculation(new)13 new 17 jan2</td>
                <td>visualbasic</td>
                <td>946</td>
                <!--<td style="font-family: monospace;">8548cd1b4a0449e05e10a3443c67be4752daedc5e95c8ac2dbfac9c77181553a</td>-->
                <td>—</td>
                <!--<td>try     Dim description as string     Dim x As DataRow = D1.NewRow     Dim Dflag as integer =0     Dim precount as integer =0     Dim Amount as integer =0     Dim Avg as Decimal=0     Dim Sum as integer =0     Dim skip as integer =0     Dim min as integer =0     Dim count as integer =0     Dim Av as...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="try
    Dim description as string
    Dim x As DataRow = D1.NewRow
    Dim Dflag as integer =0
    Dim precount as integer =0
    Dim Amount as integer =0
    Dim Avg as Decimal=0
    Dim Sum as integer =0
    Dim skip as integer =0
    Dim min as integer =0
    Dim count as integer =0
    Dim Av as integer =0
    Dim mi as integer =0
    Dim minim as string min=0 count=0 minim=&quot;&quot;
    if c1.Rows.Count&gt;2 then
        For r As Integer = 0 To c1.Rows.Count-1         description=c1.Rows(r)(&quot;Description&quot;)         Dflag=0
            for i as integer=0 To D1.Rows.Count-1
                If D1.Rows(i)(&quot;Description&quot;)=description Then
                    Dflag=1                 D1.Rows(i)(&quot;Count&quot;)=D1.Rows(i)(&quot;Count&quot;)+1
                End If
                end
                if
            next
            If Dflag=0 Then
                x(&quot;Description&quot;) = description             x(&quot;Count&quot;)=1             D1.Rows.Add(x)             x= D1.NewRow
            End If
            end
            if
        Next
        For r As Integer = 0 To D1.Rows.Count-1         description=D1.Rows(r)(&quot;Description&quot;)         CollOut=Nothing         CollOut=c1.Clone
            For Each parentRow As DataRow In c1.Select(&quot;Description=&#x27;&quot;+description+&quot;&#x27;&quot;)             x = CollOut.NewRow
                For Each c As DataColumn In x.Table.Columns                     x(c.ColumnName) = parentRow(c.ColumnName)
                Next             CollOut.Rows.Add(x)
            Next         count=CollOut.Rows.Count
            If count&gt;precount Then
                Buffer=Nothing             Buffer = CollOut.Clone             Buffer=CollOut             precount=count             ReassignFlag=0
            End If
        else
            if count = Precount             ReassignFlag=1             Status=&quot;Salary cannot be identified since there mode are equal&quot;
                end
                if
            next &#x27;+++++++++++++++++++++++++
            If Govt= False AND EF= False Then
                &#x27;+++++++++++++++++++++++++
            End If
            If Buffer.Rows.Count &gt;2 Then
                ReassignFlag=0
            End If
            if ReassignFlag=0             ReassignFlag=1
                For r As Integer = 0 To Buffer.Rows.Count-1
                    If Buffer.Rows(r)(&quot;Days&quot;)&lt;=TimePeriod Then
                        ReassignFlag=0
                    End If
                    exit
                    for
                    end
                    if
                next
                end
                if
                if ReassignFlag=0             Status=&quot;&quot;
                    For r As Integer = 0 To Buffer.Rows.Count-1                 Amount=Buffer.Rows(r)(&quot;Sal&quot;)                 Dflag=0
                        for i as integer=0 To A1.Rows.Count-1
                            If A1.Rows(i)(&quot;Amount&quot;)=Amount Then
                                Dflag=1                         A1.Rows(i)(&quot;Count&quot;)=A1.Rows(i)(&quot;Count&quot;)+1
                            End If
                            end
                            if
                        next
                        If Dflag=0 Then
                            x= A1.NewRow                     x(&quot;Amount&quot;) = Amount                     x(&quot;Count&quot;)=1                     x(&quot;Salary&quot;)=Buffer.Rows(r)(&quot;Amount&quot;)                     A1.Rows.Add(x)
                        End If
                        end
                        if
                    Next             min=Buffer.Rows(0)(&quot;Sal&quot;)+1
                    For k As Integer = 0 To 2                 Sum=Sum+Buffer.Rows(k)(&quot;Sal&quot;)
                        If min&gt;Buffer.Rows(k)(&quot;Sal&quot;) Then
                            min=Buffer.Rows(k)(&quot;Sal&quot;)                     minimum=Buffer.Rows(k)(&quot;Amount&quot;)
                        End If
                        end
                        if
                        if k=1                     Av=Sum/2                     mi=min                     minim=minimum
                            end
                            if
                        next             Avg= Sum / 3
                        If Avg&lt;1.2*min Then
                            test=1 Cop=A1                 Salary=minimum                 Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                        End If
                    else
                        If Av&lt;1.2*mi Then
                            minimum=minim                 Salary=minimum                 Other=Replace((Av-mi),&quot;.&quot;,&quot;,&quot;)
                        End If
                    else
                        For r As Integer = 0 To A1.Rows.Count-1
                            If (A1.Rows(r)(&quot;Count&quot;)*100/(Buffer.Rows.Count))&gt;60 Then
                                Salary=A1.Rows(r)(&quot;Salary&quot;)                         skip=1
                            End If
                            end
                            if
                        next
                        If skip=0 Then
                            &#x27;vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvPage2vvvvvvvvvvvvvvvvvvvvvvvvvvv
                        End If
                        if Govt=True then
                            Dim SD1p,SD1m,SD2p,SD2m,SD3p,SD3m as date
                            Dim Sflag as integer =0
                            Dim BasicSalary as Integer =0
                            Dim T as DataTable =Buffer.Clone
                            Dim T2 as DataTable=Buffer.Clone
                            Dim TX as DataTable=Buffer.Clone
                            Dim Tcounter as integer =0
                            Dim T2counter as integer =0
                            Dim BSp,BSm as Decimal                          Sum=0                         minimum=0                         Salary=0                         Other=0                         min=0                         SD1p=SD1.AddDays(5)                         SD1m=SD1.AddDays(-5)                         SD2p=SD2.AddDays(5)                         SD2m=SD2.AddDays(-5)                         SD3p=SD3.AddDays(5)                         SD3m=SD3.AddDays(-5)                 &#x27;        T=Buffer.Clone
                            For r As Integer = 0 To Buffer.Rows.Count-1 &#x27;
                                If (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3) Then
                                    if((SD1m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))OR (SD2m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD3m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD3p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))) then                                 x= Buffer.Rows(r)                                 TX.ImportRow(x)                                 x=TX.NewRow
                                End If
                            end if
                        next                         Buffer=TX
                        For r As Integer = 0 To Buffer.Rows.Count-1                 &#x27;
                            if (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1) then
                                If (SD1m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) Then
                                    Sflag=Sflag+1                                 BasicSalary=Buffer.Rows(r)(&quot;Sal&quot;)                                 &#x27;AM=BasicSalary
                                End If
                                end
                                if
                            Next                         &#x27;AM=BasicSalary
                            If Sflag=1 Then
                                x=T.NewRow
                            End If
                            For r As Integer = 0 To Buffer.Rows.Count-1                 &#x27;
                                If (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3) Then
                                    if((SD1m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))OR (SD2m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD3m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD3p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))) then                                     x= Buffer.Rows(r)                                     T.ImportRow(x)                                     x=T.NewRow                                     Tcounter=Tcounter+1
                                End If
                            end if
                        next
                        if Tcounter&lt;3                                 ReassignFlag=1                                 Status=&quot;Total number of feasible transaction is less than 3 after filtering with +/-5 salary date I&quot;
                        else                                 BSp=BasicSalary+(BasicSalary*20/100)                                 BSm=BasicSalary-(BasicSalary*20/100)                                 x=T2.NewRow
                            for r as integer=0 to T.Rows.count-1                                     if(T.Rows(r)(&quot;Sal&quot;)&gt;=BSm AND T.Rows(r)(&quot;Sal&quot;)&lt;=BSp)                                         x= T.Rows(r)                                         T2.ImportRow(x)                                         x=T2.NewRow                                         T2counter=T2counter+1
                                end
                                if
                            next
                            If T2counter&lt;2 Then
                                ReassignFlag=1                                     Status=&quot;Total number of feasible transaction is less than 2 after filtering BSm &lt;= Salary &lt;=BSp&quot;
                            End If
                        else
                            if T2counter=2                                     min=T2.Rows(0)(&quot;Sal&quot;)+1
                                For k As Integer = 0 To 1                                         Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                    If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                        min=T2.Rows(k)(&quot;Sal&quot;)                                             minimum=T2.Rows(k)(&quot;Amount&quot;)
                                    End If
                                    end
                                    if
                                next                                     Avg= Sum / 2
                                If Avg&lt;1.2*min Then
                                    test=2                                         Salary=minimum                                         Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                End If
                            else                                         Salary=minimum                                         Other=0
                                end
                                if
                            else                                     min=T2.Rows(0)(&quot;Sal&quot;)+1
                                For k As Integer = 0 To 2                                         Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                    If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                        min=T2.Rows(k)(&quot;Sal&quot;)                                             minimum=T2.Rows(k)(&quot;Amount&quot;)
                                    End If
                                    end
                                    if
                                next                                     Avg= Sum / 3
                                If Avg&lt;1.2*min Then
                                    test=2                                         Salary=minimum                                         Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                End If
                            else                                         Salary=minimum                                         Other=0
                                end
                                if
                            end if
                            end
                            if                     &#x27;    test=T                     &#x27;    testT=Tcounter
                            else &#x27;=============================================================AA===================================================BEGIN
                                Dim T3 as DataTable=Buffer.Clone
                                Dim Tcounter2 as integer=0
                                for r as integer =0 to Buffer.Rows.Count-1                                 if(Buffer.Rows(r)(&quot;Sal&quot;)&gt;=LastApproved) then                                     x=T3.NewRow                                     x=Buffer.Rows(r)                                     T3.ImportRow(x)                                     Tcounter2=Tcounter2+1                                     BasicSalary=Buffer.Rows(r)(&quot;Sal&quot;)
                                    end
                                    if
                                next                             &#x27;    Buffer=Nothing                         &#x27;    Buffer=T3 Cop=Buffer &#x27;===============================================================BB=============================================BEGIN                             if(Tcounter2=1)                                 x=T.NewRow
                                For r As Integer = 0 To Buffer.Rows.Count-1                 &#x27;
                                    If (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3) Then
                                        if((SD1m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))OR (SD2m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD3m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD3p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))) then                                         x= Buffer.Rows(r)                                         T.ImportRow(x)                                         x=T.NewRow                                         Tcounter=Tcounter+1
                                    End If
                                end if
                            next
                            if Tcounter&lt;3                                     ReassignFlag=1                                     Status=&quot;Total number of feasible transaction is less than 3 after filtering with +/-5 salary date in AA-BB-Gov I&quot;
                            else                                     BSp=BasicSalary+(BasicSalary*20/100)                                     BSm=BasicSalary-(BasicSalary*20/100)                                     x=T2.NewRow
                                for r as integer=0 to T.Rows.count-1                                         if(T.Rows(r)(&quot;Sal&quot;)&gt;=BSm AND T.Rows(r)(&quot;Sal&quot;)&lt;=BSp)                                             x= T.Rows(r)                                             T2.ImportRow(x)                                             x=T2.NewRow                                             T2counter=T2counter+1
                                    end
                                    if
                                next
                                If T2counter&lt;2 Then
                                    ReassignFlag=1                                         Status=&quot;Total number of feasible transaction is less than 2 after filtering with +/-5 salary date in AA-BB-Gov II&quot;
                                End If
                            else
                                if T2counter=2                                         min=T2.Rows(0)(&quot;Sal&quot;)+1
                                    For k As Integer = 0 To 1                                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                        If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                            min=T2.Rows(k)(&quot;Sal&quot;)                                                 minimum=T2.Rows(k)(&quot;Amount&quot;)
                                        End If
                                        end
                                        if
                                    next                                         Avg= Sum / 2
                                    If Avg&lt;1.2*min Then
                                        test=3                                             Salary=minimum                                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                    End If
                                else                                             Salary=minimum                                             Other=0
                                    end
                                    if
                                else                                         min=T2.Rows(0)(&quot;Sal&quot;)+1
                                    For k As Integer = 0 To 2                                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                        If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                            min=T2.Rows(k)(&quot;Sal&quot;)                                                 minimum=T2.Rows(k)(&quot;Amount&quot;)
                                        End If
                                        end
                                        if
                                    next                                         Avg= Sum / 3
                                    If Avg&lt;1.2*min Then
                                        test=3                                             Salary=minimum                                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                    End If
                                else                                             Salary=minimum                                             Other=0
                                    end
                                    if
                                end if
                                end
                                if &#x27;===============================================================BB=============================================END
                                else
                                    Dim Count4 as integer=0
                                    Dim Prev as integer =0
                                    Dim Base as Decimal=0
                                    for r as integer=0 to A1.Rows.Count-1
                                        For j as integer=0 to T3.Rows.Count-1
                                            if A1.Rows(r)(&quot;Amount&quot;)=T3.Rows(j)(&quot;Sal&quot;)                                             Count4=Count4+1
                                                end
                                                if
                                            next
                                            if prev&lt;Count4                                         BasicSalary=A1.Rows(r)(&quot;Amount&quot;)                                         prev=Count4
                                                end
                                                if                                     Count4=0
                                                next                                                 x=T.NewRow
                                                For r As Integer = 0 To Buffer.Rows.Count-1                 &#x27;
                                                    If (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3) Then
                                                        if((SD1m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))OR (SD2m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD3m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD3p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))) then                                         x= Buffer.Rows(r)                                         T.ImportRow(x)                                         x=T.NewRow                                         Tcounter=Tcounter+1
                                                    End If
                                                end if
                                            next
                                            if Tcounter&lt;3                                     ReassignFlag=1                                     Status=&quot;Total number of feasible transaction is less than 3 after filtering with +/-5 salary date in AA-BB-Gov III&quot;
                                            else                                     BSp=BasicSalary+(BasicSalary*20/100)                                     BSm=BasicSalary-(BasicSalary*20/100)                                     x=T2.NewRow
                                                for r as integer=0 to T.Rows.count-1                                         if(T.Rows(r)(&quot;Sal&quot;)&gt;=BSm AND T.Rows(r)(&quot;Sal&quot;)&lt;=BSp)                                             x= T.Rows(r)                                             T2.ImportRow(x)                                             x=T2.NewRow                                             T2counter=T2counter+1
                                                    end
                                                    if
                                                next
                                                If T2counter&lt;2 Then
                                                    ReassignFlag=1                                         Status=&quot;Total number of feasible transaction is less than 2 after filtering BSm&lt;= SAL &lt;=BSp in AA-BB-Gov IV&quot;
                                                End If
                                            else
                                                if T2counter=2                                         min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                    For k As Integer = 0 To 1                                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                        If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                            min=T2.Rows(k)(&quot;Sal&quot;)                                                 minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                        End If
                                                        end
                                                        if
                                                    next                                         Avg= Sum / 2
                                                    If Avg&lt;1.2*min Then
                                                        test=4                                             Salary=minimum                                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                    End If
                                                else                                             Salary=minimum                                             Other=0
                                                    end
                                                    if
                                                else                                          min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                    For k As Integer = 0 To 2                                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                        If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                            min=T2.Rows(k)(&quot;Sal&quot;)                                                 minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                        End If
                                                        end
                                                        if
                                                    next                                         Avg= Sum / 3
                                                    If Avg&lt;1.2*min Then
                                                        test=4                                             Salary=minimum                                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                    End If
                                                else                                             Salary=minimum                                             Other=0
                                                    end
                                                    if
                                                end if
                                                end
                                                if
                                                end
                                                if  &#x27;=============================================================AA===================================================    END
                                                    end
                                                    if
                                                else &#x27;==========================================================================B===================================BEGIN
                                                    Dim Sflag as integer =0
                                                    Dim BasicSalary as Integer =0
                                                    Dim T as DataTable =Buffer.Clone
                                                    Dim T2 as DataTable=Buffer.Clone
                                                    Dim Tcounter as integer =0
                                                    Dim T2counter as integer =0
                                                    Dim BSp,BSm as Decimal
                                                    Dim BaseDays as Decimal =0
                                                    Dim Dayz as decimal=0                         Sum=0                         minimum=0                         Salary=0                         Sflag=0                         Other=0                         min=0
                                                    For r As Integer = 0 To Buffer.Rows.Count-1
                                                        If (Buffer.Rows(r)(&quot;Days&quot;)&lt;=TimePeriod) Then
                                                            Sflag=Sflag+1                                 BasicSalary=Buffer.Rows(r)(&quot;Sal&quot;)                                 x=T.NewRow                                 x= Buffer.Rows(r)                                 T.ImportRow(x)                                 Tcounter=1                                 BaseDays=Buffer.Rows(r)(&quot;Days&quot;)
                                                        End If
                                                        end
                                                        if
                                                    Next &#x27;=======================================================================================BB=================================================BEGIN
                                                    If Sflag=1 Then
                                                        x=T.NewRow
                                                    End If
                                                    For r As Integer = 0 To Buffer.Rows.Count-1                                     Dayz=Buffer.Rows(r)(&quot;Days&quot;)                                 Dayz=Dayz-BaseDays
                                                        If ((Dayz&gt;=25 AND Dayz&lt;=35) OR (Dayz&gt;=55 AND Dayz&lt;=65) ) Then
                                                            x= Buffer.Rows(r)                                     T.ImportRow(x)                                     x=T.NewRow                                     Tcounter=Tcounter+1
                                                        End If
                                                    end if
                                                next                             &#x27;testT=Tcounter /checked
                                                if Tcounter&lt;3                                 ReassignFlag=1                                 Status=&quot;Total number of feasible transaction is less than 3 after filtering with 25-35 and 55 to 65 in AA-BB-nonGov II&quot;
                                                else                                 BSp=BasicSalary+(BasicSalary*20/100)                                 BSm=BasicSalary-(BasicSalary*20/100)                                 x=T2.NewRow
                                                    for r as integer=0 to T.Rows.count-1                                     if(T.Rows(r)(&quot;Sal&quot;)&gt;=BSm AND T.Rows(r)(&quot;Sal&quot;)&lt;=BSp)                                         x= T.Rows(r)                                         T2.ImportRow(x)                                         x=T2.NewRow                                         T2counter=T2counter+1
                                                        end
                                                        if
                                                    next
                                                    If T2counter&lt;2 Then
                                                        ReassignFlag=1                                     Status=&quot;Total number of feasible transaction is less than 2 after filtering BSm&lt;=SAL&lt;=BSp BB-non Gov II&quot;
                                                    End If
                                                else
                                                    if T2counter=2
                                                        For k As Integer = 0 To 1                                         Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                            If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                min=T2.Rows(k)(&quot;Sal&quot;)                                             minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                            End If
                                                            end
                                                            if
                                                        next                                      Avg= Sum / 2
                                                        If Avg&lt;1.2*min Then
                                                            Salary=minimum                                         Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                        End If
                                                    else                                          Salary=minimum                                         Other=0
                                                        end
                                                        if
                                                    else                                       min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                        For k As Integer = 0 To 2                                         Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                            If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                min=T2.Rows(k)(&quot;Sal&quot;)                                             minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                            End If
                                                            end
                                                            if
                                                        next                                      Avg= Sum / 3
                                                        If Avg&lt;1.2*min Then
                                                            Salary=minimum                                         Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                        End If
                                                    else                                          Salary=minimum                                         Other=0
                                                        end
                                                        if
                                                    end if
                                                    end
                                                    if                         &#x27;test=T2                         &#x27;testT=Tcounter
                                                    else &#x27;++++++++++++++++++++++AA+++++++++ &#x27;=============================================================AA===================================================BEGIN
                                                        Dim T3 as DataTable=Buffer.Clone
                                                        Dim Tcounter2 as integer=0
                                                        for r as integer =0 to Buffer.Rows.Count-1                                 if(Buffer.Rows(r)(&quot;Sal&quot;)&gt;=LastApproved) then                                     x=T3.NewRow                                     x=Buffer.Rows(r)                                     T3.ImportRow(x)                                     Tcounter2=Tcounter2+1                                     BasicSalary=Buffer.Rows(r)(&quot;Sal&quot;)
                                                            end
                                                            if
                                                        next                                 Buffer=Nothing                             Buffer=T3 &#x27;===============================================================BB=============================================BEGIN                             if(Tcounter2=1)                                 x=T.NewRow
                                                        For r As Integer = 0 To Buffer.Rows.Count-1                                         Dayz=Buffer.Rows(r)(&quot;Days&quot;)                                     Dayz=Dayz-BaseDays
                                                            If ((Dayz&gt;=25 AND Dayz&lt;=35) OR (Dayz&gt;=55 AND Dayz&lt;=65) ) Then
                                                                x= Buffer.Rows(r)                                         T.ImportRow(x)                                         x=T.NewRow                                         Tcounter=Tcounter+1
                                                            End If
                                                        end if
                                                    next                                 &#x27;testT=Tcounter /checked
                                                    if Tcounter&lt;3                                     ReassignFlag=1                                     Status=&quot;Total number of feasible transaction is less than 3 after filtering with 25-35 and 55 to 65 in AA-BB-nonGov III&quot;
                                                    else                                     BSp=BasicSalary+(BasicSalary*20/100)                                     BSm=BasicSalary-(BasicSalary*20/100)                                     x=T2.NewRow
                                                        for r as integer=0 to T.Rows.count-1                                         if(T.Rows(r)(&quot;Sal&quot;)&gt;=BSm AND T.Rows(r)(&quot;Sal&quot;)&lt;=BSp)                                             x= T.Rows(r)                                             T2.ImportRow(x)                                             x=T2.NewRow                                             T2counter=T2counter+1
                                                            end
                                                            if
                                                        next
                                                        If T2counter&lt;2 Then
                                                            ReassignFlag=1                                         Status=&quot;Total number of feasible transaction is less than 2 after filtering BSm&lt;SAL&lt;BSp in AA-BB-nonGov IV&quot;
                                                        End If
                                                    else
                                                        if T2counter=2                                         min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                            For k As Integer = 0 To 1                                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                                If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                    min=T2.Rows(k)(&quot;Sal&quot;)                                                 minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                                End If
                                                                end
                                                                if
                                                            next                                          Avg= Sum / 2
                                                            If Avg&lt;1.2*min Then
                                                                Salary=minimum                                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                            End If
                                                        else                                              Salary=minimum                                             Other=0
                                                            end
                                                            if
                                                        else                                         min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                            For k As Integer = 0 To 2                                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                                If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                    min=T2.Rows(k)(&quot;Sal&quot;)                                                 minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                                End If
                                                                end
                                                                if
                                                            next                                          Avg= Sum / 3
                                                            If Avg&lt;1.2*min Then
                                                                Salary=minimum                                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                            End If
                                                        else                                              Salary=minimum                                             Other=0
                                                            end
                                                            if
                                                        end if
                                                        end
                                                        if  &#x27;===============================================================BB=============================================END
                                                        else
                                                            Dim Count4 as integer=0
                                                            Dim Prev as integer =0
                                                            Dim Base as Decimal=0
                                                            for r as integer=0 to A1.Rows.Count-1
                                                                For j as integer=0 to T3.Rows.Count-1
                                                                    if A1.Rows(r)(&quot;Amount&quot;)=T3.Rows(j)(&quot;Sal&quot;)                                             Count4=Count4+1
                                                                        end
                                                                        if
                                                                    next
                                                                    if prev&lt;Count4                                         BasicSalary=A1.Rows(r)(&quot;Amount&quot;)
                                                                        end
                                                                        if
                                                                    next &#x27;============================================================BB=============================================BEGIN                                             x=T.NewRow
                                                                    For r As Integer = 0 To Buffer.Rows.Count-1                                         Dayz=Buffer.Rows(r)(&quot;Days&quot;)                                     Dayz=Dayz-BaseDays
                                                                        If ((Dayz&gt;=25 AND Dayz&lt;=35) OR (Dayz&gt;=55 AND Dayz&lt;=65) ) Then
                                                                            x= Buffer.Rows(r)                                         T.ImportRow(x)                                         x=T.NewRow                                         Tcounter=Tcounter+1
                                                                        End If
                                                                    end if
                                                                next                                 &#x27;testT=Tcounter /checked
                                                                if Tcounter&lt;3                                     ReassignFlag=1                                     Status=&quot;Total number of feasible transaction is less than 3 after filtering 25-35 and 55-65 in AA-BB-nonGov V&quot;
                                                                else                                     BSp=BasicSalary+(BasicSalary*20/100)                                     BSm=BasicSalary-(BasicSalary*20/100)                                     x=T2.NewRow
                                                                    for r as integer=0 to T.Rows.count-1                                         if(T.Rows(r)(&quot;Sal&quot;)&gt;=BSm AND T.Rows(r)(&quot;Sal&quot;)&lt;=BSp)                                             x= T.Rows(r)                                             T2.ImportRow(x)                                             x=T2.NewRow                                             T2counter=T2counter+1
                                                                        end
                                                                        if
                                                                    next
                                                                    If T2counter&lt;2 Then
                                                                        ReassignFlag=1                                         Status=&quot;Total number of feasible transaction is less than 2 after filtering BSp&lt;=SAL&lt;=BSp in AA-BB-nonGov VI&quot;
                                                                    End If
                                                                else
                                                                    if T2counter=2                                         min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                                        For k As Integer = 0 To 1                                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                                            If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                                min=T2.Rows(k)(&quot;Sal&quot;)                                                 minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                                            End If
                                                                            end
                                                                            if
                                                                        next                                          Avg= Sum / 2
                                                                        If Avg&lt;1.2*min Then
                                                                            Salary=minimum                                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                                        End If
                                                                    else                                              Salary=minimum                                             Other=0
                                                                        end
                                                                        if
                                                                    else                                          min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                                        For k As Integer = 0 To 2                                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                                            If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                                min=T2.Rows(k)(&quot;Sal&quot;)                                                 minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                                            End If
                                                                            end
                                                                            if
                                                                        next                                          Avg= Sum / 3
                                                                        If Avg&lt;1.2*min Then
                                                                            Salary=minimum                                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                                        End If
                                                                    else                                              Salary=minimum                                             Other=0
                                                                        end
                                                                        if
                                                                    end if
                                                                    end
                                                                    if &#x27;===========================================================BB======================================================END
                                                                        end
                                                                        if &#x27;=============================================================AA===================================================    END
                                                                            end
                                                                            if &#x27;==============================================================BB============================================END                      &#x27;==============================================================B=============================================END
                                                                                end
                                                                                if &#x27;^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^Page2^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                                                                    end
                                                                                    if
                                                                                    end
                                                                                    if
                                                                                else             Status=&quot;Salary cannot be identified since there is no transaction in the past &quot;+TimePeriod.ToString+&quot; days&quot;             ReassignFlag=1
                                                                                    end
                                                                                    if
                                                                                else         ReassignFlag=1         Status=&quot;Total number of feasible transaction is less than 3&quot;
                                                                                    end
                                                                                    if
                                                                                else
                                                                                    Dim SD1p,SD1m,SD2p,SD2m,SD3p,SD3m,SD4p,SD4m as date
                                                                                    Dim Sflag as integer =0
                                                                                    Dim Salflag as integer =0
                                                                                    Dim Lflag as integer =0
                                                                                    Dim L2flag as integer =0
                                                                                    Dim LLcheck as integer =0
                                                                                    Dim BasicSalary as Integer =0
                                                                                    Dim T as DataTable =Buffer.Clone
                                                                                    Dim T2 as DataTable=Buffer.Clone
                                                                                    Dim TX as DataTable=Buffer.Clone
                                                                                    Dim LL as DataTable=Buffer.Clone
                                                                                    Dim LL1 as DataTable=Buffer.Clone
                                                                                    Dim L2 as DataTable=Buffer.Clone
                                                                                    Dim L21 as DataTable=Buffer.Clone
                                                                                    Dim L3 as DataTable=Buffer.Clone
                                                                                    Dim Tcounter as integer =0
                                                                                    Dim L3counter as integer =0
                                                                                    Dim T2counter as integer =0
                                                                                    Dim BSp,BSm as Decimal          Sum=0         minimum=0         Salary=0         Other=0         min=0         SD1p=SD1.AddDays(5)         SD1m=SD1.AddDays(-5)         SD2p=SD2.AddDays(5)         SD2m=SD2.AddDays(-5)         SD3p=SD3.AddDays(5)         SD3m=SD3.AddDays(-5)         SD4p=SD4.AddDays(5)         SD4m=SD4.AddDays(-5)         &#x27;        T=Buffer.Clone
                                                                                    For r As Integer = 0 To Buffer.Rows.Count-1         &#x27;
                                                                                        If (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3) Then
                                                                                            if((SD1m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))OR (SD2m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD3m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD3p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD4m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD4p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))) then                 x= Buffer.Rows(r)                 TX.ImportRow(x)                 x=TX.NewRow
                                                                                        End If
                                                                                    end if
                                                                                next         Buffer=TX
                                                                                For r As Integer = 0 To Buffer.Rows.Count-1         &#x27;
                                                                                    If (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3) Then
                                                                                        if(SD1m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) then                 x= Buffer.Rows(r)                 LL.ImportRow(x)                 x=LL.NewRow                 Lflag=Lflag+1
                                                                                    End If
                                                                                end if
                                                                            next
                                                                            If Lflag&lt;1 Then
                                                                                Lflag=0             x=LL1.NewRow
                                                                            End If
                                                                            For r As Integer = 0 To Buffer.Rows.Count-1                 if(SD1=Buffer.Rows(r)(&quot;Account date&quot;)) then                     x= Buffer.Rows(r)                     LL1.ImportRow(x)                     x=LL1.NewRow                     Lflag=Lflag+1
                                                                            end if
                                                                        next             LL=LL1
                                                                        end
                                                                        if          LLout=LL &#x27;+++++++++++++++++++++++++++
                                                                            If Lflag&gt;0 Then
                                                                                &#x27;+++++++++++++++++++++++++++
                                                                            End If
                                                                            if Lflag=1 then
                                                                                For r As Integer = 0 To Buffer.Rows.Count-1                     if(SD2m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) then                         x= Buffer.Rows(r)                         L2.ImportRow(x)                         x=L2.NewRow                         L2flag=L2flag+1
                                                                                end if
                                                                            next
                                                                            If L2flag&gt;0 Then
                                                                                test=101
                                                                            End If
                                                                            If L2flag=1 Then
                                                                                test=120
                                                                            End If
                                                                            If L2.Rows(0)(&quot;Sal&quot;)&gt;=LL.Rows(0)(&quot;Sal&quot;) Then
                                                                                salflag=1                             Salary=LL.Rows(0)(&quot;Amount&quot;)                             ReassignFlag=0         test=100
                                                                            End If
                                                                        else                             x=L3.NewRow
                                                                            For r As Integer = 0 To Buffer.Rows.Count-1                                 if((SD1m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD2m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD3m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD3p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD4m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD4p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))) then                                     x= Buffer.Rows(r)                                     L3.ImportRow(x)                                     x=L3.NewRow                                     L3counter=L3counter+1
                                                                            end if
                                                                        next
                                                                        If L3counter&gt;2 Then
                                                                            min=L3.Rows(0)(&quot;Sal&quot;)+1
                                                                        End If
                                                                        For k As Integer = 0 To 2                                     Sum=Sum+L3.Rows(k)(&quot;Sal&quot;)
                                                                            If min&gt;L3.Rows(k)(&quot;Sal&quot;) Then
                                                                                min=L3.Rows(k)(&quot;Sal&quot;)                                         minimum=L3.Rows(k)(&quot;Amount&quot;)
                                                                            End If
                                                                            end
                                                                            if
                                                                        next                                  Avg=Sum/3
                                                                        If Avg&lt;1.2*min Then
                                                                            Salary=minimum                                     Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)                                     salflag=1
                                                                        End If
                                                                    else                                     salflag=0
                                                                        end
                                                                        if
                                                                    else                                         salflag=0
                                                                        end
                                                                        if
                                                                        end
                                                                        if
                                                                    else test=110                         L2flag=0                         x=L21.NewRow
                                                                        For r As Integer = 0 To Buffer.Rows.Count-1                             if(SD2=Buffer.Rows(r)(&quot;Account date&quot;)) then                                 x= Buffer.Rows(r)                                 L21.ImportRow(x)                                 x=L21.NewRow                                 L2flag=L2flag+1
                                                                        end if
                                                                    next                         L2=L21
                                                                    if L2flag=1 then
                                                                        If L2.Rows(0)(&quot;Sal&quot;)&gt;=LL.Rows(0)(&quot;Sal&quot;) Then
                                                                            salflag=1                                 Salary=LL.Rows(0)(&quot;Amount&quot;)                                 ReassignFlag=0
                                                                        End If
                                                                        end
                                                                        if
                                                                        end
                                                                        if
                                                                        end
                                                                        if
                                                                        If salflag=0 Then
                                                                            &#x27;test=102 &#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;                         Sum=0
                                                                        End If
                                                                        For r As Integer = 0 To Buffer.Rows.Count-1                         &#x27;
                                                                            if (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1) then
                                                                                If (SD1m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) Then
                                                                                    Sflag=Sflag+1                                 BasicSalary=Buffer.Rows(r)(&quot;Sal&quot;)                                 &#x27;AM=BasicSalary
                                                                                End If
                                                                                end
                                                                                if
                                                                            Next                         &#x27;AM=BasicSalary
                                                                            If Sflag=1 Then
                                                                                x=T.NewRow
                                                                            End If
                                                                            For r As Integer = 0 To Buffer.Rows.Count-1                         &#x27;
                                                                                If (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3) Then
                                                                                    if((SD1m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD2m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD3m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD3p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD4m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD4p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))) then                                     x= Buffer.Rows(r)                                     T.ImportRow(x)                                     x=T.NewRow                                     Tcounter=Tcounter+1
                                                                                End If
                                                                            end if
                                                                        next
                                                                        if Tcounter&lt;2                                 ReassignFlag=1                                 Status=&quot;Total number of feasible transaction is less than 2 after filtering with +/-5 salary date I&quot;
                                                                        else                                 BSp=BasicSalary+(BasicSalary*20/100)                                 BSm=BasicSalary-(BasicSalary*20/100)                                 x=T2.NewRow
                                                                            for r as integer=0 to T.Rows.count-1                                     if(T.Rows(r)(&quot;Sal&quot;)&gt;=BSm AND T.Rows(r)(&quot;Sal&quot;)&lt;=BSp)                                         x= T.Rows(r)                                         T2.ImportRow(x)                                         x=T2.NewRow                                         T2counter=T2counter+1
                                                                                end
                                                                                if
                                                                            next
                                                                            If T2counter&lt;2 Then
                                                                                ReassignFlag=1                                     Status=&quot;Total number of feasible transaction is less than 2 after filtering BSm &lt;= Salary &lt;=BSp&quot;
                                                                            End If
                                                                        else
                                                                            if T2counter=2                                     min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                                                For k As Integer = 0 To 1                                         Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                                                    If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                                        min=T2.Rows(k)(&quot;Sal&quot;)                                             minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                                                    End If
                                                                                    end
                                                                                    if
                                                                                next                                     Avg= Sum / 2
                                                                                If Avg&lt;1.2*min Then
                                                                                    test=2                 &#x27;
                                                                                End If
                                                                                For r As Integer = 0 To LL.Rows.Count-1                 &#x27;                            if(LL.Rows(r)(&quot;Sal&quot;)&gt;=Avg*0.65) then                 &#x27;
                                                                                    If LLcheck=0 Then
                                                                                        &#x27;                                    LLcheck=1                 &#x27;                                    if(Math.Floor(LL.Rows(r)(&quot;Sal&quot;))&lt;=Avg) then                 &#x27;                                        Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                    End If
                                                                                else if(LL.Rows(r)(&quot;Sal&quot;)&lt;=Avg*1.2) then                 &#x27;                                        Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                else                     &#x27;                                        ReassignFlag=1                 &#x27;                                        Status=&quot;Salary not identified sincee one transaction in last month is grater than selected salary&quot;                 &#x27;
                                                                                    end
                                                                                    if                 &#x27;
                                                                                    else                  &#x27;                                    ReassignFlag=1                 &#x27;                                    Status=&quot;More than one transaction is grater then 65% of selected salary&quot;                 &#x27;
                                                                                        end
                                                                                        if                 &#x27;
                                                                                        end if                     &#x27;
                                                                                    next                                         Salary=minimum                                         Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                                                else                 &#x27;
                                                                                    For r As Integer = 0 To LL.Rows.Count-1                 &#x27;                            if(LL.Rows(r)(&quot;Sal&quot;)&gt;=min*0.65) then                 &#x27;
                                                                                        If LLcheck=0 Then
                                                                                            &#x27;                                    LLcheck=1                 &#x27;                                    if(Math.Floor(LL.Rows(r)(&quot;Sal&quot;))&lt;=min) then                 &#x27;                                        Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                        End If
                                                                                    else if(LL.Rows(r)(&quot;Sal&quot;)&lt;min*1.2) then                 &#x27;                                        Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                    else                 &#x27;                                        ReassignFlag=1                 &#x27;                                        Status=&quot;Salary not identified sincee one transaction in last month is grater than selected salary&quot;                 &#x27;
                                                                                        end
                                                                                        if                 &#x27;
                                                                                        else                  &#x27;                                    ReassignFlag=1                 &#x27;                                    Status=&quot;More than one transaction is grater then 65% of selected salary&quot;                 &#x27;
                                                                                            end
                                                                                            if                 &#x27;
                                                                                            end if                     &#x27;
                                                                                        next                 test=2.1                                         Salary=minimum
                                                                                        end
                                                                                        if
                                                                                    else                                     min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                                                        For k As Integer = 0 To 2                                         Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                                                            If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                                                min=T2.Rows(k)(&quot;Sal&quot;)                                             minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                                                            End If
                                                                                            end
                                                                                            if
                                                                                        next                                     Avg= Sum / 3
                                                                                        If Avg&lt;1.2*min Then
                                                                                            test=2                 &#x27;
                                                                                        End If
                                                                                        For r As Integer = 0 To LL.Rows.Count-1                 &#x27;                            if(LL.Rows(r)(&quot;Sal&quot;)&gt;=Avg*0.65) then                 &#x27;
                                                                                            If LLcheck=0 Then
                                                                                                &#x27;                                    LLcheck=1                 &#x27;                                    if(Math.Floor(LL.Rows(r)(&quot;Sal&quot;))&lt;=Avg) then                 &#x27;                                        Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                            End If
                                                                                        else if(LL.Rows(r)(&quot;Sal&quot;)&lt;Avg*1.2) then                 &#x27;                                        Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                        else                 &#x27;er=Avg                 &#x27;Buffer=T2                 &#x27;                                        ReassignFlag=1                 &#x27;                                        Status=&quot;Salary not identified sincee one transaction in last month is grater than selected salary&quot;                 &#x27;
                                                                                            end
                                                                                            if                 &#x27;
                                                                                            else                  &#x27;                                    ReassignFlag=1                 &#x27;                                    Status=&quot;More than one transaction is grater then 65% of selected salary&quot;                 &#x27;
                                                                                                end
                                                                                                if                 &#x27;
                                                                                                end if                     &#x27;
                                                                                            next                                         Salary=minimum                                         Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                                                        else                 &#x27;
                                                                                            For r As Integer = 0 To LL.Rows.Count-1                 &#x27;                            if(LL.Rows(r)(&quot;Sal&quot;)&gt;=min*0.65) then                 &#x27;
                                                                                                If LLcheck=0 Then
                                                                                                    &#x27;                                    LLcheck=1                 &#x27;                                    if(Math.Floor(LL.Rows(r)(&quot;Sal&quot;))&lt;=min) then                 &#x27;                                        Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                                End If
                                                                                            else if(LL.Rows(r)(&quot;Sal&quot;)&lt;=min*1.2) then                 &#x27;                                        Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                            else                 &#x27;                                        ReassignFlag=1                 &#x27;                                        Status=&quot;Salary not identified sincee one transaction in last month is grater than selected salary&quot;                 &#x27;
                                                                                                end
                                                                                                if                 &#x27;
                                                                                                else                  &#x27;                                    ReassignFlag=1                 &#x27;                                    Status=&quot;More than one transaction is grater then 65% of selected salary&quot;                 &#x27;
                                                                                                    end
                                                                                                    if                 &#x27;
                                                                                                    end if                     &#x27;
                                                                                                next                 test=2.1                                         Salary=minimum
                                                                                                end
                                                                                                if
                                                                                            end if
                                                                                            end
                                                                                            if                         &#x27;    test=T                         &#x27;    testT=Tcounter
                                                                                            else &#x27;=============================================================AA===================================================BEGIN
                                                                                                Dim T3 as DataTable=Buffer.Clone
                                                                                                Dim Tcounter2 as integer=0
                                                                                                for r as integer =0 to Buffer.Rows.Count-1                                 if(Buffer.Rows(r)(&quot;Sal&quot;)&gt;=LastApproved) then                                     x=T3.NewRow                                     x=Buffer.Rows(r)                                     T3.ImportRow(x)                                     Tcounter2=Tcounter2+1                                     BasicSalary=Buffer.Rows(r)(&quot;Sal&quot;)
                                                                                                    end
                                                                                                    if
                                                                                                next                             &#x27;    Buffer=Nothing                         &#x27;    Buffer=T3                             Cop=Buffer &#x27;===============================================================BB=============================================BEGIN                             if(Tcounter2=1)                                 x=T.NewRow
                                                                                                For r As Integer = 0 To Buffer.Rows.Count-1                         &#x27;
                                                                                                    If (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3) Then
                                                                                                        if((SD1m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))OR (SD2m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD3m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD3p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD4m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD4p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))) then                                         x= Buffer.Rows(r)                                         T.ImportRow(x)                                         x=T.NewRow                                         Tcounter=Tcounter+1
                                                                                                    End If
                                                                                                end if
                                                                                            next
                                                                                            if Tcounter&lt;2                                     ReassignFlag=1                                     Status=&quot;Total number of feasible transaction is less than 2 after filtering with +/-5 salary date in AA-BB-Gov I&quot;
                                                                                            else                                     BSp=BasicSalary+(BasicSalary*20/100)                                     BSm=BasicSalary-(BasicSalary*20/100)                                     x=T2.NewRow
                                                                                                for r as integer=0 to T.Rows.count-1                                         if(T.Rows(r)(&quot;Sal&quot;)&gt;=BSm AND T.Rows(r)(&quot;Sal&quot;)&lt;=BSp)                                             x= T.Rows(r)                                             T2.ImportRow(x)                                             x=T2.NewRow                                             T2counter=T2counter+1
                                                                                                    end
                                                                                                    if
                                                                                                next
                                                                                                If T2counter&lt;2 Then
                                                                                                    ReassignFlag=1                                         Status=&quot;Total number of feasible transaction is less than 2 after filtering with +/-5 salary date in AA-BB-Gov II&quot;
                                                                                                End If
                                                                                            else
                                                                                                if T2counter=2                                         min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                                                                    For k As Integer = 0 To 1                                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                                                                        If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                                                            min=T2.Rows(k)(&quot;Sal&quot;)                                                 minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                                                                        End If
                                                                                                        end
                                                                                                        if
                                                                                                    next                                         Avg= Sum / 2
                                                                                                    If Avg&lt;1.2*min Then
                                                                                                        test=3                 &#x27;
                                                                                                    End If
                                                                                                    For r As Integer = 0 To LL.Rows.Count-1                 &#x27;                                if(LL.Rows(r)(&quot;Sal&quot;)&gt;=Avg*0.65) then                 &#x27;
                                                                                                        If LLcheck=0 Then
                                                                                                            &#x27;                                        LLcheck=1                 &#x27;                                        if(Math.Floor(LL.Rows(r)(&quot;Sal&quot;))&lt;=Avg) then                 &#x27;                                            Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                                        End If
                                                                                                    else if(LL.Rows(r)(&quot;Sal&quot;)&lt;=Avg*1.2) then                 &#x27;                                            Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                                    else                 &#x27;                                            ReassignFlag=1                 &#x27;                                            Status=&quot;Salary not identified sincee one transaction in last month is grater than selected salary&quot;                 &#x27;
                                                                                                        end
                                                                                                        if                 &#x27;
                                                                                                        else                  &#x27;                                        ReassignFlag=1                 &#x27;                                        Status=&quot;More than one transaction is grater then 65% of selected salary&quot;                 &#x27;
                                                                                                            end
                                                                                                            if                 &#x27;
                                                                                                            end if                     &#x27;
                                                                                                        next                                             Salary=minimum                                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                                                                    else                 &#x27;
                                                                                                        For r As Integer = 0 To LL.Rows.Count-1                 &#x27;                                if(LL.Rows(r)(&quot;Sal&quot;)&gt;=min*0.65) then                 &#x27;
                                                                                                            If LLcheck=0 Then
                                                                                                                &#x27;                                        LLcheck=1                 &#x27;                                        if(Math.Floor(LL.Rows(r)(&quot;Sal&quot;))&lt;=min) then                 &#x27;                                            Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                                            End If
                                                                                                        else if(LL.Rows(r)(&quot;Sal&quot;)&lt;=min*1.2) then                 &#x27;                                            Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                                        else                 &#x27;                                            ReassignFlag=1                 &#x27;                                            Status=&quot;Salary not identified sincee one transaction in last month is grater than selected salary&quot;                 &#x27;
                                                                                                            end
                                                                                                            if                 &#x27;
                                                                                                            else                  &#x27;                                        ReassignFlag=1                 &#x27;                                        Status=&quot;More than one transaction is grater then 65% of selected salary&quot;                 &#x27;
                                                                                                                end
                                                                                                                if                 &#x27;
                                                                                                                end if                     &#x27;
                                                                                                            next                 test=3.1                                             Salary=minimum
                                                                                                            end
                                                                                                            if
                                                                                                        else                                         min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                                                                            For k As Integer = 0 To 2                                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                                                                                If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                                                                    min=T2.Rows(k)(&quot;Sal&quot;)                                                 minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                                                                                End If
                                                                                                                end
                                                                                                                if
                                                                                                            next                                         Avg= Sum / 3
                                                                                                            If Avg&lt;1.2*min Then
                                                                                                                test=3                 &#x27;
                                                                                                            End If
                                                                                                            For r As Integer = 0 To LL.Rows.Count-1                 &#x27;                                if(LL.Rows(r)(&quot;Sal&quot;)&gt;=Avg*0.65) then                 &#x27;
                                                                                                                If LLcheck=0 Then
                                                                                                                    &#x27;                                        LLcheck=1                 &#x27;                                        if(Math.Floor(LL.Rows(r)(&quot;Sal&quot;))&lt;=Avg) then                 &#x27;                                            Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                                                End If
                                                                                                            else if(LL.Rows(r)(&quot;Sal&quot;)&lt;=Avg*1.2) then                 &#x27;                                            Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                                            else                 &#x27;                                            ReassignFlag=1                 &#x27;                                            Status=&quot;Salary not identified sincee one transaction in last month is grater than selected salary&quot;                 &#x27;
                                                                                                                end
                                                                                                                if                 &#x27;
                                                                                                                else                  &#x27;                                        ReassignFlag=1                 &#x27;                                        Status=&quot;More than one transaction is grater then 65% of selected salary&quot;                 &#x27;
                                                                                                                    end
                                                                                                                    if                 &#x27;
                                                                                                                    end if                     &#x27;
                                                                                                                next                                             Salary=minimum                                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                                                                            else                 &#x27;
                                                                                                                For r As Integer = 0 To LL.Rows.Count-1                 &#x27;                                if(LL.Rows(r)(&quot;Sal&quot;)&gt;=min*0.65) then                 &#x27;
                                                                                                                    If LLcheck=0 Then
                                                                                                                        &#x27;                                        LLcheck=1                 &#x27;                                        if(Math.Floor(LL.Rows(r)(&quot;Sal&quot;))&lt;=min) then                 &#x27;                                            Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                                                    End If
                                                                                                                else if(LL.Rows(r)(&quot;Sal&quot;)&lt;=min*1.2) then                 &#x27;                                            Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                                                else                 &#x27;                                            ReassignFlag=1                 &#x27;                                            Status=&quot;Salary not identified since one transaction in last month is grater than selected salary&quot;                 &#x27;
                                                                                                                    end
                                                                                                                    if                 &#x27;
                                                                                                                    else                  &#x27;                                        ReassignFlag=1                 &#x27;                                        Status=&quot;More than one transaction is grater then 65% of selected salary&quot;                 &#x27;
                                                                                                                        end
                                                                                                                        if                 &#x27;
                                                                                                                        end if                     &#x27;
                                                                                                                    next                 test=3.1                                             Salary=minimum
                                                                                                                    end
                                                                                                                    if
                                                                                                                end if
                                                                                                                end
                                                                                                                if &#x27;===============================================================BB=============================================END
                                                                                                                else
                                                                                                                    Dim Count4 as integer=0
                                                                                                                    Dim Prev as integer =0
                                                                                                                    Dim Base as Decimal=0
                                                                                                                    for r as integer=0 to A1.Rows.Count-1
                                                                                                                        For j as integer=0 to T3.Rows.Count-1
                                                                                                                            if A1.Rows(r)(&quot;Amount&quot;)=T3.Rows(j)(&quot;Sal&quot;)                                             Count4=Count4+1
                                                                                                                                end
                                                                                                                                if
                                                                                                                            next
                                                                                                                            if prev&lt;Count4                                         BasicSalary=A1.Rows(r)(&quot;Amount&quot;)                                         prev=Count4
                                                                                                                                end
                                                                                                                                if                                     Count4=0
                                                                                                                                next                                                 x=T.NewRow
                                                                                                                                For r As Integer = 0 To Buffer.Rows.Count-1                         &#x27;
                                                                                                                                    If (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3) Then
                                                                                                                                        if((SD1m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))OR (SD2m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD3m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD3p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD4m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD4p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))) then                                         x= Buffer.Rows(r)                                         T.ImportRow(x)                                         x=T.NewRow                                         Tcounter=Tcounter+1
                                                                                                                                    End If
                                                                                                                                end if
                                                                                                                            next
                                                                                                                            if Tcounter&lt;2                                     ReassignFlag=1                                     Status=&quot;Total number of feasible transaction is less than 2 after filtering with +/-5 salary date in AA-BB-Gov III&quot;
                                                                                                                            else                                     BSp=BasicSalary+(BasicSalary*20/100)                                     BSm=BasicSalary-(BasicSalary*20/100)                                     x=T2.NewRow
                                                                                                                                for r as integer=0 to T.Rows.count-1                                         if(T.Rows(r)(&quot;Sal&quot;)&gt;=BSm AND T.Rows(r)(&quot;Sal&quot;)&lt;=BSp)                                             x= T.Rows(r)                                             T2.ImportRow(x)                                             x=T2.NewRow                                             T2counter=T2counter+1
                                                                                                                                    end
                                                                                                                                    if
                                                                                                                                next
                                                                                                                                If T2counter&lt;2 Then
                                                                                                                                    ReassignFlag=1                                         Status=&quot;Total number of feasible transaction is less than 2 after filtering BSm&lt;= SAL &lt;=BSp in AA-BB-Gov IV&quot;
                                                                                                                                End If
                                                                                                                            else
                                                                                                                                if T2counter=2                                         min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                                                                                                    For k As Integer = 0 To 1                                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                                                                                                        If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                                                                                            min=T2.Rows(k)(&quot;Sal&quot;)                                                 minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                                                                                                        End If
                                                                                                                                        end
                                                                                                                                        if
                                                                                                                                    next                                         Avg= Sum / 2
                                                                                                                                    If Avg&lt;1.2*min Then
                                                                                                                                        test=4                 &#x27;
                                                                                                                                    End If
                                                                                                                                    For r As Integer = 0 To LL.Rows.Count-1                 &#x27;                                if(LL.Rows(r)(&quot;Sal&quot;)&gt;=Avg*0.65) then                 &#x27;
                                                                                                                                        If LLcheck=0 Then
                                                                                                                                            &#x27;                                        LLcheck=1                 &#x27;                                        if(Math.Floor(LL.Rows(r)(&quot;Sal&quot;))&lt;=Avg) then                 &#x27;                                            Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                                                                        End If
                                                                                                                                    else if(LL.Rows(r)(&quot;Sal&quot;)&lt;=Avg*1.2) then                 &#x27;                                            Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                                                                    else                 &#x27;                                            ReassignFlag=1                 &#x27;                                            Status=&quot;Salary not identified sincee one transaction in last month is grater than selected salary&quot;                 &#x27;
                                                                                                                                        end
                                                                                                                                        if                 &#x27;
                                                                                                                                        else                  &#x27;                                        ReassignFlag=1                 &#x27;                                        Status=&quot;More than one transaction is grater then 65% of selected salary&quot;                 &#x27;
                                                                                                                                            end
                                                                                                                                            if                 &#x27;
                                                                                                                                            end if                     &#x27;
                                                                                                                                        next                                             Salary=minimum                                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                                                                                                    else                 &#x27;
                                                                                                                                        For r As Integer = 0 To LL.Rows.Count-1                 &#x27;                                if(LL.Rows(r)(&quot;Sal&quot;)&gt;=min*0.65) then                 &#x27;
                                                                                                                                            If LLcheck=0 Then
                                                                                                                                                &#x27;                                        LLcheck=1                 &#x27;                                        if(Math.Floor(LL.Rows(r)(&quot;Sal&quot;))&lt;=min) then                 &#x27;                                            Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                                                                            End If
                                                                                                                                        else if(LL.Rows(r)(&quot;Sal&quot;)&lt;=min*1.2) then                 &#x27;                                            Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                                                                        else                 &#x27;                                            ReassignFlag=1                 &#x27;                                            Status=&quot;Salary not identified sincee one transaction in last month is grater than selected salary&quot;                 &#x27;
                                                                                                                                            end
                                                                                                                                            if                 &#x27;
                                                                                                                                            else                  &#x27;                                        ReassignFlag=1                 &#x27;                                        Status=&quot;More than one transaction is grater then 65% of selected salary&quot;                 &#x27;
                                                                                                                                                end
                                                                                                                                                if                 &#x27;
                                                                                                                                                end if                     &#x27;
                                                                                                                                            next                 test=4.1                                             Salary=minimum
                                                                                                                                            end
                                                                                                                                            if
                                                                                                                                        else                                          min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                                                                                                            For k As Integer = 0 To 2                                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                                                                                                                If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                                                                                                    min=T2.Rows(k)(&quot;Sal&quot;)                                                 minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                                                                                                                End If
                                                                                                                                                end
                                                                                                                                                if
                                                                                                                                            next                                         Avg= Sum / 3
                                                                                                                                            If Avg&lt;1.2*min Then
                                                                                                                                                test=4                 &#x27;
                                                                                                                                            End If
                                                                                                                                            For r As Integer = 0 To LL.Rows.Count-1                 &#x27;                                if(LL.Rows(r)(&quot;Sal&quot;)&gt;=Avg*0.65) then                 &#x27;
                                                                                                                                                If LLcheck=0 Then
                                                                                                                                                    &#x27;                                        LLcheck=1                 &#x27;                                        if(Math.Floor(LL.Rows(r)(&quot;Sal&quot;))&lt;=Avg) then                 &#x27;                                            Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                                                                                End If
                                                                                                                                            else if(LL.Rows(r)(&quot;Sal&quot;)&lt;=Avg*1.2) then                 &#x27;                                            Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                                                                            else                 &#x27;                                            ReassignFlag=1                 &#x27;                                            Status=&quot;Salary not identified sincee one transaction in last month is grater than selected salary&quot;                 &#x27;
                                                                                                                                                end
                                                                                                                                                if                 &#x27;
                                                                                                                                                else                  &#x27;                                        ReassignFlag=1                 &#x27;                                        Status=&quot;More than one transaction is grater then 65% of selected salary&quot;                 &#x27;
                                                                                                                                                    end
                                                                                                                                                    if                 &#x27;
                                                                                                                                                    end if                     &#x27;
                                                                                                                                                next                                             Salary=minimum                                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                                                                                                            else                 &#x27;
                                                                                                                                                For r As Integer = 0 To LL.Rows.Count-1                 &#x27;                                if(LL.Rows(r)(&quot;Sal&quot;)&gt;=min*0.65) then                 &#x27;
                                                                                                                                                    If LLcheck=0 Then
                                                                                                                                                        &#x27;                                        LLcheck=1                 &#x27;                                        if(Math.Floor(LL.Rows(r)(&quot;Sal&quot;))&lt;=min) then                 &#x27;                                            Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                                                                                    End If
                                                                                                                                                else if(LL.Rows(r)(&quot;Sal&quot;)&lt;=min*1.2) then                 &#x27;                                            Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                                                                                else                 &#x27;                                            ReassignFlag=1                 &#x27;                                            Status=&quot;Salary not identified sincee one transaction in last month is grater than selected salary&quot;                 &#x27;
                                                                                                                                                    end
                                                                                                                                                    if                 &#x27;
                                                                                                                                                    else                  &#x27;                                        ReassignFlag=1                 &#x27;                                        Status=&quot;More than one transaction is grater then 65% of selected salary&quot;                 &#x27;
                                                                                                                                                        end
                                                                                                                                                        if                 &#x27;
                                                                                                                                                        end if                     &#x27;
                                                                                                                                                    next                 test=4.1                                             Salary=minimum
                                                                                                                                                    end
                                                                                                                                                    if
                                                                                                                                                end if
                                                                                                                                                end
                                                                                                                                                if
                                                                                                                                                end
                                                                                                                                                if
                                                                                                                                                end
                                                                                                                                                if
                                                                                                                                                end
                                                                                                                                                if                     &#x27;
                                                                                                                                                    end
                                                                                                                                                    if &#x27;=============================================================AA===================================================    END
                                                                                                                                                    else                      ReassignFlag=1                     Status=&quot;No transaction available in 2nd last month&quot;
                                                                                                                                                        end
                                                                                                                                                        if
                                                                                                                                                    else                  Status=&quot;More than one transaction in +/-5 days of last month salary date&quot;                 ReassignFlag=1
                                                                                                                                                        end
                                                                                                                                                        if
                                                                                                                                                    else             Status=&quot;No transaction in of last salary date&quot;             ReassignFlag=1
                                                                                                                                                        end
                                                                                                                                                        if
                                                                                                                                                        end
                                                                                                                                                        if
                                                                                                                                                    else      Status=&quot;Total number of feasible transaction is less than 3&quot;     ReassignFlag=1
                                                                                                                                                        end
                                                                                                                                                        if D0=D1 A0=A1
                                                                                                                                                        catch e as Exception         er=e.ToString         ReassignFlag=1         Status=&quot;Code Error:&quot;+e.ToString
                                                                                                                                                            end
                                                                                                                                                            try"
                            data-title="UWCA_MRCC_CTF_V1.0 / Salary code / Salary Calculation(new)13 new 17 jan2">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>UWCA_MRCC_CTF_V1.0</td>
                <td>Salary code</td>
                <td>Salary Calculation(new)13 new 17 jan2017</td>
                <td>visualbasic</td>
                <td>946</td>
                <!--<td style="font-family: monospace;">e90dfdbab1e292c3a1bc1bf8e42604d96f6ceccef0a548ce4800ef7e0739d36f</td>-->
                <td>—</td>
                <!--<td>try     Dim description as string     Dim x As DataRow = D1.NewRow     Dim Dflag as integer =0     Dim precount as integer =0     Dim Amount as integer =0     Dim Avg as Decimal=0     Dim Sum as integer =0     Dim skip as integer =0     Dim min as integer =0     Dim count as integer =0     Dim Av as...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="try
    Dim description as string
    Dim x As DataRow = D1.NewRow
    Dim Dflag as integer =0
    Dim precount as integer =0
    Dim Amount as integer =0
    Dim Avg as Decimal=0
    Dim Sum as integer =0
    Dim skip as integer =0
    Dim min as integer =0
    Dim count as integer =0
    Dim Av as integer =0
    Dim mi as integer =0
    Dim minim as string min=0 count=0 minim=&quot;&quot;
    if c1.Rows.Count&gt;2 then
        For r As Integer = 0 To c1.Rows.Count-1         description=c1.Rows(r)(&quot;Description&quot;)         Dflag=0
            for i as integer=0 To D1.Rows.Count-1
                If D1.Rows(i)(&quot;Description&quot;)=description Then
                    Dflag=1                 D1.Rows(i)(&quot;Count&quot;)=D1.Rows(i)(&quot;Count&quot;)+1
                End If
                end
                if
            next
            If Dflag=0 Then
                x(&quot;Description&quot;) = description             x(&quot;Count&quot;)=1             D1.Rows.Add(x)             x= D1.NewRow
            End If
            end
            if
        Next
        For r As Integer = 0 To D1.Rows.Count-1         description=D1.Rows(r)(&quot;Description&quot;)         CollOut=Nothing         CollOut=c1.Clone
            For Each parentRow As DataRow In c1.Select(&quot;Description=&#x27;&quot;+description+&quot;&#x27;&quot;)             x = CollOut.NewRow
                For Each c As DataColumn In x.Table.Columns                     x(c.ColumnName) = parentRow(c.ColumnName)
                Next             CollOut.Rows.Add(x)
            Next         count=CollOut.Rows.Count
            If count&gt;precount Then
                Buffer=Nothing             Buffer = CollOut.Clone             Buffer=CollOut             precount=count             ReassignFlag=0
            End If
        else
            if count = Precount             ReassignFlag=1             Status=&quot;Salary cannot be identified since there mode are equal&quot;
                end
                if
            next &#x27;+++++++++++++++++++++++++
            If Govt= False AND EF= False Then
                &#x27;+++++++++++++++++++++++++
            End If
            If Buffer.Rows.Count &gt;2 Then
                ReassignFlag=0
            End If
            if ReassignFlag=0             ReassignFlag=1
                For r As Integer = 0 To Buffer.Rows.Count-1
                    If Buffer.Rows(r)(&quot;Days&quot;)&lt;=TimePeriod Then
                        ReassignFlag=0
                    End If
                    exit
                    for
                    end
                    if
                next
                end
                if
                if ReassignFlag=0             Status=&quot;&quot;
                    For r As Integer = 0 To Buffer.Rows.Count-1                 Amount=Buffer.Rows(r)(&quot;Sal&quot;)                 Dflag=0
                        for i as integer=0 To A1.Rows.Count-1
                            If A1.Rows(i)(&quot;Amount&quot;)=Amount Then
                                Dflag=1                         A1.Rows(i)(&quot;Count&quot;)=A1.Rows(i)(&quot;Count&quot;)+1
                            End If
                            end
                            if
                        next
                        If Dflag=0 Then
                            x= A1.NewRow                     x(&quot;Amount&quot;) = Amount                     x(&quot;Count&quot;)=1                     x(&quot;Salary&quot;)=Buffer.Rows(r)(&quot;Amount&quot;)                     A1.Rows.Add(x)
                        End If
                        end
                        if
                    Next             min=Buffer.Rows(0)(&quot;Sal&quot;)+1
                    For k As Integer = 0 To 2                 Sum=Sum+Buffer.Rows(k)(&quot;Sal&quot;)
                        If min&gt;Buffer.Rows(k)(&quot;Sal&quot;) Then
                            min=Buffer.Rows(k)(&quot;Sal&quot;)                     minimum=Buffer.Rows(k)(&quot;Amount&quot;)
                        End If
                        end
                        if
                        if k=1                     Av=Sum/2                     mi=min                     minim=minimum
                            end
                            if
                        next             Avg= Sum / 3
                        If Avg&lt;1.2*min Then
                            test=1 Cop=A1                 Salary=minimum                 Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                        End If
                    else
                        If Av&lt;1.2*mi Then
                            minimum=minim                 Salary=minimum                 Other=Replace((Av-mi),&quot;.&quot;,&quot;,&quot;)
                        End If
                    else
                        For r As Integer = 0 To A1.Rows.Count-1
                            If (A1.Rows(r)(&quot;Count&quot;)*100/(Buffer.Rows.Count))&gt;60 Then
                                Salary=A1.Rows(r)(&quot;Salary&quot;)                         skip=1
                            End If
                            end
                            if
                        next
                        If skip=0 Then
                            &#x27;vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvPage2vvvvvvvvvvvvvvvvvvvvvvvvvvv
                        End If
                        if Govt=True then
                            Dim SD1p,SD1m,SD2p,SD2m,SD3p,SD3m as date
                            Dim Sflag as integer =0
                            Dim BasicSalary as Integer =0
                            Dim T as DataTable =Buffer.Clone
                            Dim T2 as DataTable=Buffer.Clone
                            Dim TX as DataTable=Buffer.Clone
                            Dim Tcounter as integer =0
                            Dim T2counter as integer =0
                            Dim BSp,BSm as Decimal                          Sum=0                         minimum=0                         Salary=0                         Other=0                         min=0                         SD1p=SD1.AddDays(5)                         SD1m=SD1.AddDays(-5)                         SD2p=SD2.AddDays(5)                         SD2m=SD2.AddDays(-5)                         SD3p=SD3.AddDays(5)                         SD3m=SD3.AddDays(-5)                 &#x27;        T=Buffer.Clone
                            For r As Integer = 0 To Buffer.Rows.Count-1 &#x27;
                                If (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3) Then
                                    if((SD1m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))OR (SD2m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD3m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD3p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))) then                                 x= Buffer.Rows(r)                                 TX.ImportRow(x)                                 x=TX.NewRow
                                End If
                            end if
                        next                         Buffer=TX
                        For r As Integer = 0 To Buffer.Rows.Count-1                 &#x27;
                            if (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1) then
                                If (SD1m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) Then
                                    Sflag=Sflag+1                                 BasicSalary=Buffer.Rows(r)(&quot;Sal&quot;)                                 &#x27;AM=BasicSalary
                                End If
                                end
                                if
                            Next                         &#x27;AM=BasicSalary
                            If Sflag=1 Then
                                x=T.NewRow
                            End If
                            For r As Integer = 0 To Buffer.Rows.Count-1                 &#x27;
                                If (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3) Then
                                    if((SD1m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))OR (SD2m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD3m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD3p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))) then                                     x= Buffer.Rows(r)                                     T.ImportRow(x)                                     x=T.NewRow                                     Tcounter=Tcounter+1
                                End If
                            end if
                        next
                        if Tcounter&lt;3                                 ReassignFlag=1                                 Status=&quot;Total number of feasible transaction is less than 3 after filtering with +/-5 salary date I&quot;
                        else                                 BSp=BasicSalary+(BasicSalary*20/100)                                 BSm=BasicSalary-(BasicSalary*20/100)                                 x=T2.NewRow
                            for r as integer=0 to T.Rows.count-1                                     if(T.Rows(r)(&quot;Sal&quot;)&gt;=BSm AND T.Rows(r)(&quot;Sal&quot;)&lt;=BSp)                                         x= T.Rows(r)                                         T2.ImportRow(x)                                         x=T2.NewRow                                         T2counter=T2counter+1
                                end
                                if
                            next
                            If T2counter&lt;2 Then
                                ReassignFlag=1                                     Status=&quot;Total number of feasible transaction is less than 2 after filtering BSm &lt;= Salary &lt;=BSp&quot;
                            End If
                        else
                            if T2counter=2                                     min=T2.Rows(0)(&quot;Sal&quot;)+1
                                For k As Integer = 0 To 1                                         Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                    If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                        min=T2.Rows(k)(&quot;Sal&quot;)                                             minimum=T2.Rows(k)(&quot;Amount&quot;)
                                    End If
                                    end
                                    if
                                next                                     Avg= Sum / 2
                                If Avg&lt;1.2*min Then
                                    test=2                                         Salary=minimum                                         Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                End If
                            else                                         Salary=minimum                                         Other=0
                                end
                                if
                            else                                     min=T2.Rows(0)(&quot;Sal&quot;)+1
                                For k As Integer = 0 To 2                                         Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                    If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                        min=T2.Rows(k)(&quot;Sal&quot;)                                             minimum=T2.Rows(k)(&quot;Amount&quot;)
                                    End If
                                    end
                                    if
                                next                                     Avg= Sum / 3
                                If Avg&lt;1.2*min Then
                                    test=2                                         Salary=minimum                                         Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                End If
                            else                                         Salary=minimum                                         Other=0
                                end
                                if
                            end if
                            end
                            if                     &#x27;    test=T                     &#x27;    testT=Tcounter
                            else &#x27;=============================================================AA===================================================BEGIN
                                Dim T3 as DataTable=Buffer.Clone
                                Dim Tcounter2 as integer=0
                                for r as integer =0 to Buffer.Rows.Count-1                                 if(Buffer.Rows(r)(&quot;Sal&quot;)&gt;=LastApproved) then                                     x=T3.NewRow                                     x=Buffer.Rows(r)                                     T3.ImportRow(x)                                     Tcounter2=Tcounter2+1                                     BasicSalary=Buffer.Rows(r)(&quot;Sal&quot;)
                                    end
                                    if
                                next                             &#x27;    Buffer=Nothing                         &#x27;    Buffer=T3 Cop=Buffer &#x27;===============================================================BB=============================================BEGIN                             if(Tcounter2=1)                                 x=T.NewRow
                                For r As Integer = 0 To Buffer.Rows.Count-1                 &#x27;
                                    If (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3) Then
                                        if((SD1m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))OR (SD2m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD3m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD3p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))) then                                         x= Buffer.Rows(r)                                         T.ImportRow(x)                                         x=T.NewRow                                         Tcounter=Tcounter+1
                                    End If
                                end if
                            next
                            if Tcounter&lt;3                                     ReassignFlag=1                                     Status=&quot;Total number of feasible transaction is less than 3 after filtering with +/-5 salary date in AA-BB-Gov I&quot;
                            else                                     BSp=BasicSalary+(BasicSalary*20/100)                                     BSm=BasicSalary-(BasicSalary*20/100)                                     x=T2.NewRow
                                for r as integer=0 to T.Rows.count-1                                         if(T.Rows(r)(&quot;Sal&quot;)&gt;=BSm AND T.Rows(r)(&quot;Sal&quot;)&lt;=BSp)                                             x= T.Rows(r)                                             T2.ImportRow(x)                                             x=T2.NewRow                                             T2counter=T2counter+1
                                    end
                                    if
                                next
                                If T2counter&lt;2 Then
                                    ReassignFlag=1                                         Status=&quot;Total number of feasible transaction is less than 2 after filtering with +/-5 salary date in AA-BB-Gov II&quot;
                                End If
                            else
                                if T2counter=2                                         min=T2.Rows(0)(&quot;Sal&quot;)+1
                                    For k As Integer = 0 To 1                                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                        If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                            min=T2.Rows(k)(&quot;Sal&quot;)                                                 minimum=T2.Rows(k)(&quot;Amount&quot;)
                                        End If
                                        end
                                        if
                                    next                                         Avg= Sum / 2
                                    If Avg&lt;1.2*min Then
                                        test=3                                             Salary=minimum                                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                    End If
                                else                                             Salary=minimum                                             Other=0
                                    end
                                    if
                                else                                         min=T2.Rows(0)(&quot;Sal&quot;)+1
                                    For k As Integer = 0 To 2                                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                        If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                            min=T2.Rows(k)(&quot;Sal&quot;)                                                 minimum=T2.Rows(k)(&quot;Amount&quot;)
                                        End If
                                        end
                                        if
                                    next                                         Avg= Sum / 3
                                    If Avg&lt;1.2*min Then
                                        test=3                                             Salary=minimum                                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                    End If
                                else                                             Salary=minimum                                             Other=0
                                    end
                                    if
                                end if
                                end
                                if &#x27;===============================================================BB=============================================END
                                else
                                    Dim Count4 as integer=0
                                    Dim Prev as integer =0
                                    Dim Base as Decimal=0
                                    for r as integer=0 to A1.Rows.Count-1
                                        For j as integer=0 to T3.Rows.Count-1
                                            if A1.Rows(r)(&quot;Amount&quot;)=T3.Rows(j)(&quot;Sal&quot;)                                             Count4=Count4+1
                                                end
                                                if
                                            next
                                            if prev&lt;Count4                                         BasicSalary=A1.Rows(r)(&quot;Amount&quot;)                                         prev=Count4
                                                end
                                                if                                     Count4=0
                                                next                                                 x=T.NewRow
                                                For r As Integer = 0 To Buffer.Rows.Count-1                 &#x27;
                                                    If (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3) Then
                                                        if((SD1m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))OR (SD2m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD3m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD3p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))) then                                         x= Buffer.Rows(r)                                         T.ImportRow(x)                                         x=T.NewRow                                         Tcounter=Tcounter+1
                                                    End If
                                                end if
                                            next
                                            if Tcounter&lt;3                                     ReassignFlag=1                                     Status=&quot;Total number of feasible transaction is less than 3 after filtering with +/-5 salary date in AA-BB-Gov III&quot;
                                            else                                     BSp=BasicSalary+(BasicSalary*20/100)                                     BSm=BasicSalary-(BasicSalary*20/100)                                     x=T2.NewRow
                                                for r as integer=0 to T.Rows.count-1                                         if(T.Rows(r)(&quot;Sal&quot;)&gt;=BSm AND T.Rows(r)(&quot;Sal&quot;)&lt;=BSp)                                             x= T.Rows(r)                                             T2.ImportRow(x)                                             x=T2.NewRow                                             T2counter=T2counter+1
                                                    end
                                                    if
                                                next
                                                If T2counter&lt;2 Then
                                                    ReassignFlag=1                                         Status=&quot;Total number of feasible transaction is less than 2 after filtering BSm&lt;= SAL &lt;=BSp in AA-BB-Gov IV&quot;
                                                End If
                                            else
                                                if T2counter=2                                         min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                    For k As Integer = 0 To 1                                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                        If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                            min=T2.Rows(k)(&quot;Sal&quot;)                                                 minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                        End If
                                                        end
                                                        if
                                                    next                                         Avg= Sum / 2
                                                    If Avg&lt;1.2*min Then
                                                        test=4                                             Salary=minimum                                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                    End If
                                                else                                             Salary=minimum                                             Other=0
                                                    end
                                                    if
                                                else                                          min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                    For k As Integer = 0 To 2                                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                        If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                            min=T2.Rows(k)(&quot;Sal&quot;)                                                 minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                        End If
                                                        end
                                                        if
                                                    next                                         Avg= Sum / 3
                                                    If Avg&lt;1.2*min Then
                                                        test=4                                             Salary=minimum                                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                    End If
                                                else                                             Salary=minimum                                             Other=0
                                                    end
                                                    if
                                                end if
                                                end
                                                if
                                                end
                                                if  &#x27;=============================================================AA===================================================    END
                                                    end
                                                    if
                                                else &#x27;==========================================================================B===================================BEGIN
                                                    Dim Sflag as integer =0
                                                    Dim BasicSalary as Integer =0
                                                    Dim T as DataTable =Buffer.Clone
                                                    Dim T2 as DataTable=Buffer.Clone
                                                    Dim Tcounter as integer =0
                                                    Dim T2counter as integer =0
                                                    Dim BSp,BSm as Decimal
                                                    Dim BaseDays as Decimal =0
                                                    Dim Dayz as decimal=0                         Sum=0                         minimum=0                         Salary=0                         Sflag=0                         Other=0                         min=0
                                                    For r As Integer = 0 To Buffer.Rows.Count-1
                                                        If (Buffer.Rows(r)(&quot;Days&quot;)&lt;=TimePeriod) Then
                                                            Sflag=Sflag+1                                 BasicSalary=Buffer.Rows(r)(&quot;Sal&quot;)                                 x=T.NewRow                                 x= Buffer.Rows(r)                                 T.ImportRow(x)                                 Tcounter=1                                 BaseDays=Buffer.Rows(r)(&quot;Days&quot;)
                                                        End If
                                                        end
                                                        if
                                                    Next &#x27;=======================================================================================BB=================================================BEGIN
                                                    If Sflag=1 Then
                                                        x=T.NewRow
                                                    End If
                                                    For r As Integer = 0 To Buffer.Rows.Count-1                                     Dayz=Buffer.Rows(r)(&quot;Days&quot;)                                 Dayz=Dayz-BaseDays
                                                        If ((Dayz&gt;=25 AND Dayz&lt;=35) OR (Dayz&gt;=55 AND Dayz&lt;=65) ) Then
                                                            x= Buffer.Rows(r)                                     T.ImportRow(x)                                     x=T.NewRow                                     Tcounter=Tcounter+1
                                                        End If
                                                    end if
                                                next                             &#x27;testT=Tcounter /checked
                                                if Tcounter&lt;3                                 ReassignFlag=1                                 Status=&quot;Total number of feasible transaction is less than 3 after filtering with 25-35 and 55 to 65 in AA-BB-nonGov II&quot;
                                                else                                 BSp=BasicSalary+(BasicSalary*20/100)                                 BSm=BasicSalary-(BasicSalary*20/100)                                 x=T2.NewRow
                                                    for r as integer=0 to T.Rows.count-1                                     if(T.Rows(r)(&quot;Sal&quot;)&gt;=BSm AND T.Rows(r)(&quot;Sal&quot;)&lt;=BSp)                                         x= T.Rows(r)                                         T2.ImportRow(x)                                         x=T2.NewRow                                         T2counter=T2counter+1
                                                        end
                                                        if
                                                    next
                                                    If T2counter&lt;2 Then
                                                        ReassignFlag=1                                     Status=&quot;Total number of feasible transaction is less than 2 after filtering BSm&lt;=SAL&lt;=BSp BB-non Gov II&quot;
                                                    End If
                                                else
                                                    if T2counter=2
                                                        For k As Integer = 0 To 1                                         Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                            If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                min=T2.Rows(k)(&quot;Sal&quot;)                                             minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                            End If
                                                            end
                                                            if
                                                        next                                      Avg= Sum / 2
                                                        If Avg&lt;1.2*min Then
                                                            Salary=minimum                                         Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                        End If
                                                    else                                          Salary=minimum                                         Other=0
                                                        end
                                                        if
                                                    else                                       min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                        For k As Integer = 0 To 2                                         Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                            If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                min=T2.Rows(k)(&quot;Sal&quot;)                                             minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                            End If
                                                            end
                                                            if
                                                        next                                      Avg= Sum / 3
                                                        If Avg&lt;1.2*min Then
                                                            Salary=minimum                                         Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                        End If
                                                    else                                          Salary=minimum                                         Other=0
                                                        end
                                                        if
                                                    end if
                                                    end
                                                    if                         &#x27;test=T2                         &#x27;testT=Tcounter
                                                    else &#x27;++++++++++++++++++++++AA+++++++++ &#x27;=============================================================AA===================================================BEGIN
                                                        Dim T3 as DataTable=Buffer.Clone
                                                        Dim Tcounter2 as integer=0
                                                        for r as integer =0 to Buffer.Rows.Count-1                                 if(Buffer.Rows(r)(&quot;Sal&quot;)&gt;=LastApproved) then                                     x=T3.NewRow                                     x=Buffer.Rows(r)                                     T3.ImportRow(x)                                     Tcounter2=Tcounter2+1                                     BasicSalary=Buffer.Rows(r)(&quot;Sal&quot;)
                                                            end
                                                            if
                                                        next                                 Buffer=Nothing                             Buffer=T3 &#x27;===============================================================BB=============================================BEGIN                             if(Tcounter2=1)                                 x=T.NewRow
                                                        For r As Integer = 0 To Buffer.Rows.Count-1                                         Dayz=Buffer.Rows(r)(&quot;Days&quot;)                                     Dayz=Dayz-BaseDays
                                                            If ((Dayz&gt;=25 AND Dayz&lt;=35) OR (Dayz&gt;=55 AND Dayz&lt;=65) ) Then
                                                                x= Buffer.Rows(r)                                         T.ImportRow(x)                                         x=T.NewRow                                         Tcounter=Tcounter+1
                                                            End If
                                                        end if
                                                    next                                 &#x27;testT=Tcounter /checked
                                                    if Tcounter&lt;3                                     ReassignFlag=1                                     Status=&quot;Total number of feasible transaction is less than 3 after filtering with 25-35 and 55 to 65 in AA-BB-nonGov III&quot;
                                                    else                                     BSp=BasicSalary+(BasicSalary*20/100)                                     BSm=BasicSalary-(BasicSalary*20/100)                                     x=T2.NewRow
                                                        for r as integer=0 to T.Rows.count-1                                         if(T.Rows(r)(&quot;Sal&quot;)&gt;=BSm AND T.Rows(r)(&quot;Sal&quot;)&lt;=BSp)                                             x= T.Rows(r)                                             T2.ImportRow(x)                                             x=T2.NewRow                                             T2counter=T2counter+1
                                                            end
                                                            if
                                                        next
                                                        If T2counter&lt;2 Then
                                                            ReassignFlag=1                                         Status=&quot;Total number of feasible transaction is less than 2 after filtering BSm&lt;SAL&lt;BSp in AA-BB-nonGov IV&quot;
                                                        End If
                                                    else
                                                        if T2counter=2                                         min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                            For k As Integer = 0 To 1                                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                                If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                    min=T2.Rows(k)(&quot;Sal&quot;)                                                 minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                                End If
                                                                end
                                                                if
                                                            next                                          Avg= Sum / 2
                                                            If Avg&lt;1.2*min Then
                                                                Salary=minimum                                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                            End If
                                                        else                                              Salary=minimum                                             Other=0
                                                            end
                                                            if
                                                        else                                         min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                            For k As Integer = 0 To 2                                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                                If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                    min=T2.Rows(k)(&quot;Sal&quot;)                                                 minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                                End If
                                                                end
                                                                if
                                                            next                                          Avg= Sum / 3
                                                            If Avg&lt;1.2*min Then
                                                                Salary=minimum                                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                            End If
                                                        else                                              Salary=minimum                                             Other=0
                                                            end
                                                            if
                                                        end if
                                                        end
                                                        if  &#x27;===============================================================BB=============================================END
                                                        else
                                                            Dim Count4 as integer=0
                                                            Dim Prev as integer =0
                                                            Dim Base as Decimal=0
                                                            for r as integer=0 to A1.Rows.Count-1
                                                                For j as integer=0 to T3.Rows.Count-1
                                                                    if A1.Rows(r)(&quot;Amount&quot;)=T3.Rows(j)(&quot;Sal&quot;)                                             Count4=Count4+1
                                                                        end
                                                                        if
                                                                    next
                                                                    if prev&lt;Count4                                         BasicSalary=A1.Rows(r)(&quot;Amount&quot;)
                                                                        end
                                                                        if
                                                                    next &#x27;============================================================BB=============================================BEGIN                                             x=T.NewRow
                                                                    For r As Integer = 0 To Buffer.Rows.Count-1                                         Dayz=Buffer.Rows(r)(&quot;Days&quot;)                                     Dayz=Dayz-BaseDays
                                                                        If ((Dayz&gt;=25 AND Dayz&lt;=35) OR (Dayz&gt;=55 AND Dayz&lt;=65) ) Then
                                                                            x= Buffer.Rows(r)                                         T.ImportRow(x)                                         x=T.NewRow                                         Tcounter=Tcounter+1
                                                                        End If
                                                                    end if
                                                                next                                 &#x27;testT=Tcounter /checked
                                                                if Tcounter&lt;3                                     ReassignFlag=1                                     Status=&quot;Total number of feasible transaction is less than 3 after filtering 25-35 and 55-65 in AA-BB-nonGov V&quot;
                                                                else                                     BSp=BasicSalary+(BasicSalary*20/100)                                     BSm=BasicSalary-(BasicSalary*20/100)                                     x=T2.NewRow
                                                                    for r as integer=0 to T.Rows.count-1                                         if(T.Rows(r)(&quot;Sal&quot;)&gt;=BSm AND T.Rows(r)(&quot;Sal&quot;)&lt;=BSp)                                             x= T.Rows(r)                                             T2.ImportRow(x)                                             x=T2.NewRow                                             T2counter=T2counter+1
                                                                        end
                                                                        if
                                                                    next
                                                                    If T2counter&lt;2 Then
                                                                        ReassignFlag=1                                         Status=&quot;Total number of feasible transaction is less than 2 after filtering BSp&lt;=SAL&lt;=BSp in AA-BB-nonGov VI&quot;
                                                                    End If
                                                                else
                                                                    if T2counter=2                                         min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                                        For k As Integer = 0 To 1                                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                                            If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                                min=T2.Rows(k)(&quot;Sal&quot;)                                                 minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                                            End If
                                                                            end
                                                                            if
                                                                        next                                          Avg= Sum / 2
                                                                        If Avg&lt;1.2*min Then
                                                                            Salary=minimum                                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                                        End If
                                                                    else                                              Salary=minimum                                             Other=0
                                                                        end
                                                                        if
                                                                    else                                          min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                                        For k As Integer = 0 To 2                                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                                            If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                                min=T2.Rows(k)(&quot;Sal&quot;)                                                 minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                                            End If
                                                                            end
                                                                            if
                                                                        next                                          Avg= Sum / 3
                                                                        If Avg&lt;1.2*min Then
                                                                            Salary=minimum                                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                                        End If
                                                                    else                                              Salary=minimum                                             Other=0
                                                                        end
                                                                        if
                                                                    end if
                                                                    end
                                                                    if &#x27;===========================================================BB======================================================END
                                                                        end
                                                                        if &#x27;=============================================================AA===================================================    END
                                                                            end
                                                                            if &#x27;==============================================================BB============================================END                      &#x27;==============================================================B=============================================END
                                                                                end
                                                                                if &#x27;^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^Page2^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                                                                    end
                                                                                    if
                                                                                    end
                                                                                    if
                                                                                else             Status=&quot;Salary cannot be identified since there is no transaction in the past &quot;+TimePeriod.ToString+&quot; days&quot;             ReassignFlag=1
                                                                                    end
                                                                                    if
                                                                                else         ReassignFlag=1         Status=&quot;Total number of feasible transaction is less than 3&quot;
                                                                                    end
                                                                                    if
                                                                                else
                                                                                    Dim SD1p,SD1m,SD2p,SD2m,SD3p,SD3m,SD4p,SD4m as date
                                                                                    Dim Sflag as integer =0
                                                                                    Dim Salflag as integer =0
                                                                                    Dim Lflag as integer =0
                                                                                    Dim L2flag as integer =0
                                                                                    Dim LLcheck as integer =0
                                                                                    Dim BasicSalary as Integer =0
                                                                                    Dim T as DataTable =Buffer.Clone
                                                                                    Dim T2 as DataTable=Buffer.Clone
                                                                                    Dim TX as DataTable=Buffer.Clone
                                                                                    Dim LL as DataTable=Buffer.Clone
                                                                                    Dim LL1 as DataTable=Buffer.Clone
                                                                                    Dim L2 as DataTable=Buffer.Clone
                                                                                    Dim L21 as DataTable=Buffer.Clone
                                                                                    Dim L3 as DataTable=Buffer.Clone
                                                                                    Dim Tcounter as integer =0
                                                                                    Dim L3counter as integer =0
                                                                                    Dim T2counter as integer =0
                                                                                    Dim BSp,BSm as Decimal          Sum=0         minimum=0         Salary=0         Other=0         min=0         SD1p=SD1.AddDays(5)         SD1m=SD1.AddDays(-5)         SD2p=SD2.AddDays(5)         SD2m=SD2.AddDays(-5)         SD3p=SD3.AddDays(5)         SD3m=SD3.AddDays(-5)         SD4p=SD4.AddDays(5)         SD4m=SD4.AddDays(-5)         &#x27;        T=Buffer.Clone
                                                                                    For r As Integer = 0 To Buffer.Rows.Count-1         &#x27;
                                                                                        If (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3) Then
                                                                                            if((SD1m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))OR (SD2m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD3m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD3p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD4m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD4p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))) then                 x= Buffer.Rows(r)                 TX.ImportRow(x)                 x=TX.NewRow
                                                                                        End If
                                                                                    end if
                                                                                next         Buffer=TX
                                                                                For r As Integer = 0 To Buffer.Rows.Count-1         &#x27;
                                                                                    If (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3) Then
                                                                                        if(SD1m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) then                 x= Buffer.Rows(r)                 LL.ImportRow(x)                 x=LL.NewRow                 Lflag=Lflag+1
                                                                                    End If
                                                                                end if
                                                                            next
                                                                            If Lflag&lt;1 Then
                                                                                Lflag=0             x=LL1.NewRow
                                                                            End If
                                                                            For r As Integer = 0 To Buffer.Rows.Count-1                 if(SD1=Buffer.Rows(r)(&quot;Account date&quot;)) then                     x= Buffer.Rows(r)                     LL1.ImportRow(x)                     x=LL1.NewRow                     Lflag=Lflag+1
                                                                            end if
                                                                        next             LL=LL1
                                                                        end
                                                                        if          LLout=LL &#x27;+++++++++++++++++++++++++++
                                                                            If Lflag&gt;0 Then
                                                                                &#x27;+++++++++++++++++++++++++++
                                                                            End If
                                                                            if Lflag=1 then
                                                                                For r As Integer = 0 To Buffer.Rows.Count-1                     if(SD2m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) then                         x= Buffer.Rows(r)                         L2.ImportRow(x)                         x=L2.NewRow                         L2flag=L2flag+1
                                                                                end if
                                                                            next
                                                                            If L2flag&gt;0 Then
                                                                                test=101
                                                                            End If
                                                                            If L2flag=1 Then
                                                                                test=120
                                                                            End If
                                                                            If L2.Rows(0)(&quot;Sal&quot;)&gt;=LL.Rows(0)(&quot;Sal&quot;) Then
                                                                                salflag=1                             Salary=LL.Rows(0)(&quot;Amount&quot;)                             ReassignFlag=0         test=100
                                                                            End If
                                                                        else                             x=L3.NewRow
                                                                            For r As Integer = 0 To Buffer.Rows.Count-1                                 if((SD2m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD3m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD3p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD4m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD4p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))) then                                     x= Buffer.Rows(r)                                     L3.ImportRow(x)                                     x=L3.NewRow                                     L3counter=L3counter+1
                                                                            end if
                                                                        next
                                                                        If L3counter&gt;2 Then
                                                                            min=L3.Rows(0)(&quot;Sal&quot;)+1
                                                                        End If
                                                                        For k As Integer = 0 To 2                                     Sum=Sum+L3.Rows(k)(&quot;Sal&quot;)
                                                                            If min&gt;L3.Rows(k)(&quot;Sal&quot;) Then
                                                                                min=L3.Rows(k)(&quot;Sal&quot;)                                         minimum=L3.Rows(k)(&quot;Amount&quot;)
                                                                            End If
                                                                            end
                                                                            if
                                                                        next                                  Avg=Sum/3
                                                                        If Avg&lt;1.2*min Then
                                                                            Salary=minimum                                     Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)                                     salflag=1
                                                                        End If
                                                                    else                                     salflag=0
                                                                        end
                                                                        if
                                                                    else                                         salflag=0
                                                                        end
                                                                        if
                                                                        end
                                                                        if
                                                                    else test=110                         L2flag=0                         x=L21.NewRow
                                                                        For r As Integer = 0 To Buffer.Rows.Count-1                             if(SD2=Buffer.Rows(r)(&quot;Account date&quot;)) then                                 x= Buffer.Rows(r)                                 L21.ImportRow(x)                                 x=L21.NewRow                                 L2flag=L2flag+1
                                                                        end if
                                                                    next                         L2=L21
                                                                    if L2flag=1 then
                                                                        If L2.Rows(0)(&quot;Sal&quot;)&gt;=LL.Rows(0)(&quot;Sal&quot;) Then
                                                                            salflag=1                                 Salary=LL.Rows(0)(&quot;Amount&quot;)                                 ReassignFlag=0
                                                                        End If
                                                                        end
                                                                        if
                                                                        end
                                                                        if
                                                                        end
                                                                        if
                                                                        If salflag=0 Then
                                                                            &#x27;test=102 &#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;                         Sum=0
                                                                        End If
                                                                        For r As Integer = 0 To Buffer.Rows.Count-1                         &#x27;
                                                                            if (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1) then
                                                                                If (SD1m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) Then
                                                                                    Sflag=Sflag+1                                 BasicSalary=Buffer.Rows(r)(&quot;Sal&quot;)                                 &#x27;AM=BasicSalary
                                                                                End If
                                                                                end
                                                                                if
                                                                            Next                         &#x27;AM=BasicSalary
                                                                            If Sflag=1 Then
                                                                                x=T.NewRow
                                                                            End If
                                                                            For r As Integer = 0 To Buffer.Rows.Count-1                         &#x27;
                                                                                If (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3) Then
                                                                                    if((SD1m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD2m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD3m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD3p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD4m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD4p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))) then                                     x= Buffer.Rows(r)                                     T.ImportRow(x)                                     x=T.NewRow                                     Tcounter=Tcounter+1
                                                                                End If
                                                                            end if
                                                                        next
                                                                        if Tcounter&lt;2                                 ReassignFlag=1                                 Status=&quot;Total number of feasible transaction is less than 2 after filtering with +/-5 salary date I&quot;
                                                                        else                                 BSp=BasicSalary+(BasicSalary*20/100)                                 BSm=BasicSalary-(BasicSalary*20/100)                                 x=T2.NewRow
                                                                            for r as integer=0 to T.Rows.count-1                                     if(T.Rows(r)(&quot;Sal&quot;)&gt;=BSm AND T.Rows(r)(&quot;Sal&quot;)&lt;=BSp)                                         x= T.Rows(r)                                         T2.ImportRow(x)                                         x=T2.NewRow                                         T2counter=T2counter+1
                                                                                end
                                                                                if
                                                                            next
                                                                            If T2counter&lt;2 Then
                                                                                ReassignFlag=1                                     Status=&quot;Total number of feasible transaction is less than 2 after filtering BSm &lt;= Salary &lt;=BSp&quot;
                                                                            End If
                                                                        else
                                                                            if T2counter=2                                     min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                                                For k As Integer = 0 To 1                                         Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                                                    If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                                        min=T2.Rows(k)(&quot;Sal&quot;)                                             minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                                                    End If
                                                                                    end
                                                                                    if
                                                                                next                                     Avg= Sum / 2
                                                                                If Avg&lt;1.2*min Then
                                                                                    test=2                 &#x27;
                                                                                End If
                                                                                For r As Integer = 0 To LL.Rows.Count-1                 &#x27;                            if(LL.Rows(r)(&quot;Sal&quot;)&gt;=Avg*0.65) then                 &#x27;
                                                                                    If LLcheck=0 Then
                                                                                        &#x27;                                    LLcheck=1                 &#x27;                                    if(Math.Floor(LL.Rows(r)(&quot;Sal&quot;))&lt;=Avg) then                 &#x27;                                        Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                    End If
                                                                                else if(LL.Rows(r)(&quot;Sal&quot;)&lt;=Avg*1.2) then                 &#x27;                                        Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                else                     &#x27;                                        ReassignFlag=1                 &#x27;                                        Status=&quot;Salary not identified sincee one transaction in last month is grater than selected salary&quot;                 &#x27;
                                                                                    end
                                                                                    if                 &#x27;
                                                                                    else                  &#x27;                                    ReassignFlag=1                 &#x27;                                    Status=&quot;More than one transaction is grater then 65% of selected salary&quot;                 &#x27;
                                                                                        end
                                                                                        if                 &#x27;
                                                                                        end if                     &#x27;
                                                                                    next                                         Salary=minimum                                         Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                                                else                 &#x27;
                                                                                    For r As Integer = 0 To LL.Rows.Count-1                 &#x27;                            if(LL.Rows(r)(&quot;Sal&quot;)&gt;=min*0.65) then                 &#x27;
                                                                                        If LLcheck=0 Then
                                                                                            &#x27;                                    LLcheck=1                 &#x27;                                    if(Math.Floor(LL.Rows(r)(&quot;Sal&quot;))&lt;=min) then                 &#x27;                                        Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                        End If
                                                                                    else if(LL.Rows(r)(&quot;Sal&quot;)&lt;min*1.2) then                 &#x27;                                        Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                    else                 &#x27;                                        ReassignFlag=1                 &#x27;                                        Status=&quot;Salary not identified sincee one transaction in last month is grater than selected salary&quot;                 &#x27;
                                                                                        end
                                                                                        if                 &#x27;
                                                                                        else                  &#x27;                                    ReassignFlag=1                 &#x27;                                    Status=&quot;More than one transaction is grater then 65% of selected salary&quot;                 &#x27;
                                                                                            end
                                                                                            if                 &#x27;
                                                                                            end if                     &#x27;
                                                                                        next                 test=2.1                                         Salary=minimum
                                                                                        end
                                                                                        if
                                                                                    else                                     min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                                                        For k As Integer = 0 To 2                                         Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                                                            If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                                                min=T2.Rows(k)(&quot;Sal&quot;)                                             minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                                                            End If
                                                                                            end
                                                                                            if
                                                                                        next                                     Avg= Sum / 3
                                                                                        If Avg&lt;1.2*min Then
                                                                                            test=2                 &#x27;
                                                                                        End If
                                                                                        For r As Integer = 0 To LL.Rows.Count-1                 &#x27;                            if(LL.Rows(r)(&quot;Sal&quot;)&gt;=Avg*0.65) then                 &#x27;
                                                                                            If LLcheck=0 Then
                                                                                                &#x27;                                    LLcheck=1                 &#x27;                                    if(Math.Floor(LL.Rows(r)(&quot;Sal&quot;))&lt;=Avg) then                 &#x27;                                        Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                            End If
                                                                                        else if(LL.Rows(r)(&quot;Sal&quot;)&lt;Avg*1.2) then                 &#x27;                                        Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                        else                 &#x27;er=Avg                 &#x27;Buffer=T2                 &#x27;                                        ReassignFlag=1                 &#x27;                                        Status=&quot;Salary not identified sincee one transaction in last month is grater than selected salary&quot;                 &#x27;
                                                                                            end
                                                                                            if                 &#x27;
                                                                                            else                  &#x27;                                    ReassignFlag=1                 &#x27;                                    Status=&quot;More than one transaction is grater then 65% of selected salary&quot;                 &#x27;
                                                                                                end
                                                                                                if                 &#x27;
                                                                                                end if                     &#x27;
                                                                                            next                                         Salary=minimum                                         Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                                                        else                 &#x27;
                                                                                            For r As Integer = 0 To LL.Rows.Count-1                 &#x27;                            if(LL.Rows(r)(&quot;Sal&quot;)&gt;=min*0.65) then                 &#x27;
                                                                                                If LLcheck=0 Then
                                                                                                    &#x27;                                    LLcheck=1                 &#x27;                                    if(Math.Floor(LL.Rows(r)(&quot;Sal&quot;))&lt;=min) then                 &#x27;                                        Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                                End If
                                                                                            else if(LL.Rows(r)(&quot;Sal&quot;)&lt;=min*1.2) then                 &#x27;                                        Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                            else                 &#x27;                                        ReassignFlag=1                 &#x27;                                        Status=&quot;Salary not identified sincee one transaction in last month is grater than selected salary&quot;                 &#x27;
                                                                                                end
                                                                                                if                 &#x27;
                                                                                                else                  &#x27;                                    ReassignFlag=1                 &#x27;                                    Status=&quot;More than one transaction is grater then 65% of selected salary&quot;                 &#x27;
                                                                                                    end
                                                                                                    if                 &#x27;
                                                                                                    end if                     &#x27;
                                                                                                next                 test=2.1                                         Salary=minimum
                                                                                                end
                                                                                                if
                                                                                            end if
                                                                                            end
                                                                                            if                         &#x27;    test=T                         &#x27;    testT=Tcounter
                                                                                            else &#x27;=============================================================AA===================================================BEGIN
                                                                                                Dim T3 as DataTable=Buffer.Clone
                                                                                                Dim Tcounter2 as integer=0
                                                                                                for r as integer =0 to Buffer.Rows.Count-1                                 if(Buffer.Rows(r)(&quot;Sal&quot;)&gt;=LastApproved) then                                     x=T3.NewRow                                     x=Buffer.Rows(r)                                     T3.ImportRow(x)                                     Tcounter2=Tcounter2+1                                     BasicSalary=Buffer.Rows(r)(&quot;Sal&quot;)
                                                                                                    end
                                                                                                    if
                                                                                                next                             &#x27;    Buffer=Nothing                         &#x27;    Buffer=T3                             Cop=Buffer &#x27;===============================================================BB=============================================BEGIN                             if(Tcounter2=1)                                 x=T.NewRow
                                                                                                For r As Integer = 0 To Buffer.Rows.Count-1                         &#x27;
                                                                                                    If (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3) Then
                                                                                                        if((SD1m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))OR (SD2m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD3m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD3p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD4m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD4p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))) then                                         x= Buffer.Rows(r)                                         T.ImportRow(x)                                         x=T.NewRow                                         Tcounter=Tcounter+1
                                                                                                    End If
                                                                                                end if
                                                                                            next
                                                                                            if Tcounter&lt;2                                     ReassignFlag=1                                     Status=&quot;Total number of feasible transaction is less than 2 after filtering with +/-5 salary date in AA-BB-Gov I&quot;
                                                                                            else                                     BSp=BasicSalary+(BasicSalary*20/100)                                     BSm=BasicSalary-(BasicSalary*20/100)                                     x=T2.NewRow
                                                                                                for r as integer=0 to T.Rows.count-1                                         if(T.Rows(r)(&quot;Sal&quot;)&gt;=BSm AND T.Rows(r)(&quot;Sal&quot;)&lt;=BSp)                                             x= T.Rows(r)                                             T2.ImportRow(x)                                             x=T2.NewRow                                             T2counter=T2counter+1
                                                                                                    end
                                                                                                    if
                                                                                                next
                                                                                                If T2counter&lt;2 Then
                                                                                                    ReassignFlag=1                                         Status=&quot;Total number of feasible transaction is less than 2 after filtering with +/-5 salary date in AA-BB-Gov II&quot;
                                                                                                End If
                                                                                            else
                                                                                                if T2counter=2                                         min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                                                                    For k As Integer = 0 To 1                                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                                                                        If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                                                            min=T2.Rows(k)(&quot;Sal&quot;)                                                 minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                                                                        End If
                                                                                                        end
                                                                                                        if
                                                                                                    next                                         Avg= Sum / 2
                                                                                                    If Avg&lt;1.2*min Then
                                                                                                        test=3                 &#x27;
                                                                                                    End If
                                                                                                    For r As Integer = 0 To LL.Rows.Count-1                 &#x27;                                if(LL.Rows(r)(&quot;Sal&quot;)&gt;=Avg*0.65) then                 &#x27;
                                                                                                        If LLcheck=0 Then
                                                                                                            &#x27;                                        LLcheck=1                 &#x27;                                        if(Math.Floor(LL.Rows(r)(&quot;Sal&quot;))&lt;=Avg) then                 &#x27;                                            Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                                        End If
                                                                                                    else if(LL.Rows(r)(&quot;Sal&quot;)&lt;=Avg*1.2) then                 &#x27;                                            Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                                    else                 &#x27;                                            ReassignFlag=1                 &#x27;                                            Status=&quot;Salary not identified sincee one transaction in last month is grater than selected salary&quot;                 &#x27;
                                                                                                        end
                                                                                                        if                 &#x27;
                                                                                                        else                  &#x27;                                        ReassignFlag=1                 &#x27;                                        Status=&quot;More than one transaction is grater then 65% of selected salary&quot;                 &#x27;
                                                                                                            end
                                                                                                            if                 &#x27;
                                                                                                            end if                     &#x27;
                                                                                                        next                                             Salary=minimum                                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                                                                    else                 &#x27;
                                                                                                        For r As Integer = 0 To LL.Rows.Count-1                 &#x27;                                if(LL.Rows(r)(&quot;Sal&quot;)&gt;=min*0.65) then                 &#x27;
                                                                                                            If LLcheck=0 Then
                                                                                                                &#x27;                                        LLcheck=1                 &#x27;                                        if(Math.Floor(LL.Rows(r)(&quot;Sal&quot;))&lt;=min) then                 &#x27;                                            Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                                            End If
                                                                                                        else if(LL.Rows(r)(&quot;Sal&quot;)&lt;=min*1.2) then                 &#x27;                                            Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                                        else                 &#x27;                                            ReassignFlag=1                 &#x27;                                            Status=&quot;Salary not identified sincee one transaction in last month is grater than selected salary&quot;                 &#x27;
                                                                                                            end
                                                                                                            if                 &#x27;
                                                                                                            else                  &#x27;                                        ReassignFlag=1                 &#x27;                                        Status=&quot;More than one transaction is grater then 65% of selected salary&quot;                 &#x27;
                                                                                                                end
                                                                                                                if                 &#x27;
                                                                                                                end if                     &#x27;
                                                                                                            next                 test=3.1                                             Salary=minimum
                                                                                                            end
                                                                                                            if
                                                                                                        else                                         min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                                                                            For k As Integer = 0 To 2                                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                                                                                If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                                                                    min=T2.Rows(k)(&quot;Sal&quot;)                                                 minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                                                                                End If
                                                                                                                end
                                                                                                                if
                                                                                                            next                                         Avg= Sum / 3
                                                                                                            If Avg&lt;1.2*min Then
                                                                                                                test=3                 &#x27;
                                                                                                            End If
                                                                                                            For r As Integer = 0 To LL.Rows.Count-1                 &#x27;                                if(LL.Rows(r)(&quot;Sal&quot;)&gt;=Avg*0.65) then                 &#x27;
                                                                                                                If LLcheck=0 Then
                                                                                                                    &#x27;                                        LLcheck=1                 &#x27;                                        if(Math.Floor(LL.Rows(r)(&quot;Sal&quot;))&lt;=Avg) then                 &#x27;                                            Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                                                End If
                                                                                                            else if(LL.Rows(r)(&quot;Sal&quot;)&lt;=Avg*1.2) then                 &#x27;                                            Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                                            else                 &#x27;                                            ReassignFlag=1                 &#x27;                                            Status=&quot;Salary not identified sincee one transaction in last month is grater than selected salary&quot;                 &#x27;
                                                                                                                end
                                                                                                                if                 &#x27;
                                                                                                                else                  &#x27;                                        ReassignFlag=1                 &#x27;                                        Status=&quot;More than one transaction is grater then 65% of selected salary&quot;                 &#x27;
                                                                                                                    end
                                                                                                                    if                 &#x27;
                                                                                                                    end if                     &#x27;
                                                                                                                next                                             Salary=minimum                                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                                                                            else                 &#x27;
                                                                                                                For r As Integer = 0 To LL.Rows.Count-1                 &#x27;                                if(LL.Rows(r)(&quot;Sal&quot;)&gt;=min*0.65) then                 &#x27;
                                                                                                                    If LLcheck=0 Then
                                                                                                                        &#x27;                                        LLcheck=1                 &#x27;                                        if(Math.Floor(LL.Rows(r)(&quot;Sal&quot;))&lt;=min) then                 &#x27;                                            Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                                                    End If
                                                                                                                else if(LL.Rows(r)(&quot;Sal&quot;)&lt;=min*1.2) then                 &#x27;                                            Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                                                else                 &#x27;                                            ReassignFlag=1                 &#x27;                                            Status=&quot;Salary not identified since one transaction in last month is grater than selected salary&quot;                 &#x27;
                                                                                                                    end
                                                                                                                    if                 &#x27;
                                                                                                                    else                  &#x27;                                        ReassignFlag=1                 &#x27;                                        Status=&quot;More than one transaction is grater then 65% of selected salary&quot;                 &#x27;
                                                                                                                        end
                                                                                                                        if                 &#x27;
                                                                                                                        end if                     &#x27;
                                                                                                                    next                 test=3.1                                             Salary=minimum
                                                                                                                    end
                                                                                                                    if
                                                                                                                end if
                                                                                                                end
                                                                                                                if &#x27;===============================================================BB=============================================END
                                                                                                                else
                                                                                                                    Dim Count4 as integer=0
                                                                                                                    Dim Prev as integer =0
                                                                                                                    Dim Base as Decimal=0
                                                                                                                    for r as integer=0 to A1.Rows.Count-1
                                                                                                                        For j as integer=0 to T3.Rows.Count-1
                                                                                                                            if A1.Rows(r)(&quot;Amount&quot;)=T3.Rows(j)(&quot;Sal&quot;)                                             Count4=Count4+1
                                                                                                                                end
                                                                                                                                if
                                                                                                                            next
                                                                                                                            if prev&lt;Count4                                         BasicSalary=A1.Rows(r)(&quot;Amount&quot;)                                         prev=Count4
                                                                                                                                end
                                                                                                                                if                                     Count4=0
                                                                                                                                next                                                 x=T.NewRow
                                                                                                                                For r As Integer = 0 To Buffer.Rows.Count-1                         &#x27;
                                                                                                                                    If (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3) Then
                                                                                                                                        if((SD1m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))OR (SD2m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD3m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD3p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD4m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD4p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))) then                                         x= Buffer.Rows(r)                                         T.ImportRow(x)                                         x=T.NewRow                                         Tcounter=Tcounter+1
                                                                                                                                    End If
                                                                                                                                end if
                                                                                                                            next
                                                                                                                            if Tcounter&lt;2                                     ReassignFlag=1                                     Status=&quot;Total number of feasible transaction is less than 2 after filtering with +/-5 salary date in AA-BB-Gov III&quot;
                                                                                                                            else                                     BSp=BasicSalary+(BasicSalary*20/100)                                     BSm=BasicSalary-(BasicSalary*20/100)                                     x=T2.NewRow
                                                                                                                                for r as integer=0 to T.Rows.count-1                                         if(T.Rows(r)(&quot;Sal&quot;)&gt;=BSm AND T.Rows(r)(&quot;Sal&quot;)&lt;=BSp)                                             x= T.Rows(r)                                             T2.ImportRow(x)                                             x=T2.NewRow                                             T2counter=T2counter+1
                                                                                                                                    end
                                                                                                                                    if
                                                                                                                                next
                                                                                                                                If T2counter&lt;2 Then
                                                                                                                                    ReassignFlag=1                                         Status=&quot;Total number of feasible transaction is less than 2 after filtering BSm&lt;= SAL &lt;=BSp in AA-BB-Gov IV&quot;
                                                                                                                                End If
                                                                                                                            else
                                                                                                                                if T2counter=2                                         min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                                                                                                    For k As Integer = 0 To 1                                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                                                                                                        If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                                                                                            min=T2.Rows(k)(&quot;Sal&quot;)                                                 minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                                                                                                        End If
                                                                                                                                        end
                                                                                                                                        if
                                                                                                                                    next                                         Avg= Sum / 2
                                                                                                                                    If Avg&lt;1.2*min Then
                                                                                                                                        test=4                 &#x27;
                                                                                                                                    End If
                                                                                                                                    For r As Integer = 0 To LL.Rows.Count-1                 &#x27;                                if(LL.Rows(r)(&quot;Sal&quot;)&gt;=Avg*0.65) then                 &#x27;
                                                                                                                                        If LLcheck=0 Then
                                                                                                                                            &#x27;                                        LLcheck=1                 &#x27;                                        if(Math.Floor(LL.Rows(r)(&quot;Sal&quot;))&lt;=Avg) then                 &#x27;                                            Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                                                                        End If
                                                                                                                                    else if(LL.Rows(r)(&quot;Sal&quot;)&lt;=Avg*1.2) then                 &#x27;                                            Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                                                                    else                 &#x27;                                            ReassignFlag=1                 &#x27;                                            Status=&quot;Salary not identified sincee one transaction in last month is grater than selected salary&quot;                 &#x27;
                                                                                                                                        end
                                                                                                                                        if                 &#x27;
                                                                                                                                        else                  &#x27;                                        ReassignFlag=1                 &#x27;                                        Status=&quot;More than one transaction is grater then 65% of selected salary&quot;                 &#x27;
                                                                                                                                            end
                                                                                                                                            if                 &#x27;
                                                                                                                                            end if                     &#x27;
                                                                                                                                        next                                             Salary=minimum                                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                                                                                                    else                 &#x27;
                                                                                                                                        For r As Integer = 0 To LL.Rows.Count-1                 &#x27;                                if(LL.Rows(r)(&quot;Sal&quot;)&gt;=min*0.65) then                 &#x27;
                                                                                                                                            If LLcheck=0 Then
                                                                                                                                                &#x27;                                        LLcheck=1                 &#x27;                                        if(Math.Floor(LL.Rows(r)(&quot;Sal&quot;))&lt;=min) then                 &#x27;                                            Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                                                                            End If
                                                                                                                                        else if(LL.Rows(r)(&quot;Sal&quot;)&lt;=min*1.2) then                 &#x27;                                            Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                                                                        else                 &#x27;                                            ReassignFlag=1                 &#x27;                                            Status=&quot;Salary not identified sincee one transaction in last month is grater than selected salary&quot;                 &#x27;
                                                                                                                                            end
                                                                                                                                            if                 &#x27;
                                                                                                                                            else                  &#x27;                                        ReassignFlag=1                 &#x27;                                        Status=&quot;More than one transaction is grater then 65% of selected salary&quot;                 &#x27;
                                                                                                                                                end
                                                                                                                                                if                 &#x27;
                                                                                                                                                end if                     &#x27;
                                                                                                                                            next                 test=4.1                                             Salary=minimum
                                                                                                                                            end
                                                                                                                                            if
                                                                                                                                        else                                          min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                                                                                                            For k As Integer = 0 To 2                                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                                                                                                                If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                                                                                                    min=T2.Rows(k)(&quot;Sal&quot;)                                                 minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                                                                                                                End If
                                                                                                                                                end
                                                                                                                                                if
                                                                                                                                            next                                         Avg= Sum / 3
                                                                                                                                            If Avg&lt;1.2*min Then
                                                                                                                                                test=4                 &#x27;
                                                                                                                                            End If
                                                                                                                                            For r As Integer = 0 To LL.Rows.Count-1                 &#x27;                                if(LL.Rows(r)(&quot;Sal&quot;)&gt;=Avg*0.65) then                 &#x27;
                                                                                                                                                If LLcheck=0 Then
                                                                                                                                                    &#x27;                                        LLcheck=1                 &#x27;                                        if(Math.Floor(LL.Rows(r)(&quot;Sal&quot;))&lt;=Avg) then                 &#x27;                                            Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                                                                                End If
                                                                                                                                            else if(LL.Rows(r)(&quot;Sal&quot;)&lt;=Avg*1.2) then                 &#x27;                                            Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                                                                            else                 &#x27;                                            ReassignFlag=1                 &#x27;                                            Status=&quot;Salary not identified sincee one transaction in last month is grater than selected salary&quot;                 &#x27;
                                                                                                                                                end
                                                                                                                                                if                 &#x27;
                                                                                                                                                else                  &#x27;                                        ReassignFlag=1                 &#x27;                                        Status=&quot;More than one transaction is grater then 65% of selected salary&quot;                 &#x27;
                                                                                                                                                    end
                                                                                                                                                    if                 &#x27;
                                                                                                                                                    end if                     &#x27;
                                                                                                                                                next                                             Salary=minimum                                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                                                                                                            else                 &#x27;
                                                                                                                                                For r As Integer = 0 To LL.Rows.Count-1                 &#x27;                                if(LL.Rows(r)(&quot;Sal&quot;)&gt;=min*0.65) then                 &#x27;
                                                                                                                                                    If LLcheck=0 Then
                                                                                                                                                        &#x27;                                        LLcheck=1                 &#x27;                                        if(Math.Floor(LL.Rows(r)(&quot;Sal&quot;))&lt;=min) then                 &#x27;                                            Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                                                                                    End If
                                                                                                                                                else if(LL.Rows(r)(&quot;Sal&quot;)&lt;=min*1.2) then                 &#x27;                                            Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                                                                                else                 &#x27;                                            ReassignFlag=1                 &#x27;                                            Status=&quot;Salary not identified sincee one transaction in last month is grater than selected salary&quot;                 &#x27;
                                                                                                                                                    end
                                                                                                                                                    if                 &#x27;
                                                                                                                                                    else                  &#x27;                                        ReassignFlag=1                 &#x27;                                        Status=&quot;More than one transaction is grater then 65% of selected salary&quot;                 &#x27;
                                                                                                                                                        end
                                                                                                                                                        if                 &#x27;
                                                                                                                                                        end if                     &#x27;
                                                                                                                                                    next                 test=4.1                                             Salary=minimum
                                                                                                                                                    end
                                                                                                                                                    if
                                                                                                                                                end if
                                                                                                                                                end
                                                                                                                                                if
                                                                                                                                                end
                                                                                                                                                if
                                                                                                                                                end
                                                                                                                                                if
                                                                                                                                                end
                                                                                                                                                if                     &#x27;
                                                                                                                                                    end
                                                                                                                                                    if &#x27;=============================================================AA===================================================    END
                                                                                                                                                    else                      ReassignFlag=1                     Status=&quot;No transaction available in 2nd last month&quot;
                                                                                                                                                        end
                                                                                                                                                        if
                                                                                                                                                    else                  Status=&quot;More than one transaction in +/-5 days of last month salary date&quot;                 ReassignFlag=1
                                                                                                                                                        end
                                                                                                                                                        if
                                                                                                                                                    else             Status=&quot;No transaction in of last salary date&quot;             ReassignFlag=1
                                                                                                                                                        end
                                                                                                                                                        if
                                                                                                                                                        end
                                                                                                                                                        if
                                                                                                                                                    else      Status=&quot;Total number of feasible transaction is less than 3&quot;     ReassignFlag=1
                                                                                                                                                        end
                                                                                                                                                        if D0=D1 A0=A1
                                                                                                                                                        catch e as Exception         er=e.ToString         ReassignFlag=1         Status=&quot;Code Error:&quot;+e.ToString
                                                                                                                                                            end
                                                                                                                                                            try"
                            data-title="UWCA_MRCC_CTF_V1.0 / Salary code / Salary Calculation(new)13 new 17 jan2017">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>UWCA_MRCC_CTF_V1.0</td>
                <td>Salary code</td>
                <td>Salary Calculation(new)2</td>
                <td>visualbasic</td>
                <td>401</td>
                <!--<td style="font-family: monospace;">4ec8747e4c1a99e1ecc80ee219c8525da07f9cf21773b899a03a3c5fc5133fa5</td>-->
                <td>—</td>
                <!--<td>try     Dim description as string     Dim x As DataRow = D1.NewRow     Dim Dflag as integer =0     Dim precount as integer =0     Dim Amount as integer =0     Dim Avg as integer     Dim Sum as integer =0     Dim skip as integer =0     Dim min as integer =0     Dim count as integer =0 min=0 count=0  ...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="try
    Dim description as string
    Dim x As DataRow = D1.NewRow
    Dim Dflag as integer =0
    Dim precount as integer =0
    Dim Amount as integer =0
    Dim Avg as integer
    Dim Sum as integer =0
    Dim skip as integer =0
    Dim min as integer =0
    Dim count as integer =0 min=0 count=0
    if c1.Rows.Count&gt;2 then
        For r As Integer = 0 To c1.Rows.Count-1         description=c1.Rows(r)(&quot;Description&quot;)         Dflag=0
            for i as integer=0 To D1.Rows.Count-1
                If D1.Rows(i)(&quot;Description&quot;)=description Then
                    Dflag=1
                End If
                end
                if
            next
            If Dflag=0 Then
                x(&quot;Description&quot;) = description             D1.Rows.Add(x)             x= D1.NewRow
            End If
            end
            if
        Next
        For r As Integer = 0 To D1.Rows.Count-1         description=D1.Rows(r)(&quot;Description&quot;)         CollOut=Nothing         CollOut=c1.Clone
            For Each parentRow As DataRow In c1.Select(&quot;Description=&#x27;&quot;+description+&quot;&#x27;&quot;)             x = CollOut.NewRow
                For Each c As DataColumn In x.Table.Columns                     x(c.ColumnName) = parentRow(c.ColumnName)
                Next             CollOut.Rows.Add(x)
            Next         count=CollOut.Rows.Count
            If count&gt;precount Then
                Buffer=Nothing             Buffer = CollOut.Clone             Buffer=CollOut             precount=count             ReassignFlag=0
            End If
        else
            if count = Precount             ReassignFlag=1             Status=&quot;Salary cannot be identified since there mode are equal&quot;
                end
                if
            next
            If Buffer.Rows.Count &gt;2 Then
                ReassignFlag=0
            End If
            if ReassignFlag=0             ReassignFlag=1
                For r As Integer = 0 To Buffer.Rows.Count-1
                    If Buffer.Rows(r)(&quot;Days&quot;)&lt;=TimePeriod Then
                        ReassignFlag=0
                    End If
                    exit
                    for
                    end
                    if
                next
                end
                if
                if ReassignFlag=0             Status=&quot;&quot;
                    For r As Integer = 0 To Buffer.Rows.Count-1                 Amount=Buffer.Rows(r)(&quot;Sal&quot;)                 Dflag=0
                        for i as integer=0 To A1.Rows.Count-1
                            If A1.Rows(i)(&quot;Amount&quot;)=Amount Then
                                Dflag=1                         A1.Rows(i)(&quot;Count&quot;)=A1.Rows(i)(&quot;Count&quot;)+1
                            End If
                            end
                            if
                        next
                        If Dflag=0 Then
                            x= A1.NewRow                     x(&quot;Amount&quot;) = Amount                     x(&quot;Count&quot;)=1                     x(&quot;Salary&quot;)=Buffer.Rows(r)(&quot;Amount&quot;)                     A1.Rows.Add(x)
                        End If
                        end
                        if
                    Next             min=Buffer.Rows(0)(&quot;Sal&quot;)+1
                    For k As Integer = 0 To 2                 Sum=Sum+Buffer.Rows(k)(&quot;Sal&quot;)
                        If min&gt;Buffer.Rows(k)(&quot;Sal&quot;) Then
                            min=Buffer.Rows(k)(&quot;Sal&quot;)                     minimum=Buffer.Rows(k)(&quot;Amount&quot;)
                        End If
                        end
                        if
                    next             Avg= Sum / 3
                    If Avg&lt;1.2*min Then
                        test=1 Cop=A1                 Salary=minimum                 Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                    End If
                else
                    For r As Integer = 0 To A1.Rows.Count-1
                        If (A1.Rows(r)(&quot;Count&quot;)*100/(Buffer.Rows.Count))&gt;60 Then
                            Salary=A1.Rows(r)(&quot;Salary&quot;)                         skip=1
                        End If
                        end
                        if
                    next
                    If skip=0 Then
                        &#x27;vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvPage2vvvvvvvvvvvvvvvvvvvvvvvvvvv
                    End If
                    if Govt=True then
                        Dim SD1p,SD1m,SD2p,SD2m,SD3p,SD3m as date
                        Dim Sflag as integer =0
                        Dim BasicSalary as Integer =0
                        Dim T as DataTable =Buffer.Clone
                        Dim T2 as DataTable=Buffer.Clone
                        Dim TX as DataTable=Buffer.Clone
                        Dim Tcounter as integer =0
                        Dim T2counter as integer =0
                        Dim BSp,BSm as Decimal                          Sum=0                         minimum=0                         Salary=0                         Other=0                         min=0                         SD1p=SD1.AddDays(1)                         SD1m=SD1.AddDays(-1)                         SD2p=SD2.AddDays(1)                         SD2m=SD2.AddDays(-1)                         SD3p=SD3.AddDays(1)                         SD3m=SD3.AddDays(-1)                 &#x27;        T=Buffer.Clone
                        For r As Integer = 0 To Buffer.Rows.Count-1
                            If (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3) Then
                                x= Buffer.Rows(r)                                 TX.ImportRow(x)                                 x=TX.NewRow
                            End If
                        end if
                    next                         Buffer=TX
                    For r As Integer = 0 To Buffer.Rows.Count-1
                        If (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1) Then
                            Sflag=Sflag+1                                 BasicSalary=Buffer.Rows(r)(&quot;Sal&quot;)                                 &#x27;AM=BasicSalary
                        End If
                        end
                        if
                    Next                         &#x27;AM=BasicSalary
                    If Sflag=1 Then
                        x=T.NewRow
                    End If
                    For r As Integer = 0 To Buffer.Rows.Count-1
                        If (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3) Then
                            x= Buffer.Rows(r)                                     T.ImportRow(x)                                     x=T.NewRow                                     Tcounter=Tcounter+1
                        End If
                    end if
                next
                if Tcounter&lt;3                                 ReassignFlag=1                                 Status=&quot;Total number of feasible transaction is less than 3 after filtering with +/-1 salary date&quot;
                else                                 BSp=BasicSalary+(BasicSalary*20/100)                                 BSm=BasicSalary-(BasicSalary*20/100)                                 x=T2.NewRow
                    for r as integer=0 to T.Rows.count-1                                     if(T.Rows(r)(&quot;Sal&quot;)&gt;=BSm AND T.Rows(r)(&quot;Sal&quot;)&lt;=BSp)                                         x= T.Rows(r)                                         T2.ImportRow(x)                                         x=T2.NewRow                                         T2counter=T2counter+1
                        end
                        if
                    next
                    If T2counter&lt;3 Then
                        ReassignFlag=1                                     Status=&quot;Total number of feasible transaction is less than 3 after filtering BSm &lt;= Salary &lt;=BSp&quot;
                    End If
                else
                    if T2counter=3                                     min=T2.Rows(0)(&quot;Sal&quot;)+1
                        For k As Integer = 0 To 2                                         Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                            If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                min=T2.Rows(k)(&quot;Sal&quot;)                                             minimum=T2.Rows(k)(&quot;Amount&quot;)
                            End If
                            end
                            if
                        next                                     Avg= Sum / 3
                        If Avg&lt;1.2*min Then
                            test=2                                         Salary=minimum                                         Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                        End If
                    else                                         Salary=minimum                                         Other=0
                        end
                        if
                    end if
                    end
                    if                     &#x27;    test=T                     &#x27;    testT=Tcounter
                    else &#x27;=============================================================AA===================================================BEGIN
                        Dim T3 as DataTable=Buffer.Clone
                        Dim Tcounter2 as integer=0
                        for r as integer =0 to Buffer.Rows.Count-1                                 if(Buffer.Rows(r)(&quot;Sal&quot;)&gt;=LastApproved) then                                     x=T3.NewRow                                     x=Buffer.Rows(r)                                     T3.ImportRow(x)                                     Tcounter2=Tcounter2+1                                     BasicSalary=Buffer.Rows(r)(&quot;Sal&quot;)
                            end
                            if
                        next                                 Buffer=Nothing                             Buffer=T3 &#x27;===============================================================BB=============================================BEGIN                             if(Tcounter2=1)                                 x=T.NewRow
                        For r As Integer = 0 To Buffer.Rows.Count-1
                            If (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3) Then
                                x= Buffer.Rows(r)                                         T.ImportRow(x)                                         x=T.NewRow                                         Tcounter=Tcounter+1
                            End If
                        end if
                    next
                    if Tcounter&lt;3                                     ReassignFlag=1                                     Status=&quot;Total number of feasible transaction is less than 3 after filtering with +/-1 salary date in AA-BB-Gov&quot;
                    else                                     BSp=BasicSalary+(BasicSalary*20/100)                                     BSm=BasicSalary-(BasicSalary*20/100)                                     x=T2.NewRow
                        for r as integer=0 to T.Rows.count-1                                         if(T.Rows(r)(&quot;Sal&quot;)&gt;=BSm AND T.Rows(r)(&quot;Sal&quot;)&lt;=BSp)                                             x= T.Rows(r)                                             T2.ImportRow(x)                                             x=T2.NewRow                                             T2counter=T2counter+1
                            end
                            if
                        next
                        If T2counter&lt;3 Then
                            ReassignFlag=1                                         Status=&quot;Total number of feasible transaction is less than 3 after filtering with +/-1 salary date in AA-BB-Gov II&quot;
                        End If
                    else
                        if T2counter=3                                         min=T2.Rows(0)(&quot;Sal&quot;)+1
                            For k As Integer = 0 To 2                                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                    min=T2.Rows(k)(&quot;Sal&quot;)                                                 minimum=T2.Rows(k)(&quot;Amount&quot;)
                                End If
                                end
                                if
                            next                                         Avg= Sum / 3
                            If Avg&lt;1.2*min Then
                                test=3                                             Salary=minimum                                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                            End If
                        else                                             Salary=minimum                                             Other=0
                            end
                            if
                        end if
                        end
                        if &#x27;===============================================================BB=============================================END
                        else
                            Dim Count4 as integer=0
                            Dim Prev as integer =0
                            Dim Base as Decimal=0
                            for r as integer=0 to A1.Rows.Count-1
                                For j as integer=0 to T3.Rows.Count-1
                                    if A1.Rows(r)(&quot;Amount&quot;)=T3.Rows(j)(&quot;Sal&quot;)                                             Count4=Count4+1
                                        end
                                        if
                                    next
                                    if prev&lt;Count4                                         BasicSalary=A1.Rows(r)(&quot;Amount&quot;)                                         prev=Count4
                                        end
                                        if                                     Count4=0
                                        next                                                 x=T.NewRow
                                        For r As Integer = 0 To Buffer.Rows.Count-1
                                            If (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3) Then
                                                x= Buffer.Rows(r)                                         T.ImportRow(x)                                         x=T.NewRow                                         Tcounter=Tcounter+1
                                            End If
                                        end if
                                    next
                                    if Tcounter&lt;3                                     ReassignFlag=1                                     Status=&quot;Total number of feasible transaction is less than 3 after filtering with +/-1 salary date in AA-BB-Gov III&quot;
                                    else                                     BSp=BasicSalary+(BasicSalary*20/100)                                     BSm=BasicSalary-(BasicSalary*20/100)                                     x=T2.NewRow
                                        for r as integer=0 to T.Rows.count-1                                         if(T.Rows(r)(&quot;Sal&quot;)&gt;=BSm AND T.Rows(r)(&quot;Sal&quot;)&lt;=BSp)                                             x= T.Rows(r)                                             T2.ImportRow(x)                                             x=T2.NewRow                                             T2counter=T2counter+1
                                            end
                                            if
                                        next
                                        If T2counter&lt;3 Then
                                            ReassignFlag=1                                         Status=&quot;Total number of feasible transaction is less than 3 after filtering BSm&lt;= SAL &lt;=BSp in AA-BB-Gov IV&quot;
                                        End If
                                    else
                                        if T2counter=3                                         min=T2.Rows(0)(&quot;Sal&quot;)+1
                                            For k As Integer = 0 To 2                                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                    min=T2.Rows(k)(&quot;Sal&quot;)                                                 minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                End If
                                                end
                                                if
                                            next                                         Avg= Sum / 3
                                            If Avg&lt;1.2*min Then
                                                test=4                                             Salary=minimum                                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                            End If
                                        else                                             Salary=minimum                                             Other=0
                                            end
                                            if
                                        end if
                                        end
                                        if
                                        end
                                        if  &#x27;=============================================================AA===================================================    END
                                            end
                                            if
                                        else &#x27;==========================================================================B===================================BEGIN
                                            Dim Sflag as integer =0
                                            Dim BasicSalary as Integer =0
                                            Dim T as DataTable =Buffer.Clone
                                            Dim T2 as DataTable=Buffer.Clone
                                            Dim Tcounter as integer =0
                                            Dim T2counter as integer =0
                                            Dim BSp,BSm as Decimal
                                            Dim BaseDays as Decimal =0
                                            Dim Dayz as decimal=0                         Sum=0                         minimum=0                         Salary=0                         Sflag=0                         Other=0                         min=0
                                            For r As Integer = 0 To Buffer.Rows.Count-1
                                                If (Buffer.Rows(r)(&quot;Days&quot;)&lt;=30) Then
                                                    Sflag=Sflag+1                                 BasicSalary=Buffer.Rows(r)(&quot;Sal&quot;)                                 x=T.NewRow                                 x= Buffer.Rows(r)                                 T.ImportRow(x)                                 Tcounter=1                                 BaseDays=Buffer.Rows(r)(&quot;Days&quot;)
                                                End If
                                                end
                                                if
                                            Next &#x27;=======================================================================================BB=================================================BEGIN
                                            If Sflag=1 Then
                                                x=T.NewRow
                                            End If
                                            For r As Integer = 0 To Buffer.Rows.Count-1                                     Dayz=Buffer.Rows(r)(&quot;Days&quot;)                                 Dayz=Dayz-BaseDays
                                                If ((Dayz&gt;=25 AND Dayz&lt;=35) OR (Dayz&gt;=55 AND Dayz&lt;=65) ) Then
                                                    x= Buffer.Rows(r)                                     T.ImportRow(x)                                     x=T.NewRow                                     Tcounter=Tcounter+1
                                                End If
                                            end if
                                        next                             &#x27;testT=Tcounter /checked
                                        if Tcounter&lt;3                                 ReassignFlag=1                                 Status=&quot;Total number of feasible transaction is less than 3 after filtering with 25-35 and 55 to 65 in BB-nonGov I&quot;
                                        else                                 BSp=BasicSalary+(BasicSalary*20/100)                                 BSm=BasicSalary-(BasicSalary*20/100)                                 x=T2.NewRow
                                            for r as integer=0 to T.Rows.count-1                                     if(T.Rows(r)(&quot;Sal&quot;)&gt;=BSm AND T.Rows(r)(&quot;Sal&quot;)&lt;=BSp)                                         x= T.Rows(r)                                         T2.ImportRow(x)                                         x=T2.NewRow                                         T2counter=T2counter+1
                                                end
                                                if
                                            next
                                            If T2counter&lt;3 Then
                                                ReassignFlag=1                                     Status=&quot;Total number of feasible transaction is less than 3 after filtering BSm&lt;=SAL&lt;=BSp BB-non Gov II&quot;
                                            End If
                                        else
                                            if T2counter=3                                     min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                For k As Integer = 0 To 2                                         Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                    If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                        min=T2.Rows(k)(&quot;Sal&quot;)                                             minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                    End If
                                                    end
                                                    if
                                                next                                      Avg= Sum / 3
                                                If Avg&lt;1.2*min Then
                                                    Salary=minimum                                         Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                End If
                                            else                                          Salary=minimum                                         Other=0
                                                end
                                                if
                                            end if
                                            end
                                            if                         &#x27;test=T2                         &#x27;testT=Tcounter
                                            else &#x27;++++++++++++++++++++++AA+++++++++ &#x27;=============================================================AA===================================================BEGIN
                                                Dim T3 as DataTable=Buffer.Clone
                                                Dim Tcounter2 as integer=0
                                                for r as integer =0 to Buffer.Rows.Count-1                                 if(Buffer.Rows(r)(&quot;Sal&quot;)&gt;=LastApproved) then                                     x=T3.NewRow                                     x=Buffer.Rows(r)                                     T3.ImportRow(x)                                     Tcounter2=Tcounter2+1                                     BasicSalary=Buffer.Rows(r)(&quot;Sal&quot;)
                                                    end
                                                    if
                                                next                                 Buffer=Nothing                             Buffer=T3 &#x27;===============================================================BB=============================================BEGIN                             if(Tcounter2=1)                                 x=T.NewRow
                                                For r As Integer = 0 To Buffer.Rows.Count-1                                         Dayz=Buffer.Rows(r)(&quot;Days&quot;)                                     Dayz=Dayz-BaseDays
                                                    If ((Dayz&gt;=25 AND Dayz&lt;=35) OR (Dayz&gt;=55 AND Dayz&lt;=65) ) Then
                                                        x= Buffer.Rows(r)                                         T.ImportRow(x)                                         x=T.NewRow                                         Tcounter=Tcounter+1
                                                    End If
                                                end if
                                            next                                 &#x27;testT=Tcounter /checked
                                            if Tcounter&lt;3                                     ReassignFlag=1                                     Status=&quot;Total number of feasible transaction is less than 3 after filtering with 25-35 and 55 to 65 in AA-BB-nonGov III&quot;
                                            else                                     BSp=BasicSalary+(BasicSalary*20/100)                                     BSm=BasicSalary-(BasicSalary*20/100)                                     x=T2.NewRow
                                                for r as integer=0 to T.Rows.count-1                                         if(T.Rows(r)(&quot;Sal&quot;)&gt;=BSm AND T.Rows(r)(&quot;Sal&quot;)&lt;=BSp)                                             x= T.Rows(r)                                             T2.ImportRow(x)                                             x=T2.NewRow                                             T2counter=T2counter+1
                                                    end
                                                    if
                                                next
                                                If T2counter&lt;3 Then
                                                    ReassignFlag=1                                         Status=&quot;Total number of feasible transaction is less than 3 after filtering BSm&lt;SAL&lt;BSp in AA-BB-nonGov IV&quot;
                                                End If
                                            else
                                                if T2counter=3                                         min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                    For k As Integer = 0 To 2                                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                        If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                            min=T2.Rows(k)(&quot;Sal&quot;)                                                 minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                        End If
                                                        end
                                                        if
                                                    next                                          Avg= Sum / 3
                                                    If Avg&lt;1.2*min Then
                                                        Salary=minimum                                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                    End If
                                                else                                              Salary=minimum                                             Other=0
                                                    end
                                                    if
                                                end if
                                                end
                                                if  &#x27;===============================================================BB=============================================END
                                                else
                                                    Dim Count4 as integer=0
                                                    Dim Prev as integer =0
                                                    Dim Base as Decimal=0
                                                    for r as integer=0 to A1.Rows.Count-1
                                                        For j as integer=0 to T3.Rows.Count-1
                                                            if A1.Rows(r)(&quot;Amount&quot;)=T3.Rows(j)(&quot;Sal&quot;)                                             Count4=Count4+1
                                                                end
                                                                if
                                                            next
                                                            if prev&lt;Count4                                         BasicSalary=A1.Rows(r)(&quot;Amount&quot;)
                                                                end
                                                                if
                                                            next &#x27;============================================================BB=============================================BEGIN                                             x=T.NewRow
                                                            For r As Integer = 0 To Buffer.Rows.Count-1                                         Dayz=Buffer.Rows(r)(&quot;Days&quot;)                                     Dayz=Dayz-BaseDays
                                                                If ((Dayz&gt;=25 AND Dayz&lt;=35) OR (Dayz&gt;=55 AND Dayz&lt;=65) ) Then
                                                                    x= Buffer.Rows(r)                                         T.ImportRow(x)                                         x=T.NewRow                                         Tcounter=Tcounter+1
                                                                End If
                                                            end if
                                                        next                                 &#x27;testT=Tcounter /checked
                                                        if Tcounter&lt;3                                     ReassignFlag=1                                     Status=&quot;Total number of feasible transaction is less than 3 after filtering 25-35 and 55-65 in AA-BB-nonGov V&quot;
                                                        else                                     BSp=BasicSalary+(BasicSalary*20/100)                                     BSm=BasicSalary-(BasicSalary*20/100)                                     x=T2.NewRow
                                                            for r as integer=0 to T.Rows.count-1                                         if(T.Rows(r)(&quot;Sal&quot;)&gt;=BSm AND T.Rows(r)(&quot;Sal&quot;)&lt;=BSp)                                             x= T.Rows(r)                                             T2.ImportRow(x)                                             x=T2.NewRow                                             T2counter=T2counter+1
                                                                end
                                                                if
                                                            next
                                                            If T2counter&lt;3 Then
                                                                ReassignFlag=1                                         Status=&quot;Total number of feasible transaction is less than 3 after filtering BSp&lt;=SAL&lt;=BSp in AA-BB-nonGov VI&quot;
                                                            End If
                                                        else                                          min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                            For k As Integer = 0 To 2                                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                                If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                    min=T2.Rows(k)(&quot;Sal&quot;)                                                 minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                                End If
                                                                end
                                                                if
                                                            next                                          Avg= Sum / 3
                                                            If Avg&lt;1.2*min Then
                                                                Salary=minimum                                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                            End If
                                                        else                                              Salary=minimum                                             Other=0
                                                            end
                                                            if
                                                        end if
                                                        end
                                                        if &#x27;===========================================================BB======================================================END
                                                            end
                                                            if &#x27;=============================================================AA===================================================    END
                                                                end
                                                                if &#x27;==============================================================BB============================================END                      &#x27;==============================================================B=============================================END
                                                                    end
                                                                    if &#x27;^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^Page2^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                                                        end
                                                                        if
                                                                        end
                                                                        if
                                                                    else             Status=&quot;Salary cannot be identified since there is no transaction in the past &quot;+TimePeriod.ToString+&quot; days&quot;             ReassignFlag=1
                                                                        end
                                                                        if
                                                                    else         ReassignFlag=1         Status=&quot;Total number of feasible transaction is less than 3&quot;
                                                                        end
                                                                        if
                                                                    else      Status=&quot;Total number of feasible transaction is less than 3&quot;     ReassignFlag=1
                                                                        end
                                                                        if D0=D1 A0=A1
                                                                        catch e as Exception         er=e.ToString         ReassignFlag=1         Status=&quot;Code Error:&quot;+e.ToString
                                                                            end
                                                                            try"
                            data-title="UWCA_MRCC_CTF_V1.0 / Salary code / Salary Calculation(new)2">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>UWCA_MRCC_CTF_V1.0</td>
                <td>Salary code</td>
                <td>Salary Calculation(new)3</td>
                <td>visualbasic</td>
                <td>497</td>
                <!--<td style="font-family: monospace;">cb9101ea1fce3186fc1aa580c11d595271cadb2e7899b5abd4eec6c2afc632d5</td>-->
                <td>—</td>
                <!--<td>try     Dim description as string     Dim x As DataRow = D1.NewRow     Dim Dflag as integer =0     Dim precount as integer =0     Dim Amount as integer =0     Dim Avg as integer=0     Dim Sum as integer =0     Dim skip as integer =0     Dim min as integer =0     Dim count as integer =0     Dim Av as...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="try
    Dim description as string
    Dim x As DataRow = D1.NewRow
    Dim Dflag as integer =0
    Dim precount as integer =0
    Dim Amount as integer =0
    Dim Avg as integer=0
    Dim Sum as integer =0
    Dim skip as integer =0
    Dim min as integer =0
    Dim count as integer =0
    Dim Av as integer =0
    Dim mi as integer =0
    Dim minim as string min=0 count=0 minim=&quot;&quot;
    if c1.Rows.Count&gt;2 then
        For r As Integer = 0 To c1.Rows.Count-1         description=c1.Rows(r)(&quot;Description&quot;)         Dflag=0
            for i as integer=0 To D1.Rows.Count-1
                If D1.Rows(i)(&quot;Description&quot;)=description Then
                    Dflag=1                 D1.Rows(i)(&quot;Count&quot;)=D1.Rows(i)(&quot;Count&quot;)+1
                End If
                end
                if
            next
            If Dflag=0 Then
                x(&quot;Description&quot;) = description             x(&quot;Count&quot;)=1             D1.Rows.Add(x)             x= D1.NewRow
            End If
            end
            if
        Next
        For r As Integer = 0 To D1.Rows.Count-1         description=D1.Rows(r)(&quot;Description&quot;)         CollOut=Nothing         CollOut=c1.Clone
            For Each parentRow As DataRow In c1.Select(&quot;Description=&#x27;&quot;+description+&quot;&#x27;&quot;)             x = CollOut.NewRow
                For Each c As DataColumn In x.Table.Columns                     x(c.ColumnName) = parentRow(c.ColumnName)
                Next             CollOut.Rows.Add(x)
            Next         count=CollOut.Rows.Count
            If count&gt;precount Then
                Buffer=Nothing             Buffer = CollOut.Clone             Buffer=CollOut             precount=count             ReassignFlag=0
            End If
        else
            if count = Precount             ReassignFlag=1             Status=&quot;Salary cannot be identified since there mode are equal&quot;
                end
                if
            next
            If Buffer.Rows.Count &gt;2 Then
                ReassignFlag=0
            End If
            if ReassignFlag=0             ReassignFlag=1
                For r As Integer = 0 To Buffer.Rows.Count-1
                    If Buffer.Rows(r)(&quot;Days&quot;)&lt;=TimePeriod Then
                        ReassignFlag=0
                    End If
                    exit
                    for
                    end
                    if
                next
                end
                if
                if ReassignFlag=0             Status=&quot;&quot;
                    For r As Integer = 0 To Buffer.Rows.Count-1                 Amount=Buffer.Rows(r)(&quot;Sal&quot;)                 Dflag=0
                        for i as integer=0 To A1.Rows.Count-1
                            If A1.Rows(i)(&quot;Amount&quot;)=Amount Then
                                Dflag=1                         A1.Rows(i)(&quot;Count&quot;)=A1.Rows(i)(&quot;Count&quot;)+1
                            End If
                            end
                            if
                        next
                        If Dflag=0 Then
                            x= A1.NewRow                     x(&quot;Amount&quot;) = Amount                     x(&quot;Count&quot;)=1                     x(&quot;Salary&quot;)=Buffer.Rows(r)(&quot;Amount&quot;)                     A1.Rows.Add(x)
                        End If
                        end
                        if
                    Next             min=Buffer.Rows(0)(&quot;Sal&quot;)+1
                    For k As Integer = 0 To 2                 Sum=Sum+Buffer.Rows(k)(&quot;Sal&quot;)
                        If min&gt;Buffer.Rows(k)(&quot;Sal&quot;) Then
                            min=Buffer.Rows(k)(&quot;Sal&quot;)                     minimum=Buffer.Rows(k)(&quot;Amount&quot;)
                        End If
                        end
                        if
                        if k=1                     Av=Sum/2                     mi=min                     minim=minimum
                            end
                            if
                        next             Avg= Sum / 3
                        If Avg&lt;1.2*min Then
                            test=1 Cop=A1                 Salary=minimum                 Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                        End If
                    else
                        If Av&lt;1.2*mi Then
                            minimum=minim                 Salary=minimum                 Other=Replace((Av-mi),&quot;.&quot;,&quot;,&quot;)
                        End If
                    else
                        For r As Integer = 0 To A1.Rows.Count-1
                            If (A1.Rows(r)(&quot;Count&quot;)*100/(Buffer.Rows.Count))&gt;60 Then
                                Salary=A1.Rows(r)(&quot;Salary&quot;)                         skip=1
                            End If
                            end
                            if
                        next
                        If skip=0 Then
                            &#x27;vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvPage2vvvvvvvvvvvvvvvvvvvvvvvvvvv
                        End If
                        if Govt=True then
                            Dim SD1p,SD1m,SD2p,SD2m,SD3p,SD3m as date
                            Dim Sflag as integer =0
                            Dim BasicSalary as Integer =0
                            Dim T as DataTable =Buffer.Clone
                            Dim T2 as DataTable=Buffer.Clone
                            Dim TX as DataTable=Buffer.Clone
                            Dim Tcounter as integer =0
                            Dim T2counter as integer =0
                            Dim BSp,BSm as Decimal                          Sum=0                         minimum=0                         Salary=0                         Other=0                         min=0                         SD1p=SD1.AddDays(5)                         SD1m=SD1.AddDays(-5)                         SD2p=SD2.AddDays(5)                         SD2m=SD2.AddDays(-5)                         SD3p=SD3.AddDays(5)                         SD3m=SD3.AddDays(-5)                 &#x27;        T=Buffer.Clone
                            For r As Integer = 0 To Buffer.Rows.Count-1 &#x27;
                                If (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3) Then
                                    if((SD1m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))OR (SD2m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD3m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD3p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))) then                                 x= Buffer.Rows(r)                                 TX.ImportRow(x)                                 x=TX.NewRow
                                End If
                            end if
                        next                         Buffer=TX
                        For r As Integer = 0 To Buffer.Rows.Count-1                 &#x27;
                            if (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1) then
                                If (SD1m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) Then
                                    Sflag=Sflag+1                                 BasicSalary=Buffer.Rows(r)(&quot;Sal&quot;)                                 &#x27;AM=BasicSalary
                                End If
                                end
                                if
                            Next                         &#x27;AM=BasicSalary
                            If Sflag=1 Then
                                x=T.NewRow
                            End If
                            For r As Integer = 0 To Buffer.Rows.Count-1                 &#x27;
                                If (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3) Then
                                    if((SD1m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))OR (SD2m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD3m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD3p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))) then                                     x= Buffer.Rows(r)                                     T.ImportRow(x)                                     x=T.NewRow                                     Tcounter=Tcounter+1
                                End If
                            end if
                        next
                        if Tcounter&lt;3                                 ReassignFlag=1                                 Status=&quot;Total number of feasible transaction is less than 3 after filtering with +/-5 salary date I&quot;
                        else                                 BSp=BasicSalary+(BasicSalary*20/100)                                 BSm=BasicSalary-(BasicSalary*20/100)                                 x=T2.NewRow
                            for r as integer=0 to T.Rows.count-1                                     if(T.Rows(r)(&quot;Sal&quot;)&gt;=BSm AND T.Rows(r)(&quot;Sal&quot;)&lt;=BSp)                                         x= T.Rows(r)                                         T2.ImportRow(x)                                         x=T2.NewRow                                         T2counter=T2counter+1
                                end
                                if
                            next
                            If T2counter&lt;2 Then
                                ReassignFlag=1                                     Status=&quot;Total number of feasible transaction is less than 2 after filtering BSm &lt;= Salary &lt;=BSp&quot;
                            End If
                        else
                            if T2counter=2                                     min=T2.Rows(0)(&quot;Sal&quot;)+1
                                For k As Integer = 0 To 1                                         Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                    If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                        min=T2.Rows(k)(&quot;Sal&quot;)                                             minimum=T2.Rows(k)(&quot;Amount&quot;)
                                    End If
                                    end
                                    if
                                next                                     Avg= Sum / 2
                                If Avg&lt;1.2*min Then
                                    test=2                                         Salary=minimum                                         Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                End If
                            else                                         Salary=minimum                                         Other=0
                                end
                                if
                            else                                     min=T2.Rows(0)(&quot;Sal&quot;)+1
                                For k As Integer = 0 To 2                                         Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                    If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                        min=T2.Rows(k)(&quot;Sal&quot;)                                             minimum=T2.Rows(k)(&quot;Amount&quot;)
                                    End If
                                    end
                                    if
                                next                                     Avg= Sum / 3
                                If Avg&lt;1.2*min Then
                                    test=2                                         Salary=minimum                                         Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                End If
                            else                                         Salary=minimum                                         Other=0
                                end
                                if
                            end if
                            end
                            if                     &#x27;    test=T                     &#x27;    testT=Tcounter
                            else &#x27;=============================================================AA===================================================BEGIN
                                Dim T3 as DataTable=Buffer.Clone
                                Dim Tcounter2 as integer=0
                                for r as integer =0 to Buffer.Rows.Count-1                                 if(Buffer.Rows(r)(&quot;Sal&quot;)&gt;=LastApproved) then                                     x=T3.NewRow                                     x=Buffer.Rows(r)                                     T3.ImportRow(x)                                     Tcounter2=Tcounter2+1                                     BasicSalary=Buffer.Rows(r)(&quot;Sal&quot;)
                                    end
                                    if
                                next                             &#x27;    Buffer=Nothing                         &#x27;    Buffer=T3 Cop=Buffer &#x27;===============================================================BB=============================================BEGIN                             if(Tcounter2=1)                                 x=T.NewRow
                                For r As Integer = 0 To Buffer.Rows.Count-1                 &#x27;
                                    If (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3) Then
                                        if((SD1m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))OR (SD2m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD3m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD3p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))) then                                         x= Buffer.Rows(r)                                         T.ImportRow(x)                                         x=T.NewRow                                         Tcounter=Tcounter+1
                                    End If
                                end if
                            next
                            if Tcounter&lt;3                                     ReassignFlag=1                                     Status=&quot;Total number of feasible transaction is less than 3 after filtering with +/-5 salary date in AA-BB-Gov I&quot;
                            else                                     BSp=BasicSalary+(BasicSalary*20/100)                                     BSm=BasicSalary-(BasicSalary*20/100)                                     x=T2.NewRow
                                for r as integer=0 to T.Rows.count-1                                         if(T.Rows(r)(&quot;Sal&quot;)&gt;=BSm AND T.Rows(r)(&quot;Sal&quot;)&lt;=BSp)                                             x= T.Rows(r)                                             T2.ImportRow(x)                                             x=T2.NewRow                                             T2counter=T2counter+1
                                    end
                                    if
                                next
                                If T2counter&lt;2 Then
                                    ReassignFlag=1                                         Status=&quot;Total number of feasible transaction is less than 2 after filtering with +/-5 salary date in AA-BB-Gov II&quot;
                                End If
                            else
                                if T2counter=2                                         min=T2.Rows(0)(&quot;Sal&quot;)+1
                                    For k As Integer = 0 To 1                                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                        If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                            min=T2.Rows(k)(&quot;Sal&quot;)                                                 minimum=T2.Rows(k)(&quot;Amount&quot;)
                                        End If
                                        end
                                        if
                                    next                                         Avg= Sum / 2
                                    If Avg&lt;1.2*min Then
                                        test=3                                             Salary=minimum                                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                    End If
                                else                                             Salary=minimum                                             Other=0
                                    end
                                    if
                                else                                         min=T2.Rows(0)(&quot;Sal&quot;)+1
                                    For k As Integer = 0 To 2                                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                        If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                            min=T2.Rows(k)(&quot;Sal&quot;)                                                 minimum=T2.Rows(k)(&quot;Amount&quot;)
                                        End If
                                        end
                                        if
                                    next                                         Avg= Sum / 3
                                    If Avg&lt;1.2*min Then
                                        test=3                                             Salary=minimum                                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                    End If
                                else                                             Salary=minimum                                             Other=0
                                    end
                                    if
                                end if
                                end
                                if &#x27;===============================================================BB=============================================END
                                else
                                    Dim Count4 as integer=0
                                    Dim Prev as integer =0
                                    Dim Base as Decimal=0
                                    for r as integer=0 to A1.Rows.Count-1
                                        For j as integer=0 to T3.Rows.Count-1
                                            if A1.Rows(r)(&quot;Amount&quot;)=T3.Rows(j)(&quot;Sal&quot;)                                             Count4=Count4+1
                                                end
                                                if
                                            next
                                            if prev&lt;Count4                                         BasicSalary=A1.Rows(r)(&quot;Amount&quot;)                                         prev=Count4
                                                end
                                                if                                     Count4=0
                                                next                                                 x=T.NewRow
                                                For r As Integer = 0 To Buffer.Rows.Count-1                 &#x27;
                                                    If (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3) Then
                                                        if((SD1m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))OR (SD2m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD3m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD3p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))) then                                         x= Buffer.Rows(r)                                         T.ImportRow(x)                                         x=T.NewRow                                         Tcounter=Tcounter+1
                                                    End If
                                                end if
                                            next
                                            if Tcounter&lt;3                                     ReassignFlag=1                                     Status=&quot;Total number of feasible transaction is less than 3 after filtering with +/-5 salary date in AA-BB-Gov III&quot;
                                            else                                     BSp=BasicSalary+(BasicSalary*20/100)                                     BSm=BasicSalary-(BasicSalary*20/100)                                     x=T2.NewRow
                                                for r as integer=0 to T.Rows.count-1                                         if(T.Rows(r)(&quot;Sal&quot;)&gt;=BSm AND T.Rows(r)(&quot;Sal&quot;)&lt;=BSp)                                             x= T.Rows(r)                                             T2.ImportRow(x)                                             x=T2.NewRow                                             T2counter=T2counter+1
                                                    end
                                                    if
                                                next
                                                If T2counter&lt;2 Then
                                                    ReassignFlag=1                                         Status=&quot;Total number of feasible transaction is less than 2 after filtering BSm&lt;= SAL &lt;=BSp in AA-BB-Gov IV&quot;
                                                End If
                                            else
                                                if T2counter=2                                         min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                    For k As Integer = 0 To 1                                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                        If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                            min=T2.Rows(k)(&quot;Sal&quot;)                                                 minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                        End If
                                                        end
                                                        if
                                                    next                                         Avg= Sum / 2
                                                    If Avg&lt;1.2*min Then
                                                        test=4                                             Salary=minimum                                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                    End If
                                                else                                             Salary=minimum                                             Other=0
                                                    end
                                                    if
                                                else                                          min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                    For k As Integer = 0 To 2                                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                        If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                            min=T2.Rows(k)(&quot;Sal&quot;)                                                 minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                        End If
                                                        end
                                                        if
                                                    next                                         Avg= Sum / 3
                                                    If Avg&lt;1.2*min Then
                                                        test=4                                             Salary=minimum                                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                    End If
                                                else                                             Salary=minimum                                             Other=0
                                                    end
                                                    if
                                                end if
                                                end
                                                if
                                                end
                                                if  &#x27;=============================================================AA===================================================    END
                                                    end
                                                    if
                                                else &#x27;==========================================================================B===================================BEGIN
                                                    Dim Sflag as integer =0
                                                    Dim BasicSalary as Integer =0
                                                    Dim T as DataTable =Buffer.Clone
                                                    Dim T2 as DataTable=Buffer.Clone
                                                    Dim Tcounter as integer =0
                                                    Dim T2counter as integer =0
                                                    Dim BSp,BSm as Decimal
                                                    Dim BaseDays as Decimal =0
                                                    Dim Dayz as decimal=0                         Sum=0                         minimum=0                         Salary=0                         Sflag=0                         Other=0                         min=0
                                                    For r As Integer = 0 To Buffer.Rows.Count-1
                                                        If (Buffer.Rows(r)(&quot;Days&quot;)&lt;=TimePeriod) Then
                                                            Sflag=Sflag+1                                 BasicSalary=Buffer.Rows(r)(&quot;Sal&quot;)                                 x=T.NewRow                                 x= Buffer.Rows(r)                                 T.ImportRow(x)                                 Tcounter=1                                 BaseDays=Buffer.Rows(r)(&quot;Days&quot;)
                                                        End If
                                                        end
                                                        if
                                                    Next &#x27;=======================================================================================BB=================================================BEGIN
                                                    If Sflag=1 Then
                                                        x=T.NewRow
                                                    End If
                                                    For r As Integer = 0 To Buffer.Rows.Count-1                                     Dayz=Buffer.Rows(r)(&quot;Days&quot;)                                 Dayz=Dayz-BaseDays
                                                        If ((Dayz&gt;=25 AND Dayz&lt;=35) OR (Dayz&gt;=55 AND Dayz&lt;=65) ) Then
                                                            x= Buffer.Rows(r)                                     T.ImportRow(x)                                     x=T.NewRow                                     Tcounter=Tcounter+1
                                                        End If
                                                    end if
                                                next                             &#x27;testT=Tcounter /checked
                                                if Tcounter&lt;3                                 ReassignFlag=1                                 Status=&quot;Total number of feasible transaction is less than 3 after filtering with 25-35 and 55 to 65 in AA-BB-nonGov II&quot;
                                                else                                 BSp=BasicSalary+(BasicSalary*20/100)                                 BSm=BasicSalary-(BasicSalary*20/100)                                 x=T2.NewRow
                                                    for r as integer=0 to T.Rows.count-1                                     if(T.Rows(r)(&quot;Sal&quot;)&gt;=BSm AND T.Rows(r)(&quot;Sal&quot;)&lt;=BSp)                                         x= T.Rows(r)                                         T2.ImportRow(x)                                         x=T2.NewRow                                         T2counter=T2counter+1
                                                        end
                                                        if
                                                    next
                                                    If T2counter&lt;2 Then
                                                        ReassignFlag=1                                     Status=&quot;Total number of feasible transaction is less than 2 after filtering BSm&lt;=SAL&lt;=BSp BB-non Gov II&quot;
                                                    End If
                                                else
                                                    if T2counter=2
                                                        For k As Integer = 0 To 1                                         Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                            If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                min=T2.Rows(k)(&quot;Sal&quot;)                                             minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                            End If
                                                            end
                                                            if
                                                        next                                      Avg= Sum / 2
                                                        If Avg&lt;1.2*min Then
                                                            Salary=minimum                                         Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                        End If
                                                    else                                          Salary=minimum                                         Other=0
                                                        end
                                                        if
                                                    else                                       min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                        For k As Integer = 0 To 2                                         Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                            If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                min=T2.Rows(k)(&quot;Sal&quot;)                                             minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                            End If
                                                            end
                                                            if
                                                        next                                      Avg= Sum / 3
                                                        If Avg&lt;1.2*min Then
                                                            Salary=minimum                                         Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                        End If
                                                    else                                          Salary=minimum                                         Other=0
                                                        end
                                                        if
                                                    end if
                                                    end
                                                    if                         &#x27;test=T2                         &#x27;testT=Tcounter
                                                    else &#x27;++++++++++++++++++++++AA+++++++++ &#x27;=============================================================AA===================================================BEGIN
                                                        Dim T3 as DataTable=Buffer.Clone
                                                        Dim Tcounter2 as integer=0
                                                        for r as integer =0 to Buffer.Rows.Count-1                                 if(Buffer.Rows(r)(&quot;Sal&quot;)&gt;=LastApproved) then                                     x=T3.NewRow                                     x=Buffer.Rows(r)                                     T3.ImportRow(x)                                     Tcounter2=Tcounter2+1                                     BasicSalary=Buffer.Rows(r)(&quot;Sal&quot;)
                                                            end
                                                            if
                                                        next                                 Buffer=Nothing                             Buffer=T3 &#x27;===============================================================BB=============================================BEGIN                             if(Tcounter2=1)                                 x=T.NewRow
                                                        For r As Integer = 0 To Buffer.Rows.Count-1                                         Dayz=Buffer.Rows(r)(&quot;Days&quot;)                                     Dayz=Dayz-BaseDays
                                                            If ((Dayz&gt;=25 AND Dayz&lt;=35) OR (Dayz&gt;=55 AND Dayz&lt;=65) ) Then
                                                                x= Buffer.Rows(r)                                         T.ImportRow(x)                                         x=T.NewRow                                         Tcounter=Tcounter+1
                                                            End If
                                                        end if
                                                    next                                 &#x27;testT=Tcounter /checked
                                                    if Tcounter&lt;3                                     ReassignFlag=1                                     Status=&quot;Total number of feasible transaction is less than 3 after filtering with 25-35 and 55 to 65 in AA-BB-nonGov III&quot;
                                                    else                                     BSp=BasicSalary+(BasicSalary*20/100)                                     BSm=BasicSalary-(BasicSalary*20/100)                                     x=T2.NewRow
                                                        for r as integer=0 to T.Rows.count-1                                         if(T.Rows(r)(&quot;Sal&quot;)&gt;=BSm AND T.Rows(r)(&quot;Sal&quot;)&lt;=BSp)                                             x= T.Rows(r)                                             T2.ImportRow(x)                                             x=T2.NewRow                                             T2counter=T2counter+1
                                                            end
                                                            if
                                                        next
                                                        If T2counter&lt;2 Then
                                                            ReassignFlag=1                                         Status=&quot;Total number of feasible transaction is less than 2 after filtering BSm&lt;SAL&lt;BSp in AA-BB-nonGov IV&quot;
                                                        End If
                                                    else
                                                        if T2counter=2                                         min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                            For k As Integer = 0 To 1                                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                                If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                    min=T2.Rows(k)(&quot;Sal&quot;)                                                 minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                                End If
                                                                end
                                                                if
                                                            next                                          Avg= Sum / 2
                                                            If Avg&lt;1.2*min Then
                                                                Salary=minimum                                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                            End If
                                                        else                                              Salary=minimum                                             Other=0
                                                            end
                                                            if
                                                        else                                         min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                            For k As Integer = 0 To 2                                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                                If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                    min=T2.Rows(k)(&quot;Sal&quot;)                                                 minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                                End If
                                                                end
                                                                if
                                                            next                                          Avg= Sum / 3
                                                            If Avg&lt;1.2*min Then
                                                                Salary=minimum                                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                            End If
                                                        else                                              Salary=minimum                                             Other=0
                                                            end
                                                            if
                                                        end if
                                                        end
                                                        if  &#x27;===============================================================BB=============================================END
                                                        else
                                                            Dim Count4 as integer=0
                                                            Dim Prev as integer =0
                                                            Dim Base as Decimal=0
                                                            for r as integer=0 to A1.Rows.Count-1
                                                                For j as integer=0 to T3.Rows.Count-1
                                                                    if A1.Rows(r)(&quot;Amount&quot;)=T3.Rows(j)(&quot;Sal&quot;)                                             Count4=Count4+1
                                                                        end
                                                                        if
                                                                    next
                                                                    if prev&lt;Count4                                         BasicSalary=A1.Rows(r)(&quot;Amount&quot;)
                                                                        end
                                                                        if
                                                                    next &#x27;============================================================BB=============================================BEGIN                                             x=T.NewRow
                                                                    For r As Integer = 0 To Buffer.Rows.Count-1                                         Dayz=Buffer.Rows(r)(&quot;Days&quot;)                                     Dayz=Dayz-BaseDays
                                                                        If ((Dayz&gt;=25 AND Dayz&lt;=35) OR (Dayz&gt;=55 AND Dayz&lt;=65) ) Then
                                                                            x= Buffer.Rows(r)                                         T.ImportRow(x)                                         x=T.NewRow                                         Tcounter=Tcounter+1
                                                                        End If
                                                                    end if
                                                                next                                 &#x27;testT=Tcounter /checked
                                                                if Tcounter&lt;3                                     ReassignFlag=1                                     Status=&quot;Total number of feasible transaction is less than 3 after filtering 25-35 and 55-65 in AA-BB-nonGov V&quot;
                                                                else                                     BSp=BasicSalary+(BasicSalary*20/100)                                     BSm=BasicSalary-(BasicSalary*20/100)                                     x=T2.NewRow
                                                                    for r as integer=0 to T.Rows.count-1                                         if(T.Rows(r)(&quot;Sal&quot;)&gt;=BSm AND T.Rows(r)(&quot;Sal&quot;)&lt;=BSp)                                             x= T.Rows(r)                                             T2.ImportRow(x)                                             x=T2.NewRow                                             T2counter=T2counter+1
                                                                        end
                                                                        if
                                                                    next
                                                                    If T2counter&lt;2 Then
                                                                        ReassignFlag=1                                         Status=&quot;Total number of feasible transaction is less than 2 after filtering BSp&lt;=SAL&lt;=BSp in AA-BB-nonGov VI&quot;
                                                                    End If
                                                                else
                                                                    if T2counter=2                                         min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                                        For k As Integer = 0 To 1                                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                                            If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                                min=T2.Rows(k)(&quot;Sal&quot;)                                                 minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                                            End If
                                                                            end
                                                                            if
                                                                        next                                          Avg= Sum / 2
                                                                        If Avg&lt;1.2*min Then
                                                                            Salary=minimum                                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                                        End If
                                                                    else                                              Salary=minimum                                             Other=0
                                                                        end
                                                                        if
                                                                    else                                          min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                                        For k As Integer = 0 To 2                                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                                            If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                                min=T2.Rows(k)(&quot;Sal&quot;)                                                 minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                                            End If
                                                                            end
                                                                            if
                                                                        next                                          Avg= Sum / 3
                                                                        If Avg&lt;1.2*min Then
                                                                            Salary=minimum                                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                                        End If
                                                                    else                                              Salary=minimum                                             Other=0
                                                                        end
                                                                        if
                                                                    end if
                                                                    end
                                                                    if &#x27;===========================================================BB======================================================END
                                                                        end
                                                                        if &#x27;=============================================================AA===================================================    END
                                                                            end
                                                                            if &#x27;==============================================================BB============================================END                      &#x27;==============================================================B=============================================END
                                                                                end
                                                                                if &#x27;^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^Page2^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                                                                    end
                                                                                    if
                                                                                    end
                                                                                    if
                                                                                else             Status=&quot;Salary cannot be identified since there is no transaction in the past &quot;+TimePeriod.ToString+&quot; days&quot;             ReassignFlag=1
                                                                                    end
                                                                                    if
                                                                                else         ReassignFlag=1         Status=&quot;Total number of feasible transaction is less than 3&quot;
                                                                                    end
                                                                                    if
                                                                                else      Status=&quot;Total number of feasible transaction is less than 3&quot;     ReassignFlag=1
                                                                                    end
                                                                                    if D0=D1 A0=A1
                                                                                    catch e as Exception         er=e.ToString         ReassignFlag=1         Status=&quot;Code Error:&quot;+e.ToString
                                                                                        end
                                                                                        try"
                            data-title="UWCA_MRCC_CTF_V1.0 / Salary code / Salary Calculation(new)3">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>UWCA_MRCC_CTF_V1.0</td>
                <td>Salary code</td>
                <td>Salary Calculation(new)4</td>
                <td>visualbasic</td>
                <td>854</td>
                <!--<td style="font-family: monospace;">94940c4f5fd60e2079f4c8d49ebd4937e1cedd3dad70115f1de537e7578751de</td>-->
                <td>—</td>
                <!--<td>try     Dim description as string     Dim x As DataRow = D1.NewRow     Dim Dflag as integer =0     Dim precount as integer =0     Dim Amount as integer =0     Dim Avg as integer=0     Dim Sum as integer =0     Dim skip as integer =0     Dim min as integer =0     Dim count as integer =0     Dim Av as...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="try
    Dim description as string
    Dim x As DataRow = D1.NewRow
    Dim Dflag as integer =0
    Dim precount as integer =0
    Dim Amount as integer =0
    Dim Avg as integer=0
    Dim Sum as integer =0
    Dim skip as integer =0
    Dim min as integer =0
    Dim count as integer =0
    Dim Av as integer =0
    Dim mi as integer =0
    Dim minim as string min=0 count=0 minim=&quot;&quot;
    if c1.Rows.Count&gt;2 then
        For r As Integer = 0 To c1.Rows.Count-1         description=c1.Rows(r)(&quot;Description&quot;)         Dflag=0
            for i as integer=0 To D1.Rows.Count-1
                If D1.Rows(i)(&quot;Description&quot;)=description Then
                    Dflag=1                 D1.Rows(i)(&quot;Count&quot;)=D1.Rows(i)(&quot;Count&quot;)+1
                End If
                end
                if
            next
            If Dflag=0 Then
                x(&quot;Description&quot;) = description             x(&quot;Count&quot;)=1             D1.Rows.Add(x)             x= D1.NewRow
            End If
            end
            if
        Next
        For r As Integer = 0 To D1.Rows.Count-1         description=D1.Rows(r)(&quot;Description&quot;)         CollOut=Nothing         CollOut=c1.Clone
            For Each parentRow As DataRow In c1.Select(&quot;Description=&#x27;&quot;+description+&quot;&#x27;&quot;)             x = CollOut.NewRow
                For Each c As DataColumn In x.Table.Columns                     x(c.ColumnName) = parentRow(c.ColumnName)
                Next             CollOut.Rows.Add(x)
            Next         count=CollOut.Rows.Count
            If count&gt;precount Then
                Buffer=Nothing             Buffer = CollOut.Clone             Buffer=CollOut             precount=count             ReassignFlag=0
            End If
        else
            if count = Precount             ReassignFlag=1             Status=&quot;Salary cannot be identified since there mode are equal&quot;
                end
                if
            next &#x27;+++++++++++++++++++++++++
            If Govt= False AND EF= False Then
                &#x27;+++++++++++++++++++++++++
            End If
            If Buffer.Rows.Count &gt;2 Then
                ReassignFlag=0
            End If
            if ReassignFlag=0             ReassignFlag=1
                For r As Integer = 0 To Buffer.Rows.Count-1
                    If Buffer.Rows(r)(&quot;Days&quot;)&lt;=TimePeriod Then
                        ReassignFlag=0
                    End If
                    exit
                    for
                    end
                    if
                next
                end
                if
                if ReassignFlag=0             Status=&quot;&quot;
                    For r As Integer = 0 To Buffer.Rows.Count-1                 Amount=Buffer.Rows(r)(&quot;Sal&quot;)                 Dflag=0
                        for i as integer=0 To A1.Rows.Count-1
                            If A1.Rows(i)(&quot;Amount&quot;)=Amount Then
                                Dflag=1                         A1.Rows(i)(&quot;Count&quot;)=A1.Rows(i)(&quot;Count&quot;)+1
                            End If
                            end
                            if
                        next
                        If Dflag=0 Then
                            x= A1.NewRow                     x(&quot;Amount&quot;) = Amount                     x(&quot;Count&quot;)=1                     x(&quot;Salary&quot;)=Buffer.Rows(r)(&quot;Amount&quot;)                     A1.Rows.Add(x)
                        End If
                        end
                        if
                    Next             min=Buffer.Rows(0)(&quot;Sal&quot;)+1
                    For k As Integer = 0 To 2                 Sum=Sum+Buffer.Rows(k)(&quot;Sal&quot;)
                        If min&gt;Buffer.Rows(k)(&quot;Sal&quot;) Then
                            min=Buffer.Rows(k)(&quot;Sal&quot;)                     minimum=Buffer.Rows(k)(&quot;Amount&quot;)
                        End If
                        end
                        if
                        if k=1                     Av=Sum/2                     mi=min                     minim=minimum
                            end
                            if
                        next             Avg= Sum / 3
                        If Avg&lt;1.2*min Then
                            test=1 Cop=A1                 Salary=minimum                 Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                        End If
                    else
                        If Av&lt;1.2*mi Then
                            minimum=minim                 Salary=minimum                 Other=Replace((Av-mi),&quot;.&quot;,&quot;,&quot;)
                        End If
                    else
                        For r As Integer = 0 To A1.Rows.Count-1
                            If (A1.Rows(r)(&quot;Count&quot;)*100/(Buffer.Rows.Count))&gt;60 Then
                                Salary=A1.Rows(r)(&quot;Salary&quot;)                         skip=1
                            End If
                            end
                            if
                        next
                        If skip=0 Then
                            &#x27;vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvPage2vvvvvvvvvvvvvvvvvvvvvvvvvvv
                        End If
                        if Govt=True then
                            Dim SD1p,SD1m,SD2p,SD2m,SD3p,SD3m as date
                            Dim Sflag as integer =0
                            Dim BasicSalary as Integer =0
                            Dim T as DataTable =Buffer.Clone
                            Dim T2 as DataTable=Buffer.Clone
                            Dim TX as DataTable=Buffer.Clone
                            Dim Tcounter as integer =0
                            Dim T2counter as integer =0
                            Dim BSp,BSm as Decimal                          Sum=0                         minimum=0                         Salary=0                         Other=0                         min=0                         SD1p=SD1.AddDays(5)                         SD1m=SD1.AddDays(-5)                         SD2p=SD2.AddDays(5)                         SD2m=SD2.AddDays(-5)                         SD3p=SD3.AddDays(5)                         SD3m=SD3.AddDays(-5)                 &#x27;        T=Buffer.Clone
                            For r As Integer = 0 To Buffer.Rows.Count-1 &#x27;
                                If (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3) Then
                                    if((SD1m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))OR (SD2m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD3m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD3p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))) then                                 x= Buffer.Rows(r)                                 TX.ImportRow(x)                                 x=TX.NewRow
                                End If
                            end if
                        next                         Buffer=TX
                        For r As Integer = 0 To Buffer.Rows.Count-1                 &#x27;
                            if (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1) then
                                If (SD1m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) Then
                                    Sflag=Sflag+1                                 BasicSalary=Buffer.Rows(r)(&quot;Sal&quot;)                                 &#x27;AM=BasicSalary
                                End If
                                end
                                if
                            Next                         &#x27;AM=BasicSalary
                            If Sflag=1 Then
                                x=T.NewRow
                            End If
                            For r As Integer = 0 To Buffer.Rows.Count-1                 &#x27;
                                If (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3) Then
                                    if((SD1m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))OR (SD2m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD3m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD3p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))) then                                     x= Buffer.Rows(r)                                     T.ImportRow(x)                                     x=T.NewRow                                     Tcounter=Tcounter+1
                                End If
                            end if
                        next
                        if Tcounter&lt;3                                 ReassignFlag=1                                 Status=&quot;Total number of feasible transaction is less than 3 after filtering with +/-5 salary date I&quot;
                        else                                 BSp=BasicSalary+(BasicSalary*20/100)                                 BSm=BasicSalary-(BasicSalary*20/100)                                 x=T2.NewRow
                            for r as integer=0 to T.Rows.count-1                                     if(T.Rows(r)(&quot;Sal&quot;)&gt;=BSm AND T.Rows(r)(&quot;Sal&quot;)&lt;=BSp)                                         x= T.Rows(r)                                         T2.ImportRow(x)                                         x=T2.NewRow                                         T2counter=T2counter+1
                                end
                                if
                            next
                            If T2counter&lt;2 Then
                                ReassignFlag=1                                     Status=&quot;Total number of feasible transaction is less than 2 after filtering BSm &lt;= Salary &lt;=BSp&quot;
                            End If
                        else
                            if T2counter=2                                     min=T2.Rows(0)(&quot;Sal&quot;)+1
                                For k As Integer = 0 To 1                                         Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                    If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                        min=T2.Rows(k)(&quot;Sal&quot;)                                             minimum=T2.Rows(k)(&quot;Amount&quot;)
                                    End If
                                    end
                                    if
                                next                                     Avg= Sum / 2
                                If Avg&lt;1.2*min Then
                                    test=2                                         Salary=minimum                                         Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                End If
                            else                                         Salary=minimum                                         Other=0
                                end
                                if
                            else                                     min=T2.Rows(0)(&quot;Sal&quot;)+1
                                For k As Integer = 0 To 2                                         Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                    If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                        min=T2.Rows(k)(&quot;Sal&quot;)                                             minimum=T2.Rows(k)(&quot;Amount&quot;)
                                    End If
                                    end
                                    if
                                next                                     Avg= Sum / 3
                                If Avg&lt;1.2*min Then
                                    test=2                                         Salary=minimum                                         Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                End If
                            else                                         Salary=minimum                                         Other=0
                                end
                                if
                            end if
                            end
                            if                     &#x27;    test=T                     &#x27;    testT=Tcounter
                            else &#x27;=============================================================AA===================================================BEGIN
                                Dim T3 as DataTable=Buffer.Clone
                                Dim Tcounter2 as integer=0
                                for r as integer =0 to Buffer.Rows.Count-1                                 if(Buffer.Rows(r)(&quot;Sal&quot;)&gt;=LastApproved) then                                     x=T3.NewRow                                     x=Buffer.Rows(r)                                     T3.ImportRow(x)                                     Tcounter2=Tcounter2+1                                     BasicSalary=Buffer.Rows(r)(&quot;Sal&quot;)
                                    end
                                    if
                                next                             &#x27;    Buffer=Nothing                         &#x27;    Buffer=T3 Cop=Buffer &#x27;===============================================================BB=============================================BEGIN                             if(Tcounter2=1)                                 x=T.NewRow
                                For r As Integer = 0 To Buffer.Rows.Count-1                 &#x27;
                                    If (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3) Then
                                        if((SD1m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))OR (SD2m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD3m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD3p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))) then                                         x= Buffer.Rows(r)                                         T.ImportRow(x)                                         x=T.NewRow                                         Tcounter=Tcounter+1
                                    End If
                                end if
                            next
                            if Tcounter&lt;3                                     ReassignFlag=1                                     Status=&quot;Total number of feasible transaction is less than 3 after filtering with +/-5 salary date in AA-BB-Gov I&quot;
                            else                                     BSp=BasicSalary+(BasicSalary*20/100)                                     BSm=BasicSalary-(BasicSalary*20/100)                                     x=T2.NewRow
                                for r as integer=0 to T.Rows.count-1                                         if(T.Rows(r)(&quot;Sal&quot;)&gt;=BSm AND T.Rows(r)(&quot;Sal&quot;)&lt;=BSp)                                             x= T.Rows(r)                                             T2.ImportRow(x)                                             x=T2.NewRow                                             T2counter=T2counter+1
                                    end
                                    if
                                next
                                If T2counter&lt;2 Then
                                    ReassignFlag=1                                         Status=&quot;Total number of feasible transaction is less than 2 after filtering with +/-5 salary date in AA-BB-Gov II&quot;
                                End If
                            else
                                if T2counter=2                                         min=T2.Rows(0)(&quot;Sal&quot;)+1
                                    For k As Integer = 0 To 1                                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                        If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                            min=T2.Rows(k)(&quot;Sal&quot;)                                                 minimum=T2.Rows(k)(&quot;Amount&quot;)
                                        End If
                                        end
                                        if
                                    next                                         Avg= Sum / 2
                                    If Avg&lt;1.2*min Then
                                        test=3                                             Salary=minimum                                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                    End If
                                else                                             Salary=minimum                                             Other=0
                                    end
                                    if
                                else                                         min=T2.Rows(0)(&quot;Sal&quot;)+1
                                    For k As Integer = 0 To 2                                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                        If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                            min=T2.Rows(k)(&quot;Sal&quot;)                                                 minimum=T2.Rows(k)(&quot;Amount&quot;)
                                        End If
                                        end
                                        if
                                    next                                         Avg= Sum / 3
                                    If Avg&lt;1.2*min Then
                                        test=3                                             Salary=minimum                                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                    End If
                                else                                             Salary=minimum                                             Other=0
                                    end
                                    if
                                end if
                                end
                                if &#x27;===============================================================BB=============================================END
                                else
                                    Dim Count4 as integer=0
                                    Dim Prev as integer =0
                                    Dim Base as Decimal=0
                                    for r as integer=0 to A1.Rows.Count-1
                                        For j as integer=0 to T3.Rows.Count-1
                                            if A1.Rows(r)(&quot;Amount&quot;)=T3.Rows(j)(&quot;Sal&quot;)                                             Count4=Count4+1
                                                end
                                                if
                                            next
                                            if prev&lt;Count4                                         BasicSalary=A1.Rows(r)(&quot;Amount&quot;)                                         prev=Count4
                                                end
                                                if                                     Count4=0
                                                next                                                 x=T.NewRow
                                                For r As Integer = 0 To Buffer.Rows.Count-1                 &#x27;
                                                    If (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3) Then
                                                        if((SD1m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))OR (SD2m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD3m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD3p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))) then                                         x= Buffer.Rows(r)                                         T.ImportRow(x)                                         x=T.NewRow                                         Tcounter=Tcounter+1
                                                    End If
                                                end if
                                            next
                                            if Tcounter&lt;3                                     ReassignFlag=1                                     Status=&quot;Total number of feasible transaction is less than 3 after filtering with +/-5 salary date in AA-BB-Gov III&quot;
                                            else                                     BSp=BasicSalary+(BasicSalary*20/100)                                     BSm=BasicSalary-(BasicSalary*20/100)                                     x=T2.NewRow
                                                for r as integer=0 to T.Rows.count-1                                         if(T.Rows(r)(&quot;Sal&quot;)&gt;=BSm AND T.Rows(r)(&quot;Sal&quot;)&lt;=BSp)                                             x= T.Rows(r)                                             T2.ImportRow(x)                                             x=T2.NewRow                                             T2counter=T2counter+1
                                                    end
                                                    if
                                                next
                                                If T2counter&lt;2 Then
                                                    ReassignFlag=1                                         Status=&quot;Total number of feasible transaction is less than 2 after filtering BSm&lt;= SAL &lt;=BSp in AA-BB-Gov IV&quot;
                                                End If
                                            else
                                                if T2counter=2                                         min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                    For k As Integer = 0 To 1                                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                        If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                            min=T2.Rows(k)(&quot;Sal&quot;)                                                 minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                        End If
                                                        end
                                                        if
                                                    next                                         Avg= Sum / 2
                                                    If Avg&lt;1.2*min Then
                                                        test=4                                             Salary=minimum                                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                    End If
                                                else                                             Salary=minimum                                             Other=0
                                                    end
                                                    if
                                                else                                          min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                    For k As Integer = 0 To 2                                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                        If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                            min=T2.Rows(k)(&quot;Sal&quot;)                                                 minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                        End If
                                                        end
                                                        if
                                                    next                                         Avg= Sum / 3
                                                    If Avg&lt;1.2*min Then
                                                        test=4                                             Salary=minimum                                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                    End If
                                                else                                             Salary=minimum                                             Other=0
                                                    end
                                                    if
                                                end if
                                                end
                                                if
                                                end
                                                if  &#x27;=============================================================AA===================================================    END
                                                    end
                                                    if
                                                else &#x27;==========================================================================B===================================BEGIN
                                                    Dim Sflag as integer =0
                                                    Dim BasicSalary as Integer =0
                                                    Dim T as DataTable =Buffer.Clone
                                                    Dim T2 as DataTable=Buffer.Clone
                                                    Dim Tcounter as integer =0
                                                    Dim T2counter as integer =0
                                                    Dim BSp,BSm as Decimal
                                                    Dim BaseDays as Decimal =0
                                                    Dim Dayz as decimal=0                         Sum=0                         minimum=0                         Salary=0                         Sflag=0                         Other=0                         min=0
                                                    For r As Integer = 0 To Buffer.Rows.Count-1
                                                        If (Buffer.Rows(r)(&quot;Days&quot;)&lt;=TimePeriod) Then
                                                            Sflag=Sflag+1                                 BasicSalary=Buffer.Rows(r)(&quot;Sal&quot;)                                 x=T.NewRow                                 x= Buffer.Rows(r)                                 T.ImportRow(x)                                 Tcounter=1                                 BaseDays=Buffer.Rows(r)(&quot;Days&quot;)
                                                        End If
                                                        end
                                                        if
                                                    Next &#x27;=======================================================================================BB=================================================BEGIN
                                                    If Sflag=1 Then
                                                        x=T.NewRow
                                                    End If
                                                    For r As Integer = 0 To Buffer.Rows.Count-1                                     Dayz=Buffer.Rows(r)(&quot;Days&quot;)                                 Dayz=Dayz-BaseDays
                                                        If ((Dayz&gt;=25 AND Dayz&lt;=35) OR (Dayz&gt;=55 AND Dayz&lt;=65) ) Then
                                                            x= Buffer.Rows(r)                                     T.ImportRow(x)                                     x=T.NewRow                                     Tcounter=Tcounter+1
                                                        End If
                                                    end if
                                                next                             &#x27;testT=Tcounter /checked
                                                if Tcounter&lt;3                                 ReassignFlag=1                                 Status=&quot;Total number of feasible transaction is less than 3 after filtering with 25-35 and 55 to 65 in AA-BB-nonGov II&quot;
                                                else                                 BSp=BasicSalary+(BasicSalary*20/100)                                 BSm=BasicSalary-(BasicSalary*20/100)                                 x=T2.NewRow
                                                    for r as integer=0 to T.Rows.count-1                                     if(T.Rows(r)(&quot;Sal&quot;)&gt;=BSm AND T.Rows(r)(&quot;Sal&quot;)&lt;=BSp)                                         x= T.Rows(r)                                         T2.ImportRow(x)                                         x=T2.NewRow                                         T2counter=T2counter+1
                                                        end
                                                        if
                                                    next
                                                    If T2counter&lt;2 Then
                                                        ReassignFlag=1                                     Status=&quot;Total number of feasible transaction is less than 2 after filtering BSm&lt;=SAL&lt;=BSp BB-non Gov II&quot;
                                                    End If
                                                else
                                                    if T2counter=2
                                                        For k As Integer = 0 To 1                                         Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                            If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                min=T2.Rows(k)(&quot;Sal&quot;)                                             minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                            End If
                                                            end
                                                            if
                                                        next                                      Avg= Sum / 2
                                                        If Avg&lt;1.2*min Then
                                                            Salary=minimum                                         Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                        End If
                                                    else                                          Salary=minimum                                         Other=0
                                                        end
                                                        if
                                                    else                                       min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                        For k As Integer = 0 To 2                                         Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                            If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                min=T2.Rows(k)(&quot;Sal&quot;)                                             minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                            End If
                                                            end
                                                            if
                                                        next                                      Avg= Sum / 3
                                                        If Avg&lt;1.2*min Then
                                                            Salary=minimum                                         Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                        End If
                                                    else                                          Salary=minimum                                         Other=0
                                                        end
                                                        if
                                                    end if
                                                    end
                                                    if                         &#x27;test=T2                         &#x27;testT=Tcounter
                                                    else &#x27;++++++++++++++++++++++AA+++++++++ &#x27;=============================================================AA===================================================BEGIN
                                                        Dim T3 as DataTable=Buffer.Clone
                                                        Dim Tcounter2 as integer=0
                                                        for r as integer =0 to Buffer.Rows.Count-1                                 if(Buffer.Rows(r)(&quot;Sal&quot;)&gt;=LastApproved) then                                     x=T3.NewRow                                     x=Buffer.Rows(r)                                     T3.ImportRow(x)                                     Tcounter2=Tcounter2+1                                     BasicSalary=Buffer.Rows(r)(&quot;Sal&quot;)
                                                            end
                                                            if
                                                        next                                 Buffer=Nothing                             Buffer=T3 &#x27;===============================================================BB=============================================BEGIN                             if(Tcounter2=1)                                 x=T.NewRow
                                                        For r As Integer = 0 To Buffer.Rows.Count-1                                         Dayz=Buffer.Rows(r)(&quot;Days&quot;)                                     Dayz=Dayz-BaseDays
                                                            If ((Dayz&gt;=25 AND Dayz&lt;=35) OR (Dayz&gt;=55 AND Dayz&lt;=65) ) Then
                                                                x= Buffer.Rows(r)                                         T.ImportRow(x)                                         x=T.NewRow                                         Tcounter=Tcounter+1
                                                            End If
                                                        end if
                                                    next                                 &#x27;testT=Tcounter /checked
                                                    if Tcounter&lt;3                                     ReassignFlag=1                                     Status=&quot;Total number of feasible transaction is less than 3 after filtering with 25-35 and 55 to 65 in AA-BB-nonGov III&quot;
                                                    else                                     BSp=BasicSalary+(BasicSalary*20/100)                                     BSm=BasicSalary-(BasicSalary*20/100)                                     x=T2.NewRow
                                                        for r as integer=0 to T.Rows.count-1                                         if(T.Rows(r)(&quot;Sal&quot;)&gt;=BSm AND T.Rows(r)(&quot;Sal&quot;)&lt;=BSp)                                             x= T.Rows(r)                                             T2.ImportRow(x)                                             x=T2.NewRow                                             T2counter=T2counter+1
                                                            end
                                                            if
                                                        next
                                                        If T2counter&lt;2 Then
                                                            ReassignFlag=1                                         Status=&quot;Total number of feasible transaction is less than 2 after filtering BSm&lt;SAL&lt;BSp in AA-BB-nonGov IV&quot;
                                                        End If
                                                    else
                                                        if T2counter=2                                         min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                            For k As Integer = 0 To 1                                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                                If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                    min=T2.Rows(k)(&quot;Sal&quot;)                                                 minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                                End If
                                                                end
                                                                if
                                                            next                                          Avg= Sum / 2
                                                            If Avg&lt;1.2*min Then
                                                                Salary=minimum                                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                            End If
                                                        else                                              Salary=minimum                                             Other=0
                                                            end
                                                            if
                                                        else                                         min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                            For k As Integer = 0 To 2                                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                                If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                    min=T2.Rows(k)(&quot;Sal&quot;)                                                 minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                                End If
                                                                end
                                                                if
                                                            next                                          Avg= Sum / 3
                                                            If Avg&lt;1.2*min Then
                                                                Salary=minimum                                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                            End If
                                                        else                                              Salary=minimum                                             Other=0
                                                            end
                                                            if
                                                        end if
                                                        end
                                                        if  &#x27;===============================================================BB=============================================END
                                                        else
                                                            Dim Count4 as integer=0
                                                            Dim Prev as integer =0
                                                            Dim Base as Decimal=0
                                                            for r as integer=0 to A1.Rows.Count-1
                                                                For j as integer=0 to T3.Rows.Count-1
                                                                    if A1.Rows(r)(&quot;Amount&quot;)=T3.Rows(j)(&quot;Sal&quot;)                                             Count4=Count4+1
                                                                        end
                                                                        if
                                                                    next
                                                                    if prev&lt;Count4                                         BasicSalary=A1.Rows(r)(&quot;Amount&quot;)
                                                                        end
                                                                        if
                                                                    next &#x27;============================================================BB=============================================BEGIN                                             x=T.NewRow
                                                                    For r As Integer = 0 To Buffer.Rows.Count-1                                         Dayz=Buffer.Rows(r)(&quot;Days&quot;)                                     Dayz=Dayz-BaseDays
                                                                        If ((Dayz&gt;=25 AND Dayz&lt;=35) OR (Dayz&gt;=55 AND Dayz&lt;=65) ) Then
                                                                            x= Buffer.Rows(r)                                         T.ImportRow(x)                                         x=T.NewRow                                         Tcounter=Tcounter+1
                                                                        End If
                                                                    end if
                                                                next                                 &#x27;testT=Tcounter /checked
                                                                if Tcounter&lt;3                                     ReassignFlag=1                                     Status=&quot;Total number of feasible transaction is less than 3 after filtering 25-35 and 55-65 in AA-BB-nonGov V&quot;
                                                                else                                     BSp=BasicSalary+(BasicSalary*20/100)                                     BSm=BasicSalary-(BasicSalary*20/100)                                     x=T2.NewRow
                                                                    for r as integer=0 to T.Rows.count-1                                         if(T.Rows(r)(&quot;Sal&quot;)&gt;=BSm AND T.Rows(r)(&quot;Sal&quot;)&lt;=BSp)                                             x= T.Rows(r)                                             T2.ImportRow(x)                                             x=T2.NewRow                                             T2counter=T2counter+1
                                                                        end
                                                                        if
                                                                    next
                                                                    If T2counter&lt;2 Then
                                                                        ReassignFlag=1                                         Status=&quot;Total number of feasible transaction is less than 2 after filtering BSp&lt;=SAL&lt;=BSp in AA-BB-nonGov VI&quot;
                                                                    End If
                                                                else
                                                                    if T2counter=2                                         min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                                        For k As Integer = 0 To 1                                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                                            If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                                min=T2.Rows(k)(&quot;Sal&quot;)                                                 minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                                            End If
                                                                            end
                                                                            if
                                                                        next                                          Avg= Sum / 2
                                                                        If Avg&lt;1.2*min Then
                                                                            Salary=minimum                                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                                        End If
                                                                    else                                              Salary=minimum                                             Other=0
                                                                        end
                                                                        if
                                                                    else                                          min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                                        For k As Integer = 0 To 2                                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                                            If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                                min=T2.Rows(k)(&quot;Sal&quot;)                                                 minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                                            End If
                                                                            end
                                                                            if
                                                                        next                                          Avg= Sum / 3
                                                                        If Avg&lt;1.2*min Then
                                                                            Salary=minimum                                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                                        End If
                                                                    else                                              Salary=minimum                                             Other=0
                                                                        end
                                                                        if
                                                                    end if
                                                                    end
                                                                    if &#x27;===========================================================BB======================================================END
                                                                        end
                                                                        if &#x27;=============================================================AA===================================================    END
                                                                            end
                                                                            if &#x27;==============================================================BB============================================END                      &#x27;==============================================================B=============================================END
                                                                                end
                                                                                if &#x27;^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^Page2^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                                                                    end
                                                                                    if
                                                                                    end
                                                                                    if
                                                                                else             Status=&quot;Salary cannot be identified since there is no transaction in the past &quot;+TimePeriod.ToString+&quot; days&quot;             ReassignFlag=1
                                                                                    end
                                                                                    if
                                                                                else         ReassignFlag=1         Status=&quot;Total number of feasible transaction is less than 3&quot;
                                                                                    end
                                                                                    if
                                                                                else
                                                                                    Dim SD1p,SD1m,SD2p,SD2m,SD3p,SD3m,SD4p,SD4m as date
                                                                                    Dim Sflag as integer =0
                                                                                    Dim Lflag as integer =0
                                                                                    Dim LLcheck as integer =0
                                                                                    Dim BasicSalary as Integer =0
                                                                                    Dim T as DataTable =Buffer.Clone
                                                                                    Dim T2 as DataTable=Buffer.Clone
                                                                                    Dim TX as DataTable=Buffer.Clone
                                                                                    Dim LL as DataTable=Buffer.Clone
                                                                                    Dim Tcounter as integer =0
                                                                                    Dim T2counter as integer =0
                                                                                    Dim BSp,BSm as Decimal          Sum=0         minimum=0         Salary=0         Other=0         min=0         SD1p=SD1.AddDays(5)         SD1m=SD1.AddDays(-5)         SD2p=SD2.AddDays(5)         SD2m=SD2.AddDays(-5)         SD3p=SD3.AddDays(5)         SD3m=SD3.AddDays(-5)         SD4p=SD4.AddDays(5)         SD4m=SD4.AddDays(-5)         &#x27;        T=Buffer.Clone
                                                                                    For r As Integer = 0 To Buffer.Rows.Count-1         &#x27;
                                                                                        If (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3) Then
                                                                                            if((SD1m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))OR (SD2m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD3m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD3p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD4m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD4p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))) then                 x= Buffer.Rows(r)                 TX.ImportRow(x)                 x=TX.NewRow
                                                                                        End If
                                                                                    end if
                                                                                next         Buffer=TX
                                                                                For r As Integer = 0 To Buffer.Rows.Count-1         &#x27;
                                                                                    If (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3) Then
                                                                                        if((SD1m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))) then                 x= Buffer.Rows(r)                 LL.ImportRow(x)                 x=LL.NewRow                 Lflag=Lflag+1
                                                                                    End If
                                                                                end if
                                                                            next &#x27;+++++++++++++++++++++++++++
                                                                            If Lflag&gt;0 Then
                                                                                &#x27;+++++++++++++++++++++++++++
                                                                            End If
                                                                            For r As Integer = 0 To Buffer.Rows.Count-1         &#x27;
                                                                                if (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1) then
                                                                                    If (SD2m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) Then
                                                                                        Sflag=Sflag+1                 BasicSalary=Buffer.Rows(r)(&quot;Sal&quot;)                 &#x27;AM=BasicSalary
                                                                                    End If
                                                                                    end
                                                                                    if
                                                                                Next         &#x27;AM=BasicSalary
                                                                                If Sflag=1 Then
                                                                                    x=T.NewRow
                                                                                End If
                                                                                For r As Integer = 0 To Buffer.Rows.Count-1         &#x27;
                                                                                    If (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3) Then
                                                                                        if((SD2m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD3m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD3p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD4m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD4p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))) then                     x= Buffer.Rows(r)                     T.ImportRow(x)                     x=T.NewRow                     Tcounter=Tcounter+1
                                                                                    End If
                                                                                end if
                                                                            next
                                                                            if Tcounter&lt;2                 ReassignFlag=1                 Status=&quot;Total number of feasible transaction is less than 2 after filtering with +/-5 salary date I&quot;
                                                                            else                 BSp=BasicSalary+(BasicSalary*20/100)                 BSm=BasicSalary-(BasicSalary*20/100)                 x=T2.NewRow
                                                                                for r as integer=0 to T.Rows.count-1                     if(T.Rows(r)(&quot;Sal&quot;)&gt;=BSm AND T.Rows(r)(&quot;Sal&quot;)&lt;=BSp)                         x= T.Rows(r)                         T2.ImportRow(x)                         x=T2.NewRow                         T2counter=T2counter+1
                                                                                    end
                                                                                    if
                                                                                next
                                                                                If T2counter&lt;2 Then
                                                                                    ReassignFlag=1                     Status=&quot;Total number of feasible transaction is less than 2 after filtering BSm &lt;= Salary &lt;=BSp&quot;
                                                                                End If
                                                                            else
                                                                                if T2counter=2                     min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                                                    For k As Integer = 0 To 1                         Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                                                        If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                                            min=T2.Rows(k)(&quot;Sal&quot;)                             minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                                                        End If
                                                                                        end
                                                                                        if
                                                                                    next                     Avg= Sum / 2
                                                                                    If Avg&lt;1.2*min Then
                                                                                        test=2
                                                                                    End If
                                                                                    For r As Integer = 0 To LL.Rows.Count-1                             if(LL.Rows(r)(&quot;Sal&quot;)&gt;=Avg*0.65) then
                                                                                        If LLcheck=0 Then
                                                                                            LLcheck=1                                     if(LL.Rows(r)(&quot;Sal&quot;)&lt;=Avg) then                                         Salary=LL.Rows(r)(&quot;Amount&quot;)
                                                                                        End If
                                                                                    else                                         ReassignFlag=1                                         Status=&quot;Salary not identified sincee one transaction in last month is grater than selected salary&quot;
                                                                                        end
                                                                                        if
                                                                                    else                                      ReassignFlag=1                                     Status=&quot;More than one transaction is grater then 65% of selected salary&quot;
                                                                                        end
                                                                                        if
                                                                                    end if
                                                                                next
                                                                            else
                                                                                For r As Integer = 0 To LL.Rows.Count-1                             if(LL.Rows(r)(&quot;Sal&quot;)&gt;=min*0.65) then
                                                                                    If LLcheck=0 Then
                                                                                        LLcheck=1                                     if(LL.Rows(r)(&quot;Sal&quot;)&lt;=min) then                                         Salary=LL.Rows(r)(&quot;Amount&quot;)
                                                                                    End If
                                                                                else                                         ReassignFlag=1                                         Status=&quot;Salary not identified sincee one transaction in last month is grater than selected salary&quot;
                                                                                    end
                                                                                    if
                                                                                else                                      ReassignFlag=1                                     Status=&quot;More than one transaction is grater then 65% of selected salary&quot;
                                                                                    end
                                                                                    if
                                                                                end if
                                                                            next
                                                                            end
                                                                            if
                                                                        else                     min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                                            For k As Integer = 0 To 2                         Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                                                If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                                    min=T2.Rows(k)(&quot;Sal&quot;)                             minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                                                End If
                                                                                end
                                                                                if
                                                                            next                     Avg= Sum / 3
                                                                            If Avg&lt;1.2*min Then
                                                                                test=2
                                                                            End If
                                                                            For r As Integer = 0 To LL.Rows.Count-1                             if(LL.Rows(r)(&quot;Sal&quot;)&gt;=Avg*0.65) then
                                                                                If LLcheck=0 Then
                                                                                    LLcheck=1                                     if(LL.Rows(r)(&quot;Sal&quot;)&lt;=Avg) then                                         Salary=LL.Rows(r)(&quot;Amount&quot;)
                                                                                End If
                                                                            else                                         ReassignFlag=1                                         Status=&quot;Salary not identified sincee one transaction in last month is grater than selected salary&quot;
                                                                                end
                                                                                if
                                                                            else                                      ReassignFlag=1                                     Status=&quot;More than one transaction is grater then 65% of selected salary&quot;
                                                                                end
                                                                                if
                                                                            end if
                                                                        next
                                                                    else
                                                                        For r As Integer = 0 To LL.Rows.Count-1                             if(LL.Rows(r)(&quot;Sal&quot;)&gt;=min*0.65) then
                                                                            If LLcheck=0 Then
                                                                                LLcheck=1                                     if(LL.Rows(r)(&quot;Sal&quot;)&lt;=min) then                                         Salary=LL.Rows(r)(&quot;Amount&quot;)
                                                                            End If
                                                                        else                                         ReassignFlag=1                                         Status=&quot;Salary not identified sincee one transaction in last month is grater than selected salary&quot;
                                                                            end
                                                                            if
                                                                        else                                      ReassignFlag=1                                     Status=&quot;More than one transaction is grater then 65% of selected salary&quot;
                                                                            end
                                                                            if
                                                                        end if
                                                                    next
                                                                    end
                                                                    if
                                                                end if
                                                                end
                                                                if         &#x27;    test=T         &#x27;    testT=Tcounter
                                                                else &#x27;=============================================================AA===================================================BEGIN
                                                                    Dim T3 as DataTable=Buffer.Clone
                                                                    Dim Tcounter2 as integer=0
                                                                    for r as integer =0 to Buffer.Rows.Count-1                 if(Buffer.Rows(r)(&quot;Sal&quot;)&gt;=LastApproved) then                     x=T3.NewRow                     x=Buffer.Rows(r)                     T3.ImportRow(x)                     Tcounter2=Tcounter2+1                     BasicSalary=Buffer.Rows(r)(&quot;Sal&quot;)
                                                                        end
                                                                        if
                                                                    next             &#x27;    Buffer=Nothing         &#x27;    Buffer=T3             Cop=Buffer &#x27;===============================================================BB=============================================BEGIN             if(Tcounter2=1)                 x=T.NewRow
                                                                    For r As Integer = 0 To Buffer.Rows.Count-1         &#x27;
                                                                        If (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3) Then
                                                                            if((SD1m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))OR (SD2m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD3m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD3p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD4m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD4p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))) then                         x= Buffer.Rows(r)                         T.ImportRow(x)                         x=T.NewRow                         Tcounter=Tcounter+1
                                                                        End If
                                                                    end if
                                                                next
                                                                if Tcounter&lt;2                     ReassignFlag=1                     Status=&quot;Total number of feasible transaction is less than 2 after filtering with +/-5 salary date in AA-BB-Gov I&quot;
                                                                else                     BSp=BasicSalary+(BasicSalary*20/100)                     BSm=BasicSalary-(BasicSalary*20/100)                     x=T2.NewRow
                                                                    for r as integer=0 to T.Rows.count-1                         if(T.Rows(r)(&quot;Sal&quot;)&gt;=BSm AND T.Rows(r)(&quot;Sal&quot;)&lt;=BSp)                             x= T.Rows(r)                             T2.ImportRow(x)                             x=T2.NewRow                             T2counter=T2counter+1
                                                                        end
                                                                        if
                                                                    next
                                                                    If T2counter&lt;2 Then
                                                                        ReassignFlag=1                         Status=&quot;Total number of feasible transaction is less than 2 after filtering with +/-5 salary date in AA-BB-Gov II&quot;
                                                                    End If
                                                                else
                                                                    if T2counter=2                         min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                                        For k As Integer = 0 To 1                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                                            If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                                min=T2.Rows(k)(&quot;Sal&quot;)                                 minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                                            End If
                                                                            end
                                                                            if
                                                                        next                         Avg= Sum / 2
                                                                        If Avg&lt;1.2*min Then
                                                                            test=3
                                                                        End If
                                                                        For r As Integer = 0 To LL.Rows.Count-1                                 if(LL.Rows(r)(&quot;Sal&quot;)&gt;=Avg*0.65) then
                                                                            If LLcheck=0 Then
                                                                                LLcheck=1                                         if(LL.Rows(r)(&quot;Sal&quot;)&lt;=Avg) then                                         Salary=LL.Rows(r)(&quot;Amount&quot;)
                                                                            End If
                                                                        else                                         ReassignFlag=1                                         Status=&quot;Salary not identified sincee one transaction in last month is grater than selected salary&quot;
                                                                            end
                                                                            if
                                                                        else                                          ReassignFlag=1                                         Status=&quot;More than one transaction is grater then 65% of selected salary&quot;
                                                                            end
                                                                            if
                                                                        end if
                                                                    next
                                                                else
                                                                    For r As Integer = 0 To LL.Rows.Count-1                                 if(LL.Rows(r)(&quot;Sal&quot;)&gt;=min*0.65) then
                                                                        If LLcheck=0 Then
                                                                            LLcheck=1                                         if(LL.Rows(r)(&quot;Sal&quot;)&lt;=min) then                                         Salary=LL.Rows(r)(&quot;Amount&quot;)
                                                                        End If
                                                                    else                                         ReassignFlag=1                                         Status=&quot;Salary not identified sincee one transaction in last month is grater than selected salary&quot;
                                                                        end
                                                                        if
                                                                    else                                          ReassignFlag=1                                         Status=&quot;More than one transaction is grater then 65% of selected salary&quot;
                                                                        end
                                                                        if
                                                                    end if
                                                                next
                                                                end
                                                                if
                                                            else                         min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                                For k As Integer = 0 To 2                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                                    If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                        min=T2.Rows(k)(&quot;Sal&quot;)                                 minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                                    End If
                                                                    end
                                                                    if
                                                                next                         Avg= Sum / 3
                                                                If Avg&lt;1.2*min Then
                                                                    test=3
                                                                End If
                                                                For r As Integer = 0 To LL.Rows.Count-1                                 if(LL.Rows(r)(&quot;Sal&quot;)&gt;=Avg*0.65) then
                                                                    If LLcheck=0 Then
                                                                        LLcheck=1                                         if(LL.Rows(r)(&quot;Sal&quot;)&lt;=Avg) then                                             Salary=LL.Rows(r)(&quot;Amount&quot;)
                                                                    End If
                                                                else                                             ReassignFlag=1                                             Status=&quot;Salary not identified sincee one transaction in last month is grater than selected salary&quot;
                                                                    end
                                                                    if
                                                                else                                          ReassignFlag=1                                         Status=&quot;More than one transaction is grater then 65% of selected salary&quot;
                                                                    end
                                                                    if
                                                                end if
                                                            next
                                                        else
                                                            For r As Integer = 0 To LL.Rows.Count-1                                 if(LL.Rows(r)(&quot;Sal&quot;)&gt;=min*0.65) then
                                                                If LLcheck=0 Then
                                                                    LLcheck=1                                         if(LL.Rows(r)(&quot;Sal&quot;)&lt;=min) then                                             Salary=LL.Rows(r)(&quot;Amount&quot;)
                                                                End If
                                                            else                                             ReassignFlag=1                                             Status=&quot;Salary not identified sincee one transaction in last month is grater than selected salary&quot;
                                                                end
                                                                if
                                                            else                                          ReassignFlag=1                                         Status=&quot;More than one transaction is grater then 65% of selected salary&quot;
                                                                end
                                                                if
                                                            end if
                                                        next
                                                        end
                                                        if
                                                    end if
                                                    end
                                                    if &#x27;===============================================================BB=============================================END
                                                    else
                                                        Dim Count4 as integer=0
                                                        Dim Prev as integer =0
                                                        Dim Base as Decimal=0
                                                        for r as integer=0 to A1.Rows.Count-1
                                                            For j as integer=0 to T3.Rows.Count-1
                                                                if A1.Rows(r)(&quot;Amount&quot;)=T3.Rows(j)(&quot;Sal&quot;)                             Count4=Count4+1
                                                                    end
                                                                    if
                                                                next
                                                                if prev&lt;Count4                         BasicSalary=A1.Rows(r)(&quot;Amount&quot;)                         prev=Count4
                                                                    end
                                                                    if                     Count4=0
                                                                    next                                 x=T.NewRow
                                                                    For r As Integer = 0 To Buffer.Rows.Count-1         &#x27;
                                                                        If (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3) Then
                                                                            if((SD1m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))OR (SD2m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD3m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD3p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD4m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD4p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))) then                         x= Buffer.Rows(r)                         T.ImportRow(x)                         x=T.NewRow                         Tcounter=Tcounter+1
                                                                        End If
                                                                    end if
                                                                next
                                                                if Tcounter&lt;2                     ReassignFlag=1                     Status=&quot;Total number of feasible transaction is less than 2 after filtering with +/-5 salary date in AA-BB-Gov III&quot;
                                                                else                     BSp=BasicSalary+(BasicSalary*20/100)                     BSm=BasicSalary-(BasicSalary*20/100)                     x=T2.NewRow
                                                                    for r as integer=0 to T.Rows.count-1                         if(T.Rows(r)(&quot;Sal&quot;)&gt;=BSm AND T.Rows(r)(&quot;Sal&quot;)&lt;=BSp)                             x= T.Rows(r)                             T2.ImportRow(x)                             x=T2.NewRow                             T2counter=T2counter+1
                                                                        end
                                                                        if
                                                                    next
                                                                    If T2counter&lt;2 Then
                                                                        ReassignFlag=1                         Status=&quot;Total number of feasible transaction is less than 2 after filtering BSm&lt;= SAL &lt;=BSp in AA-BB-Gov IV&quot;
                                                                    End If
                                                                else
                                                                    if T2counter=2                         min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                                        For k As Integer = 0 To 1                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                                            If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                                min=T2.Rows(k)(&quot;Sal&quot;)                                 minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                                            End If
                                                                            end
                                                                            if
                                                                        next                         Avg= Sum / 2
                                                                        If Avg&lt;1.2*min Then
                                                                            test=4
                                                                        End If
                                                                        For r As Integer = 0 To LL.Rows.Count-1                                 if(LL.Rows(r)(&quot;Sal&quot;)&gt;=Avg*0.65) then
                                                                            If LLcheck=0 Then
                                                                                LLcheck=1                                         if(LL.Rows(r)(&quot;Sal&quot;)&lt;=Avg) then                                             Salary=LL.Rows(r)(&quot;Amount&quot;)
                                                                            End If
                                                                        else                                             ReassignFlag=1                                             Status=&quot;Salary not identified sincee one transaction in last month is grater than selected salary&quot;
                                                                            end
                                                                            if
                                                                        else                                          ReassignFlag=1                                         Status=&quot;More than one transaction is grater then 65% of selected salary&quot;
                                                                            end
                                                                            if
                                                                        end if
                                                                    next
                                                                else
                                                                    For r As Integer = 0 To LL.Rows.Count-1                                 if(LL.Rows(r)(&quot;Sal&quot;)&gt;=min*0.65) then
                                                                        If LLcheck=0 Then
                                                                            LLcheck=1                                         if(LL.Rows(r)(&quot;Sal&quot;)&lt;=min) then                                             Salary=LL.Rows(r)(&quot;Amount&quot;)
                                                                        End If
                                                                    else                                             ReassignFlag=1                                             Status=&quot;Salary not identified sincee one transaction in last month is grater than selected salary&quot;
                                                                        end
                                                                        if
                                                                    else                                          ReassignFlag=1                                         Status=&quot;More than one transaction is grater then 65% of selected salary&quot;
                                                                        end
                                                                        if
                                                                    end if
                                                                next
                                                                end
                                                                if
                                                            else                          min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                                For k As Integer = 0 To 2                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                                    If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                        min=T2.Rows(k)(&quot;Sal&quot;)                                 minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                                    End If
                                                                    end
                                                                    if
                                                                next                         Avg= Sum / 3
                                                                If Avg&lt;1.2*min Then
                                                                    test=4
                                                                End If
                                                                For r As Integer = 0 To LL.Rows.Count-1                                 if(LL.Rows(r)(&quot;Sal&quot;)&gt;=Avg*0.65) then
                                                                    If LLcheck=0 Then
                                                                        LLcheck=1                                         if(LL.Rows(r)(&quot;Sal&quot;)&lt;=Avg) then                                             Salary=LL.Rows(r)(&quot;Amount&quot;)
                                                                    End If
                                                                else                                             ReassignFlag=1                                             Status=&quot;Salary not identified sincee one transaction in last month is grater than selected salary&quot;
                                                                    end
                                                                    if
                                                                else                                          ReassignFlag=1                                         Status=&quot;More than one transaction is grater then 65% of selected salary&quot;
                                                                    end
                                                                    if
                                                                end if
                                                            next
                                                        else
                                                            For r As Integer = 0 To LL.Rows.Count-1                                 if(LL.Rows(r)(&quot;Sal&quot;)&gt;=min*0.65) then
                                                                If LLcheck=0 Then
                                                                    LLcheck=1                                         if(LL.Rows(r)(&quot;Sal&quot;)&lt;=min) then                                         Salary=LL.Rows(r)(&quot;Amount&quot;)
                                                                End If
                                                            else                                         ReassignFlag=1                                         Status=&quot;Salary not identified sincee one transaction in last month is grater than selected salary&quot;
                                                                end
                                                                if
                                                            else                                          ReassignFlag=1                                         Status=&quot;More than one transaction is grater then 65% of selected salary&quot;
                                                                end
                                                                if
                                                            end if
                                                        next
                                                        end
                                                        if
                                                    end if
                                                    end
                                                    if
                                                    end
                                                    if  &#x27;=============================================================AA===================================================    END
                                                        end
                                                        if
                                                    else             Status=&quot;No transaction in +/- 5 of last salary date&quot;             ReassignFlag=1
                                                        end
                                                        if
                                                        end
                                                        if
                                                    else      Status=&quot;Total number of feasible transaction is less than 3&quot;     ReassignFlag=1
                                                        end
                                                        if D0=D1 A0=A1
                                                        catch e as Exception         er=e.ToString         ReassignFlag=1         Status=&quot;Code Error:&quot;+e.ToString
                                                            end
                                                            try"
                            data-title="UWCA_MRCC_CTF_V1.0 / Salary code / Salary Calculation(new)4">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>UWCA_MRCC_CTF_V1.0</td>
                <td>Salary code</td>
                <td>Salary Calculation(new)5</td>
                <td>visualbasic</td>
                <td>891</td>
                <!--<td style="font-family: monospace;">3f34e6b37a825b486aa225c41d4078336b93b416ca31caf6d12afbf4a271d778</td>-->
                <td>—</td>
                <!--<td>try     Dim description as string     Dim x As DataRow = D1.NewRow     Dim Dflag as integer =0     Dim precount as integer =0     Dim Amount as integer =0     Dim Avg as Decimal=0     Dim Sum as integer =0     Dim skip as integer =0     Dim min as integer =0     Dim count as integer =0     Dim Av as...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="try
    Dim description as string
    Dim x As DataRow = D1.NewRow
    Dim Dflag as integer =0
    Dim precount as integer =0
    Dim Amount as integer =0
    Dim Avg as Decimal=0
    Dim Sum as integer =0
    Dim skip as integer =0
    Dim min as integer =0
    Dim count as integer =0
    Dim Av as integer =0
    Dim mi as integer =0
    Dim minim as string min=0 count=0 minim=&quot;&quot;
    if c1.Rows.Count&gt;2 then
        For r As Integer = 0 To c1.Rows.Count-1         description=c1.Rows(r)(&quot;Description&quot;)         Dflag=0
            for i as integer=0 To D1.Rows.Count-1
                If D1.Rows(i)(&quot;Description&quot;)=description Then
                    Dflag=1                 D1.Rows(i)(&quot;Count&quot;)=D1.Rows(i)(&quot;Count&quot;)+1
                End If
                end
                if
            next
            If Dflag=0 Then
                x(&quot;Description&quot;) = description             x(&quot;Count&quot;)=1             D1.Rows.Add(x)             x= D1.NewRow
            End If
            end
            if
        Next
        For r As Integer = 0 To D1.Rows.Count-1         description=D1.Rows(r)(&quot;Description&quot;)         CollOut=Nothing         CollOut=c1.Clone
            For Each parentRow As DataRow In c1.Select(&quot;Description=&#x27;&quot;+description+&quot;&#x27;&quot;)             x = CollOut.NewRow
                For Each c As DataColumn In x.Table.Columns                     x(c.ColumnName) = parentRow(c.ColumnName)
                Next             CollOut.Rows.Add(x)
            Next         count=CollOut.Rows.Count
            If count&gt;precount Then
                Buffer=Nothing             Buffer = CollOut.Clone             Buffer=CollOut             precount=count             ReassignFlag=0
            End If
        else
            if count = Precount             ReassignFlag=1             Status=&quot;Salary cannot be identified since there mode are equal&quot;
                end
                if
            next &#x27;+++++++++++++++++++++++++
            If Govt= False AND EF= False Then
                &#x27;+++++++++++++++++++++++++
            End If
            If Buffer.Rows.Count &gt;2 Then
                ReassignFlag=0
            End If
            if ReassignFlag=0             ReassignFlag=1
                For r As Integer = 0 To Buffer.Rows.Count-1
                    If Buffer.Rows(r)(&quot;Days&quot;)&lt;=TimePeriod Then
                        ReassignFlag=0
                    End If
                    exit
                    for
                    end
                    if
                next
                end
                if
                if ReassignFlag=0             Status=&quot;&quot;
                    For r As Integer = 0 To Buffer.Rows.Count-1                 Amount=Buffer.Rows(r)(&quot;Sal&quot;)                 Dflag=0
                        for i as integer=0 To A1.Rows.Count-1
                            If A1.Rows(i)(&quot;Amount&quot;)=Amount Then
                                Dflag=1                         A1.Rows(i)(&quot;Count&quot;)=A1.Rows(i)(&quot;Count&quot;)+1
                            End If
                            end
                            if
                        next
                        If Dflag=0 Then
                            x= A1.NewRow                     x(&quot;Amount&quot;) = Amount                     x(&quot;Count&quot;)=1                     x(&quot;Salary&quot;)=Buffer.Rows(r)(&quot;Amount&quot;)                     A1.Rows.Add(x)
                        End If
                        end
                        if
                    Next             min=Buffer.Rows(0)(&quot;Sal&quot;)+1
                    For k As Integer = 0 To 2                 Sum=Sum+Buffer.Rows(k)(&quot;Sal&quot;)
                        If min&gt;Buffer.Rows(k)(&quot;Sal&quot;) Then
                            min=Buffer.Rows(k)(&quot;Sal&quot;)                     minimum=Buffer.Rows(k)(&quot;Amount&quot;)
                        End If
                        end
                        if
                        if k=1                     Av=Sum/2                     mi=min                     minim=minimum
                            end
                            if
                        next             Avg= Sum / 3
                        If Avg&lt;1.2*min Then
                            test=1 Cop=A1                 Salary=minimum                 Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                        End If
                    else
                        If Av&lt;1.2*mi Then
                            minimum=minim                 Salary=minimum                 Other=Replace((Av-mi),&quot;.&quot;,&quot;,&quot;)
                        End If
                    else
                        For r As Integer = 0 To A1.Rows.Count-1
                            If (A1.Rows(r)(&quot;Count&quot;)*100/(Buffer.Rows.Count))&gt;60 Then
                                Salary=A1.Rows(r)(&quot;Salary&quot;)                         skip=1
                            End If
                            end
                            if
                        next
                        If skip=0 Then
                            &#x27;vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvPage2vvvvvvvvvvvvvvvvvvvvvvvvvvv
                        End If
                        if Govt=True then
                            Dim SD1p,SD1m,SD2p,SD2m,SD3p,SD3m as date
                            Dim Sflag as integer =0
                            Dim BasicSalary as Integer =0
                            Dim T as DataTable =Buffer.Clone
                            Dim T2 as DataTable=Buffer.Clone
                            Dim TX as DataTable=Buffer.Clone
                            Dim Tcounter as integer =0
                            Dim T2counter as integer =0
                            Dim BSp,BSm as Decimal                          Sum=0                         minimum=0                         Salary=0                         Other=0                         min=0                         SD1p=SD1.AddDays(5)                         SD1m=SD1.AddDays(-5)                         SD2p=SD2.AddDays(5)                         SD2m=SD2.AddDays(-5)                         SD3p=SD3.AddDays(5)                         SD3m=SD3.AddDays(-5)                 &#x27;        T=Buffer.Clone
                            For r As Integer = 0 To Buffer.Rows.Count-1 &#x27;
                                If (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3) Then
                                    if((SD1m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))OR (SD2m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD3m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD3p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))) then                                 x= Buffer.Rows(r)                                 TX.ImportRow(x)                                 x=TX.NewRow
                                End If
                            end if
                        next                         Buffer=TX
                        For r As Integer = 0 To Buffer.Rows.Count-1                 &#x27;
                            if (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1) then
                                If (SD1m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) Then
                                    Sflag=Sflag+1                                 BasicSalary=Buffer.Rows(r)(&quot;Sal&quot;)                                 &#x27;AM=BasicSalary
                                End If
                                end
                                if
                            Next                         &#x27;AM=BasicSalary
                            If Sflag=1 Then
                                x=T.NewRow
                            End If
                            For r As Integer = 0 To Buffer.Rows.Count-1                 &#x27;
                                If (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3) Then
                                    if((SD1m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))OR (SD2m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD3m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD3p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))) then                                     x= Buffer.Rows(r)                                     T.ImportRow(x)                                     x=T.NewRow                                     Tcounter=Tcounter+1
                                End If
                            end if
                        next
                        if Tcounter&lt;3                                 ReassignFlag=1                                 Status=&quot;Total number of feasible transaction is less than 3 after filtering with +/-5 salary date I&quot;
                        else                                 BSp=BasicSalary+(BasicSalary*20/100)                                 BSm=BasicSalary-(BasicSalary*20/100)                                 x=T2.NewRow
                            for r as integer=0 to T.Rows.count-1                                     if(T.Rows(r)(&quot;Sal&quot;)&gt;=BSm AND T.Rows(r)(&quot;Sal&quot;)&lt;=BSp)                                         x= T.Rows(r)                                         T2.ImportRow(x)                                         x=T2.NewRow                                         T2counter=T2counter+1
                                end
                                if
                            next
                            If T2counter&lt;2 Then
                                ReassignFlag=1                                     Status=&quot;Total number of feasible transaction is less than 2 after filtering BSm &lt;= Salary &lt;=BSp&quot;
                            End If
                        else
                            if T2counter=2                                     min=T2.Rows(0)(&quot;Sal&quot;)+1
                                For k As Integer = 0 To 1                                         Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                    If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                        min=T2.Rows(k)(&quot;Sal&quot;)                                             minimum=T2.Rows(k)(&quot;Amount&quot;)
                                    End If
                                    end
                                    if
                                next                                     Avg= Sum / 2
                                If Avg&lt;1.2*min Then
                                    test=2                                         Salary=minimum                                         Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                End If
                            else                                         Salary=minimum                                         Other=0
                                end
                                if
                            else                                     min=T2.Rows(0)(&quot;Sal&quot;)+1
                                For k As Integer = 0 To 2                                         Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                    If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                        min=T2.Rows(k)(&quot;Sal&quot;)                                             minimum=T2.Rows(k)(&quot;Amount&quot;)
                                    End If
                                    end
                                    if
                                next                                     Avg= Sum / 3
                                If Avg&lt;1.2*min Then
                                    test=2                                         Salary=minimum                                         Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                End If
                            else                                         Salary=minimum                                         Other=0
                                end
                                if
                            end if
                            end
                            if                     &#x27;    test=T                     &#x27;    testT=Tcounter
                            else &#x27;=============================================================AA===================================================BEGIN
                                Dim T3 as DataTable=Buffer.Clone
                                Dim Tcounter2 as integer=0
                                for r as integer =0 to Buffer.Rows.Count-1                                 if(Buffer.Rows(r)(&quot;Sal&quot;)&gt;=LastApproved) then                                     x=T3.NewRow                                     x=Buffer.Rows(r)                                     T3.ImportRow(x)                                     Tcounter2=Tcounter2+1                                     BasicSalary=Buffer.Rows(r)(&quot;Sal&quot;)
                                    end
                                    if
                                next                             &#x27;    Buffer=Nothing                         &#x27;    Buffer=T3 Cop=Buffer &#x27;===============================================================BB=============================================BEGIN                             if(Tcounter2=1)                                 x=T.NewRow
                                For r As Integer = 0 To Buffer.Rows.Count-1                 &#x27;
                                    If (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3) Then
                                        if((SD1m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))OR (SD2m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD3m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD3p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))) then                                         x= Buffer.Rows(r)                                         T.ImportRow(x)                                         x=T.NewRow                                         Tcounter=Tcounter+1
                                    End If
                                end if
                            next
                            if Tcounter&lt;3                                     ReassignFlag=1                                     Status=&quot;Total number of feasible transaction is less than 3 after filtering with +/-5 salary date in AA-BB-Gov I&quot;
                            else                                     BSp=BasicSalary+(BasicSalary*20/100)                                     BSm=BasicSalary-(BasicSalary*20/100)                                     x=T2.NewRow
                                for r as integer=0 to T.Rows.count-1                                         if(T.Rows(r)(&quot;Sal&quot;)&gt;=BSm AND T.Rows(r)(&quot;Sal&quot;)&lt;=BSp)                                             x= T.Rows(r)                                             T2.ImportRow(x)                                             x=T2.NewRow                                             T2counter=T2counter+1
                                    end
                                    if
                                next
                                If T2counter&lt;2 Then
                                    ReassignFlag=1                                         Status=&quot;Total number of feasible transaction is less than 2 after filtering with +/-5 salary date in AA-BB-Gov II&quot;
                                End If
                            else
                                if T2counter=2                                         min=T2.Rows(0)(&quot;Sal&quot;)+1
                                    For k As Integer = 0 To 1                                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                        If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                            min=T2.Rows(k)(&quot;Sal&quot;)                                                 minimum=T2.Rows(k)(&quot;Amount&quot;)
                                        End If
                                        end
                                        if
                                    next                                         Avg= Sum / 2
                                    If Avg&lt;1.2*min Then
                                        test=3                                             Salary=minimum                                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                    End If
                                else                                             Salary=minimum                                             Other=0
                                    end
                                    if
                                else                                         min=T2.Rows(0)(&quot;Sal&quot;)+1
                                    For k As Integer = 0 To 2                                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                        If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                            min=T2.Rows(k)(&quot;Sal&quot;)                                                 minimum=T2.Rows(k)(&quot;Amount&quot;)
                                        End If
                                        end
                                        if
                                    next                                         Avg= Sum / 3
                                    If Avg&lt;1.2*min Then
                                        test=3                                             Salary=minimum                                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                    End If
                                else                                             Salary=minimum                                             Other=0
                                    end
                                    if
                                end if
                                end
                                if &#x27;===============================================================BB=============================================END
                                else
                                    Dim Count4 as integer=0
                                    Dim Prev as integer =0
                                    Dim Base as Decimal=0
                                    for r as integer=0 to A1.Rows.Count-1
                                        For j as integer=0 to T3.Rows.Count-1
                                            if A1.Rows(r)(&quot;Amount&quot;)=T3.Rows(j)(&quot;Sal&quot;)                                             Count4=Count4+1
                                                end
                                                if
                                            next
                                            if prev&lt;Count4                                         BasicSalary=A1.Rows(r)(&quot;Amount&quot;)                                         prev=Count4
                                                end
                                                if                                     Count4=0
                                                next                                                 x=T.NewRow
                                                For r As Integer = 0 To Buffer.Rows.Count-1                 &#x27;
                                                    If (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3) Then
                                                        if((SD1m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))OR (SD2m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD3m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD3p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))) then                                         x= Buffer.Rows(r)                                         T.ImportRow(x)                                         x=T.NewRow                                         Tcounter=Tcounter+1
                                                    End If
                                                end if
                                            next
                                            if Tcounter&lt;3                                     ReassignFlag=1                                     Status=&quot;Total number of feasible transaction is less than 3 after filtering with +/-5 salary date in AA-BB-Gov III&quot;
                                            else                                     BSp=BasicSalary+(BasicSalary*20/100)                                     BSm=BasicSalary-(BasicSalary*20/100)                                     x=T2.NewRow
                                                for r as integer=0 to T.Rows.count-1                                         if(T.Rows(r)(&quot;Sal&quot;)&gt;=BSm AND T.Rows(r)(&quot;Sal&quot;)&lt;=BSp)                                             x= T.Rows(r)                                             T2.ImportRow(x)                                             x=T2.NewRow                                             T2counter=T2counter+1
                                                    end
                                                    if
                                                next
                                                If T2counter&lt;2 Then
                                                    ReassignFlag=1                                         Status=&quot;Total number of feasible transaction is less than 2 after filtering BSm&lt;= SAL &lt;=BSp in AA-BB-Gov IV&quot;
                                                End If
                                            else
                                                if T2counter=2                                         min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                    For k As Integer = 0 To 1                                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                        If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                            min=T2.Rows(k)(&quot;Sal&quot;)                                                 minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                        End If
                                                        end
                                                        if
                                                    next                                         Avg= Sum / 2
                                                    If Avg&lt;1.2*min Then
                                                        test=4                                             Salary=minimum                                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                    End If
                                                else                                             Salary=minimum                                             Other=0
                                                    end
                                                    if
                                                else                                          min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                    For k As Integer = 0 To 2                                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                        If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                            min=T2.Rows(k)(&quot;Sal&quot;)                                                 minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                        End If
                                                        end
                                                        if
                                                    next                                         Avg= Sum / 3
                                                    If Avg&lt;1.2*min Then
                                                        test=4                                             Salary=minimum                                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                    End If
                                                else                                             Salary=minimum                                             Other=0
                                                    end
                                                    if
                                                end if
                                                end
                                                if
                                                end
                                                if  &#x27;=============================================================AA===================================================    END
                                                    end
                                                    if
                                                else &#x27;==========================================================================B===================================BEGIN
                                                    Dim Sflag as integer =0
                                                    Dim BasicSalary as Integer =0
                                                    Dim T as DataTable =Buffer.Clone
                                                    Dim T2 as DataTable=Buffer.Clone
                                                    Dim Tcounter as integer =0
                                                    Dim T2counter as integer =0
                                                    Dim BSp,BSm as Decimal
                                                    Dim BaseDays as Decimal =0
                                                    Dim Dayz as decimal=0                         Sum=0                         minimum=0                         Salary=0                         Sflag=0                         Other=0                         min=0
                                                    For r As Integer = 0 To Buffer.Rows.Count-1
                                                        If (Buffer.Rows(r)(&quot;Days&quot;)&lt;=TimePeriod) Then
                                                            Sflag=Sflag+1                                 BasicSalary=Buffer.Rows(r)(&quot;Sal&quot;)                                 x=T.NewRow                                 x= Buffer.Rows(r)                                 T.ImportRow(x)                                 Tcounter=1                                 BaseDays=Buffer.Rows(r)(&quot;Days&quot;)
                                                        End If
                                                        end
                                                        if
                                                    Next &#x27;=======================================================================================BB=================================================BEGIN
                                                    If Sflag=1 Then
                                                        x=T.NewRow
                                                    End If
                                                    For r As Integer = 0 To Buffer.Rows.Count-1                                     Dayz=Buffer.Rows(r)(&quot;Days&quot;)                                 Dayz=Dayz-BaseDays
                                                        If ((Dayz&gt;=25 AND Dayz&lt;=35) OR (Dayz&gt;=55 AND Dayz&lt;=65) ) Then
                                                            x= Buffer.Rows(r)                                     T.ImportRow(x)                                     x=T.NewRow                                     Tcounter=Tcounter+1
                                                        End If
                                                    end if
                                                next                             &#x27;testT=Tcounter /checked
                                                if Tcounter&lt;3                                 ReassignFlag=1                                 Status=&quot;Total number of feasible transaction is less than 3 after filtering with 25-35 and 55 to 65 in AA-BB-nonGov II&quot;
                                                else                                 BSp=BasicSalary+(BasicSalary*20/100)                                 BSm=BasicSalary-(BasicSalary*20/100)                                 x=T2.NewRow
                                                    for r as integer=0 to T.Rows.count-1                                     if(T.Rows(r)(&quot;Sal&quot;)&gt;=BSm AND T.Rows(r)(&quot;Sal&quot;)&lt;=BSp)                                         x= T.Rows(r)                                         T2.ImportRow(x)                                         x=T2.NewRow                                         T2counter=T2counter+1
                                                        end
                                                        if
                                                    next
                                                    If T2counter&lt;2 Then
                                                        ReassignFlag=1                                     Status=&quot;Total number of feasible transaction is less than 2 after filtering BSm&lt;=SAL&lt;=BSp BB-non Gov II&quot;
                                                    End If
                                                else
                                                    if T2counter=2
                                                        For k As Integer = 0 To 1                                         Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                            If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                min=T2.Rows(k)(&quot;Sal&quot;)                                             minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                            End If
                                                            end
                                                            if
                                                        next                                      Avg= Sum / 2
                                                        If Avg&lt;1.2*min Then
                                                            Salary=minimum                                         Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                        End If
                                                    else                                          Salary=minimum                                         Other=0
                                                        end
                                                        if
                                                    else                                       min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                        For k As Integer = 0 To 2                                         Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                            If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                min=T2.Rows(k)(&quot;Sal&quot;)                                             minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                            End If
                                                            end
                                                            if
                                                        next                                      Avg= Sum / 3
                                                        If Avg&lt;1.2*min Then
                                                            Salary=minimum                                         Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                        End If
                                                    else                                          Salary=minimum                                         Other=0
                                                        end
                                                        if
                                                    end if
                                                    end
                                                    if                         &#x27;test=T2                         &#x27;testT=Tcounter
                                                    else &#x27;++++++++++++++++++++++AA+++++++++ &#x27;=============================================================AA===================================================BEGIN
                                                        Dim T3 as DataTable=Buffer.Clone
                                                        Dim Tcounter2 as integer=0
                                                        for r as integer =0 to Buffer.Rows.Count-1                                 if(Buffer.Rows(r)(&quot;Sal&quot;)&gt;=LastApproved) then                                     x=T3.NewRow                                     x=Buffer.Rows(r)                                     T3.ImportRow(x)                                     Tcounter2=Tcounter2+1                                     BasicSalary=Buffer.Rows(r)(&quot;Sal&quot;)
                                                            end
                                                            if
                                                        next                                 Buffer=Nothing                             Buffer=T3 &#x27;===============================================================BB=============================================BEGIN                             if(Tcounter2=1)                                 x=T.NewRow
                                                        For r As Integer = 0 To Buffer.Rows.Count-1                                         Dayz=Buffer.Rows(r)(&quot;Days&quot;)                                     Dayz=Dayz-BaseDays
                                                            If ((Dayz&gt;=25 AND Dayz&lt;=35) OR (Dayz&gt;=55 AND Dayz&lt;=65) ) Then
                                                                x= Buffer.Rows(r)                                         T.ImportRow(x)                                         x=T.NewRow                                         Tcounter=Tcounter+1
                                                            End If
                                                        end if
                                                    next                                 &#x27;testT=Tcounter /checked
                                                    if Tcounter&lt;3                                     ReassignFlag=1                                     Status=&quot;Total number of feasible transaction is less than 3 after filtering with 25-35 and 55 to 65 in AA-BB-nonGov III&quot;
                                                    else                                     BSp=BasicSalary+(BasicSalary*20/100)                                     BSm=BasicSalary-(BasicSalary*20/100)                                     x=T2.NewRow
                                                        for r as integer=0 to T.Rows.count-1                                         if(T.Rows(r)(&quot;Sal&quot;)&gt;=BSm AND T.Rows(r)(&quot;Sal&quot;)&lt;=BSp)                                             x= T.Rows(r)                                             T2.ImportRow(x)                                             x=T2.NewRow                                             T2counter=T2counter+1
                                                            end
                                                            if
                                                        next
                                                        If T2counter&lt;2 Then
                                                            ReassignFlag=1                                         Status=&quot;Total number of feasible transaction is less than 2 after filtering BSm&lt;SAL&lt;BSp in AA-BB-nonGov IV&quot;
                                                        End If
                                                    else
                                                        if T2counter=2                                         min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                            For k As Integer = 0 To 1                                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                                If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                    min=T2.Rows(k)(&quot;Sal&quot;)                                                 minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                                End If
                                                                end
                                                                if
                                                            next                                          Avg= Sum / 2
                                                            If Avg&lt;1.2*min Then
                                                                Salary=minimum                                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                            End If
                                                        else                                              Salary=minimum                                             Other=0
                                                            end
                                                            if
                                                        else                                         min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                            For k As Integer = 0 To 2                                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                                If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                    min=T2.Rows(k)(&quot;Sal&quot;)                                                 minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                                End If
                                                                end
                                                                if
                                                            next                                          Avg= Sum / 3
                                                            If Avg&lt;1.2*min Then
                                                                Salary=minimum                                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                            End If
                                                        else                                              Salary=minimum                                             Other=0
                                                            end
                                                            if
                                                        end if
                                                        end
                                                        if  &#x27;===============================================================BB=============================================END
                                                        else
                                                            Dim Count4 as integer=0
                                                            Dim Prev as integer =0
                                                            Dim Base as Decimal=0
                                                            for r as integer=0 to A1.Rows.Count-1
                                                                For j as integer=0 to T3.Rows.Count-1
                                                                    if A1.Rows(r)(&quot;Amount&quot;)=T3.Rows(j)(&quot;Sal&quot;)                                             Count4=Count4+1
                                                                        end
                                                                        if
                                                                    next
                                                                    if prev&lt;Count4                                         BasicSalary=A1.Rows(r)(&quot;Amount&quot;)
                                                                        end
                                                                        if
                                                                    next &#x27;============================================================BB=============================================BEGIN                                             x=T.NewRow
                                                                    For r As Integer = 0 To Buffer.Rows.Count-1                                         Dayz=Buffer.Rows(r)(&quot;Days&quot;)                                     Dayz=Dayz-BaseDays
                                                                        If ((Dayz&gt;=25 AND Dayz&lt;=35) OR (Dayz&gt;=55 AND Dayz&lt;=65) ) Then
                                                                            x= Buffer.Rows(r)                                         T.ImportRow(x)                                         x=T.NewRow                                         Tcounter=Tcounter+1
                                                                        End If
                                                                    end if
                                                                next                                 &#x27;testT=Tcounter /checked
                                                                if Tcounter&lt;3                                     ReassignFlag=1                                     Status=&quot;Total number of feasible transaction is less than 3 after filtering 25-35 and 55-65 in AA-BB-nonGov V&quot;
                                                                else                                     BSp=BasicSalary+(BasicSalary*20/100)                                     BSm=BasicSalary-(BasicSalary*20/100)                                     x=T2.NewRow
                                                                    for r as integer=0 to T.Rows.count-1                                         if(T.Rows(r)(&quot;Sal&quot;)&gt;=BSm AND T.Rows(r)(&quot;Sal&quot;)&lt;=BSp)                                             x= T.Rows(r)                                             T2.ImportRow(x)                                             x=T2.NewRow                                             T2counter=T2counter+1
                                                                        end
                                                                        if
                                                                    next
                                                                    If T2counter&lt;2 Then
                                                                        ReassignFlag=1                                         Status=&quot;Total number of feasible transaction is less than 2 after filtering BSp&lt;=SAL&lt;=BSp in AA-BB-nonGov VI&quot;
                                                                    End If
                                                                else
                                                                    if T2counter=2                                         min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                                        For k As Integer = 0 To 1                                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                                            If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                                min=T2.Rows(k)(&quot;Sal&quot;)                                                 minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                                            End If
                                                                            end
                                                                            if
                                                                        next                                          Avg= Sum / 2
                                                                        If Avg&lt;1.2*min Then
                                                                            Salary=minimum                                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                                        End If
                                                                    else                                              Salary=minimum                                             Other=0
                                                                        end
                                                                        if
                                                                    else                                          min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                                        For k As Integer = 0 To 2                                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                                            If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                                min=T2.Rows(k)(&quot;Sal&quot;)                                                 minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                                            End If
                                                                            end
                                                                            if
                                                                        next                                          Avg= Sum / 3
                                                                        If Avg&lt;1.2*min Then
                                                                            Salary=minimum                                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                                        End If
                                                                    else                                              Salary=minimum                                             Other=0
                                                                        end
                                                                        if
                                                                    end if
                                                                    end
                                                                    if &#x27;===========================================================BB======================================================END
                                                                        end
                                                                        if &#x27;=============================================================AA===================================================    END
                                                                            end
                                                                            if &#x27;==============================================================BB============================================END                      &#x27;==============================================================B=============================================END
                                                                                end
                                                                                if &#x27;^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^Page2^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                                                                    end
                                                                                    if
                                                                                    end
                                                                                    if
                                                                                else             Status=&quot;Salary cannot be identified since there is no transaction in the past &quot;+TimePeriod.ToString+&quot; days&quot;             ReassignFlag=1
                                                                                    end
                                                                                    if
                                                                                else         ReassignFlag=1         Status=&quot;Total number of feasible transaction is less than 3&quot;
                                                                                    end
                                                                                    if
                                                                                else
                                                                                    Dim SD1p,SD1m,SD2p,SD2m,SD3p,SD3m,SD4p,SD4m as date
                                                                                    Dim Sflag as integer =0
                                                                                    Dim Salflag as integer =0
                                                                                    Dim Lflag as integer =0
                                                                                    Dim L2flag as integer =0
                                                                                    Dim LLcheck as integer =0
                                                                                    Dim BasicSalary as Integer =0
                                                                                    Dim T as DataTable =Buffer.Clone
                                                                                    Dim T2 as DataTable=Buffer.Clone
                                                                                    Dim TX as DataTable=Buffer.Clone
                                                                                    Dim LL as DataTable=Buffer.Clone
                                                                                    Dim L2 as DataTable=Buffer.Clone
                                                                                    Dim Tcounter as integer =0
                                                                                    Dim T2counter as integer =0
                                                                                    Dim BSp,BSm as Decimal          Sum=0         minimum=0         Salary=0         Other=0         min=0         SD1p=SD1.AddDays(5)         SD1m=SD1.AddDays(-5)         SD2p=SD2.AddDays(5)         SD2m=SD2.AddDays(-5)         SD3p=SD3.AddDays(5)         SD3m=SD3.AddDays(-5)         SD4p=SD4.AddDays(5)         SD4m=SD4.AddDays(-5)         &#x27;        T=Buffer.Clone
                                                                                    For r As Integer = 0 To Buffer.Rows.Count-1         &#x27;
                                                                                        If (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3) Then
                                                                                            if((SD1m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))OR (SD2m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD3m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD3p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD4m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD4p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))) then                 x= Buffer.Rows(r)                 TX.ImportRow(x)                 x=TX.NewRow
                                                                                        End If
                                                                                    end if
                                                                                next         Buffer=TX
                                                                                For r As Integer = 0 To Buffer.Rows.Count-1         &#x27;
                                                                                    If (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3) Then
                                                                                        if((SD1m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))) then                 x= Buffer.Rows(r)                 LL.ImportRow(x)                 x=LL.NewRow                 Lflag=Lflag+1
                                                                                    End If
                                                                                end if
                                                                            next LLout=LL &#x27;+++++++++++++++++++++++++++
                                                                            If Lflag&gt;0 Then
                                                                                &#x27;+++++++++++++++++++++++++++
                                                                            End If
                                                                            if Lflag=1 then
                                                                                For r As Integer = 0 To Buffer.Rows.Count-1                 if((SD2m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))) then                     x= Buffer.Rows(r)                     L2.ImportRow(x)                     x=L2.NewRow                     L2flag=L2flag+1
                                                                                end if
                                                                            next
                                                                            if L2flag=1 then
                                                                                If L2.Rows(0)(&quot;Sal&quot;)&gt;=LL.Rows(0)(&quot;Sal&quot;) Then
                                                                                    salflag=1                         Salary=LL.Rows(0)(&quot;Amount&quot;)                         ReassignFlag=0 test=100
                                                                                End If
                                                                            else                     salflag=0
                                                                                end
                                                                                if
                                                                                If salflag=0 Then
                                                                                    &#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;
                                                                                End If
                                                                                For r As Integer = 0 To Buffer.Rows.Count-1         &#x27;
                                                                                    if (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1) then
                                                                                        If (SD2m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) Then
                                                                                            Sflag=Sflag+1                 BasicSalary=Buffer.Rows(r)(&quot;Sal&quot;)                 &#x27;AM=BasicSalary
                                                                                        End If
                                                                                        end
                                                                                        if
                                                                                    Next         &#x27;AM=BasicSalary
                                                                                    If Sflag=1 Then
                                                                                        x=T.NewRow
                                                                                    End If
                                                                                    For r As Integer = 0 To Buffer.Rows.Count-1         &#x27;
                                                                                        If (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3) Then
                                                                                            if((SD2m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD3m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD3p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD4m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD4p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))) then                     x= Buffer.Rows(r)                     T.ImportRow(x)                     x=T.NewRow                     Tcounter=Tcounter+1
                                                                                        End If
                                                                                    end if
                                                                                next
                                                                                if Tcounter&lt;2                 ReassignFlag=1                 Status=&quot;Total number of feasible transaction is less than 2 after filtering with +/-5 salary date I&quot;
                                                                                else                 BSp=BasicSalary+(BasicSalary*20/100)                 BSm=BasicSalary-(BasicSalary*20/100)                 x=T2.NewRow
                                                                                    for r as integer=0 to T.Rows.count-1                     if(T.Rows(r)(&quot;Sal&quot;)&gt;=BSm AND T.Rows(r)(&quot;Sal&quot;)&lt;=BSp)                         x= T.Rows(r)                         T2.ImportRow(x)                         x=T2.NewRow                         T2counter=T2counter+1
                                                                                        end
                                                                                        if
                                                                                    next
                                                                                    If T2counter&lt;2 Then
                                                                                        ReassignFlag=1                     Status=&quot;Total number of feasible transaction is less than 2 after filtering BSm &lt;= Salary &lt;=BSp&quot;
                                                                                    End If
                                                                                else
                                                                                    if T2counter=2                     min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                                                        For k As Integer = 0 To 1                         Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                                                            If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                                                min=T2.Rows(k)(&quot;Sal&quot;)                             minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                                                            End If
                                                                                            end
                                                                                            if
                                                                                        next                     Avg= Sum / 2
                                                                                        If Avg&lt;1.2*min Then
                                                                                            test=2 &#x27;
                                                                                        End If
                                                                                        For r As Integer = 0 To LL.Rows.Count-1 &#x27;                            if(LL.Rows(r)(&quot;Sal&quot;)&gt;=Avg*0.65) then &#x27;
                                                                                            If LLcheck=0 Then
                                                                                                &#x27;                                    LLcheck=1 &#x27;                                    if(Math.Floor(LL.Rows(r)(&quot;Sal&quot;))&lt;=Avg) then &#x27;                                        Salary=LL.Rows(r)(&quot;Amount&quot;) &#x27;
                                                                                            End If
                                                                                        else if(LL.Rows(r)(&quot;Sal&quot;)&lt;=Avg*1.2) then &#x27;                                        Salary=LL.Rows(r)(&quot;Amount&quot;) &#x27;
                                                                                        else     &#x27;                                        ReassignFlag=1 &#x27;                                        Status=&quot;Salary not identified sincee one transaction in last month is grater than selected salary&quot; &#x27;
                                                                                            end
                                                                                            if &#x27;
                                                                                            else  &#x27;                                    ReassignFlag=1 &#x27;                                    Status=&quot;More than one transaction is grater then 65% of selected salary&quot; &#x27;
                                                                                                end
                                                                                                if &#x27;
                                                                                                end if     &#x27;
                                                                                            next                         Salary=minimum                         Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                                                        else &#x27;
                                                                                            For r As Integer = 0 To LL.Rows.Count-1 &#x27;                            if(LL.Rows(r)(&quot;Sal&quot;)&gt;=min*0.65) then &#x27;
                                                                                                If LLcheck=0 Then
                                                                                                    &#x27;                                    LLcheck=1 &#x27;                                    if(Math.Floor(LL.Rows(r)(&quot;Sal&quot;))&lt;=min) then &#x27;                                        Salary=LL.Rows(r)(&quot;Amount&quot;) &#x27;
                                                                                                End If
                                                                                            else if(LL.Rows(r)(&quot;Sal&quot;)&lt;min*1.2) then &#x27;                                        Salary=LL.Rows(r)(&quot;Amount&quot;) &#x27;
                                                                                            else &#x27;                                        ReassignFlag=1 &#x27;                                        Status=&quot;Salary not identified sincee one transaction in last month is grater than selected salary&quot; &#x27;
                                                                                                end
                                                                                                if &#x27;
                                                                                                else  &#x27;                                    ReassignFlag=1 &#x27;                                    Status=&quot;More than one transaction is grater then 65% of selected salary&quot; &#x27;
                                                                                                    end
                                                                                                    if &#x27;
                                                                                                    end if     &#x27;
                                                                                                next test=2.1                         Salary=minimum
                                                                                                end
                                                                                                if
                                                                                            else                     min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                                                                For k As Integer = 0 To 2                         Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                                                                    If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                                                        min=T2.Rows(k)(&quot;Sal&quot;)                             minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                                                                    End If
                                                                                                    end
                                                                                                    if
                                                                                                next                     Avg= Sum / 3
                                                                                                If Avg&lt;1.2*min Then
                                                                                                    test=2 &#x27;
                                                                                                End If
                                                                                                For r As Integer = 0 To LL.Rows.Count-1 &#x27;                            if(LL.Rows(r)(&quot;Sal&quot;)&gt;=Avg*0.65) then &#x27;
                                                                                                    If LLcheck=0 Then
                                                                                                        &#x27;                                    LLcheck=1 &#x27;                                    if(Math.Floor(LL.Rows(r)(&quot;Sal&quot;))&lt;=Avg) then &#x27;                                        Salary=LL.Rows(r)(&quot;Amount&quot;) &#x27;
                                                                                                    End If
                                                                                                else if(LL.Rows(r)(&quot;Sal&quot;)&lt;Avg*1.2) then &#x27;                                        Salary=LL.Rows(r)(&quot;Amount&quot;) &#x27;
                                                                                                else &#x27;er=Avg &#x27;Buffer=T2 &#x27;                                        ReassignFlag=1 &#x27;                                        Status=&quot;Salary not identified sincee one transaction in last month is grater than selected salary&quot; &#x27;
                                                                                                    end
                                                                                                    if &#x27;
                                                                                                    else  &#x27;                                    ReassignFlag=1 &#x27;                                    Status=&quot;More than one transaction is grater then 65% of selected salary&quot; &#x27;
                                                                                                        end
                                                                                                        if &#x27;
                                                                                                        end if     &#x27;
                                                                                                    next                         Salary=minimum                         Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                                                                else &#x27;
                                                                                                    For r As Integer = 0 To LL.Rows.Count-1 &#x27;                            if(LL.Rows(r)(&quot;Sal&quot;)&gt;=min*0.65) then &#x27;
                                                                                                        If LLcheck=0 Then
                                                                                                            &#x27;                                    LLcheck=1 &#x27;                                    if(Math.Floor(LL.Rows(r)(&quot;Sal&quot;))&lt;=min) then &#x27;                                        Salary=LL.Rows(r)(&quot;Amount&quot;) &#x27;
                                                                                                        End If
                                                                                                    else if(LL.Rows(r)(&quot;Sal&quot;)&lt;=min*1.2) then &#x27;                                        Salary=LL.Rows(r)(&quot;Amount&quot;) &#x27;
                                                                                                    else &#x27;                                        ReassignFlag=1 &#x27;                                        Status=&quot;Salary not identified sincee one transaction in last month is grater than selected salary&quot; &#x27;
                                                                                                        end
                                                                                                        if &#x27;
                                                                                                        else  &#x27;                                    ReassignFlag=1 &#x27;                                    Status=&quot;More than one transaction is grater then 65% of selected salary&quot; &#x27;
                                                                                                            end
                                                                                                            if &#x27;
                                                                                                            end if     &#x27;
                                                                                                        next test=2.1                         Salary=minimum
                                                                                                        end
                                                                                                        if
                                                                                                    end if
                                                                                                    end
                                                                                                    if         &#x27;    test=T         &#x27;    testT=Tcounter
                                                                                                    else &#x27;=============================================================AA===================================================BEGIN
                                                                                                        Dim T3 as DataTable=Buffer.Clone
                                                                                                        Dim Tcounter2 as integer=0
                                                                                                        for r as integer =0 to Buffer.Rows.Count-1                 if(Buffer.Rows(r)(&quot;Sal&quot;)&gt;=LastApproved) then                     x=T3.NewRow                     x=Buffer.Rows(r)                     T3.ImportRow(x)                     Tcounter2=Tcounter2+1                     BasicSalary=Buffer.Rows(r)(&quot;Sal&quot;)
                                                                                                            end
                                                                                                            if
                                                                                                        next             &#x27;    Buffer=Nothing         &#x27;    Buffer=T3             Cop=Buffer &#x27;===============================================================BB=============================================BEGIN             if(Tcounter2=1)                 x=T.NewRow
                                                                                                        For r As Integer = 0 To Buffer.Rows.Count-1         &#x27;
                                                                                                            If (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3) Then
                                                                                                                if((SD1m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))OR (SD2m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD3m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD3p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD4m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD4p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))) then                         x= Buffer.Rows(r)                         T.ImportRow(x)                         x=T.NewRow                         Tcounter=Tcounter+1
                                                                                                            End If
                                                                                                        end if
                                                                                                    next
                                                                                                    if Tcounter&lt;2                     ReassignFlag=1                     Status=&quot;Total number of feasible transaction is less than 2 after filtering with +/-5 salary date in AA-BB-Gov I&quot;
                                                                                                    else                     BSp=BasicSalary+(BasicSalary*20/100)                     BSm=BasicSalary-(BasicSalary*20/100)                     x=T2.NewRow
                                                                                                        for r as integer=0 to T.Rows.count-1                         if(T.Rows(r)(&quot;Sal&quot;)&gt;=BSm AND T.Rows(r)(&quot;Sal&quot;)&lt;=BSp)                             x= T.Rows(r)                             T2.ImportRow(x)                             x=T2.NewRow                             T2counter=T2counter+1
                                                                                                            end
                                                                                                            if
                                                                                                        next
                                                                                                        If T2counter&lt;2 Then
                                                                                                            ReassignFlag=1                         Status=&quot;Total number of feasible transaction is less than 2 after filtering with +/-5 salary date in AA-BB-Gov II&quot;
                                                                                                        End If
                                                                                                    else
                                                                                                        if T2counter=2                         min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                                                                            For k As Integer = 0 To 1                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                                                                                If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                                                                    min=T2.Rows(k)(&quot;Sal&quot;)                                 minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                                                                                End If
                                                                                                                end
                                                                                                                if
                                                                                                            next                         Avg= Sum / 2
                                                                                                            If Avg&lt;1.2*min Then
                                                                                                                test=3 &#x27;
                                                                                                            End If
                                                                                                            For r As Integer = 0 To LL.Rows.Count-1 &#x27;                                if(LL.Rows(r)(&quot;Sal&quot;)&gt;=Avg*0.65) then &#x27;
                                                                                                                If LLcheck=0 Then
                                                                                                                    &#x27;                                        LLcheck=1 &#x27;                                        if(Math.Floor(LL.Rows(r)(&quot;Sal&quot;))&lt;=Avg) then &#x27;                                            Salary=LL.Rows(r)(&quot;Amount&quot;) &#x27;
                                                                                                                End If
                                                                                                            else if(LL.Rows(r)(&quot;Sal&quot;)&lt;=Avg*1.2) then &#x27;                                            Salary=LL.Rows(r)(&quot;Amount&quot;) &#x27;
                                                                                                            else &#x27;                                            ReassignFlag=1 &#x27;                                            Status=&quot;Salary not identified sincee one transaction in last month is grater than selected salary&quot; &#x27;
                                                                                                                end
                                                                                                                if &#x27;
                                                                                                                else  &#x27;                                        ReassignFlag=1 &#x27;                                        Status=&quot;More than one transaction is grater then 65% of selected salary&quot; &#x27;
                                                                                                                    end
                                                                                                                    if &#x27;
                                                                                                                    end if     &#x27;
                                                                                                                next                             Salary=minimum                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                                                                            else &#x27;
                                                                                                                For r As Integer = 0 To LL.Rows.Count-1 &#x27;                                if(LL.Rows(r)(&quot;Sal&quot;)&gt;=min*0.65) then &#x27;
                                                                                                                    If LLcheck=0 Then
                                                                                                                        &#x27;                                        LLcheck=1 &#x27;                                        if(Math.Floor(LL.Rows(r)(&quot;Sal&quot;))&lt;=min) then &#x27;                                            Salary=LL.Rows(r)(&quot;Amount&quot;) &#x27;
                                                                                                                    End If
                                                                                                                else if(LL.Rows(r)(&quot;Sal&quot;)&lt;=min*1.2) then &#x27;                                            Salary=LL.Rows(r)(&quot;Amount&quot;) &#x27;
                                                                                                                else &#x27;                                            ReassignFlag=1 &#x27;                                            Status=&quot;Salary not identified sincee one transaction in last month is grater than selected salary&quot; &#x27;
                                                                                                                    end
                                                                                                                    if &#x27;
                                                                                                                    else  &#x27;                                        ReassignFlag=1 &#x27;                                        Status=&quot;More than one transaction is grater then 65% of selected salary&quot; &#x27;
                                                                                                                        end
                                                                                                                        if &#x27;
                                                                                                                        end if     &#x27;
                                                                                                                    next test=3.1                             Salary=minimum
                                                                                                                    end
                                                                                                                    if
                                                                                                                else                         min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                                                                                    For k As Integer = 0 To 2                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                                                                                        If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                                                                            min=T2.Rows(k)(&quot;Sal&quot;)                                 minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                                                                                        End If
                                                                                                                        end
                                                                                                                        if
                                                                                                                    next                         Avg= Sum / 3
                                                                                                                    If Avg&lt;1.2*min Then
                                                                                                                        test=3 &#x27;
                                                                                                                    End If
                                                                                                                    For r As Integer = 0 To LL.Rows.Count-1 &#x27;                                if(LL.Rows(r)(&quot;Sal&quot;)&gt;=Avg*0.65) then &#x27;
                                                                                                                        If LLcheck=0 Then
                                                                                                                            &#x27;                                        LLcheck=1 &#x27;                                        if(Math.Floor(LL.Rows(r)(&quot;Sal&quot;))&lt;=Avg) then &#x27;                                            Salary=LL.Rows(r)(&quot;Amount&quot;) &#x27;
                                                                                                                        End If
                                                                                                                    else if(LL.Rows(r)(&quot;Sal&quot;)&lt;=Avg*1.2) then &#x27;                                            Salary=LL.Rows(r)(&quot;Amount&quot;) &#x27;
                                                                                                                    else &#x27;                                            ReassignFlag=1 &#x27;                                            Status=&quot;Salary not identified sincee one transaction in last month is grater than selected salary&quot; &#x27;
                                                                                                                        end
                                                                                                                        if &#x27;
                                                                                                                        else  &#x27;                                        ReassignFlag=1 &#x27;                                        Status=&quot;More than one transaction is grater then 65% of selected salary&quot; &#x27;
                                                                                                                            end
                                                                                                                            if &#x27;
                                                                                                                            end if     &#x27;
                                                                                                                        next                             Salary=minimum                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                                                                                    else &#x27;
                                                                                                                        For r As Integer = 0 To LL.Rows.Count-1 &#x27;                                if(LL.Rows(r)(&quot;Sal&quot;)&gt;=min*0.65) then &#x27;
                                                                                                                            If LLcheck=0 Then
                                                                                                                                &#x27;                                        LLcheck=1 &#x27;                                        if(Math.Floor(LL.Rows(r)(&quot;Sal&quot;))&lt;=min) then &#x27;                                            Salary=LL.Rows(r)(&quot;Amount&quot;) &#x27;
                                                                                                                            End If
                                                                                                                        else if(LL.Rows(r)(&quot;Sal&quot;)&lt;=min*1.2) then &#x27;                                            Salary=LL.Rows(r)(&quot;Amount&quot;) &#x27;
                                                                                                                        else &#x27;                                            ReassignFlag=1 &#x27;                                            Status=&quot;Salary not identified since one transaction in last month is grater than selected salary&quot; &#x27;
                                                                                                                            end
                                                                                                                            if &#x27;
                                                                                                                            else  &#x27;                                        ReassignFlag=1 &#x27;                                        Status=&quot;More than one transaction is grater then 65% of selected salary&quot; &#x27;
                                                                                                                                end
                                                                                                                                if &#x27;
                                                                                                                                end if     &#x27;
                                                                                                                            next test=3.1                             Salary=minimum
                                                                                                                            end
                                                                                                                            if
                                                                                                                        end if
                                                                                                                        end
                                                                                                                        if &#x27;===============================================================BB=============================================END
                                                                                                                        else
                                                                                                                            Dim Count4 as integer=0
                                                                                                                            Dim Prev as integer =0
                                                                                                                            Dim Base as Decimal=0
                                                                                                                            for r as integer=0 to A1.Rows.Count-1
                                                                                                                                For j as integer=0 to T3.Rows.Count-1
                                                                                                                                    if A1.Rows(r)(&quot;Amount&quot;)=T3.Rows(j)(&quot;Sal&quot;)                             Count4=Count4+1
                                                                                                                                        end
                                                                                                                                        if
                                                                                                                                    next
                                                                                                                                    if prev&lt;Count4                         BasicSalary=A1.Rows(r)(&quot;Amount&quot;)                         prev=Count4
                                                                                                                                        end
                                                                                                                                        if                     Count4=0
                                                                                                                                        next                                 x=T.NewRow
                                                                                                                                        For r As Integer = 0 To Buffer.Rows.Count-1         &#x27;
                                                                                                                                            If (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3) Then
                                                                                                                                                if((SD1m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))OR (SD2m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD3m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD3p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD4m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD4p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))) then                         x= Buffer.Rows(r)                         T.ImportRow(x)                         x=T.NewRow                         Tcounter=Tcounter+1
                                                                                                                                            End If
                                                                                                                                        end if
                                                                                                                                    next
                                                                                                                                    if Tcounter&lt;2                     ReassignFlag=1                     Status=&quot;Total number of feasible transaction is less than 2 after filtering with +/-5 salary date in AA-BB-Gov III&quot;
                                                                                                                                    else                     BSp=BasicSalary+(BasicSalary*20/100)                     BSm=BasicSalary-(BasicSalary*20/100)                     x=T2.NewRow
                                                                                                                                        for r as integer=0 to T.Rows.count-1                         if(T.Rows(r)(&quot;Sal&quot;)&gt;=BSm AND T.Rows(r)(&quot;Sal&quot;)&lt;=BSp)                             x= T.Rows(r)                             T2.ImportRow(x)                             x=T2.NewRow                             T2counter=T2counter+1
                                                                                                                                            end
                                                                                                                                            if
                                                                                                                                        next
                                                                                                                                        If T2counter&lt;2 Then
                                                                                                                                            ReassignFlag=1                         Status=&quot;Total number of feasible transaction is less than 2 after filtering BSm&lt;= SAL &lt;=BSp in AA-BB-Gov IV&quot;
                                                                                                                                        End If
                                                                                                                                    else
                                                                                                                                        if T2counter=2                         min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                                                                                                            For k As Integer = 0 To 1                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                                                                                                                If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                                                                                                    min=T2.Rows(k)(&quot;Sal&quot;)                                 minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                                                                                                                End If
                                                                                                                                                end
                                                                                                                                                if
                                                                                                                                            next                         Avg= Sum / 2
                                                                                                                                            If Avg&lt;1.2*min Then
                                                                                                                                                test=4 &#x27;
                                                                                                                                            End If
                                                                                                                                            For r As Integer = 0 To LL.Rows.Count-1 &#x27;                                if(LL.Rows(r)(&quot;Sal&quot;)&gt;=Avg*0.65) then &#x27;
                                                                                                                                                If LLcheck=0 Then
                                                                                                                                                    &#x27;                                        LLcheck=1 &#x27;                                        if(Math.Floor(LL.Rows(r)(&quot;Sal&quot;))&lt;=Avg) then &#x27;                                            Salary=LL.Rows(r)(&quot;Amount&quot;) &#x27;
                                                                                                                                                End If
                                                                                                                                            else if(LL.Rows(r)(&quot;Sal&quot;)&lt;=Avg*1.2) then &#x27;                                            Salary=LL.Rows(r)(&quot;Amount&quot;) &#x27;
                                                                                                                                            else &#x27;                                            ReassignFlag=1 &#x27;                                            Status=&quot;Salary not identified sincee one transaction in last month is grater than selected salary&quot; &#x27;
                                                                                                                                                end
                                                                                                                                                if &#x27;
                                                                                                                                                else  &#x27;                                        ReassignFlag=1 &#x27;                                        Status=&quot;More than one transaction is grater then 65% of selected salary&quot; &#x27;
                                                                                                                                                    end
                                                                                                                                                    if &#x27;
                                                                                                                                                    end if     &#x27;
                                                                                                                                                next                             Salary=minimum                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                                                                                                            else &#x27;
                                                                                                                                                For r As Integer = 0 To LL.Rows.Count-1 &#x27;                                if(LL.Rows(r)(&quot;Sal&quot;)&gt;=min*0.65) then &#x27;
                                                                                                                                                    If LLcheck=0 Then
                                                                                                                                                        &#x27;                                        LLcheck=1 &#x27;                                        if(Math.Floor(LL.Rows(r)(&quot;Sal&quot;))&lt;=min) then &#x27;                                            Salary=LL.Rows(r)(&quot;Amount&quot;) &#x27;
                                                                                                                                                    End If
                                                                                                                                                else if(LL.Rows(r)(&quot;Sal&quot;)&lt;=min*1.2) then &#x27;                                            Salary=LL.Rows(r)(&quot;Amount&quot;) &#x27;
                                                                                                                                                else &#x27;                                            ReassignFlag=1 &#x27;                                            Status=&quot;Salary not identified sincee one transaction in last month is grater than selected salary&quot; &#x27;
                                                                                                                                                    end
                                                                                                                                                    if &#x27;
                                                                                                                                                    else  &#x27;                                        ReassignFlag=1 &#x27;                                        Status=&quot;More than one transaction is grater then 65% of selected salary&quot; &#x27;
                                                                                                                                                        end
                                                                                                                                                        if &#x27;
                                                                                                                                                        end if     &#x27;
                                                                                                                                                    next test=4.1                             Salary=minimum
                                                                                                                                                    end
                                                                                                                                                    if
                                                                                                                                                else                          min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                                                                                                                    For k As Integer = 0 To 2                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                                                                                                                        If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                                                                                                            min=T2.Rows(k)(&quot;Sal&quot;)                                 minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                                                                                                                        End If
                                                                                                                                                        end
                                                                                                                                                        if
                                                                                                                                                    next                         Avg= Sum / 3
                                                                                                                                                    If Avg&lt;1.2*min Then
                                                                                                                                                        test=4 &#x27;
                                                                                                                                                    End If
                                                                                                                                                    For r As Integer = 0 To LL.Rows.Count-1 &#x27;                                if(LL.Rows(r)(&quot;Sal&quot;)&gt;=Avg*0.65) then &#x27;
                                                                                                                                                        If LLcheck=0 Then
                                                                                                                                                            &#x27;                                        LLcheck=1 &#x27;                                        if(Math.Floor(LL.Rows(r)(&quot;Sal&quot;))&lt;=Avg) then &#x27;                                            Salary=LL.Rows(r)(&quot;Amount&quot;) &#x27;
                                                                                                                                                        End If
                                                                                                                                                    else if(LL.Rows(r)(&quot;Sal&quot;)&lt;=Avg*1.2) then &#x27;                                            Salary=LL.Rows(r)(&quot;Amount&quot;) &#x27;
                                                                                                                                                    else &#x27;                                            ReassignFlag=1 &#x27;                                            Status=&quot;Salary not identified sincee one transaction in last month is grater than selected salary&quot; &#x27;
                                                                                                                                                        end
                                                                                                                                                        if &#x27;
                                                                                                                                                        else  &#x27;                                        ReassignFlag=1 &#x27;                                        Status=&quot;More than one transaction is grater then 65% of selected salary&quot; &#x27;
                                                                                                                                                            end
                                                                                                                                                            if &#x27;
                                                                                                                                                            end if     &#x27;
                                                                                                                                                        next                             Salary=minimum                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                                                                                                                    else &#x27;
                                                                                                                                                        For r As Integer = 0 To LL.Rows.Count-1 &#x27;                                if(LL.Rows(r)(&quot;Sal&quot;)&gt;=min*0.65) then &#x27;
                                                                                                                                                            If LLcheck=0 Then
                                                                                                                                                                &#x27;                                        LLcheck=1 &#x27;                                        if(Math.Floor(LL.Rows(r)(&quot;Sal&quot;))&lt;=min) then &#x27;                                            Salary=LL.Rows(r)(&quot;Amount&quot;) &#x27;
                                                                                                                                                            End If
                                                                                                                                                        else if(LL.Rows(r)(&quot;Sal&quot;)&lt;=min*1.2) then &#x27;                                            Salary=LL.Rows(r)(&quot;Amount&quot;) &#x27;
                                                                                                                                                        else &#x27;                                            ReassignFlag=1 &#x27;                                            Status=&quot;Salary not identified sincee one transaction in last month is grater than selected salary&quot; &#x27;
                                                                                                                                                            end
                                                                                                                                                            if &#x27;
                                                                                                                                                            else  &#x27;                                        ReassignFlag=1 &#x27;                                        Status=&quot;More than one transaction is grater then 65% of selected salary&quot; &#x27;
                                                                                                                                                                end
                                                                                                                                                                if &#x27;
                                                                                                                                                                end if     &#x27;
                                                                                                                                                            next test=4.1                             Salary=minimum
                                                                                                                                                            end
                                                                                                                                                            if
                                                                                                                                                        end if
                                                                                                                                                        end
                                                                                                                                                        if
                                                                                                                                                        end
                                                                                                                                                        if
                                                                                                                                                        end
                                                                                                                                                        if
                                                                                                                                                        end
                                                                                                                                                        if &#x27;=============================================================AA===================================================    END
                                                                                                                                                        else              ReassignFlag=1             Status=&quot;No transaction available in 2nd last month&quot;
                                                                                                                                                            end
                                                                                                                                                            if
                                                                                                                                                        else              Status=&quot;More than one transaction in last month&quot;             ReassignFlag=1
                                                                                                                                                            end
                                                                                                                                                            if
                                                                                                                                                        else             Status=&quot;No transaction in +/- 5 of last salary date&quot;             ReassignFlag=1
                                                                                                                                                            end
                                                                                                                                                            if
                                                                                                                                                            end
                                                                                                                                                            if
                                                                                                                                                        else      Status=&quot;Total number of feasible transaction is less than 3&quot;     ReassignFlag=1
                                                                                                                                                            end
                                                                                                                                                            if D0=D1 A0=A1
                                                                                                                                                            catch e as Exception         er=e.ToString         ReassignFlag=1         Status=&quot;Code Error:&quot;+e.ToString
                                                                                                                                                                end
                                                                                                                                                                try"
                            data-title="UWCA_MRCC_CTF_V1.0 / Salary code / Salary Calculation(new)5">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>UWCA_MRCC_CTF_V1.0</td>
                <td>Salary code</td>
                <td>Salary Calculation(new)6</td>
                <td>visualbasic</td>
                <td>866</td>
                <!--<td style="font-family: monospace;">8326a36b5fdf3345501935d5c6c5f328bd8c3eed0d2f37d7f4019890e5c264d7</td>-->
                <td>—</td>
                <!--<td>try     Dim description as string     Dim x As DataRow = D1.NewRow     Dim Dflag as integer =0     Dim precount as integer =0     Dim Amount as integer =0     Dim Avg as Decimal=0     Dim Sum as integer =0     Dim skip as integer =0     Dim min as integer =0     Dim count as integer =0     Dim Av as...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="try
    Dim description as string
    Dim x As DataRow = D1.NewRow
    Dim Dflag as integer =0
    Dim precount as integer =0
    Dim Amount as integer =0
    Dim Avg as Decimal=0
    Dim Sum as integer =0
    Dim skip as integer =0
    Dim min as integer =0
    Dim count as integer =0
    Dim Av as integer =0
    Dim mi as integer =0
    Dim minim as string min=0 count=0 minim=&quot;&quot;
    if c1.Rows.Count&gt;2 then
        For r As Integer = 0 To c1.Rows.Count-1         description=c1.Rows(r)(&quot;Description&quot;)         Dflag=0
            for i as integer=0 To D1.Rows.Count-1
                If D1.Rows(i)(&quot;Description&quot;)=description Then
                    Dflag=1                 D1.Rows(i)(&quot;Count&quot;)=D1.Rows(i)(&quot;Count&quot;)+1
                End If
                end
                if
            next
            If Dflag=0 Then
                x(&quot;Description&quot;) = description             x(&quot;Count&quot;)=1             D1.Rows.Add(x)             x= D1.NewRow
            End If
            end
            if
        Next
        For r As Integer = 0 To D1.Rows.Count-1         description=D1.Rows(r)(&quot;Description&quot;)         CollOut=Nothing         CollOut=c1.Clone
            For Each parentRow As DataRow In c1.Select(&quot;Description=&#x27;&quot;+description+&quot;&#x27;&quot;)             x = CollOut.NewRow
                For Each c As DataColumn In x.Table.Columns                     x(c.ColumnName) = parentRow(c.ColumnName)
                Next             CollOut.Rows.Add(x)
            Next         count=CollOut.Rows.Count
            If count&gt;precount Then
                Buffer=Nothing             Buffer = CollOut.Clone             Buffer=CollOut             precount=count             ReassignFlag=0
            End If
        else
            if count = Precount             ReassignFlag=1             Status=&quot;Salary cannot be identified since there mode are equal&quot;
                end
                if
            next &#x27;+++++++++++++++++++++++++
            If Govt= False AND EF= False Then
                &#x27;+++++++++++++++++++++++++
            End If
            If Buffer.Rows.Count &gt;2 Then
                ReassignFlag=0
            End If
            if ReassignFlag=0             ReassignFlag=1
                For r As Integer = 0 To Buffer.Rows.Count-1
                    If Buffer.Rows(r)(&quot;Days&quot;)&lt;=TimePeriod Then
                        ReassignFlag=0
                    End If
                    exit
                    for
                    end
                    if
                next
                end
                if
                if ReassignFlag=0             Status=&quot;&quot;
                    For r As Integer = 0 To Buffer.Rows.Count-1                 Amount=Buffer.Rows(r)(&quot;Sal&quot;)                 Dflag=0
                        for i as integer=0 To A1.Rows.Count-1
                            If A1.Rows(i)(&quot;Amount&quot;)=Amount Then
                                Dflag=1                         A1.Rows(i)(&quot;Count&quot;)=A1.Rows(i)(&quot;Count&quot;)+1
                            End If
                            end
                            if
                        next
                        If Dflag=0 Then
                            x= A1.NewRow                     x(&quot;Amount&quot;) = Amount                     x(&quot;Count&quot;)=1                     x(&quot;Salary&quot;)=Buffer.Rows(r)(&quot;Amount&quot;)                     A1.Rows.Add(x)
                        End If
                        end
                        if
                    Next             min=Buffer.Rows(0)(&quot;Sal&quot;)+1
                    For k As Integer = 0 To 2                 Sum=Sum+Buffer.Rows(k)(&quot;Sal&quot;)
                        If min&gt;Buffer.Rows(k)(&quot;Sal&quot;) Then
                            min=Buffer.Rows(k)(&quot;Sal&quot;)                     minimum=Buffer.Rows(k)(&quot;Amount&quot;)
                        End If
                        end
                        if
                        if k=1                     Av=Sum/2                     mi=min                     minim=minimum
                            end
                            if
                        next             Avg= Sum / 3
                        If Avg&lt;1.2*min Then
                            test=1 Cop=A1                 Salary=minimum                 Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                        End If
                    else
                        If Av&lt;1.2*mi Then
                            minimum=minim                 Salary=minimum                 Other=Replace((Av-mi),&quot;.&quot;,&quot;,&quot;)
                        End If
                    else
                        For r As Integer = 0 To A1.Rows.Count-1
                            If (A1.Rows(r)(&quot;Count&quot;)*100/(Buffer.Rows.Count))&gt;60 Then
                                Salary=A1.Rows(r)(&quot;Salary&quot;)                         skip=1
                            End If
                            end
                            if
                        next
                        If skip=0 Then
                            &#x27;vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvPage2vvvvvvvvvvvvvvvvvvvvvvvvvvv
                        End If
                        if Govt=True then
                            Dim SD1p,SD1m,SD2p,SD2m,SD3p,SD3m as date
                            Dim Sflag as integer =0
                            Dim BasicSalary as Integer =0
                            Dim T as DataTable =Buffer.Clone
                            Dim T2 as DataTable=Buffer.Clone
                            Dim TX as DataTable=Buffer.Clone
                            Dim Tcounter as integer =0
                            Dim T2counter as integer =0
                            Dim BSp,BSm as Decimal                          Sum=0                         minimum=0                         Salary=0                         Other=0                         min=0                         SD1p=SD1.AddDays(5)                         SD1m=SD1.AddDays(-5)                         SD2p=SD2.AddDays(5)                         SD2m=SD2.AddDays(-5)                         SD3p=SD3.AddDays(5)                         SD3m=SD3.AddDays(-5)                 &#x27;        T=Buffer.Clone
                            For r As Integer = 0 To Buffer.Rows.Count-1 &#x27;
                                If (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3) Then
                                    if((SD1m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))OR (SD2m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD3m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD3p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))) then                                 x= Buffer.Rows(r)                                 TX.ImportRow(x)                                 x=TX.NewRow
                                End If
                            end if
                        next                         Buffer=TX
                        For r As Integer = 0 To Buffer.Rows.Count-1                 &#x27;
                            if (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1) then
                                If (SD1m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) Then
                                    Sflag=Sflag+1                                 BasicSalary=Buffer.Rows(r)(&quot;Sal&quot;)                                 &#x27;AM=BasicSalary
                                End If
                                end
                                if
                            Next                         &#x27;AM=BasicSalary
                            If Sflag=1 Then
                                x=T.NewRow
                            End If
                            For r As Integer = 0 To Buffer.Rows.Count-1                 &#x27;
                                If (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3) Then
                                    if((SD1m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))OR (SD2m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD3m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD3p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))) then                                     x= Buffer.Rows(r)                                     T.ImportRow(x)                                     x=T.NewRow                                     Tcounter=Tcounter+1
                                End If
                            end if
                        next
                        if Tcounter&lt;3                                 ReassignFlag=1                                 Status=&quot;Total number of feasible transaction is less than 3 after filtering with +/-5 salary date I&quot;
                        else                                 BSp=BasicSalary+(BasicSalary*20/100)                                 BSm=BasicSalary-(BasicSalary*20/100)                                 x=T2.NewRow
                            for r as integer=0 to T.Rows.count-1                                     if(T.Rows(r)(&quot;Sal&quot;)&gt;=BSm AND T.Rows(r)(&quot;Sal&quot;)&lt;=BSp)                                         x= T.Rows(r)                                         T2.ImportRow(x)                                         x=T2.NewRow                                         T2counter=T2counter+1
                                end
                                if
                            next
                            If T2counter&lt;2 Then
                                ReassignFlag=1                                     Status=&quot;Total number of feasible transaction is less than 2 after filtering BSm &lt;= Salary &lt;=BSp&quot;
                            End If
                        else
                            if T2counter=2                                     min=T2.Rows(0)(&quot;Sal&quot;)+1
                                For k As Integer = 0 To 1                                         Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                    If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                        min=T2.Rows(k)(&quot;Sal&quot;)                                             minimum=T2.Rows(k)(&quot;Amount&quot;)
                                    End If
                                    end
                                    if
                                next                                     Avg= Sum / 2
                                If Avg&lt;1.2*min Then
                                    test=2                                         Salary=minimum                                         Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                End If
                            else                                         Salary=minimum                                         Other=0
                                end
                                if
                            else                                     min=T2.Rows(0)(&quot;Sal&quot;)+1
                                For k As Integer = 0 To 2                                         Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                    If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                        min=T2.Rows(k)(&quot;Sal&quot;)                                             minimum=T2.Rows(k)(&quot;Amount&quot;)
                                    End If
                                    end
                                    if
                                next                                     Avg= Sum / 3
                                If Avg&lt;1.2*min Then
                                    test=2                                         Salary=minimum                                         Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                End If
                            else                                         Salary=minimum                                         Other=0
                                end
                                if
                            end if
                            end
                            if                     &#x27;    test=T                     &#x27;    testT=Tcounter
                            else &#x27;=============================================================AA===================================================BEGIN
                                Dim T3 as DataTable=Buffer.Clone
                                Dim Tcounter2 as integer=0
                                for r as integer =0 to Buffer.Rows.Count-1                                 if(Buffer.Rows(r)(&quot;Sal&quot;)&gt;=LastApproved) then                                     x=T3.NewRow                                     x=Buffer.Rows(r)                                     T3.ImportRow(x)                                     Tcounter2=Tcounter2+1                                     BasicSalary=Buffer.Rows(r)(&quot;Sal&quot;)
                                    end
                                    if
                                next                             &#x27;    Buffer=Nothing                         &#x27;    Buffer=T3 Cop=Buffer &#x27;===============================================================BB=============================================BEGIN                             if(Tcounter2=1)                                 x=T.NewRow
                                For r As Integer = 0 To Buffer.Rows.Count-1                 &#x27;
                                    If (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3) Then
                                        if((SD1m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))OR (SD2m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD3m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD3p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))) then                                         x= Buffer.Rows(r)                                         T.ImportRow(x)                                         x=T.NewRow                                         Tcounter=Tcounter+1
                                    End If
                                end if
                            next
                            if Tcounter&lt;3                                     ReassignFlag=1                                     Status=&quot;Total number of feasible transaction is less than 3 after filtering with +/-5 salary date in AA-BB-Gov I&quot;
                            else                                     BSp=BasicSalary+(BasicSalary*20/100)                                     BSm=BasicSalary-(BasicSalary*20/100)                                     x=T2.NewRow
                                for r as integer=0 to T.Rows.count-1                                         if(T.Rows(r)(&quot;Sal&quot;)&gt;=BSm AND T.Rows(r)(&quot;Sal&quot;)&lt;=BSp)                                             x= T.Rows(r)                                             T2.ImportRow(x)                                             x=T2.NewRow                                             T2counter=T2counter+1
                                    end
                                    if
                                next
                                If T2counter&lt;2 Then
                                    ReassignFlag=1                                         Status=&quot;Total number of feasible transaction is less than 2 after filtering with +/-5 salary date in AA-BB-Gov II&quot;
                                End If
                            else
                                if T2counter=2                                         min=T2.Rows(0)(&quot;Sal&quot;)+1
                                    For k As Integer = 0 To 1                                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                        If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                            min=T2.Rows(k)(&quot;Sal&quot;)                                                 minimum=T2.Rows(k)(&quot;Amount&quot;)
                                        End If
                                        end
                                        if
                                    next                                         Avg= Sum / 2
                                    If Avg&lt;1.2*min Then
                                        test=3                                             Salary=minimum                                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                    End If
                                else                                             Salary=minimum                                             Other=0
                                    end
                                    if
                                else                                         min=T2.Rows(0)(&quot;Sal&quot;)+1
                                    For k As Integer = 0 To 2                                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                        If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                            min=T2.Rows(k)(&quot;Sal&quot;)                                                 minimum=T2.Rows(k)(&quot;Amount&quot;)
                                        End If
                                        end
                                        if
                                    next                                         Avg= Sum / 3
                                    If Avg&lt;1.2*min Then
                                        test=3                                             Salary=minimum                                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                    End If
                                else                                             Salary=minimum                                             Other=0
                                    end
                                    if
                                end if
                                end
                                if &#x27;===============================================================BB=============================================END
                                else
                                    Dim Count4 as integer=0
                                    Dim Prev as integer =0
                                    Dim Base as Decimal=0
                                    for r as integer=0 to A1.Rows.Count-1
                                        For j as integer=0 to T3.Rows.Count-1
                                            if A1.Rows(r)(&quot;Amount&quot;)=T3.Rows(j)(&quot;Sal&quot;)                                             Count4=Count4+1
                                                end
                                                if
                                            next
                                            if prev&lt;Count4                                         BasicSalary=A1.Rows(r)(&quot;Amount&quot;)                                         prev=Count4
                                                end
                                                if                                     Count4=0
                                                next                                                 x=T.NewRow
                                                For r As Integer = 0 To Buffer.Rows.Count-1                 &#x27;
                                                    If (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3) Then
                                                        if((SD1m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))OR (SD2m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD3m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD3p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))) then                                         x= Buffer.Rows(r)                                         T.ImportRow(x)                                         x=T.NewRow                                         Tcounter=Tcounter+1
                                                    End If
                                                end if
                                            next
                                            if Tcounter&lt;3                                     ReassignFlag=1                                     Status=&quot;Total number of feasible transaction is less than 3 after filtering with +/-5 salary date in AA-BB-Gov III&quot;
                                            else                                     BSp=BasicSalary+(BasicSalary*20/100)                                     BSm=BasicSalary-(BasicSalary*20/100)                                     x=T2.NewRow
                                                for r as integer=0 to T.Rows.count-1                                         if(T.Rows(r)(&quot;Sal&quot;)&gt;=BSm AND T.Rows(r)(&quot;Sal&quot;)&lt;=BSp)                                             x= T.Rows(r)                                             T2.ImportRow(x)                                             x=T2.NewRow                                             T2counter=T2counter+1
                                                    end
                                                    if
                                                next
                                                If T2counter&lt;2 Then
                                                    ReassignFlag=1                                         Status=&quot;Total number of feasible transaction is less than 2 after filtering BSm&lt;= SAL &lt;=BSp in AA-BB-Gov IV&quot;
                                                End If
                                            else
                                                if T2counter=2                                         min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                    For k As Integer = 0 To 1                                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                        If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                            min=T2.Rows(k)(&quot;Sal&quot;)                                                 minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                        End If
                                                        end
                                                        if
                                                    next                                         Avg= Sum / 2
                                                    If Avg&lt;1.2*min Then
                                                        test=4                                             Salary=minimum                                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                    End If
                                                else                                             Salary=minimum                                             Other=0
                                                    end
                                                    if
                                                else                                          min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                    For k As Integer = 0 To 2                                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                        If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                            min=T2.Rows(k)(&quot;Sal&quot;)                                                 minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                        End If
                                                        end
                                                        if
                                                    next                                         Avg= Sum / 3
                                                    If Avg&lt;1.2*min Then
                                                        test=4                                             Salary=minimum                                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                    End If
                                                else                                             Salary=minimum                                             Other=0
                                                    end
                                                    if
                                                end if
                                                end
                                                if
                                                end
                                                if  &#x27;=============================================================AA===================================================    END
                                                    end
                                                    if
                                                else &#x27;==========================================================================B===================================BEGIN
                                                    Dim Sflag as integer =0
                                                    Dim BasicSalary as Integer =0
                                                    Dim T as DataTable =Buffer.Clone
                                                    Dim T2 as DataTable=Buffer.Clone
                                                    Dim Tcounter as integer =0
                                                    Dim T2counter as integer =0
                                                    Dim BSp,BSm as Decimal
                                                    Dim BaseDays as Decimal =0
                                                    Dim Dayz as decimal=0                         Sum=0                         minimum=0                         Salary=0                         Sflag=0                         Other=0                         min=0
                                                    For r As Integer = 0 To Buffer.Rows.Count-1
                                                        If (Buffer.Rows(r)(&quot;Days&quot;)&lt;=TimePeriod) Then
                                                            Sflag=Sflag+1                                 BasicSalary=Buffer.Rows(r)(&quot;Sal&quot;)                                 x=T.NewRow                                 x= Buffer.Rows(r)                                 T.ImportRow(x)                                 Tcounter=1                                 BaseDays=Buffer.Rows(r)(&quot;Days&quot;)
                                                        End If
                                                        end
                                                        if
                                                    Next &#x27;=======================================================================================BB=================================================BEGIN
                                                    If Sflag=1 Then
                                                        x=T.NewRow
                                                    End If
                                                    For r As Integer = 0 To Buffer.Rows.Count-1                                     Dayz=Buffer.Rows(r)(&quot;Days&quot;)                                 Dayz=Dayz-BaseDays
                                                        If ((Dayz&gt;=25 AND Dayz&lt;=35) OR (Dayz&gt;=55 AND Dayz&lt;=65) ) Then
                                                            x= Buffer.Rows(r)                                     T.ImportRow(x)                                     x=T.NewRow                                     Tcounter=Tcounter+1
                                                        End If
                                                    end if
                                                next                             &#x27;testT=Tcounter /checked
                                                if Tcounter&lt;3                                 ReassignFlag=1                                 Status=&quot;Total number of feasible transaction is less than 3 after filtering with 25-35 and 55 to 65 in AA-BB-nonGov II&quot;
                                                else                                 BSp=BasicSalary+(BasicSalary*20/100)                                 BSm=BasicSalary-(BasicSalary*20/100)                                 x=T2.NewRow
                                                    for r as integer=0 to T.Rows.count-1                                     if(T.Rows(r)(&quot;Sal&quot;)&gt;=BSm AND T.Rows(r)(&quot;Sal&quot;)&lt;=BSp)                                         x= T.Rows(r)                                         T2.ImportRow(x)                                         x=T2.NewRow                                         T2counter=T2counter+1
                                                        end
                                                        if
                                                    next
                                                    If T2counter&lt;2 Then
                                                        ReassignFlag=1                                     Status=&quot;Total number of feasible transaction is less than 2 after filtering BSm&lt;=SAL&lt;=BSp BB-non Gov II&quot;
                                                    End If
                                                else
                                                    if T2counter=2
                                                        For k As Integer = 0 To 1                                         Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                            If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                min=T2.Rows(k)(&quot;Sal&quot;)                                             minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                            End If
                                                            end
                                                            if
                                                        next                                      Avg= Sum / 2
                                                        If Avg&lt;1.2*min Then
                                                            Salary=minimum                                         Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                        End If
                                                    else                                          Salary=minimum                                         Other=0
                                                        end
                                                        if
                                                    else                                       min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                        For k As Integer = 0 To 2                                         Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                            If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                min=T2.Rows(k)(&quot;Sal&quot;)                                             minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                            End If
                                                            end
                                                            if
                                                        next                                      Avg= Sum / 3
                                                        If Avg&lt;1.2*min Then
                                                            Salary=minimum                                         Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                        End If
                                                    else                                          Salary=minimum                                         Other=0
                                                        end
                                                        if
                                                    end if
                                                    end
                                                    if                         &#x27;test=T2                         &#x27;testT=Tcounter
                                                    else &#x27;++++++++++++++++++++++AA+++++++++ &#x27;=============================================================AA===================================================BEGIN
                                                        Dim T3 as DataTable=Buffer.Clone
                                                        Dim Tcounter2 as integer=0
                                                        for r as integer =0 to Buffer.Rows.Count-1                                 if(Buffer.Rows(r)(&quot;Sal&quot;)&gt;=LastApproved) then                                     x=T3.NewRow                                     x=Buffer.Rows(r)                                     T3.ImportRow(x)                                     Tcounter2=Tcounter2+1                                     BasicSalary=Buffer.Rows(r)(&quot;Sal&quot;)
                                                            end
                                                            if
                                                        next                                 Buffer=Nothing                             Buffer=T3 &#x27;===============================================================BB=============================================BEGIN                             if(Tcounter2=1)                                 x=T.NewRow
                                                        For r As Integer = 0 To Buffer.Rows.Count-1                                         Dayz=Buffer.Rows(r)(&quot;Days&quot;)                                     Dayz=Dayz-BaseDays
                                                            If ((Dayz&gt;=25 AND Dayz&lt;=35) OR (Dayz&gt;=55 AND Dayz&lt;=65) ) Then
                                                                x= Buffer.Rows(r)                                         T.ImportRow(x)                                         x=T.NewRow                                         Tcounter=Tcounter+1
                                                            End If
                                                        end if
                                                    next                                 &#x27;testT=Tcounter /checked
                                                    if Tcounter&lt;3                                     ReassignFlag=1                                     Status=&quot;Total number of feasible transaction is less than 3 after filtering with 25-35 and 55 to 65 in AA-BB-nonGov III&quot;
                                                    else                                     BSp=BasicSalary+(BasicSalary*20/100)                                     BSm=BasicSalary-(BasicSalary*20/100)                                     x=T2.NewRow
                                                        for r as integer=0 to T.Rows.count-1                                         if(T.Rows(r)(&quot;Sal&quot;)&gt;=BSm AND T.Rows(r)(&quot;Sal&quot;)&lt;=BSp)                                             x= T.Rows(r)                                             T2.ImportRow(x)                                             x=T2.NewRow                                             T2counter=T2counter+1
                                                            end
                                                            if
                                                        next
                                                        If T2counter&lt;2 Then
                                                            ReassignFlag=1                                         Status=&quot;Total number of feasible transaction is less than 2 after filtering BSm&lt;SAL&lt;BSp in AA-BB-nonGov IV&quot;
                                                        End If
                                                    else
                                                        if T2counter=2                                         min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                            For k As Integer = 0 To 1                                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                                If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                    min=T2.Rows(k)(&quot;Sal&quot;)                                                 minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                                End If
                                                                end
                                                                if
                                                            next                                          Avg= Sum / 2
                                                            If Avg&lt;1.2*min Then
                                                                Salary=minimum                                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                            End If
                                                        else                                              Salary=minimum                                             Other=0
                                                            end
                                                            if
                                                        else                                         min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                            For k As Integer = 0 To 2                                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                                If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                    min=T2.Rows(k)(&quot;Sal&quot;)                                                 minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                                End If
                                                                end
                                                                if
                                                            next                                          Avg= Sum / 3
                                                            If Avg&lt;1.2*min Then
                                                                Salary=minimum                                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                            End If
                                                        else                                              Salary=minimum                                             Other=0
                                                            end
                                                            if
                                                        end if
                                                        end
                                                        if  &#x27;===============================================================BB=============================================END
                                                        else
                                                            Dim Count4 as integer=0
                                                            Dim Prev as integer =0
                                                            Dim Base as Decimal=0
                                                            for r as integer=0 to A1.Rows.Count-1
                                                                For j as integer=0 to T3.Rows.Count-1
                                                                    if A1.Rows(r)(&quot;Amount&quot;)=T3.Rows(j)(&quot;Sal&quot;)                                             Count4=Count4+1
                                                                        end
                                                                        if
                                                                    next
                                                                    if prev&lt;Count4                                         BasicSalary=A1.Rows(r)(&quot;Amount&quot;)
                                                                        end
                                                                        if
                                                                    next &#x27;============================================================BB=============================================BEGIN                                             x=T.NewRow
                                                                    For r As Integer = 0 To Buffer.Rows.Count-1                                         Dayz=Buffer.Rows(r)(&quot;Days&quot;)                                     Dayz=Dayz-BaseDays
                                                                        If ((Dayz&gt;=25 AND Dayz&lt;=35) OR (Dayz&gt;=55 AND Dayz&lt;=65) ) Then
                                                                            x= Buffer.Rows(r)                                         T.ImportRow(x)                                         x=T.NewRow                                         Tcounter=Tcounter+1
                                                                        End If
                                                                    end if
                                                                next                                 &#x27;testT=Tcounter /checked
                                                                if Tcounter&lt;3                                     ReassignFlag=1                                     Status=&quot;Total number of feasible transaction is less than 3 after filtering 25-35 and 55-65 in AA-BB-nonGov V&quot;
                                                                else                                     BSp=BasicSalary+(BasicSalary*20/100)                                     BSm=BasicSalary-(BasicSalary*20/100)                                     x=T2.NewRow
                                                                    for r as integer=0 to T.Rows.count-1                                         if(T.Rows(r)(&quot;Sal&quot;)&gt;=BSm AND T.Rows(r)(&quot;Sal&quot;)&lt;=BSp)                                             x= T.Rows(r)                                             T2.ImportRow(x)                                             x=T2.NewRow                                             T2counter=T2counter+1
                                                                        end
                                                                        if
                                                                    next
                                                                    If T2counter&lt;2 Then
                                                                        ReassignFlag=1                                         Status=&quot;Total number of feasible transaction is less than 2 after filtering BSp&lt;=SAL&lt;=BSp in AA-BB-nonGov VI&quot;
                                                                    End If
                                                                else
                                                                    if T2counter=2                                         min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                                        For k As Integer = 0 To 1                                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                                            If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                                min=T2.Rows(k)(&quot;Sal&quot;)                                                 minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                                            End If
                                                                            end
                                                                            if
                                                                        next                                          Avg= Sum / 2
                                                                        If Avg&lt;1.2*min Then
                                                                            Salary=minimum                                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                                        End If
                                                                    else                                              Salary=minimum                                             Other=0
                                                                        end
                                                                        if
                                                                    else                                          min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                                        For k As Integer = 0 To 2                                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                                            If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                                min=T2.Rows(k)(&quot;Sal&quot;)                                                 minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                                            End If
                                                                            end
                                                                            if
                                                                        next                                          Avg= Sum / 3
                                                                        If Avg&lt;1.2*min Then
                                                                            Salary=minimum                                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                                        End If
                                                                    else                                              Salary=minimum                                             Other=0
                                                                        end
                                                                        if
                                                                    end if
                                                                    end
                                                                    if &#x27;===========================================================BB======================================================END
                                                                        end
                                                                        if &#x27;=============================================================AA===================================================    END
                                                                            end
                                                                            if &#x27;==============================================================BB============================================END                      &#x27;==============================================================B=============================================END
                                                                                end
                                                                                if &#x27;^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^Page2^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                                                                    end
                                                                                    if
                                                                                    end
                                                                                    if
                                                                                else             Status=&quot;Salary cannot be identified since there is no transaction in the past &quot;+TimePeriod.ToString+&quot; days&quot;             ReassignFlag=1
                                                                                    end
                                                                                    if
                                                                                else         ReassignFlag=1         Status=&quot;Total number of feasible transaction is less than 3&quot;
                                                                                    end
                                                                                    if
                                                                                else
                                                                                    Dim SD1p,SD1m,SD2p,SD2m,SD3p,SD3m,SD4p,SD4m as date
                                                                                    Dim Sflag as integer =0
                                                                                    Dim Lflag as integer =0
                                                                                    Dim LLcheck as integer =0
                                                                                    Dim BasicSalary as Integer =0
                                                                                    Dim T as DataTable =Buffer.Clone
                                                                                    Dim T2 as DataTable=Buffer.Clone
                                                                                    Dim TX as DataTable=Buffer.Clone
                                                                                    Dim LL as DataTable=Buffer.Clone
                                                                                    Dim Tcounter as integer =0
                                                                                    Dim T2counter as integer =0
                                                                                    Dim BSp,BSm as Decimal          Sum=0         minimum=0         Salary=0         Other=0         min=0         SD1p=SD1.AddDays(5)         SD1m=SD1.AddDays(-5)         SD2p=SD2.AddDays(5)         SD2m=SD2.AddDays(-5)         SD3p=SD3.AddDays(5)         SD3m=SD3.AddDays(-5)         SD4p=SD4.AddDays(5)         SD4m=SD4.AddDays(-5)         &#x27;        T=Buffer.Clone
                                                                                    For r As Integer = 0 To Buffer.Rows.Count-1         &#x27;
                                                                                        If (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3) Then
                                                                                            if((SD1m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))OR (SD2m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD3m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD3p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD4m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD4p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))) then                 x= Buffer.Rows(r)                 TX.ImportRow(x)                 x=TX.NewRow
                                                                                        End If
                                                                                    end if
                                                                                next         Buffer=TX
                                                                                For r As Integer = 0 To Buffer.Rows.Count-1         &#x27;
                                                                                    If (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3) Then
                                                                                        if((SD1m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))) then                 x= Buffer.Rows(r)                 LL.ImportRow(x)                 x=LL.NewRow                 Lflag=Lflag+1
                                                                                    End If
                                                                                end if
                                                                            next &#x27;+++++++++++++++++++++++++++
                                                                            If Lflag&gt;0 Then
                                                                                &#x27;+++++++++++++++++++++++++++
                                                                            End If
                                                                            For r As Integer = 0 To Buffer.Rows.Count-1         &#x27;
                                                                                if (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1) then
                                                                                    If (SD2m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) Then
                                                                                        Sflag=Sflag+1                 BasicSalary=Buffer.Rows(r)(&quot;Sal&quot;)                 &#x27;AM=BasicSalary
                                                                                    End If
                                                                                    end
                                                                                    if
                                                                                Next         &#x27;AM=BasicSalary
                                                                                If Sflag=1 Then
                                                                                    x=T.NewRow
                                                                                End If
                                                                                For r As Integer = 0 To Buffer.Rows.Count-1         &#x27;
                                                                                    If (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3) Then
                                                                                        if((SD2m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD3m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD3p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD4m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD4p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))) then                     x= Buffer.Rows(r)                     T.ImportRow(x)                     x=T.NewRow                     Tcounter=Tcounter+1
                                                                                    End If
                                                                                end if
                                                                            next
                                                                            if Tcounter&lt;2                 ReassignFlag=1                 Status=&quot;Total number of feasible transaction is less than 2 after filtering with +/-5 salary date I&quot;
                                                                            else                 BSp=BasicSalary+(BasicSalary*20/100)                 BSm=BasicSalary-(BasicSalary*20/100)                 x=T2.NewRow
                                                                                for r as integer=0 to T.Rows.count-1                     if(T.Rows(r)(&quot;Sal&quot;)&gt;=BSm AND T.Rows(r)(&quot;Sal&quot;)&lt;=BSp)                         x= T.Rows(r)                         T2.ImportRow(x)                         x=T2.NewRow                         T2counter=T2counter+1
                                                                                    end
                                                                                    if
                                                                                next
                                                                                If T2counter&lt;2 Then
                                                                                    ReassignFlag=1                     Status=&quot;Total number of feasible transaction is less than 2 after filtering BSm &lt;= Salary &lt;=BSp&quot;
                                                                                End If
                                                                            else
                                                                                if T2counter=2                     min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                                                    For k As Integer = 0 To 1                         Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                                                        If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                                            min=T2.Rows(k)(&quot;Sal&quot;)                             minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                                                        End If
                                                                                        end
                                                                                        if
                                                                                    next                     Avg= Sum / 2
                                                                                    If Avg&lt;1.2*min Then
                                                                                        test=2
                                                                                    End If
                                                                                    For r As Integer = 0 To LL.Rows.Count-1                             if(LL.Rows(r)(&quot;Sal&quot;)&gt;=Avg*0.65) then
                                                                                        If LLcheck=0 Then
                                                                                            LLcheck=1                                     if(Math.Floor(LL.Rows(r)(&quot;Sal&quot;))&lt;=Avg) then                                         Salary=LL.Rows(r)(&quot;Amount&quot;)
                                                                                        End If
                                                                                    else if(LL.Rows(r)(&quot;Sal&quot;)&lt;=Avg*1.2) then                                         Salary=LL.Rows(r)(&quot;Amount&quot;)
                                                                                    else                                             ReassignFlag=1                                         Status=&quot;Salary not identified sincee one transaction in last month is grater than selected salary&quot;
                                                                                        end
                                                                                        if
                                                                                    else                                      ReassignFlag=1                                     Status=&quot;More than one transaction is grater then 65% of selected salary&quot;
                                                                                        end
                                                                                        if
                                                                                    end if
                                                                                next
                                                                            else
                                                                                For r As Integer = 0 To LL.Rows.Count-1                             if(LL.Rows(r)(&quot;Sal&quot;)&gt;=min*0.65) then
                                                                                    If LLcheck=0 Then
                                                                                        LLcheck=1                                     if(Math.Floor(LL.Rows(r)(&quot;Sal&quot;))&lt;=min) then                                         Salary=LL.Rows(r)(&quot;Amount&quot;)
                                                                                    End If
                                                                                else if(LL.Rows(r)(&quot;Sal&quot;)&lt;min*1.2) then                                         Salary=LL.Rows(r)(&quot;Amount&quot;)
                                                                                else                                         ReassignFlag=1                                         Status=&quot;Salary not identified sincee one transaction in last month is grater than selected salary&quot;
                                                                                    end
                                                                                    if
                                                                                else                                      ReassignFlag=1                                     Status=&quot;More than one transaction is grater then 65% of selected salary&quot;
                                                                                    end
                                                                                    if
                                                                                end if
                                                                            next
                                                                            end
                                                                            if
                                                                        else                     min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                                            For k As Integer = 0 To 2                         Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                                                If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                                    min=T2.Rows(k)(&quot;Sal&quot;)                             minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                                                End If
                                                                                end
                                                                                if
                                                                            next                     Avg= Sum / 3
                                                                            If Avg&lt;1.2*min Then
                                                                                test=2
                                                                            End If
                                                                            For r As Integer = 0 To LL.Rows.Count-1                             if(LL.Rows(r)(&quot;Sal&quot;)&gt;=Avg*0.65) then
                                                                                If LLcheck=0 Then
                                                                                    LLcheck=1                                     if(Math.Floor(LL.Rows(r)(&quot;Sal&quot;))&lt;=Avg) then                                         Salary=LL.Rows(r)(&quot;Amount&quot;)
                                                                                End If
                                                                            else if(LL.Rows(r)(&quot;Sal&quot;)&lt;Avg*1.2) then                                         Salary=LL.Rows(r)(&quot;Amount&quot;)
                                                                            else &#x27;er=Avg &#x27;Buffer=T2                                         ReassignFlag=1                                         Status=&quot;Salary not identified sincee one transaction in last month is grater than selected salary&quot;
                                                                                end
                                                                                if
                                                                            else                                      ReassignFlag=1                                     Status=&quot;More than one transaction is grater then 65% of selected salary&quot;
                                                                                end
                                                                                if
                                                                            end if
                                                                        next
                                                                    else
                                                                        For r As Integer = 0 To LL.Rows.Count-1                             if(LL.Rows(r)(&quot;Sal&quot;)&gt;=min*0.65) then
                                                                            If LLcheck=0 Then
                                                                                LLcheck=1                                     if(Math.Floor(LL.Rows(r)(&quot;Sal&quot;))&lt;=min) then                                         Salary=LL.Rows(r)(&quot;Amount&quot;)
                                                                            End If
                                                                        else if(LL.Rows(r)(&quot;Sal&quot;)&lt;=min*1.2) then                                         Salary=LL.Rows(r)(&quot;Amount&quot;)
                                                                        else                                         ReassignFlag=1                                         Status=&quot;Salary not identified sincee one transaction in last month is grater than selected salary&quot;
                                                                            end
                                                                            if
                                                                        else                                      ReassignFlag=1                                     Status=&quot;More than one transaction is grater then 65% of selected salary&quot;
                                                                            end
                                                                            if
                                                                        end if
                                                                    next
                                                                    end
                                                                    if
                                                                end if
                                                                end
                                                                if         &#x27;    test=T         &#x27;    testT=Tcounter
                                                                else &#x27;=============================================================AA===================================================BEGIN
                                                                    Dim T3 as DataTable=Buffer.Clone
                                                                    Dim Tcounter2 as integer=0
                                                                    for r as integer =0 to Buffer.Rows.Count-1                 if(Buffer.Rows(r)(&quot;Sal&quot;)&gt;=LastApproved) then                     x=T3.NewRow                     x=Buffer.Rows(r)                     T3.ImportRow(x)                     Tcounter2=Tcounter2+1                     BasicSalary=Buffer.Rows(r)(&quot;Sal&quot;)
                                                                        end
                                                                        if
                                                                    next             &#x27;    Buffer=Nothing         &#x27;    Buffer=T3             Cop=Buffer &#x27;===============================================================BB=============================================BEGIN             if(Tcounter2=1)                 x=T.NewRow
                                                                    For r As Integer = 0 To Buffer.Rows.Count-1         &#x27;
                                                                        If (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3) Then
                                                                            if((SD1m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))OR (SD2m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD3m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD3p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD4m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD4p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))) then                         x= Buffer.Rows(r)                         T.ImportRow(x)                         x=T.NewRow                         Tcounter=Tcounter+1
                                                                        End If
                                                                    end if
                                                                next
                                                                if Tcounter&lt;2                     ReassignFlag=1                     Status=&quot;Total number of feasible transaction is less than 2 after filtering with +/-5 salary date in AA-BB-Gov I&quot;
                                                                else                     BSp=BasicSalary+(BasicSalary*20/100)                     BSm=BasicSalary-(BasicSalary*20/100)                     x=T2.NewRow
                                                                    for r as integer=0 to T.Rows.count-1                         if(T.Rows(r)(&quot;Sal&quot;)&gt;=BSm AND T.Rows(r)(&quot;Sal&quot;)&lt;=BSp)                             x= T.Rows(r)                             T2.ImportRow(x)                             x=T2.NewRow                             T2counter=T2counter+1
                                                                        end
                                                                        if
                                                                    next
                                                                    If T2counter&lt;2 Then
                                                                        ReassignFlag=1                         Status=&quot;Total number of feasible transaction is less than 2 after filtering with +/-5 salary date in AA-BB-Gov II&quot;
                                                                    End If
                                                                else
                                                                    if T2counter=2                         min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                                        For k As Integer = 0 To 1                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                                            If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                                min=T2.Rows(k)(&quot;Sal&quot;)                                 minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                                            End If
                                                                            end
                                                                            if
                                                                        next                         Avg= Sum / 2
                                                                        If Avg&lt;1.2*min Then
                                                                            test=3
                                                                        End If
                                                                        For r As Integer = 0 To LL.Rows.Count-1                                 if(LL.Rows(r)(&quot;Sal&quot;)&gt;=Avg*0.65) then
                                                                            If LLcheck=0 Then
                                                                                LLcheck=1                                         if(Math.Floor(LL.Rows(r)(&quot;Sal&quot;))&lt;=Avg) then                                             Salary=LL.Rows(r)(&quot;Amount&quot;)
                                                                            End If
                                                                        else if(LL.Rows(r)(&quot;Sal&quot;)&lt;=Avg*1.2) then                                             Salary=LL.Rows(r)(&quot;Amount&quot;)
                                                                        else                                             ReassignFlag=1                                             Status=&quot;Salary not identified sincee one transaction in last month is grater than selected salary&quot;
                                                                            end
                                                                            if
                                                                        else                                          ReassignFlag=1                                         Status=&quot;More than one transaction is grater then 65% of selected salary&quot;
                                                                            end
                                                                            if
                                                                        end if
                                                                    next
                                                                else
                                                                    For r As Integer = 0 To LL.Rows.Count-1                                 if(LL.Rows(r)(&quot;Sal&quot;)&gt;=min*0.65) then
                                                                        If LLcheck=0 Then
                                                                            LLcheck=1                                         if(Math.Floor(LL.Rows(r)(&quot;Sal&quot;))&lt;=min) then                                             Salary=LL.Rows(r)(&quot;Amount&quot;)
                                                                        End If
                                                                    else if(LL.Rows(r)(&quot;Sal&quot;)&lt;=min*1.2) then                                             Salary=LL.Rows(r)(&quot;Amount&quot;)
                                                                    else                                             ReassignFlag=1                                             Status=&quot;Salary not identified sincee one transaction in last month is grater than selected salary&quot;
                                                                        end
                                                                        if
                                                                    else                                          ReassignFlag=1                                         Status=&quot;More than one transaction is grater then 65% of selected salary&quot;
                                                                        end
                                                                        if
                                                                    end if
                                                                next
                                                                end
                                                                if
                                                            else                         min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                                For k As Integer = 0 To 2                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                                    If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                        min=T2.Rows(k)(&quot;Sal&quot;)                                 minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                                    End If
                                                                    end
                                                                    if
                                                                next                         Avg= Sum / 3
                                                                If Avg&lt;1.2*min Then
                                                                    test=3
                                                                End If
                                                                For r As Integer = 0 To LL.Rows.Count-1                                 if(LL.Rows(r)(&quot;Sal&quot;)&gt;=Avg*0.65) then
                                                                    If LLcheck=0 Then
                                                                        LLcheck=1                                         if(Math.Floor(LL.Rows(r)(&quot;Sal&quot;))&lt;=Avg) then                                             Salary=LL.Rows(r)(&quot;Amount&quot;)
                                                                    End If
                                                                else if(LL.Rows(r)(&quot;Sal&quot;)&lt;=Avg*1.2) then                                             Salary=LL.Rows(r)(&quot;Amount&quot;)
                                                                else                                             ReassignFlag=1                                             Status=&quot;Salary not identified sincee one transaction in last month is grater than selected salary&quot;
                                                                    end
                                                                    if
                                                                else                                          ReassignFlag=1                                         Status=&quot;More than one transaction is grater then 65% of selected salary&quot;
                                                                    end
                                                                    if
                                                                end if
                                                            next
                                                        else
                                                            For r As Integer = 0 To LL.Rows.Count-1                                 if(LL.Rows(r)(&quot;Sal&quot;)&gt;=min*0.65) then
                                                                If LLcheck=0 Then
                                                                    LLcheck=1                                         if(Math.Floor(LL.Rows(r)(&quot;Sal&quot;))&lt;=min) then                                             Salary=LL.Rows(r)(&quot;Amount&quot;)
                                                                End If
                                                            else if(LL.Rows(r)(&quot;Sal&quot;)&lt;=min*1.2) then                                             Salary=LL.Rows(r)(&quot;Amount&quot;)
                                                            else                                             ReassignFlag=1                                             Status=&quot;Salary not identified since one transaction in last month is grater than selected salary&quot;
                                                                end
                                                                if
                                                            else                                          ReassignFlag=1                                         Status=&quot;More than one transaction is grater then 65% of selected salary&quot;
                                                                end
                                                                if
                                                            end if
                                                        next
                                                        end
                                                        if
                                                    end if
                                                    end
                                                    if &#x27;===============================================================BB=============================================END
                                                    else
                                                        Dim Count4 as integer=0
                                                        Dim Prev as integer =0
                                                        Dim Base as Decimal=0
                                                        for r as integer=0 to A1.Rows.Count-1
                                                            For j as integer=0 to T3.Rows.Count-1
                                                                if A1.Rows(r)(&quot;Amount&quot;)=T3.Rows(j)(&quot;Sal&quot;)                             Count4=Count4+1
                                                                    end
                                                                    if
                                                                next
                                                                if prev&lt;Count4                         BasicSalary=A1.Rows(r)(&quot;Amount&quot;)                         prev=Count4
                                                                    end
                                                                    if                     Count4=0
                                                                    next                                 x=T.NewRow
                                                                    For r As Integer = 0 To Buffer.Rows.Count-1         &#x27;
                                                                        If (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3) Then
                                                                            if((SD1m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))OR (SD2m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD3m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD3p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD4m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD4p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))) then                         x= Buffer.Rows(r)                         T.ImportRow(x)                         x=T.NewRow                         Tcounter=Tcounter+1
                                                                        End If
                                                                    end if
                                                                next
                                                                if Tcounter&lt;2                     ReassignFlag=1                     Status=&quot;Total number of feasible transaction is less than 2 after filtering with +/-5 salary date in AA-BB-Gov III&quot;
                                                                else                     BSp=BasicSalary+(BasicSalary*20/100)                     BSm=BasicSalary-(BasicSalary*20/100)                     x=T2.NewRow
                                                                    for r as integer=0 to T.Rows.count-1                         if(T.Rows(r)(&quot;Sal&quot;)&gt;=BSm AND T.Rows(r)(&quot;Sal&quot;)&lt;=BSp)                             x= T.Rows(r)                             T2.ImportRow(x)                             x=T2.NewRow                             T2counter=T2counter+1
                                                                        end
                                                                        if
                                                                    next
                                                                    If T2counter&lt;2 Then
                                                                        ReassignFlag=1                         Status=&quot;Total number of feasible transaction is less than 2 after filtering BSm&lt;= SAL &lt;=BSp in AA-BB-Gov IV&quot;
                                                                    End If
                                                                else
                                                                    if T2counter=2                         min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                                        For k As Integer = 0 To 1                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                                            If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                                min=T2.Rows(k)(&quot;Sal&quot;)                                 minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                                            End If
                                                                            end
                                                                            if
                                                                        next                         Avg= Sum / 2
                                                                        If Avg&lt;1.2*min Then
                                                                            test=4
                                                                        End If
                                                                        For r As Integer = 0 To LL.Rows.Count-1                                 if(LL.Rows(r)(&quot;Sal&quot;)&gt;=Avg*0.65) then
                                                                            If LLcheck=0 Then
                                                                                LLcheck=1                                         if(Math.Floor(LL.Rows(r)(&quot;Sal&quot;))&lt;=Avg) then                                             Salary=LL.Rows(r)(&quot;Amount&quot;)
                                                                            End If
                                                                        else if(LL.Rows(r)(&quot;Sal&quot;)&lt;=Avg*1.2) then                                             Salary=LL.Rows(r)(&quot;Amount&quot;)
                                                                        else                                             ReassignFlag=1                                             Status=&quot;Salary not identified sincee one transaction in last month is grater than selected salary&quot;
                                                                            end
                                                                            if
                                                                        else                                          ReassignFlag=1                                         Status=&quot;More than one transaction is grater then 65% of selected salary&quot;
                                                                            end
                                                                            if
                                                                        end if
                                                                    next
                                                                else
                                                                    For r As Integer = 0 To LL.Rows.Count-1                                 if(LL.Rows(r)(&quot;Sal&quot;)&gt;=min*0.65) then
                                                                        If LLcheck=0 Then
                                                                            LLcheck=1                                         if(Math.Floor(LL.Rows(r)(&quot;Sal&quot;))&lt;=min) then                                             Salary=LL.Rows(r)(&quot;Amount&quot;)
                                                                        End If
                                                                    else if(LL.Rows(r)(&quot;Sal&quot;)&lt;=min*1.2) then                                             Salary=LL.Rows(r)(&quot;Amount&quot;)
                                                                    else                                             ReassignFlag=1                                             Status=&quot;Salary not identified sincee one transaction in last month is grater than selected salary&quot;
                                                                        end
                                                                        if
                                                                    else                                          ReassignFlag=1                                         Status=&quot;More than one transaction is grater then 65% of selected salary&quot;
                                                                        end
                                                                        if
                                                                    end if
                                                                next
                                                                end
                                                                if
                                                            else                          min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                                For k As Integer = 0 To 2                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                                    If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                        min=T2.Rows(k)(&quot;Sal&quot;)                                 minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                                    End If
                                                                    end
                                                                    if
                                                                next                         Avg= Sum / 3
                                                                If Avg&lt;1.2*min Then
                                                                    test=4
                                                                End If
                                                                For r As Integer = 0 To LL.Rows.Count-1                                 if(LL.Rows(r)(&quot;Sal&quot;)&gt;=Avg*0.65) then
                                                                    If LLcheck=0 Then
                                                                        LLcheck=1                                         if(Math.Floor(LL.Rows(r)(&quot;Sal&quot;))&lt;=Avg) then                                             Salary=LL.Rows(r)(&quot;Amount&quot;)
                                                                    End If
                                                                else if(LL.Rows(r)(&quot;Sal&quot;)&lt;=Avg*1.2) then                                             Salary=LL.Rows(r)(&quot;Amount&quot;)
                                                                else                                             ReassignFlag=1                                             Status=&quot;Salary not identified sincee one transaction in last month is grater than selected salary&quot;
                                                                    end
                                                                    if
                                                                else                                          ReassignFlag=1                                         Status=&quot;More than one transaction is grater then 65% of selected salary&quot;
                                                                    end
                                                                    if
                                                                end if
                                                            next
                                                        else
                                                            For r As Integer = 0 To LL.Rows.Count-1                                 if(LL.Rows(r)(&quot;Sal&quot;)&gt;=min*0.65) then
                                                                If LLcheck=0 Then
                                                                    LLcheck=1                                         if(Math.Floor(LL.Rows(r)(&quot;Sal&quot;))&lt;=min) then                                             Salary=LL.Rows(r)(&quot;Amount&quot;)
                                                                End If
                                                            else if(LL.Rows(r)(&quot;Sal&quot;)&lt;=min*1.2) then                                             Salary=LL.Rows(r)(&quot;Amount&quot;)
                                                            else                                             ReassignFlag=1                                             Status=&quot;Salary not identified sincee one transaction in last month is grater than selected salary&quot;
                                                                end
                                                                if
                                                            else                                          ReassignFlag=1                                         Status=&quot;More than one transaction is grater then 65% of selected salary&quot;
                                                                end
                                                                if
                                                            end if
                                                        next
                                                        end
                                                        if
                                                    end if
                                                    end
                                                    if
                                                    end
                                                    if  &#x27;=============================================================AA===================================================    END
                                                        end
                                                        if
                                                    else             Status=&quot;No transaction in +/- 5 of last salary date&quot;             ReassignFlag=1
                                                        end
                                                        if
                                                        end
                                                        if
                                                    else      Status=&quot;Total number of feasible transaction is less than 3&quot;     ReassignFlag=1
                                                        end
                                                        if D0=D1 A0=A1
                                                        catch e as Exception         er=e.ToString         ReassignFlag=1         Status=&quot;Code Error:&quot;+e.ToString
                                                            end
                                                            try"
                            data-title="UWCA_MRCC_CTF_V1.0 / Salary code / Salary Calculation(new)6">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>UWCA_MRCC_CTF_V1.0</td>
                <td>Salary code</td>
                <td>Salary Calculation(new)7</td>
                <td>visualbasic</td>
                <td>898</td>
                <!--<td style="font-family: monospace;">4f0b9a393eb7652e5bb90a3ef2a94700487f37e4b7ca29e77d93afdcf6e54af4</td>-->
                <td>—</td>
                <!--<td>try     Dim description as string     Dim x As DataRow = D1.NewRow     Dim Dflag as integer =0     Dim precount as integer =0     Dim Amount as integer =0     Dim Avg as Decimal=0     Dim Sum as integer =0     Dim skip as integer =0     Dim min as integer =0     Dim count as integer =0     Dim Av as...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="try
    Dim description as string
    Dim x As DataRow = D1.NewRow
    Dim Dflag as integer =0
    Dim precount as integer =0
    Dim Amount as integer =0
    Dim Avg as Decimal=0
    Dim Sum as integer =0
    Dim skip as integer =0
    Dim min as integer =0
    Dim count as integer =0
    Dim Av as integer =0
    Dim mi as integer =0
    Dim minim as string min=0 count=0 minim=&quot;&quot;
    if c1.Rows.Count&gt;2 then
        For r As Integer = 0 To c1.Rows.Count-1         description=c1.Rows(r)(&quot;Description&quot;)         Dflag=0
            for i as integer=0 To D1.Rows.Count-1
                If D1.Rows(i)(&quot;Description&quot;)=description Then
                    Dflag=1                 D1.Rows(i)(&quot;Count&quot;)=D1.Rows(i)(&quot;Count&quot;)+1
                End If
                end
                if
            next
            If Dflag=0 Then
                x(&quot;Description&quot;) = description             x(&quot;Count&quot;)=1             D1.Rows.Add(x)             x= D1.NewRow
            End If
            end
            if
        Next
        For r As Integer = 0 To D1.Rows.Count-1         description=D1.Rows(r)(&quot;Description&quot;)         CollOut=Nothing         CollOut=c1.Clone
            For Each parentRow As DataRow In c1.Select(&quot;Description=&#x27;&quot;+description+&quot;&#x27;&quot;)             x = CollOut.NewRow
                For Each c As DataColumn In x.Table.Columns                     x(c.ColumnName) = parentRow(c.ColumnName)
                Next             CollOut.Rows.Add(x)
            Next         count=CollOut.Rows.Count
            If count&gt;precount Then
                Buffer=Nothing             Buffer = CollOut.Clone             Buffer=CollOut             precount=count             ReassignFlag=0
            End If
        else
            if count = Precount             ReassignFlag=1             Status=&quot;Salary cannot be identified since there mode are equal&quot;
                end
                if
            next &#x27;+++++++++++++++++++++++++
            If Govt= False AND EF= False Then
                &#x27;+++++++++++++++++++++++++
            End If
            If Buffer.Rows.Count &gt;2 Then
                ReassignFlag=0
            End If
            if ReassignFlag=0             ReassignFlag=1
                For r As Integer = 0 To Buffer.Rows.Count-1
                    If Buffer.Rows(r)(&quot;Days&quot;)&lt;=TimePeriod Then
                        ReassignFlag=0
                    End If
                    exit
                    for
                    end
                    if
                next
                end
                if
                if ReassignFlag=0             Status=&quot;&quot;
                    For r As Integer = 0 To Buffer.Rows.Count-1                 Amount=Buffer.Rows(r)(&quot;Sal&quot;)                 Dflag=0
                        for i as integer=0 To A1.Rows.Count-1
                            If A1.Rows(i)(&quot;Amount&quot;)=Amount Then
                                Dflag=1                         A1.Rows(i)(&quot;Count&quot;)=A1.Rows(i)(&quot;Count&quot;)+1
                            End If
                            end
                            if
                        next
                        If Dflag=0 Then
                            x= A1.NewRow                     x(&quot;Amount&quot;) = Amount                     x(&quot;Count&quot;)=1                     x(&quot;Salary&quot;)=Buffer.Rows(r)(&quot;Amount&quot;)                     A1.Rows.Add(x)
                        End If
                        end
                        if
                    Next             min=Buffer.Rows(0)(&quot;Sal&quot;)+1
                    For k As Integer = 0 To 2                 Sum=Sum+Buffer.Rows(k)(&quot;Sal&quot;)
                        If min&gt;Buffer.Rows(k)(&quot;Sal&quot;) Then
                            min=Buffer.Rows(k)(&quot;Sal&quot;)                     minimum=Buffer.Rows(k)(&quot;Amount&quot;)
                        End If
                        end
                        if
                        if k=1                     Av=Sum/2                     mi=min                     minim=minimum
                            end
                            if
                        next             Avg= Sum / 3
                        If Avg&lt;1.2*min Then
                            test=1 Cop=A1                 Salary=minimum                 Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                        End If
                    else
                        If Av&lt;1.2*mi Then
                            minimum=minim                 Salary=minimum                 Other=Replace((Av-mi),&quot;.&quot;,&quot;,&quot;)
                        End If
                    else
                        For r As Integer = 0 To A1.Rows.Count-1
                            If (A1.Rows(r)(&quot;Count&quot;)*100/(Buffer.Rows.Count))&gt;60 Then
                                Salary=A1.Rows(r)(&quot;Salary&quot;)                         skip=1
                            End If
                            end
                            if
                        next
                        If skip=0 Then
                            &#x27;vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvPage2vvvvvvvvvvvvvvvvvvvvvvvvvvv
                        End If
                        if Govt=True then
                            Dim SD1p,SD1m,SD2p,SD2m,SD3p,SD3m as date
                            Dim Sflag as integer =0
                            Dim BasicSalary as Integer =0
                            Dim T as DataTable =Buffer.Clone
                            Dim T2 as DataTable=Buffer.Clone
                            Dim TX as DataTable=Buffer.Clone
                            Dim Tcounter as integer =0
                            Dim T2counter as integer =0
                            Dim BSp,BSm as Decimal                          Sum=0                         minimum=0                         Salary=0                         Other=0                         min=0                         SD1p=SD1.AddDays(5)                         SD1m=SD1.AddDays(-5)                         SD2p=SD2.AddDays(5)                         SD2m=SD2.AddDays(-5)                         SD3p=SD3.AddDays(5)                         SD3m=SD3.AddDays(-5)                 &#x27;        T=Buffer.Clone
                            For r As Integer = 0 To Buffer.Rows.Count-1 &#x27;
                                If (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3) Then
                                    if((SD1m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))OR (SD2m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD3m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD3p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))) then                                 x= Buffer.Rows(r)                                 TX.ImportRow(x)                                 x=TX.NewRow
                                End If
                            end if
                        next                         Buffer=TX
                        For r As Integer = 0 To Buffer.Rows.Count-1                 &#x27;
                            if (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1) then
                                If (SD1m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) Then
                                    Sflag=Sflag+1                                 BasicSalary=Buffer.Rows(r)(&quot;Sal&quot;)                                 &#x27;AM=BasicSalary
                                End If
                                end
                                if
                            Next                         &#x27;AM=BasicSalary
                            If Sflag=1 Then
                                x=T.NewRow
                            End If
                            For r As Integer = 0 To Buffer.Rows.Count-1                 &#x27;
                                If (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3) Then
                                    if((SD1m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))OR (SD2m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD3m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD3p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))) then                                     x= Buffer.Rows(r)                                     T.ImportRow(x)                                     x=T.NewRow                                     Tcounter=Tcounter+1
                                End If
                            end if
                        next
                        if Tcounter&lt;3                                 ReassignFlag=1                                 Status=&quot;Total number of feasible transaction is less than 3 after filtering with +/-5 salary date I&quot;
                        else                                 BSp=BasicSalary+(BasicSalary*20/100)                                 BSm=BasicSalary-(BasicSalary*20/100)                                 x=T2.NewRow
                            for r as integer=0 to T.Rows.count-1                                     if(T.Rows(r)(&quot;Sal&quot;)&gt;=BSm AND T.Rows(r)(&quot;Sal&quot;)&lt;=BSp)                                         x= T.Rows(r)                                         T2.ImportRow(x)                                         x=T2.NewRow                                         T2counter=T2counter+1
                                end
                                if
                            next
                            If T2counter&lt;2 Then
                                ReassignFlag=1                                     Status=&quot;Total number of feasible transaction is less than 2 after filtering BSm &lt;= Salary &lt;=BSp&quot;
                            End If
                        else
                            if T2counter=2                                     min=T2.Rows(0)(&quot;Sal&quot;)+1
                                For k As Integer = 0 To 1                                         Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                    If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                        min=T2.Rows(k)(&quot;Sal&quot;)                                             minimum=T2.Rows(k)(&quot;Amount&quot;)
                                    End If
                                    end
                                    if
                                next                                     Avg= Sum / 2
                                If Avg&lt;1.2*min Then
                                    test=2                                         Salary=minimum                                         Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                End If
                            else                                         Salary=minimum                                         Other=0
                                end
                                if
                            else                                     min=T2.Rows(0)(&quot;Sal&quot;)+1
                                For k As Integer = 0 To 2                                         Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                    If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                        min=T2.Rows(k)(&quot;Sal&quot;)                                             minimum=T2.Rows(k)(&quot;Amount&quot;)
                                    End If
                                    end
                                    if
                                next                                     Avg= Sum / 3
                                If Avg&lt;1.2*min Then
                                    test=2                                         Salary=minimum                                         Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                End If
                            else                                         Salary=minimum                                         Other=0
                                end
                                if
                            end if
                            end
                            if                     &#x27;    test=T                     &#x27;    testT=Tcounter
                            else &#x27;=============================================================AA===================================================BEGIN
                                Dim T3 as DataTable=Buffer.Clone
                                Dim Tcounter2 as integer=0
                                for r as integer =0 to Buffer.Rows.Count-1                                 if(Buffer.Rows(r)(&quot;Sal&quot;)&gt;=LastApproved) then                                     x=T3.NewRow                                     x=Buffer.Rows(r)                                     T3.ImportRow(x)                                     Tcounter2=Tcounter2+1                                     BasicSalary=Buffer.Rows(r)(&quot;Sal&quot;)
                                    end
                                    if
                                next                             &#x27;    Buffer=Nothing                         &#x27;    Buffer=T3 Cop=Buffer &#x27;===============================================================BB=============================================BEGIN                             if(Tcounter2=1)                                 x=T.NewRow
                                For r As Integer = 0 To Buffer.Rows.Count-1                 &#x27;
                                    If (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3) Then
                                        if((SD1m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))OR (SD2m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD3m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD3p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))) then                                         x= Buffer.Rows(r)                                         T.ImportRow(x)                                         x=T.NewRow                                         Tcounter=Tcounter+1
                                    End If
                                end if
                            next
                            if Tcounter&lt;3                                     ReassignFlag=1                                     Status=&quot;Total number of feasible transaction is less than 3 after filtering with +/-5 salary date in AA-BB-Gov I&quot;
                            else                                     BSp=BasicSalary+(BasicSalary*20/100)                                     BSm=BasicSalary-(BasicSalary*20/100)                                     x=T2.NewRow
                                for r as integer=0 to T.Rows.count-1                                         if(T.Rows(r)(&quot;Sal&quot;)&gt;=BSm AND T.Rows(r)(&quot;Sal&quot;)&lt;=BSp)                                             x= T.Rows(r)                                             T2.ImportRow(x)                                             x=T2.NewRow                                             T2counter=T2counter+1
                                    end
                                    if
                                next
                                If T2counter&lt;2 Then
                                    ReassignFlag=1                                         Status=&quot;Total number of feasible transaction is less than 2 after filtering with +/-5 salary date in AA-BB-Gov II&quot;
                                End If
                            else
                                if T2counter=2                                         min=T2.Rows(0)(&quot;Sal&quot;)+1
                                    For k As Integer = 0 To 1                                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                        If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                            min=T2.Rows(k)(&quot;Sal&quot;)                                                 minimum=T2.Rows(k)(&quot;Amount&quot;)
                                        End If
                                        end
                                        if
                                    next                                         Avg= Sum / 2
                                    If Avg&lt;1.2*min Then
                                        test=3                                             Salary=minimum                                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                    End If
                                else                                             Salary=minimum                                             Other=0
                                    end
                                    if
                                else                                         min=T2.Rows(0)(&quot;Sal&quot;)+1
                                    For k As Integer = 0 To 2                                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                        If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                            min=T2.Rows(k)(&quot;Sal&quot;)                                                 minimum=T2.Rows(k)(&quot;Amount&quot;)
                                        End If
                                        end
                                        if
                                    next                                         Avg= Sum / 3
                                    If Avg&lt;1.2*min Then
                                        test=3                                             Salary=minimum                                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                    End If
                                else                                             Salary=minimum                                             Other=0
                                    end
                                    if
                                end if
                                end
                                if &#x27;===============================================================BB=============================================END
                                else
                                    Dim Count4 as integer=0
                                    Dim Prev as integer =0
                                    Dim Base as Decimal=0
                                    for r as integer=0 to A1.Rows.Count-1
                                        For j as integer=0 to T3.Rows.Count-1
                                            if A1.Rows(r)(&quot;Amount&quot;)=T3.Rows(j)(&quot;Sal&quot;)                                             Count4=Count4+1
                                                end
                                                if
                                            next
                                            if prev&lt;Count4                                         BasicSalary=A1.Rows(r)(&quot;Amount&quot;)                                         prev=Count4
                                                end
                                                if                                     Count4=0
                                                next                                                 x=T.NewRow
                                                For r As Integer = 0 To Buffer.Rows.Count-1                 &#x27;
                                                    If (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3) Then
                                                        if((SD1m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))OR (SD2m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD3m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD3p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))) then                                         x= Buffer.Rows(r)                                         T.ImportRow(x)                                         x=T.NewRow                                         Tcounter=Tcounter+1
                                                    End If
                                                end if
                                            next
                                            if Tcounter&lt;3                                     ReassignFlag=1                                     Status=&quot;Total number of feasible transaction is less than 3 after filtering with +/-5 salary date in AA-BB-Gov III&quot;
                                            else                                     BSp=BasicSalary+(BasicSalary*20/100)                                     BSm=BasicSalary-(BasicSalary*20/100)                                     x=T2.NewRow
                                                for r as integer=0 to T.Rows.count-1                                         if(T.Rows(r)(&quot;Sal&quot;)&gt;=BSm AND T.Rows(r)(&quot;Sal&quot;)&lt;=BSp)                                             x= T.Rows(r)                                             T2.ImportRow(x)                                             x=T2.NewRow                                             T2counter=T2counter+1
                                                    end
                                                    if
                                                next
                                                If T2counter&lt;2 Then
                                                    ReassignFlag=1                                         Status=&quot;Total number of feasible transaction is less than 2 after filtering BSm&lt;= SAL &lt;=BSp in AA-BB-Gov IV&quot;
                                                End If
                                            else
                                                if T2counter=2                                         min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                    For k As Integer = 0 To 1                                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                        If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                            min=T2.Rows(k)(&quot;Sal&quot;)                                                 minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                        End If
                                                        end
                                                        if
                                                    next                                         Avg= Sum / 2
                                                    If Avg&lt;1.2*min Then
                                                        test=4                                             Salary=minimum                                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                    End If
                                                else                                             Salary=minimum                                             Other=0
                                                    end
                                                    if
                                                else                                          min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                    For k As Integer = 0 To 2                                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                        If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                            min=T2.Rows(k)(&quot;Sal&quot;)                                                 minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                        End If
                                                        end
                                                        if
                                                    next                                         Avg= Sum / 3
                                                    If Avg&lt;1.2*min Then
                                                        test=4                                             Salary=minimum                                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                    End If
                                                else                                             Salary=minimum                                             Other=0
                                                    end
                                                    if
                                                end if
                                                end
                                                if
                                                end
                                                if  &#x27;=============================================================AA===================================================    END
                                                    end
                                                    if
                                                else &#x27;==========================================================================B===================================BEGIN
                                                    Dim Sflag as integer =0
                                                    Dim BasicSalary as Integer =0
                                                    Dim T as DataTable =Buffer.Clone
                                                    Dim T2 as DataTable=Buffer.Clone
                                                    Dim Tcounter as integer =0
                                                    Dim T2counter as integer =0
                                                    Dim BSp,BSm as Decimal
                                                    Dim BaseDays as Decimal =0
                                                    Dim Dayz as decimal=0                         Sum=0                         minimum=0                         Salary=0                         Sflag=0                         Other=0                         min=0
                                                    For r As Integer = 0 To Buffer.Rows.Count-1
                                                        If (Buffer.Rows(r)(&quot;Days&quot;)&lt;=TimePeriod) Then
                                                            Sflag=Sflag+1                                 BasicSalary=Buffer.Rows(r)(&quot;Sal&quot;)                                 x=T.NewRow                                 x= Buffer.Rows(r)                                 T.ImportRow(x)                                 Tcounter=1                                 BaseDays=Buffer.Rows(r)(&quot;Days&quot;)
                                                        End If
                                                        end
                                                        if
                                                    Next &#x27;=======================================================================================BB=================================================BEGIN
                                                    If Sflag=1 Then
                                                        x=T.NewRow
                                                    End If
                                                    For r As Integer = 0 To Buffer.Rows.Count-1                                     Dayz=Buffer.Rows(r)(&quot;Days&quot;)                                 Dayz=Dayz-BaseDays
                                                        If ((Dayz&gt;=25 AND Dayz&lt;=35) OR (Dayz&gt;=55 AND Dayz&lt;=65) ) Then
                                                            x= Buffer.Rows(r)                                     T.ImportRow(x)                                     x=T.NewRow                                     Tcounter=Tcounter+1
                                                        End If
                                                    end if
                                                next                             &#x27;testT=Tcounter /checked
                                                if Tcounter&lt;3                                 ReassignFlag=1                                 Status=&quot;Total number of feasible transaction is less than 3 after filtering with 25-35 and 55 to 65 in AA-BB-nonGov II&quot;
                                                else                                 BSp=BasicSalary+(BasicSalary*20/100)                                 BSm=BasicSalary-(BasicSalary*20/100)                                 x=T2.NewRow
                                                    for r as integer=0 to T.Rows.count-1                                     if(T.Rows(r)(&quot;Sal&quot;)&gt;=BSm AND T.Rows(r)(&quot;Sal&quot;)&lt;=BSp)                                         x= T.Rows(r)                                         T2.ImportRow(x)                                         x=T2.NewRow                                         T2counter=T2counter+1
                                                        end
                                                        if
                                                    next
                                                    If T2counter&lt;2 Then
                                                        ReassignFlag=1                                     Status=&quot;Total number of feasible transaction is less than 2 after filtering BSm&lt;=SAL&lt;=BSp BB-non Gov II&quot;
                                                    End If
                                                else
                                                    if T2counter=2
                                                        For k As Integer = 0 To 1                                         Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                            If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                min=T2.Rows(k)(&quot;Sal&quot;)                                             minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                            End If
                                                            end
                                                            if
                                                        next                                      Avg= Sum / 2
                                                        If Avg&lt;1.2*min Then
                                                            Salary=minimum                                         Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                        End If
                                                    else                                          Salary=minimum                                         Other=0
                                                        end
                                                        if
                                                    else                                       min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                        For k As Integer = 0 To 2                                         Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                            If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                min=T2.Rows(k)(&quot;Sal&quot;)                                             minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                            End If
                                                            end
                                                            if
                                                        next                                      Avg= Sum / 3
                                                        If Avg&lt;1.2*min Then
                                                            Salary=minimum                                         Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                        End If
                                                    else                                          Salary=minimum                                         Other=0
                                                        end
                                                        if
                                                    end if
                                                    end
                                                    if                         &#x27;test=T2                         &#x27;testT=Tcounter
                                                    else &#x27;++++++++++++++++++++++AA+++++++++ &#x27;=============================================================AA===================================================BEGIN
                                                        Dim T3 as DataTable=Buffer.Clone
                                                        Dim Tcounter2 as integer=0
                                                        for r as integer =0 to Buffer.Rows.Count-1                                 if(Buffer.Rows(r)(&quot;Sal&quot;)&gt;=LastApproved) then                                     x=T3.NewRow                                     x=Buffer.Rows(r)                                     T3.ImportRow(x)                                     Tcounter2=Tcounter2+1                                     BasicSalary=Buffer.Rows(r)(&quot;Sal&quot;)
                                                            end
                                                            if
                                                        next                                 Buffer=Nothing                             Buffer=T3 &#x27;===============================================================BB=============================================BEGIN                             if(Tcounter2=1)                                 x=T.NewRow
                                                        For r As Integer = 0 To Buffer.Rows.Count-1                                         Dayz=Buffer.Rows(r)(&quot;Days&quot;)                                     Dayz=Dayz-BaseDays
                                                            If ((Dayz&gt;=25 AND Dayz&lt;=35) OR (Dayz&gt;=55 AND Dayz&lt;=65) ) Then
                                                                x= Buffer.Rows(r)                                         T.ImportRow(x)                                         x=T.NewRow                                         Tcounter=Tcounter+1
                                                            End If
                                                        end if
                                                    next                                 &#x27;testT=Tcounter /checked
                                                    if Tcounter&lt;3                                     ReassignFlag=1                                     Status=&quot;Total number of feasible transaction is less than 3 after filtering with 25-35 and 55 to 65 in AA-BB-nonGov III&quot;
                                                    else                                     BSp=BasicSalary+(BasicSalary*20/100)                                     BSm=BasicSalary-(BasicSalary*20/100)                                     x=T2.NewRow
                                                        for r as integer=0 to T.Rows.count-1                                         if(T.Rows(r)(&quot;Sal&quot;)&gt;=BSm AND T.Rows(r)(&quot;Sal&quot;)&lt;=BSp)                                             x= T.Rows(r)                                             T2.ImportRow(x)                                             x=T2.NewRow                                             T2counter=T2counter+1
                                                            end
                                                            if
                                                        next
                                                        If T2counter&lt;2 Then
                                                            ReassignFlag=1                                         Status=&quot;Total number of feasible transaction is less than 2 after filtering BSm&lt;SAL&lt;BSp in AA-BB-nonGov IV&quot;
                                                        End If
                                                    else
                                                        if T2counter=2                                         min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                            For k As Integer = 0 To 1                                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                                If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                    min=T2.Rows(k)(&quot;Sal&quot;)                                                 minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                                End If
                                                                end
                                                                if
                                                            next                                          Avg= Sum / 2
                                                            If Avg&lt;1.2*min Then
                                                                Salary=minimum                                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                            End If
                                                        else                                              Salary=minimum                                             Other=0
                                                            end
                                                            if
                                                        else                                         min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                            For k As Integer = 0 To 2                                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                                If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                    min=T2.Rows(k)(&quot;Sal&quot;)                                                 minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                                End If
                                                                end
                                                                if
                                                            next                                          Avg= Sum / 3
                                                            If Avg&lt;1.2*min Then
                                                                Salary=minimum                                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                            End If
                                                        else                                              Salary=minimum                                             Other=0
                                                            end
                                                            if
                                                        end if
                                                        end
                                                        if  &#x27;===============================================================BB=============================================END
                                                        else
                                                            Dim Count4 as integer=0
                                                            Dim Prev as integer =0
                                                            Dim Base as Decimal=0
                                                            for r as integer=0 to A1.Rows.Count-1
                                                                For j as integer=0 to T3.Rows.Count-1
                                                                    if A1.Rows(r)(&quot;Amount&quot;)=T3.Rows(j)(&quot;Sal&quot;)                                             Count4=Count4+1
                                                                        end
                                                                        if
                                                                    next
                                                                    if prev&lt;Count4                                         BasicSalary=A1.Rows(r)(&quot;Amount&quot;)
                                                                        end
                                                                        if
                                                                    next &#x27;============================================================BB=============================================BEGIN                                             x=T.NewRow
                                                                    For r As Integer = 0 To Buffer.Rows.Count-1                                         Dayz=Buffer.Rows(r)(&quot;Days&quot;)                                     Dayz=Dayz-BaseDays
                                                                        If ((Dayz&gt;=25 AND Dayz&lt;=35) OR (Dayz&gt;=55 AND Dayz&lt;=65) ) Then
                                                                            x= Buffer.Rows(r)                                         T.ImportRow(x)                                         x=T.NewRow                                         Tcounter=Tcounter+1
                                                                        End If
                                                                    end if
                                                                next                                 &#x27;testT=Tcounter /checked
                                                                if Tcounter&lt;3                                     ReassignFlag=1                                     Status=&quot;Total number of feasible transaction is less than 3 after filtering 25-35 and 55-65 in AA-BB-nonGov V&quot;
                                                                else                                     BSp=BasicSalary+(BasicSalary*20/100)                                     BSm=BasicSalary-(BasicSalary*20/100)                                     x=T2.NewRow
                                                                    for r as integer=0 to T.Rows.count-1                                         if(T.Rows(r)(&quot;Sal&quot;)&gt;=BSm AND T.Rows(r)(&quot;Sal&quot;)&lt;=BSp)                                             x= T.Rows(r)                                             T2.ImportRow(x)                                             x=T2.NewRow                                             T2counter=T2counter+1
                                                                        end
                                                                        if
                                                                    next
                                                                    If T2counter&lt;2 Then
                                                                        ReassignFlag=1                                         Status=&quot;Total number of feasible transaction is less than 2 after filtering BSp&lt;=SAL&lt;=BSp in AA-BB-nonGov VI&quot;
                                                                    End If
                                                                else
                                                                    if T2counter=2                                         min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                                        For k As Integer = 0 To 1                                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                                            If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                                min=T2.Rows(k)(&quot;Sal&quot;)                                                 minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                                            End If
                                                                            end
                                                                            if
                                                                        next                                          Avg= Sum / 2
                                                                        If Avg&lt;1.2*min Then
                                                                            Salary=minimum                                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                                        End If
                                                                    else                                              Salary=minimum                                             Other=0
                                                                        end
                                                                        if
                                                                    else                                          min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                                        For k As Integer = 0 To 2                                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                                            If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                                min=T2.Rows(k)(&quot;Sal&quot;)                                                 minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                                            End If
                                                                            end
                                                                            if
                                                                        next                                          Avg= Sum / 3
                                                                        If Avg&lt;1.2*min Then
                                                                            Salary=minimum                                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                                        End If
                                                                    else                                              Salary=minimum                                             Other=0
                                                                        end
                                                                        if
                                                                    end if
                                                                    end
                                                                    if &#x27;===========================================================BB======================================================END
                                                                        end
                                                                        if &#x27;=============================================================AA===================================================    END
                                                                            end
                                                                            if &#x27;==============================================================BB============================================END                      &#x27;==============================================================B=============================================END
                                                                                end
                                                                                if &#x27;^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^Page2^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                                                                    end
                                                                                    if
                                                                                    end
                                                                                    if
                                                                                else             Status=&quot;Salary cannot be identified since there is no transaction in the past &quot;+TimePeriod.ToString+&quot; days&quot;             ReassignFlag=1
                                                                                    end
                                                                                    if
                                                                                else         ReassignFlag=1         Status=&quot;Total number of feasible transaction is less than 3&quot;
                                                                                    end
                                                                                    if
                                                                                else
                                                                                    Dim SD1p,SD1m,SD2p,SD2m,SD3p,SD3m,SD4p,SD4m as date
                                                                                    Dim Sflag as integer =0
                                                                                    Dim Salflag as integer =0
                                                                                    Dim Lflag as integer =0
                                                                                    Dim L2flag as integer =0
                                                                                    Dim LLcheck as integer =0
                                                                                    Dim BasicSalary as Integer =0
                                                                                    Dim T as DataTable =Buffer.Clone
                                                                                    Dim T2 as DataTable=Buffer.Clone
                                                                                    Dim TX as DataTable=Buffer.Clone
                                                                                    Dim LL as DataTable=Buffer.Clone
                                                                                    Dim L2 as DataTable=Buffer.Clone
                                                                                    Dim Tcounter as integer =0
                                                                                    Dim T2counter as integer =0
                                                                                    Dim BSp,BSm as Decimal          Sum=0         minimum=0         Salary=0         Other=0         min=0         SD1p=SD1.AddDays(5)         SD1m=SD1.AddDays(-5)         SD2p=SD2.AddDays(5)         SD2m=SD2.AddDays(-5)         SD3p=SD3.AddDays(5)         SD3m=SD3.AddDays(-5)         SD4p=SD4.AddDays(5)         SD4m=SD4.AddDays(-5)         &#x27;        T=Buffer.Clone
                                                                                    For r As Integer = 0 To Buffer.Rows.Count-1         &#x27;
                                                                                        If (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3) Then
                                                                                            if((SD1m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))OR (SD2m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD3m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD3p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD4m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD4p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))) then                 x= Buffer.Rows(r)                 TX.ImportRow(x)                 x=TX.NewRow
                                                                                        End If
                                                                                    end if
                                                                                next         Buffer=TX
                                                                                For r As Integer = 0 To Buffer.Rows.Count-1         &#x27;
                                                                                    If (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3) Then
                                                                                        if(SD1=Buffer.Rows(r)(&quot;Account date&quot;)) then                 x= Buffer.Rows(r)                 LL.ImportRow(x)                 x=LL.NewRow                 Lflag=Lflag+1
                                                                                    End If
                                                                                end if
                                                                            next LLout=LL &#x27;+++++++++++++++++++++++++++
                                                                            If Lflag&gt;0 Then
                                                                                &#x27;+++++++++++++++++++++++++++
                                                                            End If
                                                                            if Lflag=1 then
                                                                                For r As Integer = 0 To Buffer.Rows.Count-1                     if(SD2=Buffer.Rows(r)(&quot;Account date&quot;)) then                         x= Buffer.Rows(r)                         L2.ImportRow(x)                         x=L2.NewRow                         L2flag=L2flag+1
                                                                                end if
                                                                            next
                                                                            If L2flag&gt;0 Then
                                                                                test=101
                                                                            End If
                                                                            if L2flag=1 then
                                                                                If L2.Rows(0)(&quot;Sal&quot;)&gt;=LL.Rows(0)(&quot;Sal&quot;) Then
                                                                                    salflag=1                             Salary=LL.Rows(0)(&quot;Amount&quot;)                             ReassignFlag=0         test=100
                                                                                End If
                                                                            else                             salflag=0
                                                                                end
                                                                                if
                                                                                end
                                                                                if
                                                                                If salflag=0 Then
                                                                                    test=102 &#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;
                                                                                End If
                                                                                For r As Integer = 0 To Buffer.Rows.Count-1                         &#x27;
                                                                                    if (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1) then
                                                                                        If (SD2m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) Then
                                                                                            Sflag=Sflag+1                                 BasicSalary=Buffer.Rows(r)(&quot;Sal&quot;)                                 &#x27;AM=BasicSalary
                                                                                        End If
                                                                                        end
                                                                                        if
                                                                                    Next                         &#x27;AM=BasicSalary
                                                                                    If Sflag=1 Then
                                                                                        x=T.NewRow
                                                                                    End If
                                                                                    For r As Integer = 0 To Buffer.Rows.Count-1                         &#x27;
                                                                                        If (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3) Then
                                                                                            if((SD2m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD3m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD3p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD4m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD4p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))) then                                     x= Buffer.Rows(r)                                     T.ImportRow(x)                                     x=T.NewRow                                     Tcounter=Tcounter+1
                                                                                        End If
                                                                                    end if
                                                                                next
                                                                                if Tcounter&lt;2                                 ReassignFlag=1                                 Status=&quot;Total number of feasible transaction is less than 2 after filtering with +/-5 salary date I&quot;
                                                                                else                                 BSp=BasicSalary+(BasicSalary*20/100)                                 BSm=BasicSalary-(BasicSalary*20/100)                                 x=T2.NewRow
                                                                                    for r as integer=0 to T.Rows.count-1                                     if(T.Rows(r)(&quot;Sal&quot;)&gt;=BSm AND T.Rows(r)(&quot;Sal&quot;)&lt;=BSp)                                         x= T.Rows(r)                                         T2.ImportRow(x)                                         x=T2.NewRow                                         T2counter=T2counter+1
                                                                                        end
                                                                                        if
                                                                                    next
                                                                                    If T2counter&lt;2 Then
                                                                                        ReassignFlag=1                                     Status=&quot;Total number of feasible transaction is less than 2 after filtering BSm &lt;= Salary &lt;=BSp&quot;
                                                                                    End If
                                                                                else
                                                                                    if T2counter=2                                     min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                                                        For k As Integer = 0 To 1                                         Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                                                            If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                                                min=T2.Rows(k)(&quot;Sal&quot;)                                             minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                                                            End If
                                                                                            end
                                                                                            if
                                                                                        next                                     Avg= Sum / 2
                                                                                        If Avg&lt;1.2*min Then
                                                                                            test=2                 &#x27;
                                                                                        End If
                                                                                        For r As Integer = 0 To LL.Rows.Count-1                 &#x27;                            if(LL.Rows(r)(&quot;Sal&quot;)&gt;=Avg*0.65) then                 &#x27;
                                                                                            If LLcheck=0 Then
                                                                                                &#x27;                                    LLcheck=1                 &#x27;                                    if(Math.Floor(LL.Rows(r)(&quot;Sal&quot;))&lt;=Avg) then                 &#x27;                                        Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                            End If
                                                                                        else if(LL.Rows(r)(&quot;Sal&quot;)&lt;=Avg*1.2) then                 &#x27;                                        Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                        else                     &#x27;                                        ReassignFlag=1                 &#x27;                                        Status=&quot;Salary not identified sincee one transaction in last month is grater than selected salary&quot;                 &#x27;
                                                                                            end
                                                                                            if                 &#x27;
                                                                                            else                  &#x27;                                    ReassignFlag=1                 &#x27;                                    Status=&quot;More than one transaction is grater then 65% of selected salary&quot;                 &#x27;
                                                                                                end
                                                                                                if                 &#x27;
                                                                                                end if                     &#x27;
                                                                                            next                                         Salary=minimum                                         Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                                                        else                 &#x27;
                                                                                            For r As Integer = 0 To LL.Rows.Count-1                 &#x27;                            if(LL.Rows(r)(&quot;Sal&quot;)&gt;=min*0.65) then                 &#x27;
                                                                                                If LLcheck=0 Then
                                                                                                    &#x27;                                    LLcheck=1                 &#x27;                                    if(Math.Floor(LL.Rows(r)(&quot;Sal&quot;))&lt;=min) then                 &#x27;                                        Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                                End If
                                                                                            else if(LL.Rows(r)(&quot;Sal&quot;)&lt;min*1.2) then                 &#x27;                                        Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                            else                 &#x27;                                        ReassignFlag=1                 &#x27;                                        Status=&quot;Salary not identified sincee one transaction in last month is grater than selected salary&quot;                 &#x27;
                                                                                                end
                                                                                                if                 &#x27;
                                                                                                else                  &#x27;                                    ReassignFlag=1                 &#x27;                                    Status=&quot;More than one transaction is grater then 65% of selected salary&quot;                 &#x27;
                                                                                                    end
                                                                                                    if                 &#x27;
                                                                                                    end if                     &#x27;
                                                                                                next                 test=2.1                                         Salary=minimum
                                                                                                end
                                                                                                if
                                                                                            else                                     min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                                                                For k As Integer = 0 To 2                                         Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                                                                    If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                                                        min=T2.Rows(k)(&quot;Sal&quot;)                                             minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                                                                    End If
                                                                                                    end
                                                                                                    if
                                                                                                next                                     Avg= Sum / 3
                                                                                                If Avg&lt;1.2*min Then
                                                                                                    test=2                 &#x27;
                                                                                                End If
                                                                                                For r As Integer = 0 To LL.Rows.Count-1                 &#x27;                            if(LL.Rows(r)(&quot;Sal&quot;)&gt;=Avg*0.65) then                 &#x27;
                                                                                                    If LLcheck=0 Then
                                                                                                        &#x27;                                    LLcheck=1                 &#x27;                                    if(Math.Floor(LL.Rows(r)(&quot;Sal&quot;))&lt;=Avg) then                 &#x27;                                        Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                                    End If
                                                                                                else if(LL.Rows(r)(&quot;Sal&quot;)&lt;Avg*1.2) then                 &#x27;                                        Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                                else                 &#x27;er=Avg                 &#x27;Buffer=T2                 &#x27;                                        ReassignFlag=1                 &#x27;                                        Status=&quot;Salary not identified sincee one transaction in last month is grater than selected salary&quot;                 &#x27;
                                                                                                    end
                                                                                                    if                 &#x27;
                                                                                                    else                  &#x27;                                    ReassignFlag=1                 &#x27;                                    Status=&quot;More than one transaction is grater then 65% of selected salary&quot;                 &#x27;
                                                                                                        end
                                                                                                        if                 &#x27;
                                                                                                        end if                     &#x27;
                                                                                                    next                                         Salary=minimum                                         Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                                                                else                 &#x27;
                                                                                                    For r As Integer = 0 To LL.Rows.Count-1                 &#x27;                            if(LL.Rows(r)(&quot;Sal&quot;)&gt;=min*0.65) then                 &#x27;
                                                                                                        If LLcheck=0 Then
                                                                                                            &#x27;                                    LLcheck=1                 &#x27;                                    if(Math.Floor(LL.Rows(r)(&quot;Sal&quot;))&lt;=min) then                 &#x27;                                        Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                                        End If
                                                                                                    else if(LL.Rows(r)(&quot;Sal&quot;)&lt;=min*1.2) then                 &#x27;                                        Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                                    else                 &#x27;                                        ReassignFlag=1                 &#x27;                                        Status=&quot;Salary not identified sincee one transaction in last month is grater than selected salary&quot;                 &#x27;
                                                                                                        end
                                                                                                        if                 &#x27;
                                                                                                        else                  &#x27;                                    ReassignFlag=1                 &#x27;                                    Status=&quot;More than one transaction is grater then 65% of selected salary&quot;                 &#x27;
                                                                                                            end
                                                                                                            if                 &#x27;
                                                                                                            end if                     &#x27;
                                                                                                        next                 test=2.1                                         Salary=minimum
                                                                                                        end
                                                                                                        if
                                                                                                    end if
                                                                                                    end
                                                                                                    if                         &#x27;    test=T                         &#x27;    testT=Tcounter
                                                                                                    else &#x27;=============================================================AA===================================================BEGIN
                                                                                                        Dim T3 as DataTable=Buffer.Clone
                                                                                                        Dim Tcounter2 as integer=0
                                                                                                        for r as integer =0 to Buffer.Rows.Count-1                                 if(Buffer.Rows(r)(&quot;Sal&quot;)&gt;=LastApproved) then                                     x=T3.NewRow                                     x=Buffer.Rows(r)                                     T3.ImportRow(x)                                     Tcounter2=Tcounter2+1                                     BasicSalary=Buffer.Rows(r)(&quot;Sal&quot;)
                                                                                                            end
                                                                                                            if
                                                                                                        next                             &#x27;    Buffer=Nothing                         &#x27;    Buffer=T3                             Cop=Buffer &#x27;===============================================================BB=============================================BEGIN                             if(Tcounter2=1)                                 x=T.NewRow
                                                                                                        For r As Integer = 0 To Buffer.Rows.Count-1                         &#x27;
                                                                                                            If (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3) Then
                                                                                                                if((SD1m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))OR (SD2m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD3m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD3p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD4m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD4p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))) then                                         x= Buffer.Rows(r)                                         T.ImportRow(x)                                         x=T.NewRow                                         Tcounter=Tcounter+1
                                                                                                            End If
                                                                                                        end if
                                                                                                    next
                                                                                                    if Tcounter&lt;2                                     ReassignFlag=1                                     Status=&quot;Total number of feasible transaction is less than 2 after filtering with +/-5 salary date in AA-BB-Gov I&quot;
                                                                                                    else                                     BSp=BasicSalary+(BasicSalary*20/100)                                     BSm=BasicSalary-(BasicSalary*20/100)                                     x=T2.NewRow
                                                                                                        for r as integer=0 to T.Rows.count-1                                         if(T.Rows(r)(&quot;Sal&quot;)&gt;=BSm AND T.Rows(r)(&quot;Sal&quot;)&lt;=BSp)                                             x= T.Rows(r)                                             T2.ImportRow(x)                                             x=T2.NewRow                                             T2counter=T2counter+1
                                                                                                            end
                                                                                                            if
                                                                                                        next
                                                                                                        If T2counter&lt;2 Then
                                                                                                            ReassignFlag=1                                         Status=&quot;Total number of feasible transaction is less than 2 after filtering with +/-5 salary date in AA-BB-Gov II&quot;
                                                                                                        End If
                                                                                                    else
                                                                                                        if T2counter=2                                         min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                                                                            For k As Integer = 0 To 1                                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                                                                                If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                                                                    min=T2.Rows(k)(&quot;Sal&quot;)                                                 minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                                                                                End If
                                                                                                                end
                                                                                                                if
                                                                                                            next                                         Avg= Sum / 2
                                                                                                            If Avg&lt;1.2*min Then
                                                                                                                test=3                 &#x27;
                                                                                                            End If
                                                                                                            For r As Integer = 0 To LL.Rows.Count-1                 &#x27;                                if(LL.Rows(r)(&quot;Sal&quot;)&gt;=Avg*0.65) then                 &#x27;
                                                                                                                If LLcheck=0 Then
                                                                                                                    &#x27;                                        LLcheck=1                 &#x27;                                        if(Math.Floor(LL.Rows(r)(&quot;Sal&quot;))&lt;=Avg) then                 &#x27;                                            Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                                                End If
                                                                                                            else if(LL.Rows(r)(&quot;Sal&quot;)&lt;=Avg*1.2) then                 &#x27;                                            Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                                            else                 &#x27;                                            ReassignFlag=1                 &#x27;                                            Status=&quot;Salary not identified sincee one transaction in last month is grater than selected salary&quot;                 &#x27;
                                                                                                                end
                                                                                                                if                 &#x27;
                                                                                                                else                  &#x27;                                        ReassignFlag=1                 &#x27;                                        Status=&quot;More than one transaction is grater then 65% of selected salary&quot;                 &#x27;
                                                                                                                    end
                                                                                                                    if                 &#x27;
                                                                                                                    end if                     &#x27;
                                                                                                                next                                             Salary=minimum                                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                                                                            else                 &#x27;
                                                                                                                For r As Integer = 0 To LL.Rows.Count-1                 &#x27;                                if(LL.Rows(r)(&quot;Sal&quot;)&gt;=min*0.65) then                 &#x27;
                                                                                                                    If LLcheck=0 Then
                                                                                                                        &#x27;                                        LLcheck=1                 &#x27;                                        if(Math.Floor(LL.Rows(r)(&quot;Sal&quot;))&lt;=min) then                 &#x27;                                            Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                                                    End If
                                                                                                                else if(LL.Rows(r)(&quot;Sal&quot;)&lt;=min*1.2) then                 &#x27;                                            Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                                                else                 &#x27;                                            ReassignFlag=1                 &#x27;                                            Status=&quot;Salary not identified sincee one transaction in last month is grater than selected salary&quot;                 &#x27;
                                                                                                                    end
                                                                                                                    if                 &#x27;
                                                                                                                    else                  &#x27;                                        ReassignFlag=1                 &#x27;                                        Status=&quot;More than one transaction is grater then 65% of selected salary&quot;                 &#x27;
                                                                                                                        end
                                                                                                                        if                 &#x27;
                                                                                                                        end if                     &#x27;
                                                                                                                    next                 test=3.1                                             Salary=minimum
                                                                                                                    end
                                                                                                                    if
                                                                                                                else                                         min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                                                                                    For k As Integer = 0 To 2                                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                                                                                        If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                                                                            min=T2.Rows(k)(&quot;Sal&quot;)                                                 minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                                                                                        End If
                                                                                                                        end
                                                                                                                        if
                                                                                                                    next                                         Avg= Sum / 3
                                                                                                                    If Avg&lt;1.2*min Then
                                                                                                                        test=3                 &#x27;
                                                                                                                    End If
                                                                                                                    For r As Integer = 0 To LL.Rows.Count-1                 &#x27;                                if(LL.Rows(r)(&quot;Sal&quot;)&gt;=Avg*0.65) then                 &#x27;
                                                                                                                        If LLcheck=0 Then
                                                                                                                            &#x27;                                        LLcheck=1                 &#x27;                                        if(Math.Floor(LL.Rows(r)(&quot;Sal&quot;))&lt;=Avg) then                 &#x27;                                            Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                                                        End If
                                                                                                                    else if(LL.Rows(r)(&quot;Sal&quot;)&lt;=Avg*1.2) then                 &#x27;                                            Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                                                    else                 &#x27;                                            ReassignFlag=1                 &#x27;                                            Status=&quot;Salary not identified sincee one transaction in last month is grater than selected salary&quot;                 &#x27;
                                                                                                                        end
                                                                                                                        if                 &#x27;
                                                                                                                        else                  &#x27;                                        ReassignFlag=1                 &#x27;                                        Status=&quot;More than one transaction is grater then 65% of selected salary&quot;                 &#x27;
                                                                                                                            end
                                                                                                                            if                 &#x27;
                                                                                                                            end if                     &#x27;
                                                                                                                        next                                             Salary=minimum                                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                                                                                    else                 &#x27;
                                                                                                                        For r As Integer = 0 To LL.Rows.Count-1                 &#x27;                                if(LL.Rows(r)(&quot;Sal&quot;)&gt;=min*0.65) then                 &#x27;
                                                                                                                            If LLcheck=0 Then
                                                                                                                                &#x27;                                        LLcheck=1                 &#x27;                                        if(Math.Floor(LL.Rows(r)(&quot;Sal&quot;))&lt;=min) then                 &#x27;                                            Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                                                            End If
                                                                                                                        else if(LL.Rows(r)(&quot;Sal&quot;)&lt;=min*1.2) then                 &#x27;                                            Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                                                        else                 &#x27;                                            ReassignFlag=1                 &#x27;                                            Status=&quot;Salary not identified since one transaction in last month is grater than selected salary&quot;                 &#x27;
                                                                                                                            end
                                                                                                                            if                 &#x27;
                                                                                                                            else                  &#x27;                                        ReassignFlag=1                 &#x27;                                        Status=&quot;More than one transaction is grater then 65% of selected salary&quot;                 &#x27;
                                                                                                                                end
                                                                                                                                if                 &#x27;
                                                                                                                                end if                     &#x27;
                                                                                                                            next                 test=3.1                                             Salary=minimum
                                                                                                                            end
                                                                                                                            if
                                                                                                                        end if
                                                                                                                        end
                                                                                                                        if &#x27;===============================================================BB=============================================END
                                                                                                                        else
                                                                                                                            Dim Count4 as integer=0
                                                                                                                            Dim Prev as integer =0
                                                                                                                            Dim Base as Decimal=0
                                                                                                                            for r as integer=0 to A1.Rows.Count-1
                                                                                                                                For j as integer=0 to T3.Rows.Count-1
                                                                                                                                    if A1.Rows(r)(&quot;Amount&quot;)=T3.Rows(j)(&quot;Sal&quot;)                                             Count4=Count4+1
                                                                                                                                        end
                                                                                                                                        if
                                                                                                                                    next
                                                                                                                                    if prev&lt;Count4                                         BasicSalary=A1.Rows(r)(&quot;Amount&quot;)                                         prev=Count4
                                                                                                                                        end
                                                                                                                                        if                                     Count4=0
                                                                                                                                        next                                                 x=T.NewRow
                                                                                                                                        For r As Integer = 0 To Buffer.Rows.Count-1                         &#x27;
                                                                                                                                            If (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3) Then
                                                                                                                                                if((SD1m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))OR (SD2m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD3m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD3p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD4m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD4p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))) then                                         x= Buffer.Rows(r)                                         T.ImportRow(x)                                         x=T.NewRow                                         Tcounter=Tcounter+1
                                                                                                                                            End If
                                                                                                                                        end if
                                                                                                                                    next
                                                                                                                                    if Tcounter&lt;2                                     ReassignFlag=1                                     Status=&quot;Total number of feasible transaction is less than 2 after filtering with +/-5 salary date in AA-BB-Gov III&quot;
                                                                                                                                    else                                     BSp=BasicSalary+(BasicSalary*20/100)                                     BSm=BasicSalary-(BasicSalary*20/100)                                     x=T2.NewRow
                                                                                                                                        for r as integer=0 to T.Rows.count-1                                         if(T.Rows(r)(&quot;Sal&quot;)&gt;=BSm AND T.Rows(r)(&quot;Sal&quot;)&lt;=BSp)                                             x= T.Rows(r)                                             T2.ImportRow(x)                                             x=T2.NewRow                                             T2counter=T2counter+1
                                                                                                                                            end
                                                                                                                                            if
                                                                                                                                        next
                                                                                                                                        If T2counter&lt;2 Then
                                                                                                                                            ReassignFlag=1                                         Status=&quot;Total number of feasible transaction is less than 2 after filtering BSm&lt;= SAL &lt;=BSp in AA-BB-Gov IV&quot;
                                                                                                                                        End If
                                                                                                                                    else
                                                                                                                                        if T2counter=2                                         min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                                                                                                            For k As Integer = 0 To 1                                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                                                                                                                If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                                                                                                    min=T2.Rows(k)(&quot;Sal&quot;)                                                 minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                                                                                                                End If
                                                                                                                                                end
                                                                                                                                                if
                                                                                                                                            next                                         Avg= Sum / 2
                                                                                                                                            If Avg&lt;1.2*min Then
                                                                                                                                                test=4                 &#x27;
                                                                                                                                            End If
                                                                                                                                            For r As Integer = 0 To LL.Rows.Count-1                 &#x27;                                if(LL.Rows(r)(&quot;Sal&quot;)&gt;=Avg*0.65) then                 &#x27;
                                                                                                                                                If LLcheck=0 Then
                                                                                                                                                    &#x27;                                        LLcheck=1                 &#x27;                                        if(Math.Floor(LL.Rows(r)(&quot;Sal&quot;))&lt;=Avg) then                 &#x27;                                            Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                                                                                End If
                                                                                                                                            else if(LL.Rows(r)(&quot;Sal&quot;)&lt;=Avg*1.2) then                 &#x27;                                            Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                                                                            else                 &#x27;                                            ReassignFlag=1                 &#x27;                                            Status=&quot;Salary not identified sincee one transaction in last month is grater than selected salary&quot;                 &#x27;
                                                                                                                                                end
                                                                                                                                                if                 &#x27;
                                                                                                                                                else                  &#x27;                                        ReassignFlag=1                 &#x27;                                        Status=&quot;More than one transaction is grater then 65% of selected salary&quot;                 &#x27;
                                                                                                                                                    end
                                                                                                                                                    if                 &#x27;
                                                                                                                                                    end if                     &#x27;
                                                                                                                                                next                                             Salary=minimum                                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                                                                                                            else                 &#x27;
                                                                                                                                                For r As Integer = 0 To LL.Rows.Count-1                 &#x27;                                if(LL.Rows(r)(&quot;Sal&quot;)&gt;=min*0.65) then                 &#x27;
                                                                                                                                                    If LLcheck=0 Then
                                                                                                                                                        &#x27;                                        LLcheck=1                 &#x27;                                        if(Math.Floor(LL.Rows(r)(&quot;Sal&quot;))&lt;=min) then                 &#x27;                                            Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                                                                                    End If
                                                                                                                                                else if(LL.Rows(r)(&quot;Sal&quot;)&lt;=min*1.2) then                 &#x27;                                            Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                                                                                else                 &#x27;                                            ReassignFlag=1                 &#x27;                                            Status=&quot;Salary not identified sincee one transaction in last month is grater than selected salary&quot;                 &#x27;
                                                                                                                                                    end
                                                                                                                                                    if                 &#x27;
                                                                                                                                                    else                  &#x27;                                        ReassignFlag=1                 &#x27;                                        Status=&quot;More than one transaction is grater then 65% of selected salary&quot;                 &#x27;
                                                                                                                                                        end
                                                                                                                                                        if                 &#x27;
                                                                                                                                                        end if                     &#x27;
                                                                                                                                                    next                 test=4.1                                             Salary=minimum
                                                                                                                                                    end
                                                                                                                                                    if
                                                                                                                                                else                                          min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                                                                                                                    For k As Integer = 0 To 2                                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                                                                                                                        If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                                                                                                            min=T2.Rows(k)(&quot;Sal&quot;)                                                 minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                                                                                                                        End If
                                                                                                                                                        end
                                                                                                                                                        if
                                                                                                                                                    next                                         Avg= Sum / 3
                                                                                                                                                    If Avg&lt;1.2*min Then
                                                                                                                                                        test=4                 &#x27;
                                                                                                                                                    End If
                                                                                                                                                    For r As Integer = 0 To LL.Rows.Count-1                 &#x27;                                if(LL.Rows(r)(&quot;Sal&quot;)&gt;=Avg*0.65) then                 &#x27;
                                                                                                                                                        If LLcheck=0 Then
                                                                                                                                                            &#x27;                                        LLcheck=1                 &#x27;                                        if(Math.Floor(LL.Rows(r)(&quot;Sal&quot;))&lt;=Avg) then                 &#x27;                                            Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                                                                                        End If
                                                                                                                                                    else if(LL.Rows(r)(&quot;Sal&quot;)&lt;=Avg*1.2) then                 &#x27;                                            Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                                                                                    else                 &#x27;                                            ReassignFlag=1                 &#x27;                                            Status=&quot;Salary not identified sincee one transaction in last month is grater than selected salary&quot;                 &#x27;
                                                                                                                                                        end
                                                                                                                                                        if                 &#x27;
                                                                                                                                                        else                  &#x27;                                        ReassignFlag=1                 &#x27;                                        Status=&quot;More than one transaction is grater then 65% of selected salary&quot;                 &#x27;
                                                                                                                                                            end
                                                                                                                                                            if                 &#x27;
                                                                                                                                                            end if                     &#x27;
                                                                                                                                                        next                                             Salary=minimum                                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                                                                                                                    else                 &#x27;
                                                                                                                                                        For r As Integer = 0 To LL.Rows.Count-1                 &#x27;                                if(LL.Rows(r)(&quot;Sal&quot;)&gt;=min*0.65) then                 &#x27;
                                                                                                                                                            If LLcheck=0 Then
                                                                                                                                                                &#x27;                                        LLcheck=1                 &#x27;                                        if(Math.Floor(LL.Rows(r)(&quot;Sal&quot;))&lt;=min) then                 &#x27;                                            Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                                                                                            End If
                                                                                                                                                        else if(LL.Rows(r)(&quot;Sal&quot;)&lt;=min*1.2) then                 &#x27;                                            Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                                                                                        else                 &#x27;                                            ReassignFlag=1                 &#x27;                                            Status=&quot;Salary not identified sincee one transaction in last month is grater than selected salary&quot;                 &#x27;
                                                                                                                                                            end
                                                                                                                                                            if                 &#x27;
                                                                                                                                                            else                  &#x27;                                        ReassignFlag=1                 &#x27;                                        Status=&quot;More than one transaction is grater then 65% of selected salary&quot;                 &#x27;
                                                                                                                                                                end
                                                                                                                                                                if                 &#x27;
                                                                                                                                                                end if                     &#x27;
                                                                                                                                                            next                 test=4.1                                             Salary=minimum
                                                                                                                                                            end
                                                                                                                                                            if
                                                                                                                                                        end if
                                                                                                                                                        end
                                                                                                                                                        if
                                                                                                                                                        end
                                                                                                                                                        if
                                                                                                                                                        end
                                                                                                                                                        if
                                                                                                                                                        end
                                                                                                                                                        if                     &#x27;
                                                                                                                                                            end
                                                                                                                                                            if &#x27;=============================================================AA===================================================    END
                                                                                                                                                            else                      ReassignFlag=1                     Status=&quot;No transaction available in 2nd last month&quot;
                                                                                                                                                                end
                                                                                                                                                                if
                                                                                                                                                            else                  Status=&quot;More than one transaction in last month&quot;                 ReassignFlag=1
                                                                                                                                                                end
                                                                                                                                                                if
                                                                                                                                                            else             Status=&quot;No transaction in +/- 5 of last salary date&quot;             ReassignFlag=1
                                                                                                                                                                end
                                                                                                                                                                if
                                                                                                                                                                end
                                                                                                                                                                if
                                                                                                                                                            else      Status=&quot;Total number of feasible transaction is less than 3&quot;     ReassignFlag=1
                                                                                                                                                                end
                                                                                                                                                                if D0=D1 A0=A1
                                                                                                                                                                catch e as Exception         er=e.ToString         ReassignFlag=1         Status=&quot;Code Error:&quot;+e.ToString
                                                                                                                                                                    end
                                                                                                                                                                    try"
                            data-title="UWCA_MRCC_CTF_V1.0 / Salary code / Salary Calculation(new)7">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>UWCA_MRCC_CTF_V1.0</td>
                <td>Salary code</td>
                <td>Salary Calculation(new)8</td>
                <td>visualbasic</td>
                <td>944</td>
                <!--<td style="font-family: monospace;">402cbc317006b6b3d6e810df681f7156b2c15b6e5e31c1b75f2f0b4d60a885ed</td>-->
                <td>—</td>
                <!--<td>try     Dim description as string     Dim x As DataRow = D1.NewRow     Dim Dflag as integer =0     Dim precount as integer =0     Dim Amount as integer =0     Dim Avg as Decimal=0     Dim Sum as integer =0     Dim skip as integer =0     Dim min as integer =0     Dim count as integer =0     Dim Av as...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="try
    Dim description as string
    Dim x As DataRow = D1.NewRow
    Dim Dflag as integer =0
    Dim precount as integer =0
    Dim Amount as integer =0
    Dim Avg as Decimal=0
    Dim Sum as integer =0
    Dim skip as integer =0
    Dim min as integer =0
    Dim count as integer =0
    Dim Av as integer =0
    Dim mi as integer =0
    Dim minim as string min=0 count=0 minim=&quot;&quot;
    if c1.Rows.Count&gt;2 then
        For r As Integer = 0 To c1.Rows.Count-1         description=c1.Rows(r)(&quot;Description&quot;)         Dflag=0
            for i as integer=0 To D1.Rows.Count-1
                If D1.Rows(i)(&quot;Description&quot;)=description Then
                    Dflag=1                 D1.Rows(i)(&quot;Count&quot;)=D1.Rows(i)(&quot;Count&quot;)+1
                End If
                end
                if
            next
            If Dflag=0 Then
                x(&quot;Description&quot;) = description             x(&quot;Count&quot;)=1             D1.Rows.Add(x)             x= D1.NewRow
            End If
            end
            if
        Next
        For r As Integer = 0 To D1.Rows.Count-1         description=D1.Rows(r)(&quot;Description&quot;)         CollOut=Nothing         CollOut=c1.Clone
            For Each parentRow As DataRow In c1.Select(&quot;Description=&#x27;&quot;+description+&quot;&#x27;&quot;)             x = CollOut.NewRow
                For Each c As DataColumn In x.Table.Columns                     x(c.ColumnName) = parentRow(c.ColumnName)
                Next             CollOut.Rows.Add(x)
            Next         count=CollOut.Rows.Count
            If count&gt;precount Then
                Buffer=Nothing             Buffer = CollOut.Clone             Buffer=CollOut             precount=count             ReassignFlag=0
            End If
        else
            if count = Precount             ReassignFlag=1             Status=&quot;Salary cannot be identified since there mode are equal&quot;
                end
                if
            next &#x27;+++++++++++++++++++++++++
            If Govt= False AND EF= False Then
                &#x27;+++++++++++++++++++++++++
            End If
            If Buffer.Rows.Count &gt;2 Then
                ReassignFlag=0
            End If
            if ReassignFlag=0             ReassignFlag=1
                For r As Integer = 0 To Buffer.Rows.Count-1
                    If Buffer.Rows(r)(&quot;Days&quot;)&lt;=TimePeriod Then
                        ReassignFlag=0
                    End If
                    exit
                    for
                    end
                    if
                next
                end
                if
                if ReassignFlag=0             Status=&quot;&quot;
                    For r As Integer = 0 To Buffer.Rows.Count-1                 Amount=Buffer.Rows(r)(&quot;Sal&quot;)                 Dflag=0
                        for i as integer=0 To A1.Rows.Count-1
                            If A1.Rows(i)(&quot;Amount&quot;)=Amount Then
                                Dflag=1                         A1.Rows(i)(&quot;Count&quot;)=A1.Rows(i)(&quot;Count&quot;)+1
                            End If
                            end
                            if
                        next
                        If Dflag=0 Then
                            x= A1.NewRow                     x(&quot;Amount&quot;) = Amount                     x(&quot;Count&quot;)=1                     x(&quot;Salary&quot;)=Buffer.Rows(r)(&quot;Amount&quot;)                     A1.Rows.Add(x)
                        End If
                        end
                        if
                    Next             min=Buffer.Rows(0)(&quot;Sal&quot;)+1
                    For k As Integer = 0 To 2                 Sum=Sum+Buffer.Rows(k)(&quot;Sal&quot;)
                        If min&gt;Buffer.Rows(k)(&quot;Sal&quot;) Then
                            min=Buffer.Rows(k)(&quot;Sal&quot;)                     minimum=Buffer.Rows(k)(&quot;Amount&quot;)
                        End If
                        end
                        if
                        if k=1                     Av=Sum/2                     mi=min                     minim=minimum
                            end
                            if
                        next             Avg= Sum / 3
                        If Avg&lt;1.2*min Then
                            test=1 Cop=A1                 Salary=minimum                 Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                        End If
                    else
                        If Av&lt;1.2*mi Then
                            minimum=minim                 Salary=minimum                 Other=Replace((Av-mi),&quot;.&quot;,&quot;,&quot;)
                        End If
                    else
                        For r As Integer = 0 To A1.Rows.Count-1
                            If (A1.Rows(r)(&quot;Count&quot;)*100/(Buffer.Rows.Count))&gt;60 Then
                                Salary=A1.Rows(r)(&quot;Salary&quot;)                         skip=1
                            End If
                            end
                            if
                        next
                        If skip=0 Then
                            &#x27;vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvPage2vvvvvvvvvvvvvvvvvvvvvvvvvvv
                        End If
                        if Govt=True then
                            Dim SD1p,SD1m,SD2p,SD2m,SD3p,SD3m as date
                            Dim Sflag as integer =0
                            Dim BasicSalary as Integer =0
                            Dim T as DataTable =Buffer.Clone
                            Dim T2 as DataTable=Buffer.Clone
                            Dim TX as DataTable=Buffer.Clone
                            Dim Tcounter as integer =0
                            Dim T2counter as integer =0
                            Dim BSp,BSm as Decimal                          Sum=0                         minimum=0                         Salary=0                         Other=0                         min=0                         SD1p=SD1.AddDays(5)                         SD1m=SD1.AddDays(-5)                         SD2p=SD2.AddDays(5)                         SD2m=SD2.AddDays(-5)                         SD3p=SD3.AddDays(5)                         SD3m=SD3.AddDays(-5)                 &#x27;        T=Buffer.Clone
                            For r As Integer = 0 To Buffer.Rows.Count-1 &#x27;
                                If (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3) Then
                                    if((SD1m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))OR (SD2m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD3m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD3p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))) then                                 x= Buffer.Rows(r)                                 TX.ImportRow(x)                                 x=TX.NewRow
                                End If
                            end if
                        next                         Buffer=TX
                        For r As Integer = 0 To Buffer.Rows.Count-1                 &#x27;
                            if (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1) then
                                If (SD1m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) Then
                                    Sflag=Sflag+1                                 BasicSalary=Buffer.Rows(r)(&quot;Sal&quot;)                                 &#x27;AM=BasicSalary
                                End If
                                end
                                if
                            Next                         &#x27;AM=BasicSalary
                            If Sflag=1 Then
                                x=T.NewRow
                            End If
                            For r As Integer = 0 To Buffer.Rows.Count-1                 &#x27;
                                If (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3) Then
                                    if((SD1m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))OR (SD2m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD3m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD3p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))) then                                     x= Buffer.Rows(r)                                     T.ImportRow(x)                                     x=T.NewRow                                     Tcounter=Tcounter+1
                                End If
                            end if
                        next
                        if Tcounter&lt;3                                 ReassignFlag=1                                 Status=&quot;Total number of feasible transaction is less than 3 after filtering with +/-5 salary date I&quot;
                        else                                 BSp=BasicSalary+(BasicSalary*20/100)                                 BSm=BasicSalary-(BasicSalary*20/100)                                 x=T2.NewRow
                            for r as integer=0 to T.Rows.count-1                                     if(T.Rows(r)(&quot;Sal&quot;)&gt;=BSm AND T.Rows(r)(&quot;Sal&quot;)&lt;=BSp)                                         x= T.Rows(r)                                         T2.ImportRow(x)                                         x=T2.NewRow                                         T2counter=T2counter+1
                                end
                                if
                            next
                            If T2counter&lt;2 Then
                                ReassignFlag=1                                     Status=&quot;Total number of feasible transaction is less than 2 after filtering BSm &lt;= Salary &lt;=BSp&quot;
                            End If
                        else
                            if T2counter=2                                     min=T2.Rows(0)(&quot;Sal&quot;)+1
                                For k As Integer = 0 To 1                                         Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                    If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                        min=T2.Rows(k)(&quot;Sal&quot;)                                             minimum=T2.Rows(k)(&quot;Amount&quot;)
                                    End If
                                    end
                                    if
                                next                                     Avg= Sum / 2
                                If Avg&lt;1.2*min Then
                                    test=2                                         Salary=minimum                                         Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                End If
                            else                                         Salary=minimum                                         Other=0
                                end
                                if
                            else                                     min=T2.Rows(0)(&quot;Sal&quot;)+1
                                For k As Integer = 0 To 2                                         Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                    If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                        min=T2.Rows(k)(&quot;Sal&quot;)                                             minimum=T2.Rows(k)(&quot;Amount&quot;)
                                    End If
                                    end
                                    if
                                next                                     Avg= Sum / 3
                                If Avg&lt;1.2*min Then
                                    test=2                                         Salary=minimum                                         Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                End If
                            else                                         Salary=minimum                                         Other=0
                                end
                                if
                            end if
                            end
                            if                     &#x27;    test=T                     &#x27;    testT=Tcounter
                            else &#x27;=============================================================AA===================================================BEGIN
                                Dim T3 as DataTable=Buffer.Clone
                                Dim Tcounter2 as integer=0
                                for r as integer =0 to Buffer.Rows.Count-1                                 if(Buffer.Rows(r)(&quot;Sal&quot;)&gt;=LastApproved) then                                     x=T3.NewRow                                     x=Buffer.Rows(r)                                     T3.ImportRow(x)                                     Tcounter2=Tcounter2+1                                     BasicSalary=Buffer.Rows(r)(&quot;Sal&quot;)
                                    end
                                    if
                                next                             &#x27;    Buffer=Nothing                         &#x27;    Buffer=T3 Cop=Buffer &#x27;===============================================================BB=============================================BEGIN                             if(Tcounter2=1)                                 x=T.NewRow
                                For r As Integer = 0 To Buffer.Rows.Count-1                 &#x27;
                                    If (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3) Then
                                        if((SD1m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))OR (SD2m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD3m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD3p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))) then                                         x= Buffer.Rows(r)                                         T.ImportRow(x)                                         x=T.NewRow                                         Tcounter=Tcounter+1
                                    End If
                                end if
                            next
                            if Tcounter&lt;3                                     ReassignFlag=1                                     Status=&quot;Total number of feasible transaction is less than 3 after filtering with +/-5 salary date in AA-BB-Gov I&quot;
                            else                                     BSp=BasicSalary+(BasicSalary*20/100)                                     BSm=BasicSalary-(BasicSalary*20/100)                                     x=T2.NewRow
                                for r as integer=0 to T.Rows.count-1                                         if(T.Rows(r)(&quot;Sal&quot;)&gt;=BSm AND T.Rows(r)(&quot;Sal&quot;)&lt;=BSp)                                             x= T.Rows(r)                                             T2.ImportRow(x)                                             x=T2.NewRow                                             T2counter=T2counter+1
                                    end
                                    if
                                next
                                If T2counter&lt;2 Then
                                    ReassignFlag=1                                         Status=&quot;Total number of feasible transaction is less than 2 after filtering with +/-5 salary date in AA-BB-Gov II&quot;
                                End If
                            else
                                if T2counter=2                                         min=T2.Rows(0)(&quot;Sal&quot;)+1
                                    For k As Integer = 0 To 1                                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                        If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                            min=T2.Rows(k)(&quot;Sal&quot;)                                                 minimum=T2.Rows(k)(&quot;Amount&quot;)
                                        End If
                                        end
                                        if
                                    next                                         Avg= Sum / 2
                                    If Avg&lt;1.2*min Then
                                        test=3                                             Salary=minimum                                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                    End If
                                else                                             Salary=minimum                                             Other=0
                                    end
                                    if
                                else                                         min=T2.Rows(0)(&quot;Sal&quot;)+1
                                    For k As Integer = 0 To 2                                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                        If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                            min=T2.Rows(k)(&quot;Sal&quot;)                                                 minimum=T2.Rows(k)(&quot;Amount&quot;)
                                        End If
                                        end
                                        if
                                    next                                         Avg= Sum / 3
                                    If Avg&lt;1.2*min Then
                                        test=3                                             Salary=minimum                                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                    End If
                                else                                             Salary=minimum                                             Other=0
                                    end
                                    if
                                end if
                                end
                                if &#x27;===============================================================BB=============================================END
                                else
                                    Dim Count4 as integer=0
                                    Dim Prev as integer =0
                                    Dim Base as Decimal=0
                                    for r as integer=0 to A1.Rows.Count-1
                                        For j as integer=0 to T3.Rows.Count-1
                                            if A1.Rows(r)(&quot;Amount&quot;)=T3.Rows(j)(&quot;Sal&quot;)                                             Count4=Count4+1
                                                end
                                                if
                                            next
                                            if prev&lt;Count4                                         BasicSalary=A1.Rows(r)(&quot;Amount&quot;)                                         prev=Count4
                                                end
                                                if                                     Count4=0
                                                next                                                 x=T.NewRow
                                                For r As Integer = 0 To Buffer.Rows.Count-1                 &#x27;
                                                    If (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3) Then
                                                        if((SD1m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))OR (SD2m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD3m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD3p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))) then                                         x= Buffer.Rows(r)                                         T.ImportRow(x)                                         x=T.NewRow                                         Tcounter=Tcounter+1
                                                    End If
                                                end if
                                            next
                                            if Tcounter&lt;3                                     ReassignFlag=1                                     Status=&quot;Total number of feasible transaction is less than 3 after filtering with +/-5 salary date in AA-BB-Gov III&quot;
                                            else                                     BSp=BasicSalary+(BasicSalary*20/100)                                     BSm=BasicSalary-(BasicSalary*20/100)                                     x=T2.NewRow
                                                for r as integer=0 to T.Rows.count-1                                         if(T.Rows(r)(&quot;Sal&quot;)&gt;=BSm AND T.Rows(r)(&quot;Sal&quot;)&lt;=BSp)                                             x= T.Rows(r)                                             T2.ImportRow(x)                                             x=T2.NewRow                                             T2counter=T2counter+1
                                                    end
                                                    if
                                                next
                                                If T2counter&lt;2 Then
                                                    ReassignFlag=1                                         Status=&quot;Total number of feasible transaction is less than 2 after filtering BSm&lt;= SAL &lt;=BSp in AA-BB-Gov IV&quot;
                                                End If
                                            else
                                                if T2counter=2                                         min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                    For k As Integer = 0 To 1                                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                        If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                            min=T2.Rows(k)(&quot;Sal&quot;)                                                 minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                        End If
                                                        end
                                                        if
                                                    next                                         Avg= Sum / 2
                                                    If Avg&lt;1.2*min Then
                                                        test=4                                             Salary=minimum                                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                    End If
                                                else                                             Salary=minimum                                             Other=0
                                                    end
                                                    if
                                                else                                          min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                    For k As Integer = 0 To 2                                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                        If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                            min=T2.Rows(k)(&quot;Sal&quot;)                                                 minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                        End If
                                                        end
                                                        if
                                                    next                                         Avg= Sum / 3
                                                    If Avg&lt;1.2*min Then
                                                        test=4                                             Salary=minimum                                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                    End If
                                                else                                             Salary=minimum                                             Other=0
                                                    end
                                                    if
                                                end if
                                                end
                                                if
                                                end
                                                if  &#x27;=============================================================AA===================================================    END
                                                    end
                                                    if
                                                else &#x27;==========================================================================B===================================BEGIN
                                                    Dim Sflag as integer =0
                                                    Dim BasicSalary as Integer =0
                                                    Dim T as DataTable =Buffer.Clone
                                                    Dim T2 as DataTable=Buffer.Clone
                                                    Dim Tcounter as integer =0
                                                    Dim T2counter as integer =0
                                                    Dim BSp,BSm as Decimal
                                                    Dim BaseDays as Decimal =0
                                                    Dim Dayz as decimal=0                         Sum=0                         minimum=0                         Salary=0                         Sflag=0                         Other=0                         min=0
                                                    For r As Integer = 0 To Buffer.Rows.Count-1
                                                        If (Buffer.Rows(r)(&quot;Days&quot;)&lt;=TimePeriod) Then
                                                            Sflag=Sflag+1                                 BasicSalary=Buffer.Rows(r)(&quot;Sal&quot;)                                 x=T.NewRow                                 x= Buffer.Rows(r)                                 T.ImportRow(x)                                 Tcounter=1                                 BaseDays=Buffer.Rows(r)(&quot;Days&quot;)
                                                        End If
                                                        end
                                                        if
                                                    Next &#x27;=======================================================================================BB=================================================BEGIN
                                                    If Sflag=1 Then
                                                        x=T.NewRow
                                                    End If
                                                    For r As Integer = 0 To Buffer.Rows.Count-1                                     Dayz=Buffer.Rows(r)(&quot;Days&quot;)                                 Dayz=Dayz-BaseDays
                                                        If ((Dayz&gt;=25 AND Dayz&lt;=35) OR (Dayz&gt;=55 AND Dayz&lt;=65) ) Then
                                                            x= Buffer.Rows(r)                                     T.ImportRow(x)                                     x=T.NewRow                                     Tcounter=Tcounter+1
                                                        End If
                                                    end if
                                                next                             &#x27;testT=Tcounter /checked
                                                if Tcounter&lt;3                                 ReassignFlag=1                                 Status=&quot;Total number of feasible transaction is less than 3 after filtering with 25-35 and 55 to 65 in AA-BB-nonGov II&quot;
                                                else                                 BSp=BasicSalary+(BasicSalary*20/100)                                 BSm=BasicSalary-(BasicSalary*20/100)                                 x=T2.NewRow
                                                    for r as integer=0 to T.Rows.count-1                                     if(T.Rows(r)(&quot;Sal&quot;)&gt;=BSm AND T.Rows(r)(&quot;Sal&quot;)&lt;=BSp)                                         x= T.Rows(r)                                         T2.ImportRow(x)                                         x=T2.NewRow                                         T2counter=T2counter+1
                                                        end
                                                        if
                                                    next
                                                    If T2counter&lt;2 Then
                                                        ReassignFlag=1                                     Status=&quot;Total number of feasible transaction is less than 2 after filtering BSm&lt;=SAL&lt;=BSp BB-non Gov II&quot;
                                                    End If
                                                else
                                                    if T2counter=2
                                                        For k As Integer = 0 To 1                                         Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                            If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                min=T2.Rows(k)(&quot;Sal&quot;)                                             minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                            End If
                                                            end
                                                            if
                                                        next                                      Avg= Sum / 2
                                                        If Avg&lt;1.2*min Then
                                                            Salary=minimum                                         Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                        End If
                                                    else                                          Salary=minimum                                         Other=0
                                                        end
                                                        if
                                                    else                                       min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                        For k As Integer = 0 To 2                                         Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                            If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                min=T2.Rows(k)(&quot;Sal&quot;)                                             minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                            End If
                                                            end
                                                            if
                                                        next                                      Avg= Sum / 3
                                                        If Avg&lt;1.2*min Then
                                                            Salary=minimum                                         Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                        End If
                                                    else                                          Salary=minimum                                         Other=0
                                                        end
                                                        if
                                                    end if
                                                    end
                                                    if                         &#x27;test=T2                         &#x27;testT=Tcounter
                                                    else &#x27;++++++++++++++++++++++AA+++++++++ &#x27;=============================================================AA===================================================BEGIN
                                                        Dim T3 as DataTable=Buffer.Clone
                                                        Dim Tcounter2 as integer=0
                                                        for r as integer =0 to Buffer.Rows.Count-1                                 if(Buffer.Rows(r)(&quot;Sal&quot;)&gt;=LastApproved) then                                     x=T3.NewRow                                     x=Buffer.Rows(r)                                     T3.ImportRow(x)                                     Tcounter2=Tcounter2+1                                     BasicSalary=Buffer.Rows(r)(&quot;Sal&quot;)
                                                            end
                                                            if
                                                        next                                 Buffer=Nothing                             Buffer=T3 &#x27;===============================================================BB=============================================BEGIN                             if(Tcounter2=1)                                 x=T.NewRow
                                                        For r As Integer = 0 To Buffer.Rows.Count-1                                         Dayz=Buffer.Rows(r)(&quot;Days&quot;)                                     Dayz=Dayz-BaseDays
                                                            If ((Dayz&gt;=25 AND Dayz&lt;=35) OR (Dayz&gt;=55 AND Dayz&lt;=65) ) Then
                                                                x= Buffer.Rows(r)                                         T.ImportRow(x)                                         x=T.NewRow                                         Tcounter=Tcounter+1
                                                            End If
                                                        end if
                                                    next                                 &#x27;testT=Tcounter /checked
                                                    if Tcounter&lt;3                                     ReassignFlag=1                                     Status=&quot;Total number of feasible transaction is less than 3 after filtering with 25-35 and 55 to 65 in AA-BB-nonGov III&quot;
                                                    else                                     BSp=BasicSalary+(BasicSalary*20/100)                                     BSm=BasicSalary-(BasicSalary*20/100)                                     x=T2.NewRow
                                                        for r as integer=0 to T.Rows.count-1                                         if(T.Rows(r)(&quot;Sal&quot;)&gt;=BSm AND T.Rows(r)(&quot;Sal&quot;)&lt;=BSp)                                             x= T.Rows(r)                                             T2.ImportRow(x)                                             x=T2.NewRow                                             T2counter=T2counter+1
                                                            end
                                                            if
                                                        next
                                                        If T2counter&lt;2 Then
                                                            ReassignFlag=1                                         Status=&quot;Total number of feasible transaction is less than 2 after filtering BSm&lt;SAL&lt;BSp in AA-BB-nonGov IV&quot;
                                                        End If
                                                    else
                                                        if T2counter=2                                         min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                            For k As Integer = 0 To 1                                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                                If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                    min=T2.Rows(k)(&quot;Sal&quot;)                                                 minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                                End If
                                                                end
                                                                if
                                                            next                                          Avg= Sum / 2
                                                            If Avg&lt;1.2*min Then
                                                                Salary=minimum                                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                            End If
                                                        else                                              Salary=minimum                                             Other=0
                                                            end
                                                            if
                                                        else                                         min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                            For k As Integer = 0 To 2                                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                                If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                    min=T2.Rows(k)(&quot;Sal&quot;)                                                 minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                                End If
                                                                end
                                                                if
                                                            next                                          Avg= Sum / 3
                                                            If Avg&lt;1.2*min Then
                                                                Salary=minimum                                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                            End If
                                                        else                                              Salary=minimum                                             Other=0
                                                            end
                                                            if
                                                        end if
                                                        end
                                                        if  &#x27;===============================================================BB=============================================END
                                                        else
                                                            Dim Count4 as integer=0
                                                            Dim Prev as integer =0
                                                            Dim Base as Decimal=0
                                                            for r as integer=0 to A1.Rows.Count-1
                                                                For j as integer=0 to T3.Rows.Count-1
                                                                    if A1.Rows(r)(&quot;Amount&quot;)=T3.Rows(j)(&quot;Sal&quot;)                                             Count4=Count4+1
                                                                        end
                                                                        if
                                                                    next
                                                                    if prev&lt;Count4                                         BasicSalary=A1.Rows(r)(&quot;Amount&quot;)
                                                                        end
                                                                        if
                                                                    next &#x27;============================================================BB=============================================BEGIN                                             x=T.NewRow
                                                                    For r As Integer = 0 To Buffer.Rows.Count-1                                         Dayz=Buffer.Rows(r)(&quot;Days&quot;)                                     Dayz=Dayz-BaseDays
                                                                        If ((Dayz&gt;=25 AND Dayz&lt;=35) OR (Dayz&gt;=55 AND Dayz&lt;=65) ) Then
                                                                            x= Buffer.Rows(r)                                         T.ImportRow(x)                                         x=T.NewRow                                         Tcounter=Tcounter+1
                                                                        End If
                                                                    end if
                                                                next                                 &#x27;testT=Tcounter /checked
                                                                if Tcounter&lt;3                                     ReassignFlag=1                                     Status=&quot;Total number of feasible transaction is less than 3 after filtering 25-35 and 55-65 in AA-BB-nonGov V&quot;
                                                                else                                     BSp=BasicSalary+(BasicSalary*20/100)                                     BSm=BasicSalary-(BasicSalary*20/100)                                     x=T2.NewRow
                                                                    for r as integer=0 to T.Rows.count-1                                         if(T.Rows(r)(&quot;Sal&quot;)&gt;=BSm AND T.Rows(r)(&quot;Sal&quot;)&lt;=BSp)                                             x= T.Rows(r)                                             T2.ImportRow(x)                                             x=T2.NewRow                                             T2counter=T2counter+1
                                                                        end
                                                                        if
                                                                    next
                                                                    If T2counter&lt;2 Then
                                                                        ReassignFlag=1                                         Status=&quot;Total number of feasible transaction is less than 2 after filtering BSp&lt;=SAL&lt;=BSp in AA-BB-nonGov VI&quot;
                                                                    End If
                                                                else
                                                                    if T2counter=2                                         min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                                        For k As Integer = 0 To 1                                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                                            If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                                min=T2.Rows(k)(&quot;Sal&quot;)                                                 minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                                            End If
                                                                            end
                                                                            if
                                                                        next                                          Avg= Sum / 2
                                                                        If Avg&lt;1.2*min Then
                                                                            Salary=minimum                                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                                        End If
                                                                    else                                              Salary=minimum                                             Other=0
                                                                        end
                                                                        if
                                                                    else                                          min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                                        For k As Integer = 0 To 2                                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                                            If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                                min=T2.Rows(k)(&quot;Sal&quot;)                                                 minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                                            End If
                                                                            end
                                                                            if
                                                                        next                                          Avg= Sum / 3
                                                                        If Avg&lt;1.2*min Then
                                                                            Salary=minimum                                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                                        End If
                                                                    else                                              Salary=minimum                                             Other=0
                                                                        end
                                                                        if
                                                                    end if
                                                                    end
                                                                    if &#x27;===========================================================BB======================================================END
                                                                        end
                                                                        if &#x27;=============================================================AA===================================================    END
                                                                            end
                                                                            if &#x27;==============================================================BB============================================END                      &#x27;==============================================================B=============================================END
                                                                                end
                                                                                if &#x27;^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^Page2^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                                                                    end
                                                                                    if
                                                                                    end
                                                                                    if
                                                                                else             Status=&quot;Salary cannot be identified since there is no transaction in the past &quot;+TimePeriod.ToString+&quot; days&quot;             ReassignFlag=1
                                                                                    end
                                                                                    if
                                                                                else         ReassignFlag=1         Status=&quot;Total number of feasible transaction is less than 3&quot;
                                                                                    end
                                                                                    if
                                                                                else
                                                                                    Dim SD1p,SD1m,SD2p,SD2m,SD3p,SD3m,SD4p,SD4m as date
                                                                                    Dim Sflag as integer =0
                                                                                    Dim Salflag as integer =0
                                                                                    Dim Lflag as integer =0
                                                                                    Dim L2flag as integer =0
                                                                                    Dim LLcheck as integer =0
                                                                                    Dim BasicSalary as Integer =0
                                                                                    Dim T as DataTable =Buffer.Clone
                                                                                    Dim T2 as DataTable=Buffer.Clone
                                                                                    Dim TX as DataTable=Buffer.Clone
                                                                                    Dim LL as DataTable=Buffer.Clone
                                                                                    Dim LL1 as DataTable=Buffer.Clone
                                                                                    Dim L2 as DataTable=Buffer.Clone
                                                                                    Dim L21 as DataTable=Buffer.Clone
                                                                                    Dim L3 as DataTable=Buffer.Clone
                                                                                    Dim Tcounter as integer =0
                                                                                    Dim L3counter as integer =0
                                                                                    Dim T2counter as integer =0
                                                                                    Dim BSp,BSm as Decimal          Sum=0         minimum=0         Salary=0         Other=0         min=0         SD1p=SD1.AddDays(5)         SD1m=SD1.AddDays(-5)         SD2p=SD2.AddDays(5)         SD2m=SD2.AddDays(-5)         SD3p=SD3.AddDays(5)         SD3m=SD3.AddDays(-5)         SD4p=SD4.AddDays(5)         SD4m=SD4.AddDays(-5)         &#x27;        T=Buffer.Clone
                                                                                    For r As Integer = 0 To Buffer.Rows.Count-1         &#x27;
                                                                                        If (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3) Then
                                                                                            if((SD1m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))OR (SD2m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD3m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD3p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD4m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD4p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))) then                 x= Buffer.Rows(r)                 TX.ImportRow(x)                 x=TX.NewRow
                                                                                        End If
                                                                                    end if
                                                                                next         Buffer=TX
                                                                                For r As Integer = 0 To Buffer.Rows.Count-1         &#x27;
                                                                                    If (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3) Then
                                                                                        if(SD1m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) then                 x= Buffer.Rows(r)                 LL.ImportRow(x)                 x=LL.NewRow                 Lflag=Lflag+1
                                                                                    End If
                                                                                end if
                                                                            next
                                                                            If Lflag&lt;1 Then
                                                                                Lflag=0             x=LL1.NewRow
                                                                            End If
                                                                            For r As Integer = 0 To Buffer.Rows.Count-1                 if(SD1=Buffer.Rows(r)(&quot;Account date&quot;)) then                     x= Buffer.Rows(r)                     LL1.ImportRow(x)                     x=LL1.NewRow                     Lflag=Lflag+1
                                                                            end if
                                                                        next
                                                                        end
                                                                        if         LL=LL1 LLout=LL &#x27;+++++++++++++++++++++++++++
                                                                            If Lflag&gt;0 Then
                                                                                &#x27;+++++++++++++++++++++++++++
                                                                            End If
                                                                            if Lflag=1 then
                                                                                For r As Integer = 0 To Buffer.Rows.Count-1                     if(SD2m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) then                         x= Buffer.Rows(r)                         L2.ImportRow(x)                         x=L2.NewRow                         L2flag=L2flag+1
                                                                                end if
                                                                            next
                                                                            If L2flag&gt;0 Then
                                                                                test=101
                                                                            End If
                                                                            if L2flag=1 then
                                                                                If L2.Rows(0)(&quot;Sal&quot;)&gt;=LL.Rows(0)(&quot;Sal&quot;) Then
                                                                                    salflag=1                             Salary=LL.Rows(0)(&quot;Amount&quot;)                             ReassignFlag=0         test=100
                                                                                End If
                                                                            else                             x=L3.NewRow
                                                                                For r As Integer = 0 To Buffer.Rows.Count-1                                 if((SD2m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD3m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD3p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD4m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD4p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))) then                                     x= Buffer.Rows(r)                                     L3.ImportRow(x)                                     x=L3.NewRow                                     L3counter=L3counter+1
                                                                                end if
                                                                            next
                                                                            If L3counter&gt;2 Then
                                                                                min=L3.Rows(0)(&quot;Sal&quot;)
                                                                            End If
                                                                            For k As Integer = 0 To 2                                     Sum=Sum+L3.Rows(k)(&quot;Sal&quot;)
                                                                                If min&gt;L3.Rows(k)(&quot;Sal&quot;) Then
                                                                                    min=L3.Rows(k)(&quot;Sal&quot;)                                         minimum=L3.Rows(k)(&quot;Amount&quot;)
                                                                                End If
                                                                                end
                                                                                if
                                                                            next                                  Avg=Sum/3
                                                                            If Avg&lt;1.2*min Then
                                                                                Salary=minimum                                     Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)                                     salflag=1
                                                                            End If
                                                                        else                                     salflag=0
                                                                            end
                                                                            if
                                                                        else                                         salflag=0
                                                                            end
                                                                            if
                                                                            end
                                                                            if
                                                                        else                         L2flag=0
                                                                            For r As Integer = 0 To Buffer.Rows.Count-1                             if(SD2=Buffer.Rows(r)(&quot;Account date&quot;)) then                                 x= Buffer.Rows(r)                                 L21.ImportRow(x)                                 x=L21.NewRow                                 L2flag=L2flag+1
                                                                            end if
                                                                        next                         L2=L21
                                                                        if L2flag=1 then
                                                                            If L2.Rows(0)(&quot;Sal&quot;)&gt;=LL.Rows(0)(&quot;Sal&quot;) Then
                                                                                salflag=1                                 Salary=LL.Rows(0)(&quot;Amount&quot;)                                 ReassignFlag=0
                                                                            End If
                                                                            end
                                                                            if
                                                                            end
                                                                            if
                                                                            end
                                                                            if
                                                                            If salflag=0 Then
                                                                                &#x27;test=102 &#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;                         Sum=0
                                                                            End If
                                                                            For r As Integer = 0 To Buffer.Rows.Count-1                         &#x27;
                                                                                if (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1) then
                                                                                    If (SD2m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) Then
                                                                                        Sflag=Sflag+1                                 BasicSalary=Buffer.Rows(r)(&quot;Sal&quot;)                                 &#x27;AM=BasicSalary
                                                                                    End If
                                                                                    end
                                                                                    if
                                                                                Next                         &#x27;AM=BasicSalary
                                                                                If Sflag=1 Then
                                                                                    x=T.NewRow
                                                                                End If
                                                                                For r As Integer = 0 To Buffer.Rows.Count-1                         &#x27;
                                                                                    If (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3) Then
                                                                                        if((SD2m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD3m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD3p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD4m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD4p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))) then                                     x= Buffer.Rows(r)                                     T.ImportRow(x)                                     x=T.NewRow                                     Tcounter=Tcounter+1
                                                                                    End If
                                                                                end if
                                                                            next
                                                                            if Tcounter&lt;2                                 ReassignFlag=1                                 Status=&quot;Total number of feasible transaction is less than 2 after filtering with +/-5 salary date I&quot;
                                                                            else                                 BSp=BasicSalary+(BasicSalary*20/100)                                 BSm=BasicSalary-(BasicSalary*20/100)                                 x=T2.NewRow
                                                                                for r as integer=0 to T.Rows.count-1                                     if(T.Rows(r)(&quot;Sal&quot;)&gt;=BSm AND T.Rows(r)(&quot;Sal&quot;)&lt;=BSp)                                         x= T.Rows(r)                                         T2.ImportRow(x)                                         x=T2.NewRow                                         T2counter=T2counter+1
                                                                                    end
                                                                                    if
                                                                                next
                                                                                If T2counter&lt;2 Then
                                                                                    ReassignFlag=1                                     Status=&quot;Total number of feasible transaction is less than 2 after filtering BSm &lt;= Salary &lt;=BSp&quot;
                                                                                End If
                                                                            else
                                                                                if T2counter=2                                     min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                                                    For k As Integer = 0 To 1                                         Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                                                        If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                                            min=T2.Rows(k)(&quot;Sal&quot;)                                             minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                                                        End If
                                                                                        end
                                                                                        if
                                                                                    next                                     Avg= Sum / 2
                                                                                    If Avg&lt;1.2*min Then
                                                                                        test=2                 &#x27;
                                                                                    End If
                                                                                    For r As Integer = 0 To LL.Rows.Count-1                 &#x27;                            if(LL.Rows(r)(&quot;Sal&quot;)&gt;=Avg*0.65) then                 &#x27;
                                                                                        If LLcheck=0 Then
                                                                                            &#x27;                                    LLcheck=1                 &#x27;                                    if(Math.Floor(LL.Rows(r)(&quot;Sal&quot;))&lt;=Avg) then                 &#x27;                                        Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                        End If
                                                                                    else if(LL.Rows(r)(&quot;Sal&quot;)&lt;=Avg*1.2) then                 &#x27;                                        Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                    else                     &#x27;                                        ReassignFlag=1                 &#x27;                                        Status=&quot;Salary not identified sincee one transaction in last month is grater than selected salary&quot;                 &#x27;
                                                                                        end
                                                                                        if                 &#x27;
                                                                                        else                  &#x27;                                    ReassignFlag=1                 &#x27;                                    Status=&quot;More than one transaction is grater then 65% of selected salary&quot;                 &#x27;
                                                                                            end
                                                                                            if                 &#x27;
                                                                                            end if                     &#x27;
                                                                                        next                                         Salary=minimum                                         Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                                                    else                 &#x27;
                                                                                        For r As Integer = 0 To LL.Rows.Count-1                 &#x27;                            if(LL.Rows(r)(&quot;Sal&quot;)&gt;=min*0.65) then                 &#x27;
                                                                                            If LLcheck=0 Then
                                                                                                &#x27;                                    LLcheck=1                 &#x27;                                    if(Math.Floor(LL.Rows(r)(&quot;Sal&quot;))&lt;=min) then                 &#x27;                                        Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                            End If
                                                                                        else if(LL.Rows(r)(&quot;Sal&quot;)&lt;min*1.2) then                 &#x27;                                        Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                        else                 &#x27;                                        ReassignFlag=1                 &#x27;                                        Status=&quot;Salary not identified sincee one transaction in last month is grater than selected salary&quot;                 &#x27;
                                                                                            end
                                                                                            if                 &#x27;
                                                                                            else                  &#x27;                                    ReassignFlag=1                 &#x27;                                    Status=&quot;More than one transaction is grater then 65% of selected salary&quot;                 &#x27;
                                                                                                end
                                                                                                if                 &#x27;
                                                                                                end if                     &#x27;
                                                                                            next                 test=2.1                                         Salary=minimum
                                                                                            end
                                                                                            if
                                                                                        else                                     min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                                                            For k As Integer = 0 To 2                                         Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                                                                If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                                                    min=T2.Rows(k)(&quot;Sal&quot;)                                             minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                                                                End If
                                                                                                end
                                                                                                if
                                                                                            next                                     Avg= Sum / 3
                                                                                            If Avg&lt;1.2*min Then
                                                                                                test=2                 &#x27;
                                                                                            End If
                                                                                            For r As Integer = 0 To LL.Rows.Count-1                 &#x27;                            if(LL.Rows(r)(&quot;Sal&quot;)&gt;=Avg*0.65) then                 &#x27;
                                                                                                If LLcheck=0 Then
                                                                                                    &#x27;                                    LLcheck=1                 &#x27;                                    if(Math.Floor(LL.Rows(r)(&quot;Sal&quot;))&lt;=Avg) then                 &#x27;                                        Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                                End If
                                                                                            else if(LL.Rows(r)(&quot;Sal&quot;)&lt;Avg*1.2) then                 &#x27;                                        Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                            else                 &#x27;er=Avg                 &#x27;Buffer=T2                 &#x27;                                        ReassignFlag=1                 &#x27;                                        Status=&quot;Salary not identified sincee one transaction in last month is grater than selected salary&quot;                 &#x27;
                                                                                                end
                                                                                                if                 &#x27;
                                                                                                else                  &#x27;                                    ReassignFlag=1                 &#x27;                                    Status=&quot;More than one transaction is grater then 65% of selected salary&quot;                 &#x27;
                                                                                                    end
                                                                                                    if                 &#x27;
                                                                                                    end if                     &#x27;
                                                                                                next                                         Salary=minimum                                         Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                                                            else                 &#x27;
                                                                                                For r As Integer = 0 To LL.Rows.Count-1                 &#x27;                            if(LL.Rows(r)(&quot;Sal&quot;)&gt;=min*0.65) then                 &#x27;
                                                                                                    If LLcheck=0 Then
                                                                                                        &#x27;                                    LLcheck=1                 &#x27;                                    if(Math.Floor(LL.Rows(r)(&quot;Sal&quot;))&lt;=min) then                 &#x27;                                        Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                                    End If
                                                                                                else if(LL.Rows(r)(&quot;Sal&quot;)&lt;=min*1.2) then                 &#x27;                                        Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                                else                 &#x27;                                        ReassignFlag=1                 &#x27;                                        Status=&quot;Salary not identified sincee one transaction in last month is grater than selected salary&quot;                 &#x27;
                                                                                                    end
                                                                                                    if                 &#x27;
                                                                                                    else                  &#x27;                                    ReassignFlag=1                 &#x27;                                    Status=&quot;More than one transaction is grater then 65% of selected salary&quot;                 &#x27;
                                                                                                        end
                                                                                                        if                 &#x27;
                                                                                                        end if                     &#x27;
                                                                                                    next                 test=2.1                                         Salary=minimum
                                                                                                    end
                                                                                                    if
                                                                                                end if
                                                                                                end
                                                                                                if                         &#x27;    test=T                         &#x27;    testT=Tcounter
                                                                                                else &#x27;=============================================================AA===================================================BEGIN
                                                                                                    Dim T3 as DataTable=Buffer.Clone
                                                                                                    Dim Tcounter2 as integer=0
                                                                                                    for r as integer =0 to Buffer.Rows.Count-1                                 if(Buffer.Rows(r)(&quot;Sal&quot;)&gt;=LastApproved) then                                     x=T3.NewRow                                     x=Buffer.Rows(r)                                     T3.ImportRow(x)                                     Tcounter2=Tcounter2+1                                     BasicSalary=Buffer.Rows(r)(&quot;Sal&quot;)
                                                                                                        end
                                                                                                        if
                                                                                                    next                             &#x27;    Buffer=Nothing                         &#x27;    Buffer=T3                             Cop=Buffer &#x27;===============================================================BB=============================================BEGIN                             if(Tcounter2=1)                                 x=T.NewRow
                                                                                                    For r As Integer = 0 To Buffer.Rows.Count-1                         &#x27;
                                                                                                        If (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3) Then
                                                                                                            if((SD1m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))OR (SD2m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD3m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD3p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD4m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD4p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))) then                                         x= Buffer.Rows(r)                                         T.ImportRow(x)                                         x=T.NewRow                                         Tcounter=Tcounter+1
                                                                                                        End If
                                                                                                    end if
                                                                                                next
                                                                                                if Tcounter&lt;2                                     ReassignFlag=1                                     Status=&quot;Total number of feasible transaction is less than 2 after filtering with +/-5 salary date in AA-BB-Gov I&quot;
                                                                                                else                                     BSp=BasicSalary+(BasicSalary*20/100)                                     BSm=BasicSalary-(BasicSalary*20/100)                                     x=T2.NewRow
                                                                                                    for r as integer=0 to T.Rows.count-1                                         if(T.Rows(r)(&quot;Sal&quot;)&gt;=BSm AND T.Rows(r)(&quot;Sal&quot;)&lt;=BSp)                                             x= T.Rows(r)                                             T2.ImportRow(x)                                             x=T2.NewRow                                             T2counter=T2counter+1
                                                                                                        end
                                                                                                        if
                                                                                                    next
                                                                                                    If T2counter&lt;2 Then
                                                                                                        ReassignFlag=1                                         Status=&quot;Total number of feasible transaction is less than 2 after filtering with +/-5 salary date in AA-BB-Gov II&quot;
                                                                                                    End If
                                                                                                else
                                                                                                    if T2counter=2                                         min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                                                                        For k As Integer = 0 To 1                                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                                                                            If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                                                                min=T2.Rows(k)(&quot;Sal&quot;)                                                 minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                                                                            End If
                                                                                                            end
                                                                                                            if
                                                                                                        next                                         Avg= Sum / 2
                                                                                                        If Avg&lt;1.2*min Then
                                                                                                            test=3                 &#x27;
                                                                                                        End If
                                                                                                        For r As Integer = 0 To LL.Rows.Count-1                 &#x27;                                if(LL.Rows(r)(&quot;Sal&quot;)&gt;=Avg*0.65) then                 &#x27;
                                                                                                            If LLcheck=0 Then
                                                                                                                &#x27;                                        LLcheck=1                 &#x27;                                        if(Math.Floor(LL.Rows(r)(&quot;Sal&quot;))&lt;=Avg) then                 &#x27;                                            Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                                            End If
                                                                                                        else if(LL.Rows(r)(&quot;Sal&quot;)&lt;=Avg*1.2) then                 &#x27;                                            Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                                        else                 &#x27;                                            ReassignFlag=1                 &#x27;                                            Status=&quot;Salary not identified sincee one transaction in last month is grater than selected salary&quot;                 &#x27;
                                                                                                            end
                                                                                                            if                 &#x27;
                                                                                                            else                  &#x27;                                        ReassignFlag=1                 &#x27;                                        Status=&quot;More than one transaction is grater then 65% of selected salary&quot;                 &#x27;
                                                                                                                end
                                                                                                                if                 &#x27;
                                                                                                                end if                     &#x27;
                                                                                                            next                                             Salary=minimum                                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                                                                        else                 &#x27;
                                                                                                            For r As Integer = 0 To LL.Rows.Count-1                 &#x27;                                if(LL.Rows(r)(&quot;Sal&quot;)&gt;=min*0.65) then                 &#x27;
                                                                                                                If LLcheck=0 Then
                                                                                                                    &#x27;                                        LLcheck=1                 &#x27;                                        if(Math.Floor(LL.Rows(r)(&quot;Sal&quot;))&lt;=min) then                 &#x27;                                            Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                                                End If
                                                                                                            else if(LL.Rows(r)(&quot;Sal&quot;)&lt;=min*1.2) then                 &#x27;                                            Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                                            else                 &#x27;                                            ReassignFlag=1                 &#x27;                                            Status=&quot;Salary not identified sincee one transaction in last month is grater than selected salary&quot;                 &#x27;
                                                                                                                end
                                                                                                                if                 &#x27;
                                                                                                                else                  &#x27;                                        ReassignFlag=1                 &#x27;                                        Status=&quot;More than one transaction is grater then 65% of selected salary&quot;                 &#x27;
                                                                                                                    end
                                                                                                                    if                 &#x27;
                                                                                                                    end if                     &#x27;
                                                                                                                next                 test=3.1                                             Salary=minimum
                                                                                                                end
                                                                                                                if
                                                                                                            else                                         min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                                                                                For k As Integer = 0 To 2                                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                                                                                    If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                                                                        min=T2.Rows(k)(&quot;Sal&quot;)                                                 minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                                                                                    End If
                                                                                                                    end
                                                                                                                    if
                                                                                                                next                                         Avg= Sum / 3
                                                                                                                If Avg&lt;1.2*min Then
                                                                                                                    test=3                 &#x27;
                                                                                                                End If
                                                                                                                For r As Integer = 0 To LL.Rows.Count-1                 &#x27;                                if(LL.Rows(r)(&quot;Sal&quot;)&gt;=Avg*0.65) then                 &#x27;
                                                                                                                    If LLcheck=0 Then
                                                                                                                        &#x27;                                        LLcheck=1                 &#x27;                                        if(Math.Floor(LL.Rows(r)(&quot;Sal&quot;))&lt;=Avg) then                 &#x27;                                            Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                                                    End If
                                                                                                                else if(LL.Rows(r)(&quot;Sal&quot;)&lt;=Avg*1.2) then                 &#x27;                                            Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                                                else                 &#x27;                                            ReassignFlag=1                 &#x27;                                            Status=&quot;Salary not identified sincee one transaction in last month is grater than selected salary&quot;                 &#x27;
                                                                                                                    end
                                                                                                                    if                 &#x27;
                                                                                                                    else                  &#x27;                                        ReassignFlag=1                 &#x27;                                        Status=&quot;More than one transaction is grater then 65% of selected salary&quot;                 &#x27;
                                                                                                                        end
                                                                                                                        if                 &#x27;
                                                                                                                        end if                     &#x27;
                                                                                                                    next                                             Salary=minimum                                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                                                                                else                 &#x27;
                                                                                                                    For r As Integer = 0 To LL.Rows.Count-1                 &#x27;                                if(LL.Rows(r)(&quot;Sal&quot;)&gt;=min*0.65) then                 &#x27;
                                                                                                                        If LLcheck=0 Then
                                                                                                                            &#x27;                                        LLcheck=1                 &#x27;                                        if(Math.Floor(LL.Rows(r)(&quot;Sal&quot;))&lt;=min) then                 &#x27;                                            Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                                                        End If
                                                                                                                    else if(LL.Rows(r)(&quot;Sal&quot;)&lt;=min*1.2) then                 &#x27;                                            Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                                                    else                 &#x27;                                            ReassignFlag=1                 &#x27;                                            Status=&quot;Salary not identified since one transaction in last month is grater than selected salary&quot;                 &#x27;
                                                                                                                        end
                                                                                                                        if                 &#x27;
                                                                                                                        else                  &#x27;                                        ReassignFlag=1                 &#x27;                                        Status=&quot;More than one transaction is grater then 65% of selected salary&quot;                 &#x27;
                                                                                                                            end
                                                                                                                            if                 &#x27;
                                                                                                                            end if                     &#x27;
                                                                                                                        next                 test=3.1                                             Salary=minimum
                                                                                                                        end
                                                                                                                        if
                                                                                                                    end if
                                                                                                                    end
                                                                                                                    if &#x27;===============================================================BB=============================================END
                                                                                                                    else
                                                                                                                        Dim Count4 as integer=0
                                                                                                                        Dim Prev as integer =0
                                                                                                                        Dim Base as Decimal=0
                                                                                                                        for r as integer=0 to A1.Rows.Count-1
                                                                                                                            For j as integer=0 to T3.Rows.Count-1
                                                                                                                                if A1.Rows(r)(&quot;Amount&quot;)=T3.Rows(j)(&quot;Sal&quot;)                                             Count4=Count4+1
                                                                                                                                    end
                                                                                                                                    if
                                                                                                                                next
                                                                                                                                if prev&lt;Count4                                         BasicSalary=A1.Rows(r)(&quot;Amount&quot;)                                         prev=Count4
                                                                                                                                    end
                                                                                                                                    if                                     Count4=0
                                                                                                                                    next                                                 x=T.NewRow
                                                                                                                                    For r As Integer = 0 To Buffer.Rows.Count-1                         &#x27;
                                                                                                                                        If (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3) Then
                                                                                                                                            if((SD1m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))OR (SD2m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD3m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD3p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD4m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD4p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))) then                                         x= Buffer.Rows(r)                                         T.ImportRow(x)                                         x=T.NewRow                                         Tcounter=Tcounter+1
                                                                                                                                        End If
                                                                                                                                    end if
                                                                                                                                next
                                                                                                                                if Tcounter&lt;2                                     ReassignFlag=1                                     Status=&quot;Total number of feasible transaction is less than 2 after filtering with +/-5 salary date in AA-BB-Gov III&quot;
                                                                                                                                else                                     BSp=BasicSalary+(BasicSalary*20/100)                                     BSm=BasicSalary-(BasicSalary*20/100)                                     x=T2.NewRow
                                                                                                                                    for r as integer=0 to T.Rows.count-1                                         if(T.Rows(r)(&quot;Sal&quot;)&gt;=BSm AND T.Rows(r)(&quot;Sal&quot;)&lt;=BSp)                                             x= T.Rows(r)                                             T2.ImportRow(x)                                             x=T2.NewRow                                             T2counter=T2counter+1
                                                                                                                                        end
                                                                                                                                        if
                                                                                                                                    next
                                                                                                                                    If T2counter&lt;2 Then
                                                                                                                                        ReassignFlag=1                                         Status=&quot;Total number of feasible transaction is less than 2 after filtering BSm&lt;= SAL &lt;=BSp in AA-BB-Gov IV&quot;
                                                                                                                                    End If
                                                                                                                                else
                                                                                                                                    if T2counter=2                                         min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                                                                                                        For k As Integer = 0 To 1                                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                                                                                                            If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                                                                                                min=T2.Rows(k)(&quot;Sal&quot;)                                                 minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                                                                                                            End If
                                                                                                                                            end
                                                                                                                                            if
                                                                                                                                        next                                         Avg= Sum / 2
                                                                                                                                        If Avg&lt;1.2*min Then
                                                                                                                                            test=4                 &#x27;
                                                                                                                                        End If
                                                                                                                                        For r As Integer = 0 To LL.Rows.Count-1                 &#x27;                                if(LL.Rows(r)(&quot;Sal&quot;)&gt;=Avg*0.65) then                 &#x27;
                                                                                                                                            If LLcheck=0 Then
                                                                                                                                                &#x27;                                        LLcheck=1                 &#x27;                                        if(Math.Floor(LL.Rows(r)(&quot;Sal&quot;))&lt;=Avg) then                 &#x27;                                            Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                                                                            End If
                                                                                                                                        else if(LL.Rows(r)(&quot;Sal&quot;)&lt;=Avg*1.2) then                 &#x27;                                            Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                                                                        else                 &#x27;                                            ReassignFlag=1                 &#x27;                                            Status=&quot;Salary not identified sincee one transaction in last month is grater than selected salary&quot;                 &#x27;
                                                                                                                                            end
                                                                                                                                            if                 &#x27;
                                                                                                                                            else                  &#x27;                                        ReassignFlag=1                 &#x27;                                        Status=&quot;More than one transaction is grater then 65% of selected salary&quot;                 &#x27;
                                                                                                                                                end
                                                                                                                                                if                 &#x27;
                                                                                                                                                end if                     &#x27;
                                                                                                                                            next                                             Salary=minimum                                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                                                                                                        else                 &#x27;
                                                                                                                                            For r As Integer = 0 To LL.Rows.Count-1                 &#x27;                                if(LL.Rows(r)(&quot;Sal&quot;)&gt;=min*0.65) then                 &#x27;
                                                                                                                                                If LLcheck=0 Then
                                                                                                                                                    &#x27;                                        LLcheck=1                 &#x27;                                        if(Math.Floor(LL.Rows(r)(&quot;Sal&quot;))&lt;=min) then                 &#x27;                                            Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                                                                                End If
                                                                                                                                            else if(LL.Rows(r)(&quot;Sal&quot;)&lt;=min*1.2) then                 &#x27;                                            Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                                                                            else                 &#x27;                                            ReassignFlag=1                 &#x27;                                            Status=&quot;Salary not identified sincee one transaction in last month is grater than selected salary&quot;                 &#x27;
                                                                                                                                                end
                                                                                                                                                if                 &#x27;
                                                                                                                                                else                  &#x27;                                        ReassignFlag=1                 &#x27;                                        Status=&quot;More than one transaction is grater then 65% of selected salary&quot;                 &#x27;
                                                                                                                                                    end
                                                                                                                                                    if                 &#x27;
                                                                                                                                                    end if                     &#x27;
                                                                                                                                                next                 test=4.1                                             Salary=minimum
                                                                                                                                                end
                                                                                                                                                if
                                                                                                                                            else                                          min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                                                                                                                For k As Integer = 0 To 2                                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                                                                                                                    If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                                                                                                        min=T2.Rows(k)(&quot;Sal&quot;)                                                 minimum=T2.Rows(k)(&quot;Amount&quot;)
                                                                                                                                                    End If
                                                                                                                                                    end
                                                                                                                                                    if
                                                                                                                                                next                                         Avg= Sum / 3
                                                                                                                                                If Avg&lt;1.2*min Then
                                                                                                                                                    test=4                 &#x27;
                                                                                                                                                End If
                                                                                                                                                For r As Integer = 0 To LL.Rows.Count-1                 &#x27;                                if(LL.Rows(r)(&quot;Sal&quot;)&gt;=Avg*0.65) then                 &#x27;
                                                                                                                                                    If LLcheck=0 Then
                                                                                                                                                        &#x27;                                        LLcheck=1                 &#x27;                                        if(Math.Floor(LL.Rows(r)(&quot;Sal&quot;))&lt;=Avg) then                 &#x27;                                            Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                                                                                    End If
                                                                                                                                                else if(LL.Rows(r)(&quot;Sal&quot;)&lt;=Avg*1.2) then                 &#x27;                                            Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                                                                                else                 &#x27;                                            ReassignFlag=1                 &#x27;                                            Status=&quot;Salary not identified sincee one transaction in last month is grater than selected salary&quot;                 &#x27;
                                                                                                                                                    end
                                                                                                                                                    if                 &#x27;
                                                                                                                                                    else                  &#x27;                                        ReassignFlag=1                 &#x27;                                        Status=&quot;More than one transaction is grater then 65% of selected salary&quot;                 &#x27;
                                                                                                                                                        end
                                                                                                                                                        if                 &#x27;
                                                                                                                                                        end if                     &#x27;
                                                                                                                                                    next                                             Salary=minimum                                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                                                                                                                else                 &#x27;
                                                                                                                                                    For r As Integer = 0 To LL.Rows.Count-1                 &#x27;                                if(LL.Rows(r)(&quot;Sal&quot;)&gt;=min*0.65) then                 &#x27;
                                                                                                                                                        If LLcheck=0 Then
                                                                                                                                                            &#x27;                                        LLcheck=1                 &#x27;                                        if(Math.Floor(LL.Rows(r)(&quot;Sal&quot;))&lt;=min) then                 &#x27;                                            Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                                                                                        End If
                                                                                                                                                    else if(LL.Rows(r)(&quot;Sal&quot;)&lt;=min*1.2) then                 &#x27;                                            Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                                                                                    else                 &#x27;                                            ReassignFlag=1                 &#x27;                                            Status=&quot;Salary not identified sincee one transaction in last month is grater than selected salary&quot;                 &#x27;
                                                                                                                                                        end
                                                                                                                                                        if                 &#x27;
                                                                                                                                                        else                  &#x27;                                        ReassignFlag=1                 &#x27;                                        Status=&quot;More than one transaction is grater then 65% of selected salary&quot;                 &#x27;
                                                                                                                                                            end
                                                                                                                                                            if                 &#x27;
                                                                                                                                                            end if                     &#x27;
                                                                                                                                                        next                 test=4.1                                             Salary=minimum
                                                                                                                                                        end
                                                                                                                                                        if
                                                                                                                                                    end if
                                                                                                                                                    end
                                                                                                                                                    if
                                                                                                                                                    end
                                                                                                                                                    if
                                                                                                                                                    end
                                                                                                                                                    if
                                                                                                                                                    end
                                                                                                                                                    if                     &#x27;
                                                                                                                                                        end
                                                                                                                                                        if &#x27;=============================================================AA===================================================    END
                                                                                                                                                        else                      ReassignFlag=1                     Status=&quot;No transaction available in 2nd last month&quot;
                                                                                                                                                            end
                                                                                                                                                            if
                                                                                                                                                        else                  Status=&quot;More than one transaction in last month&quot;                 ReassignFlag=1
                                                                                                                                                            end
                                                                                                                                                            if
                                                                                                                                                        else             Status=&quot;No transaction in of last salary date&quot;             ReassignFlag=1
                                                                                                                                                            end
                                                                                                                                                            if
                                                                                                                                                            end
                                                                                                                                                            if
                                                                                                                                                        else      Status=&quot;Total number of feasible transaction is less than 3&quot;     ReassignFlag=1
                                                                                                                                                            end
                                                                                                                                                            if D0=D1 A0=A1
                                                                                                                                                            catch e as Exception         er=e.ToString         ReassignFlag=1         Status=&quot;Code Error:&quot;+e.ToString
                                                                                                                                                                end
                                                                                                                                                                try"
                            data-title="UWCA_MRCC_CTF_V1.0 / Salary code / Salary Calculation(new)8">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>UWCA_MRCC_CTF_V1.0</td>
                <td>Salary code</td>
                <td>Salary Calculation(new)9 wit C\A added</td>
                <td>visualbasic</td>
                <td>946</td>
                <!--<td style="font-family: monospace;">0c365821114c202faeaec546fb1b560d65fa0b5ecaa1acc95d346c9be4e0cfd0</td>-->
                <td>—</td>
                <!--<td>try     Dim description as string     Dim x As DataRow = D1.NewRow     Dim Dflag as integer =0     Dim precount as integer =0     Dim Amount as integer =0     Dim Avg as Decimal=0     Dim Sum as integer =0     Dim skip as integer =0     Dim min as integer =0     Dim count as integer =0     Dim Av as...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="try
    Dim description as string
    Dim x As DataRow = D1.NewRow
    Dim Dflag as integer =0
    Dim precount as integer =0
    Dim Amount as integer =0
    Dim Avg as Decimal=0
    Dim Sum as integer =0
    Dim skip as integer =0
    Dim min as integer =0
    Dim count as integer =0
    Dim Av as integer =0
    Dim mi as integer =0
    Dim minim as string min=0 count=0 minim=&quot;&quot;
    if c1.Rows.Count&gt;2 then
        For r As Integer = 0 To c1.Rows.Count-1         description=c1.Rows(r)(&quot;Description&quot;)         Dflag=0
            for i as integer=0 To D1.Rows.Count-1
                If D1.Rows(i)(&quot;Description&quot;)=description Then
                    Dflag=1                 D1.Rows(i)(&quot;Count&quot;)=D1.Rows(i)(&quot;Count&quot;)+1
                End If
                end
                if
            next
            If Dflag=0 Then
                x(&quot;Description&quot;) = description             x(&quot;Count&quot;)=1             D1.Rows.Add(x)             x= D1.NewRow
            End If
            end
            if
        Next
        For r As Integer = 0 To D1.Rows.Count-1         description=D1.Rows(r)(&quot;Description&quot;)         CollOut=Nothing         CollOut=c1.Clone
            For Each parentRow As DataRow In c1.Select(&quot;Description=&#x27;&quot;+description+&quot;&#x27;&quot;)             x = CollOut.NewRow
                For Each c As DataColumn In x.Table.Columns                     x(c.ColumnName) = parentRow(c.ColumnName)
                Next             CollOut.Rows.Add(x)
            Next         count=CollOut.Rows.Count
            If count&gt;precount Then
                Buffer=Nothing             Buffer = CollOut.Clone             Buffer=CollOut             precount=count             ReassignFlag=0
            End If
        else
            if count = Precount             ReassignFlag=1             Status=&quot;Salary cannot be identified since there mode are equal&quot;
                end
                if
            next &#x27;+++++++++++++++++++++++++
            If Govt= False AND EF= False Then
                &#x27;+++++++++++++++++++++++++
            End If
            If Buffer.Rows.Count &gt;2 Then
                ReassignFlag=0
            End If
            if ReassignFlag=0             ReassignFlag=1
                For r As Integer = 0 To Buffer.Rows.Count-1
                    If Buffer.Rows(r)(&quot;Days&quot;)&lt;=TimePeriod Then
                        ReassignFlag=0
                    End If
                    exit
                    for
                    end
                    if
                next
                end
                if
                if ReassignFlag=0             Status=&quot;&quot;
                    For r As Integer = 0 To Buffer.Rows.Count-1                 Amount=Buffer.Rows(r)(&quot;Sal&quot;)                 Dflag=0
                        for i as integer=0 To A1.Rows.Count-1
                            If A1.Rows(i)(&quot;Amount&quot;)=Amount Then
                                Dflag=1                         A1.Rows(i)(&quot;Count&quot;)=A1.Rows(i)(&quot;Count&quot;)+1
                            End If
                            end
                            if
                        next
                        If Dflag=0 Then
                            x= A1.NewRow                     x(&quot;Amount&quot;) = Amount                     x(&quot;Count&quot;)=1                     x(&quot;Salary&quot;)=Buffer.Rows(r)(&quot;Amount&quot;)                     A1.Rows.Add(x)
                        End If
                        end
                        if
                    Next             min=Buffer.Rows(0)(&quot;Sal&quot;)+1
                    For k As Integer = 0 To 2                 Sum=Sum+Buffer.Rows(k)(&quot;Sal&quot;)
                        If min&gt;Buffer.Rows(k)(&quot;Sal&quot;) Then
                            min=Buffer.Rows(k)(&quot;Sal&quot;)                     minimum=Buffer.Rows(k)(&quot;Amount&quot;)                     CA=Buffer.Rows(k)(&quot;C/A&quot;)
                        End If
                        end
                        if
                        if k=1                     Av=Sum/2                     mi=min                     minim=minimum
                            end
                            if
                        next             Avg= Sum / 3
                        If Avg&lt;1.2*min Then
                            test=1 Cop=A1                 Salary=minimum                 Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                        End If
                    else
                        If Av&lt;1.2*mi Then
                            minimum=minim                 Salary=minimum                 Other=Replace((Av-mi),&quot;.&quot;,&quot;,&quot;)
                        End If
                    else
                        For r As Integer = 0 To A1.Rows.Count-1
                            If (A1.Rows(r)(&quot;Count&quot;)*100/(Buffer.Rows.Count))&gt;60 Then
                                Salary=A1.Rows(r)(&quot;Salary&quot;)                         skip=1
                            End If
                            end
                            if
                        next
                        If skip=0 Then
                            &#x27;vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvPage2vvvvvvvvvvvvvvvvvvvvvvvvvvv
                        End If
                        if Govt=True then
                            Dim SD1p,SD1m,SD2p,SD2m,SD3p,SD3m as date
                            Dim Sflag as integer =0
                            Dim BasicSalary as Integer =0
                            Dim T as DataTable =Buffer.Clone
                            Dim T2 as DataTable=Buffer.Clone
                            Dim TX as DataTable=Buffer.Clone
                            Dim Tcounter as integer =0
                            Dim T2counter as integer =0
                            Dim BSp,BSm as Decimal                          Sum=0                         minimum=0                         Salary=0                         Other=0                         min=0                         SD1p=SD1.AddDays(5)                         SD1m=SD1.AddDays(-5)                         SD2p=SD2.AddDays(5)                         SD2m=SD2.AddDays(-5)                         SD3p=SD3.AddDays(5)                         SD3m=SD3.AddDays(-5)                 &#x27;        T=Buffer.Clone
                            For r As Integer = 0 To Buffer.Rows.Count-1 &#x27;
                                If (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3) Then
                                    if((SD1m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))OR (SD2m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD3m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD3p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))) then                                 x= Buffer.Rows(r)                                 TX.ImportRow(x)                                 x=TX.NewRow
                                End If
                            end if
                        next                         Buffer=TX
                        For r As Integer = 0 To Buffer.Rows.Count-1                 &#x27;
                            if (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1) then
                                If (SD1m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) Then
                                    Sflag=Sflag+1                                 BasicSalary=Buffer.Rows(r)(&quot;Sal&quot;)                                 &#x27;AM=BasicSalary
                                End If
                                end
                                if
                            Next                         &#x27;AM=BasicSalary
                            If Sflag=1 Then
                                x=T.NewRow
                            End If
                            For r As Integer = 0 To Buffer.Rows.Count-1                 &#x27;
                                If (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3) Then
                                    if((SD1m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))OR (SD2m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD3m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD3p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))) then                                     x= Buffer.Rows(r)                                     T.ImportRow(x)                                     x=T.NewRow                                     Tcounter=Tcounter+1
                                End If
                            end if
                        next
                        if Tcounter&lt;3                                 ReassignFlag=1                                 Status=&quot;Total number of feasible transaction is less than 3 after filtering with +/-5 salary date I&quot;
                        else                                 BSp=BasicSalary+(BasicSalary*20/100)                                 BSm=BasicSalary-(BasicSalary*20/100)                                 x=T2.NewRow
                            for r as integer=0 to T.Rows.count-1                                     if(T.Rows(r)(&quot;Sal&quot;)&gt;=BSm AND T.Rows(r)(&quot;Sal&quot;)&lt;=BSp)                                         x= T.Rows(r)                                         T2.ImportRow(x)                                         x=T2.NewRow                                         T2counter=T2counter+1
                                end
                                if
                            next
                            If T2counter&lt;2 Then
                                ReassignFlag=1                                     Status=&quot;Total number of feasible transaction is less than 2 after filtering BSm &lt;= Salary &lt;=BSp&quot;
                            End If
                        else
                            if T2counter=2                                     min=T2.Rows(0)(&quot;Sal&quot;)+1
                                For k As Integer = 0 To 1                                         Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                    If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                        min=T2.Rows(k)(&quot;Sal&quot;)                                             minimum=T2.Rows(k)(&quot;Amount&quot;)                                             CA=T2.Rows(k)(&quot;C/A&quot;)
                                    End If
                                    end
                                    if
                                next                                     Avg= Sum / 2
                                If Avg&lt;1.2*min Then
                                    test=2                                         Salary=minimum                                         Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                End If
                            else                                         Salary=minimum                                         Other=0
                                end
                                if
                            else                                     min=T2.Rows(0)(&quot;Sal&quot;)+1
                                For k As Integer = 0 To 2                                         Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                    If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                        min=T2.Rows(k)(&quot;Sal&quot;)                                             minimum=T2.Rows(k)(&quot;Amount&quot;)                                             CA=T2.Rows(k)(&quot;C/A&quot;)
                                    End If
                                    end
                                    if
                                next                                     Avg= Sum / 3
                                If Avg&lt;1.2*min Then
                                    test=2                                         Salary=minimum                                         Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                End If
                            else                                         Salary=minimum                                         Other=0
                                end
                                if
                            end if
                            end
                            if                     &#x27;    test=T                     &#x27;    testT=Tcounter
                            else &#x27;=============================================================AA===================================================BEGIN
                                Dim T3 as DataTable=Buffer.Clone
                                Dim Tcounter2 as integer=0
                                for r as integer =0 to Buffer.Rows.Count-1                                 if(Buffer.Rows(r)(&quot;Sal&quot;)&gt;=LastApproved) then                                     x=T3.NewRow                                     x=Buffer.Rows(r)                                     T3.ImportRow(x)                                     Tcounter2=Tcounter2+1                                     BasicSalary=Buffer.Rows(r)(&quot;Sal&quot;)
                                    end
                                    if
                                next                             &#x27;    Buffer=Nothing                         &#x27;    Buffer=T3 Cop=Buffer &#x27;===============================================================BB=============================================BEGIN                             if(Tcounter2=1)                                 x=T.NewRow
                                For r As Integer = 0 To Buffer.Rows.Count-1                 &#x27;
                                    If (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3) Then
                                        if((SD1m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))OR (SD2m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD3m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD3p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))) then                                         x= Buffer.Rows(r)                                         T.ImportRow(x)                                         x=T.NewRow                                         Tcounter=Tcounter+1
                                    End If
                                end if
                            next
                            if Tcounter&lt;3                                     ReassignFlag=1                                     Status=&quot;Total number of feasible transaction is less than 3 after filtering with +/-5 salary date in AA-BB-Gov I&quot;
                            else                                     BSp=BasicSalary+(BasicSalary*20/100)                                     BSm=BasicSalary-(BasicSalary*20/100)                                     x=T2.NewRow
                                for r as integer=0 to T.Rows.count-1                                         if(T.Rows(r)(&quot;Sal&quot;)&gt;=BSm AND T.Rows(r)(&quot;Sal&quot;)&lt;=BSp)                                             x= T.Rows(r)                                             T2.ImportRow(x)                                             x=T2.NewRow                                             T2counter=T2counter+1
                                    end
                                    if
                                next
                                If T2counter&lt;2 Then
                                    ReassignFlag=1                                         Status=&quot;Total number of feasible transaction is less than 2 after filtering with +/-5 salary date in AA-BB-Gov II&quot;
                                End If
                            else
                                if T2counter=2                                         min=T2.Rows(0)(&quot;Sal&quot;)+1
                                    For k As Integer = 0 To 1                                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                        If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                            min=T2.Rows(k)(&quot;Sal&quot;)                                                 minimum=T2.Rows(k)(&quot;Amount&quot;)                                                 CA=T2.Rows(k)(&quot;C/A&quot;)
                                        End If
                                        end
                                        if
                                    next                                         Avg= Sum / 2
                                    If Avg&lt;1.2*min Then
                                        test=3                                             Salary=minimum                                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                    End If
                                else                                             Salary=minimum                                             Other=0
                                    end
                                    if
                                else                                         min=T2.Rows(0)(&quot;Sal&quot;)+1
                                    For k As Integer = 0 To 2                                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                        If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                            min=T2.Rows(k)(&quot;Sal&quot;)                                                 minimum=T2.Rows(k)(&quot;Amount&quot;)                                                 CA=T2.Rows(k)(&quot;C/A&quot;)
                                        End If
                                        end
                                        if
                                    next                                         Avg= Sum / 3
                                    If Avg&lt;1.2*min Then
                                        test=3                                             Salary=minimum                                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                    End If
                                else                                             Salary=minimum                                             Other=0
                                    end
                                    if
                                end if
                                end
                                if &#x27;===============================================================BB=============================================END
                                else
                                    Dim Count4 as integer=0
                                    Dim Prev as integer =0
                                    Dim Base as Decimal=0
                                    for r as integer=0 to A1.Rows.Count-1
                                        For j as integer=0 to T3.Rows.Count-1
                                            if A1.Rows(r)(&quot;Amount&quot;)=T3.Rows(j)(&quot;Sal&quot;)                                             Count4=Count4+1
                                                end
                                                if
                                            next
                                            if prev&lt;Count4                                         BasicSalary=A1.Rows(r)(&quot;Amount&quot;)                                         prev=Count4
                                                end
                                                if                                     Count4=0
                                                next                                                 x=T.NewRow
                                                For r As Integer = 0 To Buffer.Rows.Count-1                 &#x27;
                                                    If (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3) Then
                                                        if((SD1m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))OR (SD2m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD3m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD3p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))) then                                         x= Buffer.Rows(r)                                         T.ImportRow(x)                                         x=T.NewRow                                         Tcounter=Tcounter+1
                                                    End If
                                                end if
                                            next
                                            if Tcounter&lt;3                                     ReassignFlag=1                                     Status=&quot;Total number of feasible transaction is less than 3 after filtering with +/-5 salary date in AA-BB-Gov III&quot;
                                            else                                     BSp=BasicSalary+(BasicSalary*20/100)                                     BSm=BasicSalary-(BasicSalary*20/100)                                     x=T2.NewRow
                                                for r as integer=0 to T.Rows.count-1                                         if(T.Rows(r)(&quot;Sal&quot;)&gt;=BSm AND T.Rows(r)(&quot;Sal&quot;)&lt;=BSp)                                             x= T.Rows(r)                                             T2.ImportRow(x)                                             x=T2.NewRow                                             T2counter=T2counter+1
                                                    end
                                                    if
                                                next
                                                If T2counter&lt;2 Then
                                                    ReassignFlag=1                                         Status=&quot;Total number of feasible transaction is less than 2 after filtering BSm&lt;= SAL &lt;=BSp in AA-BB-Gov IV&quot;
                                                End If
                                            else
                                                if T2counter=2                                         min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                    For k As Integer = 0 To 1                                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                        If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                            min=T2.Rows(k)(&quot;Sal&quot;)                                                 minimum=T2.Rows(k)(&quot;Amount&quot;)                                                 CA=T2.Rows(k)(&quot;C/A&quot;)
                                                        End If
                                                        end
                                                        if
                                                    next                                         Avg= Sum / 2
                                                    If Avg&lt;1.2*min Then
                                                        test=4                                             Salary=minimum                                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                    End If
                                                else                                             Salary=minimum                                             Other=0
                                                    end
                                                    if
                                                else                                          min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                    For k As Integer = 0 To 2                                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                        If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                            min=T2.Rows(k)(&quot;Sal&quot;)                                                 minimum=T2.Rows(k)(&quot;Amount&quot;)                                                 CA=T2.Rows(k)(&quot;C/A&quot;)
                                                        End If
                                                        end
                                                        if
                                                    next                                         Avg= Sum / 3
                                                    If Avg&lt;1.2*min Then
                                                        test=4                                             Salary=minimum                                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                    End If
                                                else                                             Salary=minimum                                             Other=0
                                                    end
                                                    if
                                                end if
                                                end
                                                if
                                                end
                                                if  &#x27;=============================================================AA===================================================    END
                                                    end
                                                    if
                                                else &#x27;==========================================================================B===================================BEGIN
                                                    Dim Sflag as integer =0
                                                    Dim BasicSalary as Integer =0
                                                    Dim T as DataTable =Buffer.Clone
                                                    Dim T2 as DataTable=Buffer.Clone
                                                    Dim Tcounter as integer =0
                                                    Dim T2counter as integer =0
                                                    Dim BSp,BSm as Decimal
                                                    Dim BaseDays as Decimal =0
                                                    Dim Dayz as decimal=0                         Sum=0                         minimum=0                         Salary=0                         Sflag=0                         Other=0                         min=0
                                                    For r As Integer = 0 To Buffer.Rows.Count-1
                                                        If (Buffer.Rows(r)(&quot;Days&quot;)&lt;=TimePeriod) Then
                                                            Sflag=Sflag+1                                 BasicSalary=Buffer.Rows(r)(&quot;Sal&quot;)                                 x=T.NewRow                                 x= Buffer.Rows(r)                                 T.ImportRow(x)                                 Tcounter=1                                 BaseDays=Buffer.Rows(r)(&quot;Days&quot;)
                                                        End If
                                                        end
                                                        if
                                                    Next &#x27;=======================================================================================BB=================================================BEGIN
                                                    If Sflag=1 Then
                                                        x=T.NewRow
                                                    End If
                                                    For r As Integer = 0 To Buffer.Rows.Count-1                                     Dayz=Buffer.Rows(r)(&quot;Days&quot;)                                 Dayz=Dayz-BaseDays
                                                        If ((Dayz&gt;=25 AND Dayz&lt;=35) OR (Dayz&gt;=55 AND Dayz&lt;=65) ) Then
                                                            x= Buffer.Rows(r)                                     T.ImportRow(x)                                     x=T.NewRow                                     Tcounter=Tcounter+1
                                                        End If
                                                    end if
                                                next                             &#x27;testT=Tcounter /checked
                                                if Tcounter&lt;3                                 ReassignFlag=1                                 Status=&quot;Total number of feasible transaction is less than 3 after filtering with 25-35 and 55 to 65 in AA-BB-nonGov II&quot;
                                                else                                 BSp=BasicSalary+(BasicSalary*20/100)                                 BSm=BasicSalary-(BasicSalary*20/100)                                 x=T2.NewRow
                                                    for r as integer=0 to T.Rows.count-1                                     if(T.Rows(r)(&quot;Sal&quot;)&gt;=BSm AND T.Rows(r)(&quot;Sal&quot;)&lt;=BSp)                                         x= T.Rows(r)                                         T2.ImportRow(x)                                         x=T2.NewRow                                         T2counter=T2counter+1
                                                        end
                                                        if
                                                    next
                                                    If T2counter&lt;2 Then
                                                        ReassignFlag=1                                     Status=&quot;Total number of feasible transaction is less than 2 after filtering BSm&lt;=SAL&lt;=BSp BB-non Gov II&quot;
                                                    End If
                                                else
                                                    if T2counter=2
                                                        For k As Integer = 0 To 1                                         Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                            If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                min=T2.Rows(k)(&quot;Sal&quot;)                                             minimum=T2.Rows(k)(&quot;Amount&quot;)                                             CA=T2.Rows(k)(&quot;C/A&quot;)
                                                            End If
                                                            end
                                                            if
                                                        next                                      Avg= Sum / 2
                                                        If Avg&lt;1.2*min Then
                                                            Salary=minimum                                         Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                        End If
                                                    else                                          Salary=minimum                                         Other=0
                                                        end
                                                        if
                                                    else                                       min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                        For k As Integer = 0 To 2                                         Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                            If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                min=T2.Rows(k)(&quot;Sal&quot;)                                             minimum=T2.Rows(k)(&quot;Amount&quot;)                                             CA=T2.Rows(k)(&quot;C/A&quot;)
                                                            End If
                                                            end
                                                            if
                                                        next                                      Avg= Sum / 3
                                                        If Avg&lt;1.2*min Then
                                                            Salary=minimum                                         Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                        End If
                                                    else                                          Salary=minimum                                         Other=0
                                                        end
                                                        if
                                                    end if
                                                    end
                                                    if                         &#x27;test=T2                         &#x27;testT=Tcounter
                                                    else &#x27;++++++++++++++++++++++AA+++++++++ &#x27;=============================================================AA===================================================BEGIN
                                                        Dim T3 as DataTable=Buffer.Clone
                                                        Dim Tcounter2 as integer=0
                                                        for r as integer =0 to Buffer.Rows.Count-1                                 if(Buffer.Rows(r)(&quot;Sal&quot;)&gt;=LastApproved) then                                     x=T3.NewRow                                     x=Buffer.Rows(r)                                     T3.ImportRow(x)                                     Tcounter2=Tcounter2+1                                     BasicSalary=Buffer.Rows(r)(&quot;Sal&quot;)
                                                            end
                                                            if
                                                        next                                 Buffer=Nothing                             Buffer=T3 &#x27;===============================================================BB=============================================BEGIN                             if(Tcounter2=1)                                 x=T.NewRow
                                                        For r As Integer = 0 To Buffer.Rows.Count-1                                         Dayz=Buffer.Rows(r)(&quot;Days&quot;)                                     Dayz=Dayz-BaseDays
                                                            If ((Dayz&gt;=25 AND Dayz&lt;=35) OR (Dayz&gt;=55 AND Dayz&lt;=65) ) Then
                                                                x= Buffer.Rows(r)                                         T.ImportRow(x)                                         x=T.NewRow                                         Tcounter=Tcounter+1
                                                            End If
                                                        end if
                                                    next                                 &#x27;testT=Tcounter /checked
                                                    if Tcounter&lt;3                                     ReassignFlag=1                                     Status=&quot;Total number of feasible transaction is less than 3 after filtering with 25-35 and 55 to 65 in AA-BB-nonGov III&quot;
                                                    else                                     BSp=BasicSalary+(BasicSalary*20/100)                                     BSm=BasicSalary-(BasicSalary*20/100)                                     x=T2.NewRow
                                                        for r as integer=0 to T.Rows.count-1                                         if(T.Rows(r)(&quot;Sal&quot;)&gt;=BSm AND T.Rows(r)(&quot;Sal&quot;)&lt;=BSp)                                             x= T.Rows(r)                                             T2.ImportRow(x)                                             x=T2.NewRow                                             T2counter=T2counter+1
                                                            end
                                                            if
                                                        next
                                                        If T2counter&lt;2 Then
                                                            ReassignFlag=1                                         Status=&quot;Total number of feasible transaction is less than 2 after filtering BSm&lt;SAL&lt;BSp in AA-BB-nonGov IV&quot;
                                                        End If
                                                    else
                                                        if T2counter=2                                         min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                            For k As Integer = 0 To 1                                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                                If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                    min=T2.Rows(k)(&quot;Sal&quot;)                                                 minimum=T2.Rows(k)(&quot;Amount&quot;)                                                 CA=T2.Rows(k)(&quot;C/A&quot;)
                                                                End If
                                                                end
                                                                if
                                                            next                                          Avg= Sum / 2
                                                            If Avg&lt;1.2*min Then
                                                                Salary=minimum                                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                            End If
                                                        else                                              Salary=minimum                                             Other=0
                                                            end
                                                            if
                                                        else                                         min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                            For k As Integer = 0 To 2                                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                                If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                    min=T2.Rows(k)(&quot;Sal&quot;)                                                 minimum=T2.Rows(k)(&quot;Amount&quot;)                                                 CA=T2.Rows(k)(&quot;C/A&quot;)
                                                                End If
                                                                end
                                                                if
                                                            next                                          Avg= Sum / 3
                                                            If Avg&lt;1.2*min Then
                                                                Salary=minimum                                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                            End If
                                                        else                                              Salary=minimum                                             Other=0
                                                            end
                                                            if
                                                        end if
                                                        end
                                                        if  &#x27;===============================================================BB=============================================END
                                                        else
                                                            Dim Count4 as integer=0
                                                            Dim Prev as integer =0
                                                            Dim Base as Decimal=0
                                                            for r as integer=0 to A1.Rows.Count-1
                                                                For j as integer=0 to T3.Rows.Count-1
                                                                    if A1.Rows(r)(&quot;Amount&quot;)=T3.Rows(j)(&quot;Sal&quot;)                                             Count4=Count4+1
                                                                        end
                                                                        if
                                                                    next
                                                                    if prev&lt;Count4                                         BasicSalary=A1.Rows(r)(&quot;Amount&quot;)
                                                                        end
                                                                        if
                                                                    next &#x27;============================================================BB=============================================BEGIN                                             x=T.NewRow
                                                                    For r As Integer = 0 To Buffer.Rows.Count-1                                         Dayz=Buffer.Rows(r)(&quot;Days&quot;)                                     Dayz=Dayz-BaseDays
                                                                        If ((Dayz&gt;=25 AND Dayz&lt;=35) OR (Dayz&gt;=55 AND Dayz&lt;=65) ) Then
                                                                            x= Buffer.Rows(r)                                         T.ImportRow(x)                                         x=T.NewRow                                         Tcounter=Tcounter+1
                                                                        End If
                                                                    end if
                                                                next                                 &#x27;testT=Tcounter /checked
                                                                if Tcounter&lt;3                                     ReassignFlag=1                                     Status=&quot;Total number of feasible transaction is less than 3 after filtering 25-35 and 55-65 in AA-BB-nonGov V&quot;
                                                                else                                     BSp=BasicSalary+(BasicSalary*20/100)                                     BSm=BasicSalary-(BasicSalary*20/100)                                     x=T2.NewRow
                                                                    for r as integer=0 to T.Rows.count-1                                         if(T.Rows(r)(&quot;Sal&quot;)&gt;=BSm AND T.Rows(r)(&quot;Sal&quot;)&lt;=BSp)                                             x= T.Rows(r)                                             T2.ImportRow(x)                                             x=T2.NewRow                                             T2counter=T2counter+1
                                                                        end
                                                                        if
                                                                    next
                                                                    If T2counter&lt;2 Then
                                                                        ReassignFlag=1                                         Status=&quot;Total number of feasible transaction is less than 2 after filtering BSp&lt;=SAL&lt;=BSp in AA-BB-nonGov VI&quot;
                                                                    End If
                                                                else
                                                                    if T2counter=2                                         min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                                        For k As Integer = 0 To 1                                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                                            If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                                min=T2.Rows(k)(&quot;Sal&quot;)                                                 minimum=T2.Rows(k)(&quot;Amount&quot;)                                                 CA=T2.Rows(k)(&quot;C/A&quot;)
                                                                            End If
                                                                            end
                                                                            if
                                                                        next                                          Avg= Sum / 2
                                                                        If Avg&lt;1.2*min Then
                                                                            Salary=minimum                                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                                        End If
                                                                    else                                              Salary=minimum                                             Other=0
                                                                        end
                                                                        if
                                                                    else                                          min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                                        For k As Integer = 0 To 2                                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                                            If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                                min=T2.Rows(k)(&quot;Sal&quot;)                                                 minimum=T2.Rows(k)(&quot;Amount&quot;)                                                 CA=T2.Rows(k)(&quot;C/A&quot;)
                                                                            End If
                                                                            end
                                                                            if
                                                                        next                                          Avg= Sum / 3
                                                                        If Avg&lt;1.2*min Then
                                                                            Salary=minimum                                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                                        End If
                                                                    else                                              Salary=minimum                                             Other=0
                                                                        end
                                                                        if
                                                                    end if
                                                                    end
                                                                    if &#x27;===========================================================BB======================================================END
                                                                        end
                                                                        if &#x27;=============================================================AA===================================================    END
                                                                            end
                                                                            if &#x27;==============================================================BB============================================END                      &#x27;==============================================================B=============================================END
                                                                                end
                                                                                if &#x27;^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^Page2^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                                                                    end
                                                                                    if
                                                                                    end
                                                                                    if
                                                                                else             Status=&quot;Salary cannot be identified since there is no transaction in the past &quot;+TimePeriod.ToString+&quot; days&quot;             ReassignFlag=1
                                                                                    end
                                                                                    if
                                                                                else         ReassignFlag=1         Status=&quot;Total number of feasible transaction is less than 3&quot;
                                                                                    end
                                                                                    if
                                                                                else
                                                                                    Dim SD1p,SD1m,SD2p,SD2m,SD3p,SD3m,SD4p,SD4m as date
                                                                                    Dim Sflag as integer =0
                                                                                    Dim Salflag as integer =0
                                                                                    Dim Lflag as integer =0
                                                                                    Dim L2flag as integer =0
                                                                                    Dim LLcheck as integer =0
                                                                                    Dim BasicSalary as Integer =0
                                                                                    Dim T as DataTable =Buffer.Clone
                                                                                    Dim T2 as DataTable=Buffer.Clone
                                                                                    Dim TX as DataTable=Buffer.Clone
                                                                                    Dim LL as DataTable=Buffer.Clone
                                                                                    Dim LL1 as DataTable=Buffer.Clone
                                                                                    Dim L2 as DataTable=Buffer.Clone
                                                                                    Dim L21 as DataTable=Buffer.Clone
                                                                                    Dim L3 as DataTable=Buffer.Clone
                                                                                    Dim Tcounter as integer =0
                                                                                    Dim L3counter as integer =0
                                                                                    Dim T2counter as integer =0
                                                                                    Dim BSp,BSm as Decimal          Sum=0         minimum=0         Salary=0         Other=0         min=0         SD1p=SD1.AddDays(5)         SD1m=SD1.AddDays(-5)         SD2p=SD2.AddDays(5)         SD2m=SD2.AddDays(-5)         SD3p=SD3.AddDays(5)         SD3m=SD3.AddDays(-5)         SD4p=SD4.AddDays(5)         SD4m=SD4.AddDays(-5)         &#x27;        T=Buffer.Clone
                                                                                    For r As Integer = 0 To Buffer.Rows.Count-1         &#x27;
                                                                                        If (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3) Then
                                                                                            if((SD1m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))OR (SD2m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD3m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD3p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD4m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD4p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))) then                 x= Buffer.Rows(r)                 TX.ImportRow(x)                 x=TX.NewRow
                                                                                        End If
                                                                                    end if
                                                                                next         Buffer=TX
                                                                                For r As Integer = 0 To Buffer.Rows.Count-1         &#x27;
                                                                                    If (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3) Then
                                                                                        if(SD1m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) then                 x= Buffer.Rows(r)                 LL.ImportRow(x)                 x=LL.NewRow                 Lflag=Lflag+1
                                                                                    End If
                                                                                end if
                                                                            next
                                                                            If Lflag&lt;1 Then
                                                                                Lflag=0             x=LL1.NewRow
                                                                            End If
                                                                            For r As Integer = 0 To Buffer.Rows.Count-1                 if(SD1=Buffer.Rows(r)(&quot;Account date&quot;)) then                     x= Buffer.Rows(r)                     LL1.ImportRow(x)                     x=LL1.NewRow                     Lflag=Lflag+1
                                                                            end if
                                                                        next             LL=LL1
                                                                        end
                                                                        if          LLout=LL &#x27;+++++++++++++++++++++++++++
                                                                            If Lflag&gt;0 Then
                                                                                &#x27;+++++++++++++++++++++++++++
                                                                            End If
                                                                            if Lflag=1 then
                                                                                For r As Integer = 0 To Buffer.Rows.Count-1                     if(SD2m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) then                         x= Buffer.Rows(r)                         L2.ImportRow(x)                         x=L2.NewRow                         L2flag=L2flag+1
                                                                                end if
                                                                            next
                                                                            If L2flag&gt;0 Then
                                                                                test=101
                                                                            End If
                                                                            If L2flag=1 Then
                                                                                test=120
                                                                            End If
                                                                            If L2.Rows(0)(&quot;Sal&quot;)&gt;=LL.Rows(0)(&quot;Sal&quot;) Then
                                                                                salflag=1                             Salary=LL.Rows(0)(&quot;Amount&quot;)                             ReassignFlag=0                             CA=LL.Rows(0)(&quot;C/A&quot;)         test=100
                                                                            End If
                                                                        else                             x=L3.NewRow
                                                                            For r As Integer = 0 To Buffer.Rows.Count-1                                 if((SD2m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD3m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD3p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD4m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD4p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))) then                                     x= Buffer.Rows(r)                                     L3.ImportRow(x)                                     x=L3.NewRow                                     L3counter=L3counter+1
                                                                            end if
                                                                        next
                                                                        If L3counter&gt;2 Then
                                                                            min=L3.Rows(0)(&quot;Sal&quot;)+1
                                                                        End If
                                                                        For k As Integer = 0 To 2                                     Sum=Sum+L3.Rows(k)(&quot;Sal&quot;)
                                                                            If min&gt;L3.Rows(k)(&quot;Sal&quot;) Then
                                                                                min=L3.Rows(k)(&quot;Sal&quot;)                                         minimum=L3.Rows(k)(&quot;Amount&quot;)                                         CA=L3.Rows(k)(&quot;C/A&quot;)
                                                                            End If
                                                                            end
                                                                            if
                                                                        next                                  Avg=Sum/3
                                                                        If Avg&lt;1.2*min Then
                                                                            Salary=minimum                                     Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)                                     salflag=1
                                                                        End If
                                                                    else                                     salflag=0
                                                                        end
                                                                        if
                                                                    else                                         salflag=0
                                                                        end
                                                                        if
                                                                        end
                                                                        if
                                                                    else test=110                         L2flag=0                         x=L21.NewRow
                                                                        For r As Integer = 0 To Buffer.Rows.Count-1                             if(SD2=Buffer.Rows(r)(&quot;Account date&quot;)) then                                 x= Buffer.Rows(r)                                 L21.ImportRow(x)                                 x=L21.NewRow                                 L2flag=L2flag+1
                                                                        end if
                                                                    next                         L2=L21
                                                                    if L2flag=1 then
                                                                        If L2.Rows(0)(&quot;Sal&quot;)&gt;=LL.Rows(0)(&quot;Sal&quot;) Then
                                                                            salflag=1                                 Salary=LL.Rows(0)(&quot;Amount&quot;)                                 ReassignFlag=0
                                                                        End If
                                                                        end
                                                                        if
                                                                        end
                                                                        if
                                                                        end
                                                                        if
                                                                        If salflag=0 Then
                                                                            &#x27;test=102 &#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;                         Sum=0
                                                                        End If
                                                                        For r As Integer = 0 To Buffer.Rows.Count-1                         &#x27;
                                                                            if (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1) then
                                                                                If (SD2m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) Then
                                                                                    Sflag=Sflag+1                                 BasicSalary=Buffer.Rows(r)(&quot;Sal&quot;)                                 &#x27;AM=BasicSalary
                                                                                End If
                                                                                end
                                                                                if
                                                                            Next                         &#x27;AM=BasicSalary
                                                                            If Sflag=1 Then
                                                                                x=T.NewRow
                                                                            End If
                                                                            For r As Integer = 0 To Buffer.Rows.Count-1                         &#x27;
                                                                                If (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3) Then
                                                                                    if((SD2m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD3m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD3p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD4m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD4p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))) then                                     x= Buffer.Rows(r)                                     T.ImportRow(x)                                     x=T.NewRow                                     Tcounter=Tcounter+1
                                                                                End If
                                                                            end if
                                                                        next
                                                                        if Tcounter&lt;2                                 ReassignFlag=1                                 Status=&quot;Total number of feasible transaction is less than 2 after filtering with +/-5 salary date I&quot;
                                                                        else                                 BSp=BasicSalary+(BasicSalary*20/100)                                 BSm=BasicSalary-(BasicSalary*20/100)                                 x=T2.NewRow
                                                                            for r as integer=0 to T.Rows.count-1                                     if(T.Rows(r)(&quot;Sal&quot;)&gt;=BSm AND T.Rows(r)(&quot;Sal&quot;)&lt;=BSp)                                         x= T.Rows(r)                                         T2.ImportRow(x)                                         x=T2.NewRow                                         T2counter=T2counter+1
                                                                                end
                                                                                if
                                                                            next
                                                                            If T2counter&lt;2 Then
                                                                                ReassignFlag=1                                     Status=&quot;Total number of feasible transaction is less than 2 after filtering BSm &lt;= Salary &lt;=BSp&quot;
                                                                            End If
                                                                        else
                                                                            if T2counter=2                                     min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                                                For k As Integer = 0 To 1                                         Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                                                    If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                                        min=T2.Rows(k)(&quot;Sal&quot;)                                             minimum=T2.Rows(k)(&quot;Amount&quot;)                                             CA=T2.Rows(k)(&quot;C/A&quot;)
                                                                                    End If
                                                                                    end
                                                                                    if
                                                                                next                                     Avg= Sum / 2
                                                                                If Avg&lt;1.2*min Then
                                                                                    test=2                 &#x27;
                                                                                End If
                                                                                For r As Integer = 0 To LL.Rows.Count-1                 &#x27;                            if(LL.Rows(r)(&quot;Sal&quot;)&gt;=Avg*0.65) then                 &#x27;
                                                                                    If LLcheck=0 Then
                                                                                        &#x27;                                    LLcheck=1                 &#x27;                                    if(Math.Floor(LL.Rows(r)(&quot;Sal&quot;))&lt;=Avg) then                 &#x27;                                        Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                    End If
                                                                                else if(LL.Rows(r)(&quot;Sal&quot;)&lt;=Avg*1.2) then                 &#x27;                                        Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                else                     &#x27;                                        ReassignFlag=1                 &#x27;                                        Status=&quot;Salary not identified sincee one transaction in last month is grater than selected salary&quot;                 &#x27;
                                                                                    end
                                                                                    if                 &#x27;
                                                                                    else                  &#x27;                                    ReassignFlag=1                 &#x27;                                    Status=&quot;More than one transaction is grater then 65% of selected salary&quot;                 &#x27;
                                                                                        end
                                                                                        if                 &#x27;
                                                                                        end if                     &#x27;
                                                                                    next                                         Salary=minimum                                         Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                                                else                 &#x27;
                                                                                    For r As Integer = 0 To LL.Rows.Count-1                 &#x27;                            if(LL.Rows(r)(&quot;Sal&quot;)&gt;=min*0.65) then                 &#x27;
                                                                                        If LLcheck=0 Then
                                                                                            &#x27;                                    LLcheck=1                 &#x27;                                    if(Math.Floor(LL.Rows(r)(&quot;Sal&quot;))&lt;=min) then                 &#x27;                                        Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                        End If
                                                                                    else if(LL.Rows(r)(&quot;Sal&quot;)&lt;min*1.2) then                 &#x27;                                        Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                    else                 &#x27;                                        ReassignFlag=1                 &#x27;                                        Status=&quot;Salary not identified sincee one transaction in last month is grater than selected salary&quot;                 &#x27;
                                                                                        end
                                                                                        if                 &#x27;
                                                                                        else                  &#x27;                                    ReassignFlag=1                 &#x27;                                    Status=&quot;More than one transaction is grater then 65% of selected salary&quot;                 &#x27;
                                                                                            end
                                                                                            if                 &#x27;
                                                                                            end if                     &#x27;
                                                                                        next                 test=2.1                                         Salary=minimum
                                                                                        end
                                                                                        if
                                                                                    else                                     min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                                                        For k As Integer = 0 To 2                                         Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                                                            If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                                                min=T2.Rows(k)(&quot;Sal&quot;)                                             minimum=T2.Rows(k)(&quot;Amount&quot;)                                             CA=T2.Rows(k)(&quot;C/A&quot;)
                                                                                            End If
                                                                                            end
                                                                                            if
                                                                                        next                                     Avg= Sum / 3
                                                                                        If Avg&lt;1.2*min Then
                                                                                            test=2                 &#x27;
                                                                                        End If
                                                                                        For r As Integer = 0 To LL.Rows.Count-1                 &#x27;                            if(LL.Rows(r)(&quot;Sal&quot;)&gt;=Avg*0.65) then                 &#x27;
                                                                                            If LLcheck=0 Then
                                                                                                &#x27;                                    LLcheck=1                 &#x27;                                    if(Math.Floor(LL.Rows(r)(&quot;Sal&quot;))&lt;=Avg) then                 &#x27;                                        Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                            End If
                                                                                        else if(LL.Rows(r)(&quot;Sal&quot;)&lt;Avg*1.2) then                 &#x27;                                        Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                        else                 &#x27;er=Avg                 &#x27;Buffer=T2                 &#x27;                                        ReassignFlag=1                 &#x27;                                        Status=&quot;Salary not identified sincee one transaction in last month is grater than selected salary&quot;                 &#x27;
                                                                                            end
                                                                                            if                 &#x27;
                                                                                            else                  &#x27;                                    ReassignFlag=1                 &#x27;                                    Status=&quot;More than one transaction is grater then 65% of selected salary&quot;                 &#x27;
                                                                                                end
                                                                                                if                 &#x27;
                                                                                                end if                     &#x27;
                                                                                            next                                         Salary=minimum                                         Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                                                        else                 &#x27;
                                                                                            For r As Integer = 0 To LL.Rows.Count-1                 &#x27;                            if(LL.Rows(r)(&quot;Sal&quot;)&gt;=min*0.65) then                 &#x27;
                                                                                                If LLcheck=0 Then
                                                                                                    &#x27;                                    LLcheck=1                 &#x27;                                    if(Math.Floor(LL.Rows(r)(&quot;Sal&quot;))&lt;=min) then                 &#x27;                                        Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                                End If
                                                                                            else if(LL.Rows(r)(&quot;Sal&quot;)&lt;=min*1.2) then                 &#x27;                                        Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                            else                 &#x27;                                        ReassignFlag=1                 &#x27;                                        Status=&quot;Salary not identified sincee one transaction in last month is grater than selected salary&quot;                 &#x27;
                                                                                                end
                                                                                                if                 &#x27;
                                                                                                else                  &#x27;                                    ReassignFlag=1                 &#x27;                                    Status=&quot;More than one transaction is grater then 65% of selected salary&quot;                 &#x27;
                                                                                                    end
                                                                                                    if                 &#x27;
                                                                                                    end if                     &#x27;
                                                                                                next                 test=2.1                                         Salary=minimum
                                                                                                end
                                                                                                if
                                                                                            end if
                                                                                            end
                                                                                            if                         &#x27;    test=T                         &#x27;    testT=Tcounter
                                                                                            else &#x27;=============================================================AA===================================================BEGIN
                                                                                                Dim T3 as DataTable=Buffer.Clone
                                                                                                Dim Tcounter2 as integer=0
                                                                                                for r as integer =0 to Buffer.Rows.Count-1                                 if(Buffer.Rows(r)(&quot;Sal&quot;)&gt;=LastApproved) then                                     x=T3.NewRow                                     x=Buffer.Rows(r)                                     T3.ImportRow(x)                                     Tcounter2=Tcounter2+1                                     BasicSalary=Buffer.Rows(r)(&quot;Sal&quot;)
                                                                                                    end
                                                                                                    if
                                                                                                next                             &#x27;    Buffer=Nothing                         &#x27;    Buffer=T3                             Cop=Buffer &#x27;===============================================================BB=============================================BEGIN                             if(Tcounter2=1)                                 x=T.NewRow
                                                                                                For r As Integer = 0 To Buffer.Rows.Count-1                         &#x27;
                                                                                                    If (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3) Then
                                                                                                        if((SD1m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))OR (SD2m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD3m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD3p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD4m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD4p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))) then                                         x= Buffer.Rows(r)                                         T.ImportRow(x)                                         x=T.NewRow                                         Tcounter=Tcounter+1
                                                                                                    End If
                                                                                                end if
                                                                                            next
                                                                                            if Tcounter&lt;2                                     ReassignFlag=1                                     Status=&quot;Total number of feasible transaction is less than 2 after filtering with +/-5 salary date in AA-BB-Gov I&quot;
                                                                                            else                                     BSp=BasicSalary+(BasicSalary*20/100)                                     BSm=BasicSalary-(BasicSalary*20/100)                                     x=T2.NewRow
                                                                                                for r as integer=0 to T.Rows.count-1                                         if(T.Rows(r)(&quot;Sal&quot;)&gt;=BSm AND T.Rows(r)(&quot;Sal&quot;)&lt;=BSp)                                             x= T.Rows(r)                                             T2.ImportRow(x)                                             x=T2.NewRow                                             T2counter=T2counter+1
                                                                                                    end
                                                                                                    if
                                                                                                next
                                                                                                If T2counter&lt;2 Then
                                                                                                    ReassignFlag=1                                         Status=&quot;Total number of feasible transaction is less than 2 after filtering with +/-5 salary date in AA-BB-Gov II&quot;
                                                                                                End If
                                                                                            else
                                                                                                if T2counter=2                                         min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                                                                    For k As Integer = 0 To 1                                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                                                                        If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                                                            min=T2.Rows(k)(&quot;Sal&quot;)                                                 minimum=T2.Rows(k)(&quot;Amount&quot;)                                                 CA=T2.Rows(k)(&quot;C/A&quot;)
                                                                                                        End If
                                                                                                        end
                                                                                                        if
                                                                                                    next                                         Avg= Sum / 2
                                                                                                    If Avg&lt;1.2*min Then
                                                                                                        test=3                 &#x27;
                                                                                                    End If
                                                                                                    For r As Integer = 0 To LL.Rows.Count-1                 &#x27;                                if(LL.Rows(r)(&quot;Sal&quot;)&gt;=Avg*0.65) then                 &#x27;
                                                                                                        If LLcheck=0 Then
                                                                                                            &#x27;                                        LLcheck=1                 &#x27;                                        if(Math.Floor(LL.Rows(r)(&quot;Sal&quot;))&lt;=Avg) then                 &#x27;                                            Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                                        End If
                                                                                                    else if(LL.Rows(r)(&quot;Sal&quot;)&lt;=Avg*1.2) then                 &#x27;                                            Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                                    else                 &#x27;                                            ReassignFlag=1                 &#x27;                                            Status=&quot;Salary not identified sincee one transaction in last month is grater than selected salary&quot;                 &#x27;
                                                                                                        end
                                                                                                        if                 &#x27;
                                                                                                        else                  &#x27;                                        ReassignFlag=1                 &#x27;                                        Status=&quot;More than one transaction is grater then 65% of selected salary&quot;                 &#x27;
                                                                                                            end
                                                                                                            if                 &#x27;
                                                                                                            end if                     &#x27;
                                                                                                        next                                             Salary=minimum                                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                                                                    else                 &#x27;
                                                                                                        For r As Integer = 0 To LL.Rows.Count-1                 &#x27;                                if(LL.Rows(r)(&quot;Sal&quot;)&gt;=min*0.65) then                 &#x27;
                                                                                                            If LLcheck=0 Then
                                                                                                                &#x27;                                        LLcheck=1                 &#x27;                                        if(Math.Floor(LL.Rows(r)(&quot;Sal&quot;))&lt;=min) then                 &#x27;                                            Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                                            End If
                                                                                                        else if(LL.Rows(r)(&quot;Sal&quot;)&lt;=min*1.2) then                 &#x27;                                            Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                                        else                 &#x27;                                            ReassignFlag=1                 &#x27;                                            Status=&quot;Salary not identified sincee one transaction in last month is grater than selected salary&quot;                 &#x27;
                                                                                                            end
                                                                                                            if                 &#x27;
                                                                                                            else                  &#x27;                                        ReassignFlag=1                 &#x27;                                        Status=&quot;More than one transaction is grater then 65% of selected salary&quot;                 &#x27;
                                                                                                                end
                                                                                                                if                 &#x27;
                                                                                                                end if                     &#x27;
                                                                                                            next                 test=3.1                                             Salary=minimum
                                                                                                            end
                                                                                                            if
                                                                                                        else                                         min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                                                                            For k As Integer = 0 To 2                                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                                                                                If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                                                                    min=T2.Rows(k)(&quot;Sal&quot;)                                                 minimum=T2.Rows(k)(&quot;Amount&quot;)                                                 CA=T2.Rows(k)(&quot;C/A&quot;)
                                                                                                                End If
                                                                                                                end
                                                                                                                if
                                                                                                            next                                         Avg= Sum / 3
                                                                                                            If Avg&lt;1.2*min Then
                                                                                                                test=3                 &#x27;
                                                                                                            End If
                                                                                                            For r As Integer = 0 To LL.Rows.Count-1                 &#x27;                                if(LL.Rows(r)(&quot;Sal&quot;)&gt;=Avg*0.65) then                 &#x27;
                                                                                                                If LLcheck=0 Then
                                                                                                                    &#x27;                                        LLcheck=1                 &#x27;                                        if(Math.Floor(LL.Rows(r)(&quot;Sal&quot;))&lt;=Avg) then                 &#x27;                                            Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                                                End If
                                                                                                            else if(LL.Rows(r)(&quot;Sal&quot;)&lt;=Avg*1.2) then                 &#x27;                                            Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                                            else                 &#x27;                                            ReassignFlag=1                 &#x27;                                            Status=&quot;Salary not identified sincee one transaction in last month is grater than selected salary&quot;                 &#x27;
                                                                                                                end
                                                                                                                if                 &#x27;
                                                                                                                else                  &#x27;                                        ReassignFlag=1                 &#x27;                                        Status=&quot;More than one transaction is grater then 65% of selected salary&quot;                 &#x27;
                                                                                                                    end
                                                                                                                    if                 &#x27;
                                                                                                                    end if                     &#x27;
                                                                                                                next                                             Salary=minimum                                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                                                                            else                 &#x27;
                                                                                                                For r As Integer = 0 To LL.Rows.Count-1                 &#x27;                                if(LL.Rows(r)(&quot;Sal&quot;)&gt;=min*0.65) then                 &#x27;
                                                                                                                    If LLcheck=0 Then
                                                                                                                        &#x27;                                        LLcheck=1                 &#x27;                                        if(Math.Floor(LL.Rows(r)(&quot;Sal&quot;))&lt;=min) then                 &#x27;                                            Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                                                    End If
                                                                                                                else if(LL.Rows(r)(&quot;Sal&quot;)&lt;=min*1.2) then                 &#x27;                                            Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                                                else                 &#x27;                                            ReassignFlag=1                 &#x27;                                            Status=&quot;Salary not identified since one transaction in last month is grater than selected salary&quot;                 &#x27;
                                                                                                                    end
                                                                                                                    if                 &#x27;
                                                                                                                    else                  &#x27;                                        ReassignFlag=1                 &#x27;                                        Status=&quot;More than one transaction is grater then 65% of selected salary&quot;                 &#x27;
                                                                                                                        end
                                                                                                                        if                 &#x27;
                                                                                                                        end if                     &#x27;
                                                                                                                    next                 test=3.1                                             Salary=minimum
                                                                                                                    end
                                                                                                                    if
                                                                                                                end if
                                                                                                                end
                                                                                                                if &#x27;===============================================================BB=============================================END
                                                                                                                else
                                                                                                                    Dim Count4 as integer=0
                                                                                                                    Dim Prev as integer =0
                                                                                                                    Dim Base as Decimal=0
                                                                                                                    for r as integer=0 to A1.Rows.Count-1
                                                                                                                        For j as integer=0 to T3.Rows.Count-1
                                                                                                                            if A1.Rows(r)(&quot;Amount&quot;)=T3.Rows(j)(&quot;Sal&quot;)                                             Count4=Count4+1
                                                                                                                                end
                                                                                                                                if
                                                                                                                            next
                                                                                                                            if prev&lt;Count4                                         BasicSalary=A1.Rows(r)(&quot;Amount&quot;)                                         prev=Count4
                                                                                                                                end
                                                                                                                                if                                     Count4=0
                                                                                                                                next                                                 x=T.NewRow
                                                                                                                                For r As Integer = 0 To Buffer.Rows.Count-1                         &#x27;
                                                                                                                                    If (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3) Then
                                                                                                                                        if((SD1m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))OR (SD2m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD3m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD3p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD4m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD4p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))) then                                         x= Buffer.Rows(r)                                         T.ImportRow(x)                                         x=T.NewRow                                         Tcounter=Tcounter+1
                                                                                                                                    End If
                                                                                                                                end if
                                                                                                                            next
                                                                                                                            if Tcounter&lt;2                                     ReassignFlag=1                                     Status=&quot;Total number of feasible transaction is less than 2 after filtering with +/-5 salary date in AA-BB-Gov III&quot;
                                                                                                                            else                                     BSp=BasicSalary+(BasicSalary*20/100)                                     BSm=BasicSalary-(BasicSalary*20/100)                                     x=T2.NewRow
                                                                                                                                for r as integer=0 to T.Rows.count-1                                         if(T.Rows(r)(&quot;Sal&quot;)&gt;=BSm AND T.Rows(r)(&quot;Sal&quot;)&lt;=BSp)                                             x= T.Rows(r)                                             T2.ImportRow(x)                                             x=T2.NewRow                                             T2counter=T2counter+1
                                                                                                                                    end
                                                                                                                                    if
                                                                                                                                next
                                                                                                                                If T2counter&lt;2 Then
                                                                                                                                    ReassignFlag=1                                         Status=&quot;Total number of feasible transaction is less than 2 after filtering BSm&lt;= SAL &lt;=BSp in AA-BB-Gov IV&quot;
                                                                                                                                End If
                                                                                                                            else
                                                                                                                                if T2counter=2                                         min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                                                                                                    For k As Integer = 0 To 1                                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                                                                                                        If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                                                                                            min=T2.Rows(k)(&quot;Sal&quot;)                                                 minimum=T2.Rows(k)(&quot;Amount&quot;)                                                 CA=T2.Rows(k)(&quot;C/A&quot;)
                                                                                                                                        End If
                                                                                                                                        end
                                                                                                                                        if
                                                                                                                                    next                                         Avg= Sum / 2
                                                                                                                                    If Avg&lt;1.2*min Then
                                                                                                                                        test=4                 &#x27;
                                                                                                                                    End If
                                                                                                                                    For r As Integer = 0 To LL.Rows.Count-1                 &#x27;                                if(LL.Rows(r)(&quot;Sal&quot;)&gt;=Avg*0.65) then                 &#x27;
                                                                                                                                        If LLcheck=0 Then
                                                                                                                                            &#x27;                                        LLcheck=1                 &#x27;                                        if(Math.Floor(LL.Rows(r)(&quot;Sal&quot;))&lt;=Avg) then                 &#x27;                                            Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                                                                        End If
                                                                                                                                    else if(LL.Rows(r)(&quot;Sal&quot;)&lt;=Avg*1.2) then                 &#x27;                                            Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                                                                    else                 &#x27;                                            ReassignFlag=1                 &#x27;                                            Status=&quot;Salary not identified sincee one transaction in last month is grater than selected salary&quot;                 &#x27;
                                                                                                                                        end
                                                                                                                                        if                 &#x27;
                                                                                                                                        else                  &#x27;                                        ReassignFlag=1                 &#x27;                                        Status=&quot;More than one transaction is grater then 65% of selected salary&quot;                 &#x27;
                                                                                                                                            end
                                                                                                                                            if                 &#x27;
                                                                                                                                            end if                     &#x27;
                                                                                                                                        next                                             Salary=minimum                                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                                                                                                    else                 &#x27;
                                                                                                                                        For r As Integer = 0 To LL.Rows.Count-1                 &#x27;                                if(LL.Rows(r)(&quot;Sal&quot;)&gt;=min*0.65) then                 &#x27;
                                                                                                                                            If LLcheck=0 Then
                                                                                                                                                &#x27;                                        LLcheck=1                 &#x27;                                        if(Math.Floor(LL.Rows(r)(&quot;Sal&quot;))&lt;=min) then                 &#x27;                                            Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                                                                            End If
                                                                                                                                        else if(LL.Rows(r)(&quot;Sal&quot;)&lt;=min*1.2) then                 &#x27;                                            Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                                                                        else                 &#x27;                                            ReassignFlag=1                 &#x27;                                            Status=&quot;Salary not identified sincee one transaction in last month is grater than selected salary&quot;                 &#x27;
                                                                                                                                            end
                                                                                                                                            if                 &#x27;
                                                                                                                                            else                  &#x27;                                        ReassignFlag=1                 &#x27;                                        Status=&quot;More than one transaction is grater then 65% of selected salary&quot;                 &#x27;
                                                                                                                                                end
                                                                                                                                                if                 &#x27;
                                                                                                                                                end if                     &#x27;
                                                                                                                                            next                 test=4.1                                             Salary=minimum
                                                                                                                                            end
                                                                                                                                            if
                                                                                                                                        else                                          min=T2.Rows(0)(&quot;Sal&quot;)+1
                                                                                                                                            For k As Integer = 0 To 2                                             Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                                                                                                                                If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                                                                                                                                    min=T2.Rows(k)(&quot;Sal&quot;)                                                 minimum=T2.Rows(k)(&quot;Amount&quot;)                                                 CA=T2.Rows(k)(&quot;C/A&quot;)
                                                                                                                                                End If
                                                                                                                                                end
                                                                                                                                                if
                                                                                                                                            next                                         Avg= Sum / 3
                                                                                                                                            If Avg&lt;1.2*min Then
                                                                                                                                                test=4                 &#x27;
                                                                                                                                            End If
                                                                                                                                            For r As Integer = 0 To LL.Rows.Count-1                 &#x27;                                if(LL.Rows(r)(&quot;Sal&quot;)&gt;=Avg*0.65) then                 &#x27;
                                                                                                                                                If LLcheck=0 Then
                                                                                                                                                    &#x27;                                        LLcheck=1                 &#x27;                                        if(Math.Floor(LL.Rows(r)(&quot;Sal&quot;))&lt;=Avg) then                 &#x27;                                            Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                                                                                End If
                                                                                                                                            else if(LL.Rows(r)(&quot;Sal&quot;)&lt;=Avg*1.2) then                 &#x27;                                            Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                                                                            else                 &#x27;                                            ReassignFlag=1                 &#x27;                                            Status=&quot;Salary not identified sincee one transaction in last month is grater than selected salary&quot;                 &#x27;
                                                                                                                                                end
                                                                                                                                                if                 &#x27;
                                                                                                                                                else                  &#x27;                                        ReassignFlag=1                 &#x27;                                        Status=&quot;More than one transaction is grater then 65% of selected salary&quot;                 &#x27;
                                                                                                                                                    end
                                                                                                                                                    if                 &#x27;
                                                                                                                                                    end if                     &#x27;
                                                                                                                                                next                                             Salary=minimum                                             Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                                                                                                                                            else                 &#x27;
                                                                                                                                                For r As Integer = 0 To LL.Rows.Count-1                 &#x27;                                if(LL.Rows(r)(&quot;Sal&quot;)&gt;=min*0.65) then                 &#x27;
                                                                                                                                                    If LLcheck=0 Then
                                                                                                                                                        &#x27;                                        LLcheck=1                 &#x27;                                        if(Math.Floor(LL.Rows(r)(&quot;Sal&quot;))&lt;=min) then                 &#x27;                                            Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                                                                                    End If
                                                                                                                                                else if(LL.Rows(r)(&quot;Sal&quot;)&lt;=min*1.2) then                 &#x27;                                            Salary=LL.Rows(r)(&quot;Amount&quot;)                 &#x27;
                                                                                                                                                else                 &#x27;                                            ReassignFlag=1                 &#x27;                                            Status=&quot;Salary not identified sincee one transaction in last month is grater than selected salary&quot;                 &#x27;
                                                                                                                                                    end
                                                                                                                                                    if                 &#x27;
                                                                                                                                                    else                  &#x27;                                        ReassignFlag=1                 &#x27;                                        Status=&quot;More than one transaction is grater then 65% of selected salary&quot;                 &#x27;
                                                                                                                                                        end
                                                                                                                                                        if                 &#x27;
                                                                                                                                                        end if                     &#x27;
                                                                                                                                                    next                 test=4.1                                             Salary=minimum
                                                                                                                                                    end
                                                                                                                                                    if
                                                                                                                                                end if
                                                                                                                                                end
                                                                                                                                                if
                                                                                                                                                end
                                                                                                                                                if
                                                                                                                                                end
                                                                                                                                                if
                                                                                                                                                end
                                                                                                                                                if                     &#x27;
                                                                                                                                                    end
                                                                                                                                                    if &#x27;=============================================================AA===================================================    END
                                                                                                                                                    else                      ReassignFlag=1                     Status=&quot;No transaction available in 2nd last month&quot;
                                                                                                                                                        end
                                                                                                                                                        if
                                                                                                                                                    else                  Status=&quot;More than one transaction in last month&quot;                 ReassignFlag=1
                                                                                                                                                        end
                                                                                                                                                        if
                                                                                                                                                    else             Status=&quot;No transaction in of last salary date&quot;             ReassignFlag=1
                                                                                                                                                        end
                                                                                                                                                        if
                                                                                                                                                        end
                                                                                                                                                        if
                                                                                                                                                    else      Status=&quot;Total number of feasible transaction is less than 3&quot;     ReassignFlag=1
                                                                                                                                                        end
                                                                                                                                                        if D0=D1 A0=A1
                                                                                                                                                        catch e as Exception         er=e.ToString         ReassignFlag=1         Status=&quot;Code Error:&quot;+e.ToString
                                                                                                                                                            end
                                                                                                                                                            try"
                            data-title="UWCA_MRCC_CTF_V1.0 / Salary code / Salary Calculation(new)9 wit C\A added">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>UWCA_MRCC_CTF_V1.0</td>
                <td>Salary code</td>
                <td>Salary code requirements2</td>
                <td>visualbasic</td>
                <td>61</td>
                <!--<td style="font-family: monospace;">76b4abcfbf7c9252f9e8e35da9781613c9eb74b34a1bff941de20f3e2932d304</td>-->
                <td>reflection</td>
                <!--<td>&#x27;Page1 If Not c1.Columns.Contains(&quot;Sal&quot;) Then     c1.Columns.Add(&quot;Sal&quot;, Type.GetType(&quot;System.Decimal&quot;)) End If End If For r As Integer = 0 To c1.Rows.Count - 1         c1.Rows(r)(&quot;Sal&quot;) = Replace(Replace(c1.Rows(r)(&quot;Amount&quot;), &quot;.&quot;, &quot;&quot;), &quot;,&quot;, &quot;.&quot;)         c1.Rows(r)(&quot;Sal&quot;)=Convert.ToDecimal(c1.Rows(r)...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="&#x27;Page1
If Not c1.Columns.Contains(&quot;Sal&quot;) Then
    c1.Columns.Add(&quot;Sal&quot;, Type.GetType(&quot;System.Decimal&quot;))
End If
End
If
For r As Integer = 0 To c1.Rows.Count - 1         c1.Rows(r)(&quot;Sal&quot;) = Replace(Replace(c1.Rows(r)(&quot;Amount&quot;), &quot;.&quot;, &quot;&quot;), &quot;,&quot;, &quot;.&quot;)         c1.Rows(r)(&quot;Sal&quot;)=Convert.ToDecimal(c1.Rows(r)(&quot;Sal&quot;))
Next  &#x27;Filter
Dim NewRow As DataRow  C0 = C1.Clone
For Each parentRow As DataRow In C1.Select(Select_Condition)     NewRow = C0.NewRow
    For Each c As DataColumn In NewRow.Table.Columns         NewRow(c.ColumnName) = parentRow(c.ColumnName)
    Next     C0.Rows.Add(NewRow)
Next  NewRow = Nothing C1 = Nothing  &#x27;Page2 C1=C0
Dim x as integer = 0
Dim dd,mm,yy as string
Dim count as integer =0
dim test,dec
dim flag as integer=1
dim days as integer =0 dec=&quot;&quot; dd=&quot;&quot; mm=&quot;&quot; yy=&quot;&quot; &#x27;
If Not c1.Columns.Contains(&quot;ADate&quot;) Then
    &#x27;    c1.Columns.Add(&quot;ADate&quot;, Type.GetType(&quot;System.String&quot;)) &#x27;
End If
End
if
If Not c1.Columns.Contains(&quot;Days&quot;) Then
    c1.Columns.Add(&quot;Days&quot;, Type.GetType(&quot;System.Decimal&quot;))
End If
End
if
For i As Integer = 0 To c1.Rows.Count - 1     c1.Rows(i)(&quot;Description&quot;)=Replace(c1.Rows(i)(&quot;Description&quot;),&quot; &quot;,&quot;&quot;)     test=c1.Rows(i)(&quot;Description&quot;)
    do         x = InStr(test, &quot;/&quot;)     if(x&gt;0)             test=Replace(test, Left(test, x),&quot;&quot;)
        if flag=1         dec=test         flag = 0
            end
            if             count = count+1
            end if
        loop
        while x&lt;&gt;0
            if count&gt;2         c1.Rows(i)(&quot;Description&quot;)= Trim(dec)
            else &#x27;        dec=&quot;arb: &quot;+c1.Rows(r)(&quot;Description&quot;)
                Dim R as New Regex(&quot;[A-Z,0-9,/]*(?&lt;Result&gt;[أ-ي,0-9]*)&quot;, RegexOptions.SingleLine)
                Dim M as Match = R.Match(c1.Rows(i)(&quot;Description&quot;))
                If M IsNot Nothing AndAlso M.Success Then
                    dec = M.Groups(&quot;Result&quot;).Value
                End If
                End
                If         c1.Rows(i)(&quot;Description&quot;)= Trim(dec)
                    end
                    if     flag=1     count=0     x=0     yy=c1.Rows(i)(&quot;Account date&quot;)
                        for j as integer =0 to 2         x=Instr(yy,&quot;/&quot;)
                            If j=0 Then
                                dd=Left(yy,x-1)             yy=Right(yy,len(yy)-x)
                            End If
                        else
                            if j=1             mm=Left(yy,x-1)             yy=Right(yy,len(yy)-x)
                                end
                                if
                            next
                            if mm&lt;&gt;&quot;&quot;&#x27;Date.Parse         c1.Rows(i)(&quot;Account date&quot;)=(mm+&quot;/&quot;+dd+&quot;/&quot;+yy)
                                end
                                if     days=DateDiff(DateInterval.Day,Date.Parse(c1.Rows(i)(&quot;Account date&quot;)),Today())         c1.Rows(i)(&quot;Days&quot;)=days dec=&quot;&quot; dd=&quot;&quot; mm=&quot;&quot;  yy=&quot;&quot;
                                Next  c1.DefaultView.Sort = &quot;Days&quot; &amp; &quot; ASC&quot;  c0 = c1.DefaultView.ToTable"
                            data-title="UWCA_MRCC_CTF_V1.0 / Salary code / Salary code requirements2">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>UWCA_MRCC_CTF_V1.0</td>
                <td>Salary code</td>
                <td>Universal salary code</td>
                <td>visualbasic</td>
                <td>326</td>
                <!--<td style="font-family: monospace;">d9018d38a95c6937618378b5ff57a6bd4dfdecab074454201b3c73ea262f9765</td>-->
                <td>—</td>
                <!--<td>try     Dim description as string     Dim x As DataRow = D1.NewRow     Dim Dflag as integer =0     Dim precount as integer =0     Dim Amount as integer =0     Dim Avg as Decimal=0     Dim Sum as integer =0     Dim skip as integer =0     Dim min as integer =0     Dim count as integer =0     Dim Av as...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="try
    Dim description as string
    Dim x As DataRow = D1.NewRow
    Dim Dflag as integer =0
    Dim precount as integer =0
    Dim Amount as integer =0
    Dim Avg as Decimal=0
    Dim Sum as integer =0
    Dim skip as integer =0
    Dim min as integer =0
    Dim count as integer =0
    Dim Av as integer =0
    Dim mi as integer =0
    Dim minim as string min=0 count=0 minim=&quot;&quot;
    if c1.Rows.Count&gt;2 then
        For r As Integer = 0 To c1.Rows.Count-1         description=c1.Rows(r)(&quot;Description&quot;)         Dflag=0
            for i as integer=0 To D1.Rows.Count-1
                If D1.Rows(i)(&quot;Description&quot;)=description Then
                    Dflag=1                 D1.Rows(i)(&quot;Count&quot;)=D1.Rows(i)(&quot;Count&quot;)+1
                End If
                end
                if
            next
            If Dflag=0 Then
                x(&quot;Description&quot;) = description             x(&quot;Count&quot;)=1             D1.Rows.Add(x)             x= D1.NewRow
            End If
            end
            if
        Next
        For r As Integer = 0 To D1.Rows.Count-1         description=D1.Rows(r)(&quot;Description&quot;)         CollOut=Nothing         CollOut=c1.Clone
            For Each parentRow As DataRow In c1.Select(&quot;Description=&#x27;&quot;+description+&quot;&#x27;&quot;)             x = CollOut.NewRow
                For Each c As DataColumn In x.Table.Columns                     x(c.ColumnName) = parentRow(c.ColumnName)
                Next             CollOut.Rows.Add(x)
            Next         count=CollOut.Rows.Count
            If count&gt;precount Then
                Buffer=Nothing             Buffer = CollOut.Clone             Buffer=CollOut             precount=count             ReassignFlag=0
            End If
        else
            if count = Precount             ReassignFlag=1             Status=&quot;Salary cannot be identified since there mode are equal&quot;
                end
                if
            next
            Dim SD1p,SD1m,SD2p,SD2m,SD3p,SD3m,SD4p,SD4m as date
            Dim Sflag as integer =0
            Dim Salflag as integer =0
            Dim Lflag as integer =0
            Dim L2flag as integer =0
            Dim LLcheck as integer =0
            Dim BasicSalary as Integer =0
            Dim T as DataTable =Buffer.Clone
            Dim T2 as DataTable=Buffer.Clone
            Dim TX as DataTable=Buffer.Clone
            Dim LL as DataTable=Buffer.Clone
            Dim LL1 as DataTable=Buffer.Clone
            Dim L2 as DataTable=Buffer.Clone
            Dim L21 as DataTable=Buffer.Clone
            Dim L3 as DataTable=Buffer.Clone
            Dim Tcounter as integer =0
            Dim L3counter as integer =0
            Dim T2counter as integer =0
            Dim BSp,BSm as Decimal      Sum=0     minimum=0     Salary=0     Other=0     min=0     SD1p=SD1.AddDays(5)     SD1m=SD1.AddDays(-5)     SD2p=SD2.AddDays(5)     SD2m=SD2.AddDays(-5)     SD3p=SD3.AddDays(5)     SD3m=SD3.AddDays(-5)     SD4p=SD4.AddDays(9)     SD4m=SD4.AddDays(-9)     &#x27;        T=Buffer.Clone
            For r As Integer = 0 To Buffer.Rows.Count-1         if((SD1m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))OR (SD2m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD3m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD3p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD4m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD4p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))) then             x= Buffer.Rows(r)             TX.ImportRow(x)             x=TX.NewRow
            end if
        next     Buffer=TX
        For r As Integer = 0 To Buffer.Rows.Count-1     &#x27;
            If (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3) Then
                if(SD1m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) then             x= Buffer.Rows(r)             LL.ImportRow(x)             x=LL.NewRow             Lflag=Lflag+1
            End If
        end if
    next
    If Lflag&lt;1 Then
        Lflag=0         x=LL1.NewRow
    End If
    For r As Integer = 0 To Buffer.Rows.Count-1             if(SD1=Buffer.Rows(r)(&quot;Account date&quot;)) then                 x= Buffer.Rows(r)                 LL1.ImportRow(x)                 x=LL1.NewRow                 Lflag=Lflag+1
    end if
next         LL=LL1
end
if      LLout=LL &#x27;+++++++++++++++++++++++++++
    If Lflag&gt;0 Then
        &#x27;+++++++++++++++++++++++++++
    End If
    if Lflag=1 then
        For r As Integer = 0 To Buffer.Rows.Count-1                 if(SD2m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) then                     x= Buffer.Rows(r)                     L2.ImportRow(x)                     x=L2.NewRow                     L2flag=L2flag+1
        end if
    next
    If L2flag&gt;0 Then
        test=101
    End If
    If L2flag=1 Then
        test=120
    End If
    If L2.Rows(0)(&quot;Sal&quot;)&gt;=LL.Rows(0)(&quot;Sal&quot;) Then
        salflag=1                         Salary=LL.Rows(0)(&quot;Amount&quot;)                         ReassignFlag=0     test=100
    End If
else                         x=L3.NewRow
    For r As Integer = 0 To Buffer.Rows.Count-1                             if((SD1m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD2m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD3m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD3p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD4m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD4p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))) then                                 x= Buffer.Rows(r)                                 L3.ImportRow(x)                                 x=L3.NewRow                                 L3counter=L3counter+1
    end if
next
If L3counter&gt;2 Then
    min=L3.Rows(0)(&quot;Sal&quot;)+1
End If
For k As Integer = 0 To 2                                 Sum=Sum+L3.Rows(k)(&quot;Sal&quot;)
    If min&gt;L3.Rows(k)(&quot;Sal&quot;) Then
        min=L3.Rows(k)(&quot;Sal&quot;)                                     minimum=L3.Rows(k)(&quot;Amount&quot;)
    End If
    end
    if
next                              Avg=Sum/3
If Avg&lt;1.2*min Then
    Salary=minimum                                 Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)                                 salflag=1
End If
else                                 salflag=0
    end
    if
else                                     salflag=0
    end
    if
    end
    if
else test=110                     L2flag=0                     x=L21.NewRow
    For r As Integer = 0 To Buffer.Rows.Count-1                         if(SD2=Buffer.Rows(r)(&quot;Account date&quot;)) then                             x= Buffer.Rows(r)                             L21.ImportRow(x)                             x=L21.NewRow                             L2flag=L2flag+1
    end if
next                     L2=L21
if L2flag=1 then
    If L2.Rows(0)(&quot;Sal&quot;)&gt;=LL.Rows(0)(&quot;Sal&quot;) Then
        salflag=1                             Salary=LL.Rows(0)(&quot;Amount&quot;)                             ReassignFlag=0
    End If
    end
    if
    end
    if
    end
    if
    If salflag=0 Then
        &#x27;test=102 &#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;                     Sum=0
    End If
    For r As Integer = 0 To Buffer.Rows.Count-1                     &#x27;
        if (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1) then
            If (SD1m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) Then
                Sflag=Sflag+1                             BasicSalary=Buffer.Rows(r)(&quot;Sal&quot;)                             &#x27;AM=BasicSalary
            End If
            end
            if
        Next                     &#x27;AM=BasicSalary
        If Sflag=1 Then
            x=T.NewRow
        End If
        For r As Integer = 0 To Buffer.Rows.Count-1                     &#x27;
            If (Buffer.Rows(r)(&quot;Account date&quot;)=SD1p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD1 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD2 OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3p OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3m OR Buffer.Rows(r)(&quot;Account date&quot;)=SD3) Then
                if((SD1m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD2m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD3m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD3p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD4m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD4p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))) then                                 x= Buffer.Rows(r)                                 T.ImportRow(x)                                 x=T.NewRow                                 Tcounter=Tcounter+1
            End If
        end if
    next
    if Tcounter&lt;2                             ReassignFlag=1                             Status=&quot;Total number of feasible transaction is less than 2 after filtering with +/-5 salary date I&quot;
    else                             BSp=BasicSalary+(BasicSalary*20/100)                             BSm=BasicSalary-(BasicSalary*20/100)                             x=T2.NewRow
        for r as integer=0 to T.Rows.count-1                                 if(T.Rows(r)(&quot;Sal&quot;)&gt;=BSm AND T.Rows(r)(&quot;Sal&quot;)&lt;=BSp)                                     x= T.Rows(r)                                     T2.ImportRow(x)                                     x=T2.NewRow                                     T2counter=T2counter+1
            end
            if
        next
        If T2counter&lt;2 Then
            ReassignFlag=1                                 Status=&quot;Total number of feasible transaction is less than 2 after filtering BSm &lt;= Salary &lt;=BSp&quot;
        End If
    else
        if T2counter=2                                 min=T2.Rows(0)(&quot;Sal&quot;)+1
            For k As Integer = 0 To 1                                     Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                    min=T2.Rows(k)(&quot;Sal&quot;)                                         minimum=T2.Rows(k)(&quot;Amount&quot;)
                End If
                end
                if
            next                                 Avg= Sum / 2
            If Avg&lt;1.2*min Then
                test=2                                     Salary=minimum                                     Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
            End If
        else             test=2.1                                     Salary=minimum
            end
            if
        else                                 min=T2.Rows(0)(&quot;Sal&quot;)+1
            For k As Integer = 0 To 2                                     Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                    min=T2.Rows(k)(&quot;Sal&quot;)                                         minimum=T2.Rows(k)(&quot;Amount&quot;)
                End If
                end
                if
            next                                 Avg= Sum / 3
            If Avg&lt;1.2*min Then
                test=2                                     Salary=minimum                                     Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
            End If
        else             test=2.1                                     Salary=minimum
            end
            if
        end if
        end
        if
    else &#x27;=============================================================AA===================================================BEGIN
        Dim T3 as DataTable=Buffer.Clone
        Dim Tcounter2 as integer=0
        for r as integer =0 to Buffer.Rows.Count-1                             if(Buffer.Rows(r)(&quot;Sal&quot;)&gt;=LastApproved) then                                 x=T3.NewRow                                 x=Buffer.Rows(r)                                 T3.ImportRow(x)                                 Tcounter2=Tcounter2+1                                 BasicSalary=Buffer.Rows(r)(&quot;Sal&quot;)
            end
            if
        next                             Cop=Buffer &#x27;===============================================================BB=============================================BEGIN                         if(Tcounter2=1)                             x=T.NewRow
        For r As Integer = 0 To Buffer.Rows.Count-1                                 if((SD1m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))OR (SD2m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD3m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD3p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD4m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD4p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))) then                                     x= Buffer.Rows(r)                                     T.ImportRow(x)                                     x=T.NewRow                                     Tcounter=Tcounter+1
        end if
    next
    if Tcounter&lt;2                                 ReassignFlag=1                                 Status=&quot;Total number of feasible transaction is less than 2 after filtering with +/-5 salary date in AA-BB-Gov I&quot;
    else                                 BSp=BasicSalary+(BasicSalary*20/100)                                 BSm=BasicSalary-(BasicSalary*20/100)                                 x=T2.NewRow
        for r as integer=0 to T.Rows.count-1                                     if(T.Rows(r)(&quot;Sal&quot;)&gt;=BSm AND T.Rows(r)(&quot;Sal&quot;)&lt;=BSp)                                         x= T.Rows(r)                                         T2.ImportRow(x)                                         x=T2.NewRow                                         T2counter=T2counter+1
            end
            if
        next
        If T2counter&lt;2 Then
            ReassignFlag=1                                     Status=&quot;Total number of feasible transaction is less than 2 after filtering with +/-5 salary date in AA-BB-Gov II&quot;
        End If
    else
        if T2counter=2                                     min=T2.Rows(0)(&quot;Sal&quot;)+1
            For k As Integer = 0 To 1                                         Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                    min=T2.Rows(k)(&quot;Sal&quot;)                                             minimum=T2.Rows(k)(&quot;Amount&quot;)
                End If
                end
                if
            next                                     Avg= Sum / 2
            If Avg&lt;1.2*min Then
                test=3                                         Salary=minimum                                         Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
            End If
        else             test=3.1                                         Salary=minimum
            end
            if
        else                                     min=T2.Rows(0)(&quot;Sal&quot;)+1
            For k As Integer = 0 To 2                                         Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                    min=T2.Rows(k)(&quot;Sal&quot;)                                             minimum=T2.Rows(k)(&quot;Amount&quot;)
                End If
                end
                if
            next                                     Avg= Sum / 3
            If Avg&lt;1.2*min Then
                test=3                                         Salary=minimum                                         Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
            End If
        else             test=3.1                                         Salary=minimum
            end
            if
        end if
        end
        if &#x27;===============================================================BB=============================================END
        else
            Dim Count4 as integer=0
            Dim Prev as integer =0
            Dim Base as Decimal=0
            for r as integer=0 to A1.Rows.Count-1
                For j as integer=0 to T3.Rows.Count-1
                    if A1.Rows(r)(&quot;Amount&quot;)=T3.Rows(j)(&quot;Sal&quot;)                                         Count4=Count4+1
                        end
                        if
                    next
                    if prev&lt;Count4                                     BasicSalary=A1.Rows(r)(&quot;Amount&quot;)                                     prev=Count4
                        end
                        if                                 Count4=0
                        next                                             x=T.NewRow
                        For r As Integer = 0 To Buffer.Rows.Count-1                                 if((SD1m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD1p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))OR (SD2m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD2p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD3m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD3p&gt;=Buffer.Rows(r)(&quot;Account date&quot;)) OR (SD4m&lt;=Buffer.Rows(r)(&quot;Account date&quot;) AND SD4p&gt;=Buffer.Rows(r)(&quot;Account date&quot;))) then                                     x= Buffer.Rows(r)                                     T.ImportRow(x)                                     x=T.NewRow                                     Tcounter=Tcounter+1
                        end if
                    next
                    if Tcounter&lt;2                                 ReassignFlag=1                                 Status=&quot;Total number of feasible transaction is less than 2 after filtering with +/-5 salary date in AA-BB-Gov III&quot;
                    else                                 BSp=BasicSalary+(BasicSalary*20/100)                                 BSm=BasicSalary-(BasicSalary*20/100)                                 x=T2.NewRow
                        for r as integer=0 to T.Rows.count-1                                     if(T.Rows(r)(&quot;Sal&quot;)&gt;=BSm AND T.Rows(r)(&quot;Sal&quot;)&lt;=BSp)                                         x= T.Rows(r)                                         T2.ImportRow(x)                                         x=T2.NewRow                                         T2counter=T2counter+1
                            end
                            if
                        next
                        If T2counter&lt;2 Then
                            ReassignFlag=1                                     Status=&quot;Total number of feasible transaction is less than 2 after filtering BSm&lt;= SAL &lt;=BSp in AA-BB-Gov IV&quot;
                        End If
                    else
                        if T2counter=2                                     min=T2.Rows(0)(&quot;Sal&quot;)+1
                            For k As Integer = 0 To 1                                         Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                    min=T2.Rows(k)(&quot;Sal&quot;)                                             minimum=T2.Rows(k)(&quot;Amount&quot;)
                                End If
                                end
                                if
                            next                                     Avg= Sum / 2
                            If Avg&lt;1.2*min Then
                                test=4                                         Salary=minimum                                         Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                            End If
                        else             test=4.1                                         Salary=minimum
                            end
                            if
                        else                                      min=T2.Rows(0)(&quot;Sal&quot;)+1
                            For k As Integer = 0 To 2                                         Sum=Sum+T2.Rows(k)(&quot;Sal&quot;)
                                If min&gt;T2.Rows(k)(&quot;Sal&quot;) Then
                                    min=T2.Rows(k)(&quot;Sal&quot;)                                             minimum=T2.Rows(k)(&quot;Amount&quot;)
                                End If
                                end
                                if
                            next                                     Avg= Sum / 3
                            If Avg&lt;1.2*min Then
                                test=4                                         Salary=minimum                                         Other=Replace((Avg-min),&quot;.&quot;,&quot;,&quot;)
                            End If
                        else             test=4.1                                         Salary=minimum
                            end
                            if
                        end if
                        end
                        if
                        end
                        if
                        end
                        if
                        end
                        if                 &#x27;
                            end
                            if &#x27;=============================================================AA===================================================    END
                            else                  ReassignFlag=1                 Status=&quot;No transaction available in 2nd last month&quot;
                                end
                                if
                            else              Status=&quot;More than one transaction in +/-5 days of last month salary date&quot;             ReassignFlag=1
                                end
                                if
                            else         Status=&quot;No transaction in of last salary date&quot;         ReassignFlag=1
                                end
                                if
                            else      Status=&quot;Total number of feasible transaction is less than 3&quot;     ReassignFlag=1
                                end
                                if D0=D1 A0=A1
                                catch e as Exception         er=e.ToString         ReassignFlag=1         Status=&quot;Code Error:&quot;+e.ToString
                                    end
                                    try"
                            data-title="UWCA_MRCC_CTF_V1.0 / Salary code / Universal salary code">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>UWCA_MRCC_CTF_V1.0</td>
                <td>SimahLogic</td>
                <td>Simah Code</td>
                <td>visualbasic</td>
                <td>213</td>
                <!--<td style="font-family: monospace;">ed44e41c88674a3ef361c41dca88ad4fd6607d08bd074f6da07eaabbfdeeb68d</td>-->
                <td>reflection</td>
                <!--<td>&#x27;Simah logic is to check other banks outstanding amout. if any of the cusotmer have more than expected outstanding amout BOT will reassign the case.     Dim Company_Type,Product_Type,Status_W,Status_Hiso     try as String         Dim DefaultProductCode,DefaultStatusCode,DefaultOutStandingAmount,Defa...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="&#x27;Simah logic is to check other banks outstanding amout.
if any of the cusotmer have more than expected outstanding amout BOT will reassign the case.
    Dim Company_Type,Product_Type,Status_W,Status_Hiso
    try as String
        Dim DefaultProductCode,DefaultStatusCode,DefaultOutStandingAmount,DefaultDate,DefaultCredit,TotOutstandingAmount,TotOutStandingAmountNONMobile as String
        Dim NSDateDiff as Integer
        Dim Status_Flag as Boolean=False
        Dim Rajb_Flag as Boolean =False
        Dim FlagForSimahApprovalOrRejection as Boolean=False ReassignFlag =&quot;&quot; ReassignReason=&quot;&quot;
        Dim NWtable as new DataTable
        Dim TotalOutstandingAmountNONMobile as Double=0 &#x27;
        Dim TotalOutstandingAmountMilitory as Double=0  &#x27;
        Dim TotalOutstandingAmountGov as Double=0 &#x27;
        Dim TotalOutstandingAmountPrivate as Double=0
        Dim TotalOutstandingAmount as Double=0 NWtable.Columns.Add(&quot;Column1&quot;, Type.GetType(&quot;System.String&quot;)) NWtable.Columns.Add(&quot;Column2&quot;, Type.GetType(&quot;System.String&quot;)) NWtable.Columns.Add(&quot;Column20&quot;, Type.GetType(&quot;System.String&quot;)) NWtable.Columns.Add(&quot;Column14&quot;, Type.GetType(&quot;System.String&quot;))  &#x27;check wether CreditDetails table contain status as W and Company_Type either RAJB or ADFL leave those rows. Other than that add to NWtable.
        If  CreditDetails.Rows.Count&gt;=3 Then
            For i As Integer = 0 To CreditDetails.Rows.Count - 1
                If i&gt;=2 Then
                    Company_Type=CreditDetails.Rows(i)(&quot;Column1&quot;)         Product_Type=CreditDetails.Rows(i)(&quot;Column2&quot;)         Status_W=CreditDetails.Rows(i)(&quot;Column7&quot;)         Status_Hiso
                End If
                try=CreditDetails.Rows(i)(&quot;Column20&quot;)
                    If Status_W=&quot;W&quot; Then
                        Status_Flag=True
                    End If
                else
                    if Company_Type=&quot;RAJB&quot; OR Company_Type=&quot;ADFL&quot; OR Company_Type=&quot;GOVR&quot; OR Company_Type=&quot;VRA&quot; OR Product_Type=&quot;VRA&quot; then
                    else         NWtable.Rows.Add(CreditDetails.Rows(i)(&quot;Column1&quot;),CreditDetails.Rows(i)(&quot;Column2&quot;),CreditDetails.Rows(i)(&quot;Column20&quot;),CreditDetails.Rows(i)(&quot;Column14&quot;))
                        end
                        if
                    end if
                Next
                End
                If   &#x27;
                    If Status is W(defaulter) and Defaulter table having more than 2 records. calculate outstanding amount based on the business rules.
                        If DefaultTable.Rows.Count&gt;=3 Then
                            For j As Integer = 0 To DefaultTable.Rows.Count - 1
                                If j &gt;= 2 Then
                                    &#x27;Start If1             DefaultProductCode=Trim(DefaultTable.Rows(j)(&quot;Column1&quot;))             DefaultStatusCode=Trim(DefaultTable.Rows(j)(&quot;Column6&quot;))             DefaultOutStandingAmount=Trim(DefaultTable.Rows(j)(&quot;Column5&quot;))              DefaultDate=DefaultTable.Rows(j)(&quot;Column3&quot;)             DefaultCredit=Trim(DefaultTable.Rows(j)(&quot;Column2&quot;))                 NSDateDiff=DateDiff(&quot;d&quot;,Convert.ToDateTime(DefaultDate),Now())
                                End If
                                If  DefaultCredit=&quot;RAJB&quot;   Then
                                    If DefaultStatusCode &lt;&gt; &quot;FS&quot; Then
                                        Rajb_Flag=True
                                    End If
                                    end
                                    if
                                    end
                                    if
                                    If DefaultCredit=&quot;AQAR&quot; OR DefaultCredit=&quot;ADFL&quot; OR DefaultCredit=&quot;SCSB&quot; OR DefaultCredit=&quot;REDF&quot; OR DefaultCredit=&quot;AGDF&quot; OR DefaultProductCode=&quot;VRA&quot;  Then
                                        End
                                        if
                                        If DefaultProductCode=&quot;MBL&quot; OR DefaultProductCode=&quot;LND&quot; OR DefaultProductCode=&quot;NET&quot; OR DefaultProductCode=&quot;RCSR&quot; OR DefaultProductCode=&quot;WAT&quot; Then
                                            &#x27;Start If2
                                        End If
                                        If DefaultCredit=&quot;AQAR&quot; OR DefaultCredit=&quot;ADFL&quot; OR DefaultCredit=&quot;SCSB&quot; OR DefaultCredit=&quot;REDF&quot; OR DefaultCredit=&quot;AGDF&quot; OR DefaultProductCode=&quot;VRA&quot; Then
                                            &#x27;Start If3                 &#x27;
                                        End If
                                        If above 2 condition match BOT will continue to take other record.
                                        else
                                            If DefaultStatusCode=&quot;OS&quot; OR DefaultStatusCode=&quot;PP&quot; Then
                                                &#x27;Start If4                     TotOutStandingAmount=Replace(Replace(DefaultOutStandingAmount,&quot;.&quot;,&quot;&quot;),&quot;,&quot;,&quot;.&quot;)                                         TotalOutstandingAmount=TotalOutstandingAmount+CDbl(TotOutStandingAmount)
                                            End If
                                            End
                                            If &#x27;
                                            End If4
                                            End
                                            If  &#x27;
                                            End If3
                                        else
                                            if DefaultCredit=&quot;RAJB&quot; then
                                                If DefaultStatusCode &lt;&gt; &quot;FS&quot; Then
                                                    &#x27;Start If7                     Rajb_Flag=True
                                                End If
                                                End
                                                If &#x27;
                                                End If7
                                            else
                                                If DefaultCredit=&quot;RAJB&quot; then&#x27;Start If8
                                                    If DefaultStatusCode &lt;&gt; &quot;FS&quot; Then
                                                        &#x27;Start If9                         Rajb_Flag=True
                                                    End If
                                                    End
                                                    If &#x27;
                                                    End If9
                                                else
                                                    If DefaultCredit=&quot;AQAR&quot; OR DefaultCredit=&quot;ADFL&quot; OR DefaultCredit=&quot;SCSB&quot; OR DefaultCredit=&quot;REDF&quot; OR DefaultCredit=&quot;AGDF&quot; OR DefaultProductCode=&quot;VRA&quot; Then
                                                        &#x27;
                                                    End If
                                                    if above condition met
                                                        End
                                                        IF
                                                    else             &#x27;MsgBox(TotalOutstandingAmountNONMobile.ToString())
                                                        If DefaultStatusCode=&quot;OS&quot; OR DefaultStatusCode=&quot;PP&quot; Then&#x27;Start If10                         TotOutStandingAmountNONMobile=Replace(Replace(DefaultOutStandingAmount,&quot;.&quot;,&quot;&quot;),&quot;,&quot;,&quot;.&quot;)                             TotalOutstandingAmountNONMobile=TotalOutstandingAmountNONMobile+CDbl(TotOutStandingAmountNONMobile)                     &#x27;
                                                        else
                                                            If DefaultStatusCode=&quot;NS&quot; Then
                                                                &#x27;Deleted the NS Logic here
                                                            End If
                                                            End
                                                            If &#x27;
                                                            End If10
                                                            End
                                                            if
                                                            End
                                                            if
                                                            end
                                                            if &#x27;
                                                            End If1
                                                        Next
                                                        End
                                                        If   &#x27;
                                                            if any of the outstanding amout greater than expected amout BOt will reject with below comments
                                                                If TotalOutstandingAmountNONMobile &gt;=5000 Then
                                                                    ReassignFlag=&quot;Reject&quot; ReassignReason=&quot;Rejected the case since the outstanding amount in simah check the non telecom outstanding amount is greater than 5000&quot;
                                                                End If
                                                                return
                                                            else
                                                                If TotalOutstandingAmount &gt;=20000 Then
                                                                    ReassignFlag=&quot;Reject&quot; ReassignReason=&quot;Rejected the case since the outstanding amount in simah check the teleco outstanding balance is greater than 20000&quot;
                                                                End If
                                                                return
                                                            else
                                                                If Rajb_Flag Then
                                                                    ReassignFlag=&quot;Reassign&quot; ReassignReason=&quot;Reassigned the case since there is a RAJB case in simah Creditor and status not FS in default table&quot;
                                                                End If
                                                                return &#x27;
                                                            else
                                                                If TotalOutstandingAmountMilitory &gt;=15000 Then
                                                                    &#x27;ReassignFlag=&quot;Reject&quot; &#x27;ReassignReason=&quot;Rejected since the NS amount for the military category is greater than 15000&quot; &#x27;
                                                                End If
                                                                return &#x27;
                                                            else
                                                                If TotalOutstandingAmountGov &gt;=30000 Then
                                                                    &#x27;ReassignFlag=&quot;Reject&quot; &#x27;ReassignReason=&quot;Rejected since the NS amount for the government category is greater than 30000&quot; &#x27;
                                                                End If
                                                                return &#x27;
                                                            else
                                                                If TotalOutstandingAmountPrivate &gt;=10000 Then
                                                                    &#x27;ReassignFlag=&quot;Reject&quot; &#x27;ReassignReason=&quot;Rejected since the NS amount for the private category is greater than 10000&quot; &#x27;
                                                                End If
                                                                return
                                                            else
                                                                end
                                                                If
                                                                Dim TelicomCase,StatusHistory,StatusHistory1 as String  &#x27;
                                                                If CreditInstrument table have Status with BOT will check that outstanding amout.
                                                                    if any of the outstanding amout more than expected BOT will reject the case.
                                                                        if NWtable.Rows.Count&gt;=1 then
                                                                            For k As Integer = 0 To NWtable.Rows.Count - 1         TelicomCase=NWtable.Rows(k)(&quot;Column14&quot;)         StatusHistory=NWtable.Rows(k)(&quot;Column20&quot;)         StatusHistory1=Left(StatusHistory,1)         StatusHistory=&quot; &quot;+StatusHistory
                                                                                if StatusHistory1=&quot;0&quot; OR StatusHistory1=&quot;1&quot; OR  StatusHistory1=&quot;2&quot; OR StatusHistory1=&quot;3&quot; OR StatusHistory1=&quot;Q&quot; OR StatusHistory1=&quot;D&quot; OR            StatusHistory1=&quot;C&quot; OR StatusHistory1=&quot;F&quot; OR StatusHistory1=&quot;R&quot; OR StatusHistory1=&quot;N&quot;  then
                                                                                else
                                                                                    if StatusHistory1=&quot;4&quot; OR StatusHistory1=&quot;5&quot; OR StatusHistory1=&quot;6&quot; then
                                                                                        if Trim(NWtable.Rows(k)(&quot;Column2&quot;))=&quot;MBL&quot; OR Trim(NWtable.Rows(k)(&quot;Column2&quot;))=&quot;LND&quot; OR Trim(NWtable.Rows(k)(&quot;Column2&quot;))=&quot;NET&quot; OR Trim(NWtable.Rows(k)(&quot;Column2&quot;))=&quot;WAT&quot; OR Trim(NWtable.Rows(k)(&quot;Column2&quot;))=&quot;RCSR&quot;  then
                                                                                            If Len(Trim(TelicomCase))&gt; 0 Then
                                                                                                TelicomCase=Replace(Replace(TelicomCase,&quot;.&quot;,&quot;&quot;),&quot;,&quot;,&quot;.&quot;)                     TotalOutstandingAmount=TotalOutstandingAmount+CDbl(TelicomCase)
                                                                                            End If
                                                                                        else                     TelicomCase=&quot;0&quot;                     TotalOutstandingAmount=TotalOutstandingAmount+CDbl(TelicomCase)
                                                                                            end
                                                                                            if
                                                                                            If TotalOutstandingAmount&gt;=20000 Then
                                                                                                ReassignFlag=&quot;Reject&quot;                     ReassignReason=&quot;Rejected the case since the outstanding amount in simah check since the teleco outstanding balance is greater than 20000&quot;
                                                                                            End If
                                                                                            return
                                                                                            end
                                                                                            if
                                                                                        else
                                                                                            if Trim(NWtable.Rows(k)(&quot;Column2&quot;))=&quot;AQAR&quot; OR Trim(NWtable.Rows(k)(&quot;Column2&quot;))=&quot;ADLF&quot; OR Trim(NWtable.Rows(k)(&quot;Column2&quot;))=&quot;SLAN&quot; then
                                                                                            else             FlagForSimahApprovalOrRejection=True
                                                                                                end
                                                                                                if
                                                                                            else
                                                                                                If StatusHistory1=&quot;M&quot; OR StatusHistory1=&quot;m&quot; Then
                                                                                                    &#x27;
                                                                                                End If
                                                                                                Dim TempText as String=IsPatternMatch(&quot;(?&lt;Result&gt;[m,M]*)[0-9].*&quot;,StatusHistory)
                                                                                                Dim out as Integer
                                                                                                Dim TempText as String=Trim(StatusHistory)             out=0  &#x27;=================================================================================================
                                                                                                For i as integer=1 to TempText.Length()
                                                                                                    If Mid(TempText,i,1).ToUpper()=&quot;M&quot; Then
                                                                                                        out=out+1
                                                                                                    End If
                                                                                                else
                                                                                                    If InStr(&quot;0123456789&quot;,Mid(TempText,i,1))&gt;0 Then
                                                                                                        out=out+CInt(Mid(TempText,i,1))
                                                                                                    End If
                                                                                                    exit
                                                                                                    For
                                                                                                else
                                                                                                    exit
                                                                                                    For
                                                                                                    end
                                                                                                    If
                                                                                                Next   &#x27;================================================================================================
                                                                                                If out &gt; 3 Then
                                                                                                    ReassignFlag=&quot;Reject&quot;             ReassignReason=&quot;Rejected the case since the Statushistory M check fail&quot;
                                                                                                End If
                                                                                                return
                                                                                            end If
                                                                                        else
                                                                                            End
                                                                                            if
                                                                                        Next
                                                                                        End
                                                                                        if
                                                                                        If TotalOutstandingAmount&gt;=20000 Then
                                                                                            ReassignFlag=&quot;Reject&quot; ReassignReason=&quot;Rejected the case since the outstanding amount in simah check since the teleco outstanding balance is greater than 20000&quot;
                                                                                        End If
                                                                                        return
                                                                                        end
                                                                                        if
                                                                                        If FlagForSimahApprovalOrRejection = True Then
                                                                                            ReassignFlag=&quot;Reject&quot; ReassignReason=&quot;Rejected due to Simah check failed since the status history shows rejection code(4,5,6)&quot;
                                                                                        End If
                                                                                        return
                                                                                    End If"
                            data-title="UWCA_MRCC_CTF_V1.0 / SimahLogic / Simah Code">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>Utility - General</td>
                <td>Process Exists</td>
                <td>Process Exists</td>
                <td>visualbasic</td>
                <td>7</td>
                <!--<td style="font-family: monospace;">97d465bf1aafd1ff0dff1a1f864e4de8c1dbb536bfb806480fdb92716316551d</td>-->
                <td>—</td>
                <!--<td>try     for each p as system.diagnostics.process in system.diagnostics.process.getprocessesbyname(Process_Name)  exists = true         exit sub     next catch e as exception     end     try  exists = false</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="try
    for each p as system.diagnostics.process in system.diagnostics.process.getprocessesbyname(Process_Name)  exists = true
        exit sub
    next
catch e as exception
    end
    try  exists = false"
                            data-title="Utility - General / Process Exists / Process Exists">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>Utility - General</td>
                <td>Window Exists</td>
                <td>Window Exists</td>
                <td>visualbasic</td>
                <td>27</td>
                <!--<td style="font-family: monospace;">608b6ce9597677e7a2dd0e82338c9014fa769678824e1b6653a9ef65c41163eb</td>-->
                <td>—</td>
                <!--<td>try     If wildcard Then         title = title.replace(&quot;*&quot;, &quot;.*&quot;)     title = title.replace(&quot;?&quot;, &quot;\w&quot;)     End If     end     if  exists = false         for each p as system.diagnostics.process in system.diagnostics.process.getprocesses()             if wildcard then                 If system.text.r...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="try
    If wildcard Then
        title = title.replace(&quot;*&quot;, &quot;.*&quot;)     title = title.replace(&quot;?&quot;, &quot;\w&quot;)
    End If
    end
    if  exists = false
        for each p as system.diagnostics.process in system.diagnostics.process.getprocesses()
            if wildcard then
                If system.text.regularexpressions.regex.ismatch(p.mainwindowtitle, title) Then
                    exists = true
                End If
                exit sub
                end
                if
            else
                If p.mainwindowtitle.tolower = title.tolower Then
                    exists = true
                End If
                exit sub
                end
                if
                end
                if
            next
        catch e as exception
            end
            try"
                            data-title="Utility - General / Window Exists / Window Exists">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>Utility - JSON</td>
                <td>Collection to JSON</td>
                <td>Collection To JSON</td>
                <td>visualbasic</td>
                <td>1</td>
                <!--<td style="font-family: monospace;">cb461afcb12d189aed4192b25079c585a732206dc0d0c9d1d9a2dfd50a1148db</td>-->
                <td>—</td>
                <!--<td>json = convertToJSON(data)</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="json = convertToJSON(data)"
                            data-title="Utility - JSON / Collection to JSON / Collection To JSON">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>Utility - JSON</td>
                <td>JSON to Collection</td>
                <td>JSON To Collection</td>
                <td>visualbasic</td>
                <td>1</td>
                <!--<td style="font-family: monospace;">8630ceede4aa013696351f0cabc58f6d69b994ea380451d656b8d9f675b90046</td>-->
                <td>—</td>
                <!--<td>result = ConvertToDataTable(json)</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="result = ConvertToDataTable(json)"
                            data-title="Utility - JSON / JSON to Collection / JSON To Collection">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>Utility - JSON</td>
                <td>JSON to Collection (skipping JArray)</td>
                <td>JSON To Collection Without JArray</td>
                <td>visualbasic</td>
                <td>4</td>
                <!--<td style="font-family: monospace;">c3510d210aa55fea30258248b32c0da0402994ddb6ae76fd96d190b7d8ff6d90</td>-->
                <td>—</td>
                <!--<td>Try     mUseNewParseMethod = True     result = ConvertToDataTable(json) Finally     mUseNewParseMethod = False     End     Try</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Try     mUseNewParseMethod = True     result = ConvertToDataTable(json)
Finally     mUseNewParseMethod = False
    End
    Try"
                            data-title="Utility - JSON / JSON to Collection (skipping JArray) / JSON To Collection Without JArray">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>Utility - Maths</td>
                <td>ArcCos (Deg)</td>
                <td>ArcCos (Deg)</td>
                <td>csharp</td>
                <td>1</td>
                <!--<td style="font-family: monospace;">a3404ed09954987084cfd0d806b23583e91af953b55f5f6caedf4166b4b01fd5</td>-->
                <td>—</td>
                <!--<td>AngleInRadians = (decimal)Math.Acos((double)CosValue);</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="AngleInRadians = (decimal)Math.Acos((double)CosValue);"
                            data-title="Utility - Maths / ArcCos (Deg) / ArcCos (Deg)">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>Utility - Maths</td>
                <td>ArcCos (Rad)</td>
                <td>ArcCos (Rad)</td>
                <td>csharp</td>
                <td>1</td>
                <!--<td style="font-family: monospace;">a3404ed09954987084cfd0d806b23583e91af953b55f5f6caedf4166b4b01fd5</td>-->
                <td>—</td>
                <!--<td>AngleInRadians = (decimal)Math.Acos((double)CosValue);</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="AngleInRadians = (decimal)Math.Acos((double)CosValue);"
                            data-title="Utility - Maths / ArcCos (Rad) / ArcCos (Rad)">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>Utility - Maths</td>
                <td>ArcSin (Deg)</td>
                <td>ArcSin (Deg)</td>
                <td>csharp</td>
                <td>1</td>
                <!--<td style="font-family: monospace;">d198db147cbf9fee498e209863b31deb21d1bfadba46d95174f3d9a74de60128</td>-->
                <td>—</td>
                <!--<td>AngleInRadians = (decimal)Math.Asin((double)SinValue);</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="AngleInRadians = (decimal)Math.Asin((double)SinValue);"
                            data-title="Utility - Maths / ArcSin (Deg) / ArcSin (Deg)">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>Utility - Maths</td>
                <td>ArcSin (Rad)</td>
                <td>ArcSin (Rad)</td>
                <td>csharp</td>
                <td>1</td>
                <!--<td style="font-family: monospace;">d198db147cbf9fee498e209863b31deb21d1bfadba46d95174f3d9a74de60128</td>-->
                <td>—</td>
                <!--<td>AngleInRadians = (decimal)Math.Asin((double)SinValue);</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="AngleInRadians = (decimal)Math.Asin((double)SinValue);"
                            data-title="Utility - Maths / ArcSin (Rad) / ArcSin (Rad)">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>Utility - Maths</td>
                <td>ArcTan (Deg)</td>
                <td>ArcTan (Deg)</td>
                <td>csharp</td>
                <td>1</td>
                <!--<td style="font-family: monospace;">92fe212b17a115c3a917f3361b856a601391ba99cef1268b616ee891a55c78f5</td>-->
                <td>—</td>
                <!--<td>AngleInRadians = (decimal)Math.Atan((double)TanValue);</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="AngleInRadians = (decimal)Math.Atan((double)TanValue);"
                            data-title="Utility - Maths / ArcTan (Deg) / ArcTan (Deg)">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>Utility - Maths</td>
                <td>ArcTan (Rad)</td>
                <td>ArcTan (Rad)</td>
                <td>csharp</td>
                <td>1</td>
                <!--<td style="font-family: monospace;">92fe212b17a115c3a917f3361b856a601391ba99cef1268b616ee891a55c78f5</td>-->
                <td>—</td>
                <!--<td>AngleInRadians = (decimal)Math.Atan((double)TanValue);</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="AngleInRadians = (decimal)Math.Atan((double)TanValue);"
                            data-title="Utility - Maths / ArcTan (Rad) / ArcTan (Rad)">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>Utility - Maths</td>
                <td>Cos (Rad)</td>
                <td>Calculate Cosine</td>
                <td>csharp</td>
                <td>1</td>
                <!--<td style="font-family: monospace;">1d476b56542862190ceb2234b1ce9c1926f35157904d190160f5350d5d4dd90e</td>-->
                <td>—</td>
                <!--<td>Result = (Decimal)Math.Cos((Double)AngleInRadians);</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Result = (Decimal)Math.Cos((Double)AngleInRadians);"
                            data-title="Utility - Maths / Cos (Rad) / Calculate Cosine">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>Utility - Maths</td>
                <td>Cosh (Rad)</td>
                <td>Calculate Hyperbolic Cosine</td>
                <td>csharp</td>
                <td>1</td>
                <!--<td style="font-family: monospace;">300dac470dd300ff512f27c15c28f5a48049a359b34c48a2bd87ed942fb90a17</td>-->
                <td>—</td>
                <!--<td>Result = (Decimal)Math.Cosh((Double)AngleInRadians);</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Result = (Decimal)Math.Cosh((Double)AngleInRadians);"
                            data-title="Utility - Maths / Cosh (Rad) / Calculate Hyperbolic Cosine">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>Utility - Maths</td>
                <td>E</td>
                <td>Calculate E</td>
                <td>csharp</td>
                <td>1</td>
                <!--<td style="font-family: monospace;">7c4140bdcd45b9951c6924d1e527d4c6e787652088449e5ac3c2ca40d32a2a10</td>-->
                <td>—</td>
                <!--<td>EOut = (Decimal)Math.E;</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="EOut = (Decimal)Math.E;"
                            data-title="Utility - Maths / E / Calculate E">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>Utility - Maths</td>
                <td>Modulo</td>
                <td>Calculate Modulo</td>
                <td>csharp</td>
                <td>7</td>
                <!--<td style="font-family: monospace;">6b712540d63a60643deb0cf18ccc2570fcbda9ef524cdf92221a685e214b9308</td>-->
                <td>—</td>
                <!--<td>if (CodeValue1 &gt; 0 &amp;&amp; CodeValue2&gt;0) {     Out = CodeValue1 % CodeValue2; } else {     Out = -1; }</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="if (CodeValue1 &gt; 0 &amp;&amp; CodeValue2&gt;0) {
    Out = CodeValue1 % CodeValue2;
}
else
{
    Out = -1;
}"
                            data-title="Utility - Maths / Modulo / Calculate Modulo">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>Utility - Maths</td>
                <td>PI</td>
                <td>Calculate PI</td>
                <td>csharp</td>
                <td>1</td>
                <!--<td style="font-family: monospace;">b7041810bb42c642b326f08c21fc1da06300d16739910868d5f5af624922fd6a</td>-->
                <td>—</td>
                <!--<td>PI = (Decimal)Math.PI;</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="PI = (Decimal)Math.PI;"
                            data-title="Utility - Maths / PI / Calculate PI">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>Utility - Maths</td>
                <td>Random (Single)</td>
                <td>Generate Random</td>
                <td>csharp</td>
                <td>4</td>
                <!--<td style="font-family: monospace;">ca1e3daca612c1cab52a74c1f1736423ae56a35e72cabde7c160d06b844f3d27</td>-->
                <td>—</td>
                <!--<td>Random rand = new Random(); if (MinValue&lt;MaxValue) RandomValue = rand.Next((int)MinValue,(int)MaxValue); else if(MinValue&gt;MaxValue) RandomValue=-1; else RandomValue = MinValue;</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Random rand = new Random();
if (MinValue&lt;MaxValue) RandomValue = rand.Next((int)MinValue,(int)MaxValue);
else if(MinValue&gt;MaxValue) RandomValue=-1;
else RandomValue = MinValue;"
                            data-title="Utility - Maths / Random (Single) / Generate Random">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>Utility - Maths</td>
                <td>Random True (Single)</td>
                <td>Generate True Random</td>
                <td>csharp</td>
                <td>22</td>
                <!--<td style="font-family: monospace;">bc65f4c3562f7d616079177ad91059d4f640f2f4ed8b86dd3bb771f1814654dc</td>-->
                <td>—</td>
                <!--<td>if (MinValue &lt; MaxValue) {     using (RNGCryptoServiceProvider rg = new RNGCryptoServiceProvider()) {         // byte[] rno = new byte[4];         // rg.GetBytes(rno);         // RandomValue = (decimal)BitConverter.ToInt32(rno, 0);         uint scale = uint.MaxValue;         while (scale == uint.Max...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="if (MinValue &lt; MaxValue) {
    using (RNGCryptoServiceProvider rg = new RNGCryptoServiceProvider()) {
        // byte[] rno = new byte[4];
        // rg.GetBytes(rno);
        // RandomValue = (decimal)BitConverter.ToInt32(rno, 0);
        uint scale = uint.MaxValue;
        while (scale == uint.MaxValue) {
            // Get four random bytes. byte[] four_bytes = new byte[4];
            rg.GetBytes(four_bytes);
            // Convert that into an uint. scale = BitConverter.ToUInt32(four_bytes, 0);
        }
    // Add min to the scaled difference between max and min. RandomValue = (int)(MinValue + (MaxValue - MinValue) * (scale / (decimal)uint.MaxValue));
}

}
else if (MinValue&gt;MaxValue) {
    RandomValue = -1;
}
else
{
    RandomValue = MinValue;
}"
                            data-title="Utility - Maths / Random True (Single) / Generate True Random">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>Utility - Maths</td>
                <td>Root</td>
                <td>Calculate Root</td>
                <td>csharp</td>
                <td>5</td>
                <!--<td style="font-family: monospace;">cb57f2f522abb002bba7d783a8b5c361b0cc24da0998b508edfce5846cb77b24</td>-->
                <td>—</td>
                <!--<td>double root = (System.Math.Pow((double)ValueIn, (1.0D/(double)Root))); double roundedRoot = Math.Round(root); //if (Math.Abs(roundedRoot - root) &lt; VERY_SMALL_NUMBER) //return roundedRoot; //else //return root; Result = (decimal)roundedRoot;</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="double root = (System.Math.Pow((double)ValueIn, (1.0D/(double)Root)));
double roundedRoot = Math.Round(root);
//if (Math.Abs(roundedRoot - root) &lt; VERY_SMALL_NUMBER) //return roundedRoot;
//else //return root;
Result = (decimal)roundedRoot;"
                            data-title="Utility - Maths / Root / Calculate Root">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>Utility - Maths</td>
                <td>Sin (Rad)</td>
                <td>Calculate Sine</td>
                <td>csharp</td>
                <td>1</td>
                <!--<td style="font-family: monospace;">726f4ec2c8d2708e727fcbf0312ef745d63d5b777a762722d913dc1ab8491ae8</td>-->
                <td>—</td>
                <!--<td>Result = (Decimal)Math.Sin((Double)AngleInRadians);</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Result = (Decimal)Math.Sin((Double)AngleInRadians);"
                            data-title="Utility - Maths / Sin (Rad) / Calculate Sine">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>Utility - Maths</td>
                <td>Sinh (Rad)</td>
                <td>Calculate Sinh</td>
                <td>csharp</td>
                <td>1</td>
                <!--<td style="font-family: monospace;">a5369ce34ec9ca5fb397082b38adc21d6842b9eb3527b0e002918cb82e097d6f</td>-->
                <td>—</td>
                <!--<td>Result = (Decimal)Math.Sinh((Double)AngleInRadians);</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Result = (Decimal)Math.Sinh((Double)AngleInRadians);"
                            data-title="Utility - Maths / Sinh (Rad) / Calculate Sinh">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>Utility - Maths</td>
                <td>Tan (Rad)</td>
                <td>Calculate Tan</td>
                <td>csharp</td>
                <td>1</td>
                <!--<td style="font-family: monospace;">7971c031c6cbe7dcbdc36d2f1423a89fd8a1e5d87ef3bfefa5f9cc57702112dc</td>-->
                <td>—</td>
                <!--<td>Result = (Decimal)Math.Tan((Double)AngleInRadians);</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Result = (Decimal)Math.Tan((Double)AngleInRadians);"
                            data-title="Utility - Maths / Tan (Rad) / Calculate Tan">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>Utility - Maths</td>
                <td>Tanh (Rad)</td>
                <td>Calculate Tanh</td>
                <td>csharp</td>
                <td>1</td>
                <!--<td style="font-family: monospace;">16983607e43e76c8ea2b371da06b7e2dfb5bcd041fc0d1e42e7a185dfb37ff62</td>-->
                <td>—</td>
                <!--<td>Result = (Decimal)Math.Tanh((Double)AngleInRadians);</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Result = (Decimal)Math.Tanh((Double)AngleInRadians);"
                            data-title="Utility - Maths / Tanh (Rad) / Calculate Tanh">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>Utility - Strings (Extended)</td>
                <td>Regex V2</td>
                <td>Perform Regex And Return Matches</td>
                <td>visualbasic</td>
                <td>8</td>
                <!--<td style="font-family: monospace;">82607da073f274ffa29a6febf8f67cbb1fbe0318428e5d8f65c51df6fcbb3d24</td>-->
                <td>reflection</td>
                <!--<td>Dim options as RegexOptions = 0 If Ignore Case Then options = RegexOptions.Ignore     Case     Dim rex as New Regex(Rx, options)     Dim matches as MatchCollection = rex.matches(Str)  RxGroups = New DataTable() RxGroups.Columns.Add(&quot;Group&quot;, GetType(String))     For Each match as Match In matches   R...</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="Dim options as RegexOptions = 0
If Ignore
Case Then options = RegexOptions.Ignore
    Case
    Dim rex as New Regex(Rx, options)
    Dim matches as MatchCollection = rex.matches(Str)  RxGroups = New DataTable() RxGroups.Columns.Add(&quot;Group&quot;, GetType(String))
    For Each match as Match In matches   RxGroups.Rows.Add(New Object() {match.Groups(0).Value})     IsMatch = True
    Next"
                            data-title="Utility - Strings (Extended) / Regex V2 / Perform Regex And Return Matches">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>Utility - Timestamp Conversion</td>
                <td>Convert Timestamp to DateTime</td>
                <td>Unix Epoch Time To DateTime</td>
                <td>csharp</td>
                <td>1</td>
                <!--<td style="font-family: monospace;">8974b8bdd2987705a297c2675bdd58800ed0f5f13a98311ca8933584998b71cd</td>-->
                <td>—</td>
                <!--<td>DateTimeValue = UnixTimeStampToDateTime((int)UnixEpochTime);</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="DateTimeValue = UnixTimeStampToDateTime((int)UnixEpochTime);"
                            data-title="Utility - Timestamp Conversion / Convert Timestamp to DateTime / Unix Epoch Time To DateTime">
                      View code
                    </button>
                </td>
            </tr>
        
            <tr>
                <td>Utility - Timestamp Conversion</td>
                <td>Create Timestamp</td>
                <td>Unix Epoch Time</td>
                <td>csharp</td>
                <td>1</td>
                <!--<td style="font-family: monospace;">d8450b09bca32096505bbce49d4d7d757d45fee7a1612c76ed657442b5f2da89</td>-->
                <td>—</td>
                <!--<td>UnixEpochTime = DateTimeToUnixTimeStamp(DateTimeValue);</td>-->
                <td>
                    <button class="code-btn"
                            onclick="openCodeModal(this)"
                            data-code="UnixEpochTime = DateTimeToUnixTimeStamp(DateTimeValue);"
                            data-title="Utility - Timestamp Conversion / Create Timestamp / Unix Epoch Time">
                      View code
                    </button>
                </td>
            </tr>
        
            </tbody>
        </table>
        <p style="margin-top: 10px; color: #555;">
            Tip: use SHA256 to find duplicates across objects (same code copied around).
        </p>
    </div>
    
        </div>

        <!-- Modal (hidden until opened) -->
        <div id="code-modal-overlay" class="code-modal-overlay" onclick="closeCodeModal(event)">
          <div class="code-modal" role="dialog" aria-modal="true" aria-labelledby="code-modal-title" onclick="event.stopPropagation()">
            <div class="code-modal-header">
              <div id="code-modal-title" class="code-modal-title">Code</div>
              <div class="code-modal-actions">
                <button class="code-modal-action" onclick="copyCode()">Copy</button>
                <button class="code-modal-action" onclick="closeCodeModal()">Close</button>
              </div>
            </div>
            <pre id="code-modal-pre" class="code-modal-pre"></pre>
          </div>
        </div>
    </body>
    </html>
    